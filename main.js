(function(){(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,o=Function.prototype,a=r.push,s=r.slice,l=r.concat,u=(r.unshift,i.toString),c=i.hasOwnProperty,d=r.forEach,f=r.map,p=r.reduce,h=r.reduceRight,m=r.filter,g=r.every,v=r.some,_=r.indexOf,y=r.lastIndexOf,b=Array.isArray,w=Object.keys,S=o.bind,k=function(e){return e instanceof k?e:this instanceof k?(this._wrapped=e,void 0):new k(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):e._=k,k.VERSION="1.4.2";var x=k.each=k.forEach=function(e,t,r){if(null!=e)if(d&&e.forEach===d)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,o=e.length;o>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var a in e)if(k.has(e,a)&&t.call(r,e[a],a,e)===n)return};k.map=k.collect=function(e,t,n){var r=[];return null==e?r:f&&e.map===f?e.map(t,n):(x(e,function(e,i,o){r[r.length]=t.call(n,e,i,o)}),r)},k.reduce=k.foldl=k.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=k.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(x(e,function(e,o,a){i?n=t.call(r,n,e,o,a):(n=e,i=!0)}),!i)throw new TypeError("Reduce of empty array with no initial value");return n},k.reduceRight=k.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),h&&e.reduceRight===h)return r&&(t=k.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var o=e.length;if(o!==+o){var a=k.keys(e);o=a.length}if(x(e,function(s,l,u){l=a?a[--o]:--o,i?n=t.call(r,n,e[l],l,u):(n=e[l],i=!0)}),!i)throw new TypeError("Reduce of empty array with no initial value");return n},k.find=k.detect=function(e,t,n){var r;return E(e,function(e,i,o){return t.call(n,e,i,o)?(r=e,!0):void 0}),r},k.filter=k.select=function(e,t,n){var r=[];return null==e?r:m&&e.filter===m?e.filter(t,n):(x(e,function(e,i,o){t.call(n,e,i,o)&&(r[r.length]=e)}),r)},k.reject=function(e,t,n){var r=[];return null==e?r:(x(e,function(e,i,o){t.call(n,e,i,o)||(r[r.length]=e)}),r)},k.every=k.all=function(e,t,r){t||(t=k.identity);var i=!0;return null==e?i:g&&e.every===g?e.every(t,r):(x(e,function(e,o,a){return(i=i&&t.call(r,e,o,a))?void 0:n}),!!i)};var E=k.some=k.any=function(e,t,r){t||(t=k.identity);var i=!1;return null==e?i:v&&e.some===v?e.some(t,r):(x(e,function(e,o,a){return i||(i=t.call(r,e,o,a))?n:void 0}),!!i)};k.contains=k.include=function(e,t){var n=!1;return null==e?n:_&&e.indexOf===_?-1!=e.indexOf(t):n=E(e,function(e){return e===t})},k.invoke=function(e,t){var n=s.call(arguments,2);return k.map(e,function(e){return(k.isFunction(t)?t:e[t]).apply(e,n)})},k.pluck=function(e,t){return k.map(e,function(e){return e[t]})},k.where=function(e,t){return k.isEmpty(t)?[]:k.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},k.max=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&k.isEmpty(e))return-1/0;var r={computed:-1/0};return x(e,function(e,i,o){var a=t?t.call(n,e,i,o):e;a>=r.computed&&(r={value:e,computed:a})}),r.value},k.min=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&k.isEmpty(e))return 1/0;var r={computed:1/0};return x(e,function(e,i,o){var a=t?t.call(n,e,i,o):e;r.computed>a&&(r={value:e,computed:a})}),r.value},k.shuffle=function(e){var t,n=0,r=[];return x(e,function(e){t=k.random(n++),r[n-1]=r[t],r[t]=e}),r};var T=function(e){return k.isFunction(e)?e:function(t){return t[e]}};k.sortBy=function(e,t,n){var r=T(t);return k.pluck(k.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index<t.index?-1:1}),"value")};var C=function(e,t,n,r){var i={},o=T(t);return x(e,function(t,a){var s=o.call(n,t,a,e);r(i,s,t)}),i};k.groupBy=function(e,t,n){return C(e,t,n,function(e,t,n){(k.has(e,t)?e[t]:e[t]=[]).push(n)})},k.countBy=function(e,t,n){return C(e,t,n,function(e,t){k.has(e,t)||(e[t]=0),e[t]++})},k.sortedIndex=function(e,t,n,r){n=null==n?k.identity:T(n);for(var i=n.call(r,t),o=0,a=e.length;a>o;){var s=o+a>>>1;i>n.call(r,e[s])?o=s+1:a=s}return o},k.toArray=function(e){return e?e.length===+e.length?s.call(e):k.values(e):[]},k.size=function(e){return e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,n){return null==t||n?e[0]:s.call(e,0,t)},k.initial=function(e,t,n){return s.call(e,0,e.length-(null==t||n?1:t))},k.last=function(e,t,n){return null==t||n?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,n){return s.call(e,null==t||n?1:t)},k.compact=function(e){return k.filter(e,function(e){return!!e})};var M=function(e,t,n){return x(e,function(e){k.isArray(e)?t?a.apply(n,e):M(e,t,n):n.push(e)}),n};k.flatten=function(e,t){return M(e,t,[])},k.without=function(e){return k.difference(e,s.call(arguments,1))},k.uniq=k.unique=function(e,t,n,r){var i=n?k.map(e,n,r):e,o=[],a=[];return x(i,function(n,r){(t?r&&a[a.length-1]===n:k.contains(a,n))||(a.push(n),o.push(e[r]))}),o},k.union=function(){return k.uniq(l.apply(r,arguments))},k.intersection=function(e){var t=s.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.indexOf(t,e)>=0})})},k.difference=function(e){var t=l.apply(r,s.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=s.call(arguments),t=k.max(k.pluck(e,"length")),n=Array(t),r=0;t>r;r++)n[r]=k.pluck(e,""+r);return n},k.object=function(e,t){for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},k.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=k.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(_&&e.indexOf===_)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},k.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(y&&e.lastIndexOf===y)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},k.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,o=Array(r);r>i;)o[i++]=e,e+=n;return o};var A=function(){};k.bind=function(e,t){var n,r;if(e.bind===S&&S)return S.apply(e,s.call(arguments,1));if(!k.isFunction(e))throw new TypeError;return r=s.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,r.concat(s.call(arguments)));A.prototype=e.prototype;var i=new A,o=e.apply(i,r.concat(s.call(arguments)));return Object(o)===o?o:i}},k.bindAll=function(e){var t=s.call(arguments,1);return 0==t.length&&(t=k.functions(e)),x(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var n={};return t||(t=k.identity),function(){var r=t.apply(this,arguments);return k.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},k.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(s.call(arguments,1)))},k.throttle=function(e,t){var n,r,i,o,a,s,l=k.debounce(function(){a=o=!1},t);return function(){n=this,r=arguments;var u=function(){i=null,a&&(s=e.apply(n,r)),l()};return i||(i=setTimeout(u,t)),o?a=!0:(o=!0,s=e.apply(n,r)),l(),s}},k.debounce=function(e,t,n){var r,i;return function(){var o=this,a=arguments,s=function(){r=null,n||(i=e.apply(o,a))},l=n&&!r;return clearTimeout(r),r=setTimeout(s,t),l&&(i=e.apply(o,a)),i}},k.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return function(){var n=[e];return a.apply(n,arguments),t.apply(this,n)}},k.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},k.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},k.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)k.has(e,n)&&(t[t.length]=n);return t},k.values=function(e){var t=[];for(var n in e)k.has(e,n)&&t.push(e[n]);return t},k.pairs=function(e){var t=[];for(var n in e)k.has(e,n)&&t.push([n,e[n]]);return t},k.invert=function(e){var t={};for(var n in e)k.has(e,n)&&(t[e[n]]=n);return t},k.functions=k.methods=function(e){var t=[];for(var n in e)k.isFunction(e[n])&&t.push(n);return t.sort()},k.extend=function(e){return x(s.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},k.pick=function(e){var t={},n=l.apply(r,s.call(arguments,1));return x(n,function(n){n in e&&(t[n]=e[n])}),t},k.omit=function(e){var t={},n=l.apply(r,s.call(arguments,1));for(var i in e)k.contains(n,i)||(t[i]=e[i]);return t},k.defaults=function(e){return x(s.call(arguments,1),function(t){for(var n in t)null==e[n]&&(e[n]=t[n])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var N=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var i=u.call(e);if(i!=u.call(t))return!1;switch(i){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]==e)return r[o]==t;n.push(e),r.push(t);var a=0,s=!0;if("[object Array]"==i){if(a=e.length,s=a==t.length)for(;a--&&(s=N(e[a],t[a],n,r)););}else{var l=e.constructor,c=t.constructor;if(l!==c&&!(k.isFunction(l)&&l instanceof l&&k.isFunction(c)&&c instanceof c))return!1;for(var d in e)if(k.has(e,d)&&(a++,!(s=k.has(t,d)&&N(e[d],t[d],n,r))))break;if(s){for(d in t)if(k.has(t,d)&&!a--)break;s=!a}}return n.pop(),r.pop(),s};k.isEqual=function(e,t){return N(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=b||function(e){return"[object Array]"==u.call(e)},k.isObject=function(e){return e===Object(e)},x(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),k.isFunction=function(e){return"function"==typeof e},k.isFinite=function(e){return k.isNumber(e)&&isFinite(e)},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return c.call(e,t)},k.noConflict=function(){return e._=t,this},k.identity=function(e){return e},k.times=function(e,t,n){for(var r=0;e>r;r++)t.call(n,r)},k.random=function(e,t){return null==t&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=k.invert(I.escape);var D={escape:RegExp("["+k.keys(I.escape).join("")+"]","g"),unescape:RegExp("("+k.keys(I.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return I[e][t]})}}),k.result=function(e,t){if(null==e)return null;var n=e[t];return k.isFunction(n)?n.call(e):n},k.mixin=function(e){x(k.functions(e),function(t){var n=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),R.call(this,n.apply(k,e))}})};var O=0;k.uniqueId=function(e){var t=O++;return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","  ":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,n){n=k.defaults({},n,k.templateSettings);var r=RegExp([(n.escape||L).source,(n.interpolate||L).source,(n.evaluate||L).source].join("|")+"|$","g"),i=0,o="__p+='";e.replace(r,function(t,n,r,a,s){o+=e.slice(i,s).replace(j,function(e){return"\\"+P[e]}),o+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":a?"';\n"+a+"\n__p+='":"",i=s+t.length}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=Function(n.variable||"obj","_",o)}catch(s){throw s.source=o,s}if(t)return a(t,k);var l=function(e){return a.call(this,e,k)};return l.source="function("+(n.variable||"obj")+"){\n"+o+"}",l},k.chain=function(e){return k(e).chain()};var R=function(e){return this._chain?k(e).chain():e};k.mixin(k),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];k.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],R.call(this,n)}}),x(["concat","join","slice"],function(e){var t=r[e];k.prototype[e]=function(){return R.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)})(),function(){Meteor={isClient:!0,isServer:!1},"undefined"!=typeof __meteor_runtime_config__&&__meteor_runtime_config__&&__meteor_runtime_config__.PUBLIC_SETTINGS&&(Meteor.settings={"public":__meteor_runtime_config__.PUBLIC_SETTINGS})}(),function(){__meteor_runtime_config__.meteorRelease&&(Meteor.release=__meteor_runtime_config__.meteorRelease),_.extend(Meteor,{_get:function(e){for(var t=1;arguments.length>t;t++){if(!(arguments[t]in e))return void 0;e=e[arguments[t]]}return e},_ensure:function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];n in e||(e[n]={}),e=e[n]}return e},_delete:function(e){for(var t=[e],n=!0,r=1;arguments.length-1>r;r++){var i=arguments[r];if(!(i in e)){n=!1;break}if(e=e[i],"object"!=typeof e)break;t.push(e)}for(var r=t.length-1;r>=0;r--){var i=arguments[r+1];if(n)n=!1;else for(var o in t[r][i])return;delete t[r][i]}}})}(),function(){_.extend(Meteor,{setTimeout:function(e,t){if(Meteor._CurrentInvocation){if(Meteor._CurrentInvocation.get()&&Meteor._CurrentInvocation.get().isSimulation)throw Error("Can't set timers inside simulations");var n=e;e=function(){Meteor._CurrentInvocation.withValue(null,n)}}return setTimeout(Meteor.bindEnvironment(e,function(e){Meteor._debug("Exception from setTimeout callback:",e.stack)}),t)},setInterval:function(e,t){if(Meteor._CurrentInvocation){if(Meteor._CurrentInvocation.get()&&Meteor._CurrentInvocation.get().isSimulation)throw Error("Can't set timers inside simulations");var n=e;e=function(){Meteor._CurrentInvocation.withValue(null,n)}}return setInterval(Meteor.bindEnvironment(e,function(e){Meteor._debug("Exception from setInterval callback:",e)}),t)},clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)},defer:function(e){Meteor.setTimeout(function(){e()},0)}})}(),function(){var e=0,t=[];Meteor.EnvironmentVariable=function(){this.slot=e++},_.extend(Meteor.EnvironmentVariable.prototype,{get:function(){return t[this.slot]},withValue:function(e,n){var r=t[this.slot];try{t[this.slot]=e;var i=n()}finally{t[this.slot]=r}return i}}),Meteor.bindEnvironment=function(e,n,r){var i=_.clone(t);if(!n)throw Error("onException must be supplied");return function(){var o=t;try{t=i;var a=e.apply(r,_.toArray(arguments))}catch(s){n(s)}finally{t=o}return a}}}(),function(){Meteor.absoluteUrl=function(e,t){t||"object"!=typeof e||(t=e,e=void 0),t=_.extend({},Meteor.absoluteUrl.defaultOptions,t||{});var n=t.rootUrl;if(!n)throw Error("Must pass options.rootUrl or set ROOT_URL in the server environment");return/\/$/.test(n)||(n+="/"),e&&(n+=e),t.secure&&/^http:/.test(n)&&!/http:\/\/localhost[:\/]/.test(n)&&!/http:\/\/127\.0\.0\.1[:\/]/.test(n)&&(n=n.replace(/^http:/,"https:")),t.replaceLocalhost&&(n=n.replace(/^http:\/\/localhost([:\/].*)/,"http://127.0.0.1$1")),n},Meteor.absoluteUrl.defaultOptions={},__meteor_runtime_config__&&__meteor_runtime_config__.ROOT_URL&&(Meteor.absoluteUrl.defaultOptions.rootUrl=__meteor_runtime_config__.ROOT_URL)}(),function(){Deps={},Deps.active=!1,Deps.currentComputation=null;var e=function(e){Deps.currentComputation=e,Deps.active=!!e},t=function(){return"undefined"!=typeof Meteor?Meteor._debug:"undefined"!=typeof console&&console.log?console.log:function(){}},n=1,r=[],i=!1,o=!1,a=!1,s=[],l=function(){i||(setTimeout(Deps.flush,0),i=!0)},u=!1;Deps.Computation=function(e,t){if(!u)throw Error("Deps.Computation constructor is private; use Deps.autorun");u=!1;var r=this;r.stopped=!1,r.invalidated=!1,r.firstRun=!0,r._id=n++,r._onInvalidateCallbacks=[],r._parent=t,r._func=e,r._recomputing=!1;var i=!0;try{r._compute(),i=!1}finally{r.firstRun=!1,i&&r.stop()}},_.extend(Deps.Computation.prototype,{onInvalidate:function(e){var t=this;if("function"!=typeof e)throw Error("onInvalidate requires a function");var n=function(){Deps.nonreactive(function(){e(t)})};t.invalidated?n():t._onInvalidateCallbacks.push(n)},invalidate:function(){var e=this;if(!e.invalidated){e._recomputing||e.stopped||(l(),r.push(this)),e.invalidated=!0;for(var t,n=0;t=e._onInvalidateCallbacks[n];n++)t();e._onInvalidateCallbacks=[]}},stop:function(){this.stopped||(this.stopped=!0,this.invalidate())},_compute:function(){var t=this;t.invalidated=!1;var n=Deps.currentComputation;e(t),a=!0;try{t._func(t)}finally{e(n),a=!1}},_recompute:function(){var e=this;for(e._recomputing=!0;e.invalidated&&!e.stopped;)try{e._compute()}catch(n){t()("Exception from Deps recompute:",n.stack||n.message)}e._recomputing=!1}}),Deps.Dependency=function(){this._dependentsById={}},_.extend(Deps.Dependency.prototype,{depend:function(e){if(!e){if(!Deps.active)return!1;e=Deps.currentComputation}var t=this,n=e._id;return n in t._dependentsById?!1:(t._dependentsById[n]=e,e.onInvalidate(function(){delete t._dependentsById[n]}),!0)},changed:function(){var e=this;for(var t in e._dependentsById)e._dependentsById[t].invalidate()},hasDependents:function(){var e=this;for(var t in e._dependentsById)return!0;return!1}}),_.extend(Deps,{flush:function(){if(o)throw Error("Can't call Deps.flush while flushing");if(a)throw Error("Can't flush inside Deps.autorun");for(o=!0,i=!0;r.length||s.length;){var e=r;r=[];for(var n,l=0;n=e[l];l++)n._recompute();if(s.length){var u=s.shift();try{u()}catch(c){t()("Exception from Deps afterFlush function:",c.stack||c.message)}}}o=!1,i=!1},autorun:function(e){if("function"!=typeof e)throw Error("Deps.autorun requires a function argument");u=!0;var t=new Deps.Computation(e,Deps.currentComputation);return Deps.active&&Deps.onInvalidate(function(){t.stop()}),t},nonreactive:function(t){var n=Deps.currentComputation;e(null);try{return t()}finally{e(n)}},_makeNonreactive:function(e){if(e.$isNonreactive)return e;var t=function(){var t,n=this,r=_.toArray(arguments);return Deps.nonreactive(function(){t=e.apply(n,r)}),t};return t.$isNonreactive=!0,t},onInvalidate:function(e){if(!Deps.active)throw Error("Deps.onInvalidate requires a currentComputation");Deps.currentComputation.onInvalidate(e)},afterFlush:function(e){s.push(e),l()}})}(),function(){var e=function(e){return void 0===e?"undefined":EJSON.stringify(e)},t=function(e){return void 0===e||"undefined"===e?void 0:EJSON.parse(e)};ReactiveDict=function(e){this.keys=e||{},this.keyDeps={},this.keyValueDeps={}},_.extend(ReactiveDict.prototype,{set:function(t,n){var r=this;n=e(n);var i="undefined";if(_.has(r.keys,t)&&(i=r.keys[t]),n!==i){r.keys[t]=n;var o=function(e){e&&e.changed()};o(r.keyDeps[t]),r.keyValueDeps[t]&&(o(r.keyValueDeps[t][i]),o(r.keyValueDeps[t][n]))}},setDefault:function(e,t){var n=this;void 0===n.keys[e]&&n.set(e,t)},get:function(e){var n=this;return n._ensureKey(e),n.keyDeps[e].depend(),t(n.keys[e])},equals:function(n,r){var i=this;if(!("string"==typeof r||"number"==typeof r||"boolean"==typeof r||void 0===r||r instanceof Date||Meteor.Collection!==void 0&&r instanceof Meteor.Collection.ObjectID||null===r))throw Error("ReactiveDict.equals: value must be scalar");var o=e(r);if(Deps.active){i._ensureKey(n),_.has(i.keyValueDeps[n],o)||(i.keyValueDeps[n][o]=new Deps.Dependency);var a=i.keyValueDeps[n][o].depend();a&&Deps.onInvalidate(function(){i.keyValueDeps[n][o].hasDependents()||delete i.keyValueDeps[n][o]})}var s=void 0;return _.has(i.keys,n)&&(s=t(i.keys[n])),EJSON.equals(s,r)},_ensureKey:function(e){var t=this;e in t.keyDeps||(t.keyDeps[e]=new Deps.Dependency,t.keyValueDeps[e]={})},getMigrationData:function(){return this.keys}})}(),function(){var e=0;Meteor._debug=function(){if(e)return e--,void 0;if("undefined"!=typeof console&&console.log!==void 0)if(0==arguments.length)console.log("");else if("function"==typeof console.log.apply){for(var t=!0,n=0;arguments.length>n;n++)"string"!=typeof arguments[n]&&(t=!1);t?console.log.apply(console,[Array.prototype.join.call(arguments," ")]):console.log.apply(console,arguments)}else if("function"==typeof Function.prototype.bind){var r=Function.prototype.bind.call(console.log,console);r.apply(console,arguments)}else Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments))},Meteor._suppress_log=function(t){e+=t}}(),function(){"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,o,a,s=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?l+"":"null";case"boolean":case"null":return l+"";case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(o=l.length,n=0;o>n;n+=1)a[n]=str(n,l)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)"string"==typeof rep[n]&&(r=rep[n],i=str(r,l),i&&a.push(quote(r)+(gap?": ":":")+i));else for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(i=str(r,l),i&&a.push(quote(r)+(gap?": ":":")+i));return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b"," ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),void 0!==r?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()}(),function(){Meteor._reload={};var e,t="Meteor_Reload",n=3e4,r={};"undefined"!=typeof sessionStorage&&sessionStorage&&(e=sessionStorage.getItem(t),sessionStorage.removeItem(t)),e||(e="{}");var i={};try{i=JSON.parse(e),"object"!=typeof i&&(Meteor._debug("Got bad data on reload. Ignoring."),i={})}catch(o){Meteor._debug("Got invalid JSON on reload. Ignoring.")}i.reload&&"object"==typeof i.data&&i.time+n>(new Date).getTime()&&(r=i.data);var a=[];Meteor._reload.onMigrate=function(e,t){t||(t=e,e=void 0),a.push({name:e,callback:t})},Meteor._reload.migrationData=function(e){return r[e]};var s=!1;Meteor._reload.reload=function(){if(!s){s=!0;var e=function(){_.defer(function(){for(var n={},r=_.clone(a);r.length;){var i=r.shift(),o=i.callback(e);if(!o[0])return;o.length>1&&i.name&&(n[i.name]=o[1])}try{var s=JSON.stringify({time:(new Date).getTime(),data:n,reload:!0})}catch(l){throw Meteor._debug("Couldn't serialize data for migration",n),l}"undefined"!=typeof sessionStorage&&sessionStorage?sessionStorage.setItem(t,s):Meteor._debug("Browser does not support sessionStorage. Not saving migration state."),window.location.reload()})};e()}}}(),function(){var e={};if(Meteor._reload){var t=Meteor._reload.migrationData("session");t&&t.keys&&(e=t.keys)}Session=new ReactiveDict(e),Meteor._reload&&Meteor._reload.onMigrate("session",function(){return[!0,{keys:Session.keys}]})}(),function(){Random={},Random._Alea=function(){function e(){var e=4022871197,t=function(t){t=""+t;for(var n=0;t.length>n;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=4294967296*r}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t}return function(t){var n=0,r=0,i=0,o=1;0==t.length&&(t=[+new Date]);var a=e();n=a(" "),r=a(" "),i=a(" ");for(var s=0;t.length>s;s++)n-=a(t[s]),0>n&&(n+=1),r-=a(t[s]),0>r&&(r+=1),i-=a(t[s]),0>i&&(i+=1);a=null;var l=function(){var e=2091639*n+2.3283064365386963e-10*o;return n=r,r=i,i=e-(o=0|e)};return l.uint32=function(){return 4294967296*l()},l.fract53=function(){return l()+1.1102230246251565e-16*(0|2097152*l())},l.version="Alea 0.9",l.args=t,l}(Array.prototype.slice.call(arguments))};var e="undefined"!=typeof window&&window.innerHeight||"undefined"!=typeof document&&document.documentElement&&document.documentElement.clientHeight||"undefined"!=typeof document&&document.body&&document.body.clientHeight||1,t="undefined"!=typeof window&&window.innerWidth||"undefined"!=typeof document&&document.documentElement&&document.documentElement.clientWidth||"undefined"!=typeof document&&document.body&&document.body.clientWidth||1,n="undefined"!=typeof navigator&&navigator.userAgent||"",r="undefined"!=typeof process&&process.pid||1;Random.fraction=new Random._Alea([new Date,e,t,n,r,Math.random()]),Random.choice=function(e){var t=Math.floor(Random.fraction()*e.length);return"string"==typeof e?e.substr(t,1):e[t]};var i="23456789ABCDEFGHJKLMNPQRSTWXYZabcdefghijkmnopqrstuvwxyz";Random.id=function(){for(var e=[],t=0;17>t;t++)e[t]=Random.choice(i);return e.join("")},Random.hexString=function(e){for(var t=[],n=0;e>n;++n)t.push(Random.choice("0123456789abcdef"));return t.join("")}}(),function(){var JSON;JSON||(JSON={}),function(){function str(e,t){var n,r,i,o,a,s=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?l+"":"null";case"boolean":case"null":return l+"";case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(o=l.length,n=0;o>n;n+=1)a[n]=str(n,l)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)"string"==typeof rep[n]&&(r=rep[n],i=str(r,l),i&&a.push(quote(r)+(gap?": ":":")+i));else for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(i=str(r,l),i&&a.push(quote(r)+(gap?": ":":")+i));return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function f(e){return 10>e?"0"+e:e}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b"," ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,!t||"function"==typeof t||"object"==typeof t&&"number"==typeof t.length)return str("",{"":e});throw Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),void 0!==r?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),SockJS=function(){var e=document,t=window,n={},r=function(){};r.prototype.addEventListener=function(e,t){this._listeners||(this._listeners={}),e in this._listeners||(this._listeners[e]=[]);var r=this._listeners[e];-1===n.arrIndexOf(r,t)&&r.push(t)},r.prototype.removeEventListener=function(e,t){if(this._listeners&&e in this._listeners){var r=this._listeners[e],i=n.arrIndexOf(r,t);return-1!==i?(r.length>1?this._listeners[e]=r.slice(0,i).concat(r.slice(i+1)):delete this._listeners[e],void 0):void 0}},r.prototype.dispatchEvent=function(e){var t=e.type,n=Array.prototype.slice.call(arguments,0);if(this["on"+t]&&this["on"+t].apply(this,n),this._listeners&&t in this._listeners)for(var r=0;this._listeners[t].length>r;r++)this._listeners[t][r].apply(this,n)};var i=function(e,t){if(this.type=e,t!==void 0)for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])};i.prototype.toString=function(){var e=[];for(var t in this)if(this.hasOwnProperty(t)){var n=this[t];"function"==typeof n&&(n="[function]"),e.push(t+"="+n)}return"SimpleEvent("+e.join(", ")+")"};var o=function(e){var t=this;t._events=e||[],t._listeners={}};o.prototype.emit=function(e){var t=this;if(t._verifyType(e),!t._nuked){var n=Array.prototype.slice.call(arguments,1);if(t["on"+e]&&t["on"+e].apply(t,n),e in t._listeners)for(var r=0;t._listeners[e].length>r;r++)t._listeners[e][r].apply(t,n)}},o.prototype.on=function(e,t){var n=this;n._verifyType(e),n._nuked||(e in n._listeners||(n._listeners[e]=[]),n._listeners[e].push(t))},o.prototype._verifyType=function(e){var t=this;-1===n.arrIndexOf(t._events,e)&&n.log("Event "+JSON.stringify(e)+" not listed "+JSON.stringify(t._events)+" in "+t)
},o.prototype.nuke=function(){var e=this;e._nuked=!0;for(var t=0;e._events.length>t;t++)delete e[e._events[t]];e._listeners={}};var a="abcdefghijklmnopqrstuvwxyz0123456789_";n.random_string=function(e,t){t=t||a.length;var n,r=[];for(n=0;e>n;n++)r.push(a.substr(Math.floor(Math.random()*t),1));return r.join("")},n.random_number=function(e){return Math.floor(Math.random()*e)},n.random_number_string=function(e){var t=(""+(e-1)).length,r=Array(t+1).join("0");return(r+n.random_number(e)).slice(-t)},n.getOrigin=function(e){e+="/";var t=e.split("/").slice(0,3);return t.join("/")},n.isSameOriginUrl=function(e,n){return n||(n=t.location.href),e.split("/").slice(0,3).join("/")===n.split("/").slice(0,3).join("/")},n.isSameOriginScheme=function(e,n){return n||(n=t.location.href),e.split(":")[0]===n.split(":")[0]},n.getParentDomain=function(e){if(/^[0-9.]*$/.test(e))return e;if(/^\[/.test(e))return e;if(!/[.]/.test(e))return e;var t=e.split(".").slice(1);return t.join(".")},n.objectExtend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e};var s="_jp";n.polluteGlobalNamespace=function(){s in t||(t[s]={})},n.closeFrame=function(e,t){return"c"+JSON.stringify([e,t])},n.userSetCode=function(e){return 1e3===e||e>=3e3&&4999>=e},n.countRTO=function(e){var t;return t=e>100?3*e:e+200},n.log=function(){t.console&&console.log&&console.log.apply&&console.log.apply(console,arguments)},n.bind=function(e,t){return e.bind?e.bind(t):function(){return e.apply(t,arguments)}},n.flatUrl=function(e){return-1===e.indexOf("?")&&-1===e.indexOf("#")},n.amendUrl=function(t){var r=e.location;if(!t)throw Error("Wrong url for SockJS");if(!n.flatUrl(t))throw Error("Only basic urls are supported in SockJS");return 0===t.indexOf("//")&&(t=r.protocol+t),0===t.indexOf("/")&&(t=r.protocol+"//"+r.host+t),t=t.replace(/[/]+$/,"")},n.arrIndexOf=function(e,t){for(var n=0;e.length>n;n++)if(e[n]===t)return n;return-1},n.arrSkip=function(e,t){var r=n.arrIndexOf(e,t);if(-1===r)return e.slice();var i=e.slice(0,r);return i.concat(e.slice(r+1))},n.isArray=Array.isArray||function(e){return{}.toString.call(e).indexOf("Array")>=0},n.delay=function(e,t){return"function"==typeof e&&(t=e,e=0),setTimeout(t,e)};var l,u=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\0":"\\u0000","":"\\u0001","":"\\u0002","":"\\u0003","":"\\u0004","":"\\u0005","":"\\u0006","":"\\u0007","\b":"\\b","  ":"\\t","\n":"\\n","":"\\u000b","\f":"\\f","\r":"\\r","":"\\u000e","":"\\u000f","":"\\u0010","":"\\u0011","":"\\u0012","":"\\u0013","":"\\u0014","":"\\u0015","":"\\u0016","":"\\u0017","":"\\u0018","":"\\u0019","":"\\u001a","":"\\u001b","":"\\u001c","":"\\u001d","":"\\u001e","":"\\u001f",'"':'\\"',"\\":"\\\\","":"\\u007f","Â€":"\\u0080","Â":"\\u0081","Â‚":"\\u0082","Âƒ":"\\u0083","Â„":"\\u0084","Â…":"\\u0085","Â†":"\\u0086","Â‡":"\\u0087","Âˆ":"\\u0088","Â‰":"\\u0089","ÂŠ":"\\u008a","Â‹":"\\u008b","ÂŒ":"\\u008c","Â":"\\u008d","ÂŽ":"\\u008e","Â":"\\u008f","Â":"\\u0090","Â‘":"\\u0091","Â’":"\\u0092","Â“":"\\u0093","Â”":"\\u0094","Â•":"\\u0095","Â–":"\\u0096","Â—":"\\u0097","Â˜":"\\u0098","Â™":"\\u0099","Âš":"\\u009a","Â›":"\\u009b","Âœ":"\\u009c","Â":"\\u009d","Âž":"\\u009e","ÂŸ":"\\u009f","Â­":"\\u00ad","Ø€":"\\u0600","Ø":"\\u0601","Ø‚":"\\u0602","Øƒ":"\\u0603","Ø„":"\\u0604","Ü":"\\u070f","áž´":"\\u17b4","ážµ":"\\u17b5","â€Œ":"\\u200c","â€":"\\u200d","â€Ž":"\\u200e","â€":"\\u200f","\u2028":"\\u2028","\u2029":"\\u2029","â€ª":"\\u202a","â€«":"\\u202b","â€¬":"\\u202c","â€­":"\\u202d","â€®":"\\u202e","â€¯":"\\u202f","â ":"\\u2060","â¡":"\\u2061","â¢":"\\u2062","â£":"\\u2063","â¤":"\\u2064","â¥":"\\u2065","â¦":"\\u2066","â§":"\\u2067","â¨":"\\u2068","â©":"\\u2069","âª":"\\u206a","â«":"\\u206b","â¬":"\\u206c","â­":"\\u206d","â®":"\\u206e","â¯":"\\u206f","ï»¿":"\\ufeff","ï¿°":"\\ufff0","ï¿±":"\\ufff1","ï¿²":"\\ufff2","ï¿³":"\\ufff3","ï¿´":"\\ufff4","ï¿µ":"\\ufff5","ï¿¶":"\\ufff6","ï¿·":"\\ufff7","ï¿¸":"\\ufff8","ï¿¹":"\\ufff9","ï¿º":"\\ufffa","ï¿»":"\\ufffb","ï¿¼":"\\ufffc","ï¿½":"\\ufffd","ï¿¾":"\\ufffe","ï¿¿":"\\uffff"},d=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,f=JSON&&JSON.stringify||function(e){return u.lastIndex=0,u.test(e)&&(e=e.replace(u,function(e){return c[e]})),'"'+e+'"'},p=function(e){var t,n={},r=[];for(t=0;65536>t;t++)r.push(String.fromCharCode(t));return e.lastIndex=0,r.join("").replace(e,function(e){return n[e]="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4),""}),e.lastIndex=0,n};n.quote=function(e){var t=f(e);return d.lastIndex=0,d.test(t)?(l||(l=p(d)),t.replace(d,function(e){return l[e]})):t};var h=["websocket","xdr-streaming","xhr-streaming","iframe-eventsource","iframe-htmlfile","xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"];n.probeProtocols=function(){for(var e={},t=0;h.length>t;t++){var n=h[t];e[n]=x[n]&&x[n].enabled()}return e},n.detectProtocols=function(e,t,n){var r={},i=[];t||(t=h);for(var o=0;t.length>o;o++){var a=t[o];r[a]=e[a]}var s=function(e){var t=e.shift();r[t]?i.push(t):e.length>0&&s(e)};return n.websocket!==!1&&s(["websocket"]),r["xhr-streaming"]&&!n.null_origin?i.push("xhr-streaming"):!r["xdr-streaming"]||n.cookie_needed||n.null_origin?s(["iframe-eventsource","iframe-htmlfile"]):i.push("xdr-streaming"),r["xhr-polling"]&&!n.null_origin?i.push("xhr-polling"):!r["xdr-polling"]||n.cookie_needed||n.null_origin?s(["iframe-xhr-polling","jsonp-polling"]):i.push("xdr-polling"),i};var m="_sockjs_global";n.createHook=function(){var e="a"+n.random_string(8);if(!(m in t)){var r={};t[m]=function(e){return e in r||(r[e]={id:e,del:function(){delete r[e]}}),r[e]}}return t[m](e)},n.attachMessage=function(e){n.attachEvent("message",e)},n.attachEvent=function(n,r){t.addEventListener!==void 0?t.addEventListener(n,r,!1):(e.attachEvent("on"+n,r),t.attachEvent("on"+n,r))},n.detachMessage=function(e){n.detachEvent("message",e)},n.detachEvent=function(n,r){t.addEventListener!==void 0?t.removeEventListener(n,r,!1):(e.detachEvent("on"+n,r),t.detachEvent("on"+n,r))};var g={},v=!1,_=function(){for(var e in g)g[e](),delete g[e]},y=function(){v||(v=!0,_())};n.attachEvent("unload",y),n.unload_add=function(e){var t=n.random_string(8);return g[t]=e,v&&n.delay(_),t},n.unload_del=function(e){e in g&&delete g[e]},n.createIframe=function(t,r){var i,o,a=e.createElement("iframe"),s=function(){clearTimeout(i);try{a.onload=null}catch(e){}a.onerror=null},l=function(){a&&(s(),setTimeout(function(){a&&a.parentNode.removeChild(a),a=null},0),n.unload_del(o))},u=function(e){a&&(l(),r(e))},c=function(e,t){try{a&&a.contentWindow&&a.contentWindow.postMessage(e,t)}catch(n){}};return a.src=t,a.style.display="none",a.style.position="absolute",a.onerror=function(){u("onerror")},a.onload=function(){clearTimeout(i),i=setTimeout(function(){u("onload timeout")},2e3)},e.body.appendChild(a),i=setTimeout(function(){u("timeout")},15e3),o=n.unload_add(l),{post:c,cleanup:l,loaded:s}},n.createHtmlfile=function(e,r){var i,o,a,l=new ActiveXObject("htmlfile"),u=function(){clearTimeout(i)},c=function(){l&&(u(),n.unload_del(o),a.parentNode.removeChild(a),a=l=null,CollectGarbage())},d=function(e){l&&(c(),r(e))},f=function(e,t){try{a&&a.contentWindow&&a.contentWindow.postMessage(e,t)}catch(n){}};l.open(),l.write('<html><script>document.domain="'+document.domain+'";'+"</s"+"cript></html>"),l.close(),l.parentWindow[s]=t[s];var p=l.createElement("div");return l.body.appendChild(p),a=l.createElement("iframe"),p.appendChild(a),a.src=e,i=setTimeout(function(){d("timeout")},15e3),o=n.unload_add(c),{post:f,cleanup:c,loaded:u}};var b=function(){};b.prototype=new o(["chunk","finish"]),b.prototype._start=function(e,r,i,o){var a=this;try{a.xhr=new XMLHttpRequest}catch(s){}if(!a.xhr)try{a.xhr=new t.ActiveXObject("Microsoft.XMLHTTP")}catch(s){}(t.ActiveXObject||t.XDomainRequest)&&(r+=(-1===r.indexOf("?")?"?":"&")+"t="+ +new Date),a.unload_ref=n.unload_add(function(){a._cleanup(!0)});try{a.xhr.open(e,r,!0)}catch(l){return a.emit("finish",0,""),a._cleanup(),void 0}if(o&&o.no_credentials||(a.xhr.withCredentials="true"),o&&o.headers)for(var u in o.headers)a.xhr.setRequestHeader(u,o.headers[u]);a.xhr.onreadystatechange=function(){if(a.xhr){var e=a.xhr;switch(e.readyState){case 3:try{var t=e.status,n=e.responseText}catch(e){}1223===t&&(t=204),n&&n.length>0&&a.emit("chunk",t,n);break;case 4:var t=e.status;1223===t&&(t=204),a.emit("finish",t,e.responseText),a._cleanup(!1)}}},a.xhr.send(i)},b.prototype._cleanup=function(e){var t=this;if(t.xhr){if(n.unload_del(t.unload_ref),t.xhr.onreadystatechange=function(){},e)try{t.xhr.abort()}catch(r){}t.unload_ref=t.xhr=null}},b.prototype.close=function(){var e=this;e.nuke(),e._cleanup(!0)};var w=n.XHRCorsObject=function(){var e=this,t=arguments;n.delay(function(){e._start.apply(e,t)})};w.prototype=new b;var S=n.XHRLocalObject=function(e,t,r){var i=this;n.delay(function(){i._start(e,t,r,{no_credentials:!0})})};S.prototype=new b;var k=n.XDRObject=function(e,t,r){var i=this;n.delay(function(){i._start(e,t,r)})};k.prototype=new o(["chunk","finish"]),k.prototype._start=function(e,t,r){var i=this,o=new XDomainRequest;t+=(-1===t.indexOf("?")?"?":"&")+"t="+ +new Date;var a=o.ontimeout=o.onerror=function(){i.emit("finish",0,""),i._cleanup(!1)};o.onprogress=function(){i.emit("chunk",200,o.responseText)},o.onload=function(){i.emit("finish",200,o.responseText),i._cleanup(!1)},i.xdr=o,i.unload_ref=n.unload_add(function(){i._cleanup(!0)});try{i.xdr.open(e,t),i.xdr.send(r)}catch(s){a()}},k.prototype._cleanup=function(e){var t=this;if(t.xdr){if(n.unload_del(t.unload_ref),t.xdr.ontimeout=t.xdr.onerror=t.xdr.onprogress=t.xdr.onload=null,e)try{t.xdr.abort()}catch(r){}t.unload_ref=t.xdr=null}},k.prototype.close=function(){var e=this;e.nuke(),e._cleanup(!0)},n.isXHRCorsCapable=function(){return t.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?1:t.XDomainRequest&&e.domain?2:R.enabled()?3:4};var x=function(e,r,i){if(this===t)return new x(e,r,i);var o,a=this;a._options={devel:!1,debug:!1,protocols_whitelist:[],info:void 0,rtt:void 0},i&&n.objectExtend(a._options,i),a._base_url=n.amendUrl(e),a._server=a._options.server||n.random_number_string(1e3),a._options.protocols_whitelist&&a._options.protocols_whitelist.length?o=a._options.protocols_whitelist:(o="string"==typeof r&&r.length>0?[r]:n.isArray(r)?r:null,o&&a._debug('Deprecated API: Use "protocols_whitelist" option instead of supplying protocol list as a second parameter to SockJS constructor.')),a._protocols=[],a.protocol=null,a.readyState=x.CONNECTING,a._ir=V(a._base_url),a._ir.onfinish=function(e,t){a._ir=null,e?(a._options.info&&(e=n.objectExtend(e,a._options.info)),a._options.rtt&&(t=a._options.rtt),a._applyInfo(e,t,o),a._didClose()):a._didClose(1002,"Can't connect to server",!0)}};x.prototype=new r,x.version="0.3.4",x.CONNECTING=0,x.OPEN=1,x.CLOSING=2,x.CLOSED=3,x.prototype._debug=function(){this._options.debug&&n.log.apply(n,arguments)},x.prototype._dispatchOpen=function(){var e=this;e.readyState===x.CONNECTING?(e._transport_tref&&(clearTimeout(e._transport_tref),e._transport_tref=null),e.readyState=x.OPEN,e.dispatchEvent(new i("open"))):e._didClose(1006,"Server lost session")},x.prototype._dispatchMessage=function(e){var t=this;t.readyState===x.OPEN&&t.dispatchEvent(new i("message",{data:e}))},x.prototype._dispatchHeartbeat=function(){var e=this;e.readyState===x.OPEN&&e.dispatchEvent(new i("heartbeat",{}))},x.prototype._didClose=function(e,t,r){var o=this;if(o.readyState!==x.CONNECTING&&o.readyState!==x.OPEN&&o.readyState!==x.CLOSING)throw Error("INVALID_STATE_ERR");o._ir&&(o._ir.nuke(),o._ir=null),o._transport&&(o._transport.doCleanup(),o._transport=null);var a=new i("close",{code:e,reason:t,wasClean:n.userSetCode(e)});if(!n.userSetCode(e)&&o.readyState===x.CONNECTING&&!r){if(o._try_next_protocol(a))return;a=new i("close",{code:2e3,reason:"All transports failed",wasClean:!1,last_event:a})}o.readyState=x.CLOSED,n.delay(function(){o.dispatchEvent(a)})},x.prototype._didMessage=function(e){var t=this,n=e.slice(0,1);switch(n){case"o":t._dispatchOpen();break;case"a":for(var r=JSON.parse(e.slice(1)||"[]"),i=0;r.length>i;i++)t._dispatchMessage(r[i]);break;case"m":var r=JSON.parse(e.slice(1)||"null");t._dispatchMessage(r);break;case"c":var r=JSON.parse(e.slice(1)||"[]");t._didClose(r[0],r[1]);break;case"h":t._dispatchHeartbeat()}},x.prototype._try_next_protocol=function(t){var r=this;for(r.protocol&&(r._debug("Closed transport:",r.protocol,""+t),r.protocol=null),r._transport_tref&&(clearTimeout(r._transport_tref),r._transport_tref=null);;){var i=r.protocol=r._protocols.shift();if(!i)return!1;if(x[i]&&x[i].need_body===!0&&(!e.body||e.readyState!==void 0&&"complete"!==e.readyState))return r._protocols.unshift(i),r.protocol="waiting-for-load",n.attachEvent("load",function(){r._try_next_protocol()}),!0;if(x[i]&&x[i].enabled(r._options)){var o=x[i].roundTrips||1,a=(r._options.rto||0)*o||5e3;r._transport_tref=n.delay(a,function(){r.readyState===x.CONNECTING&&r._didClose(2007,"Transport timeouted")});var s=n.random_string(8),l=r._base_url+"/"+r._server+"/"+s;return r._debug("Opening transport:",i," url:"+l," RTO:"+r._options.rto),r._transport=new x[i](r,l,r._base_url),!0}r._debug("Skipping transport:",i)}},x.prototype.close=function(e,t){var r=this;if(e&&!n.userSetCode(e))throw Error("INVALID_ACCESS_ERR");return r.readyState!==x.CONNECTING&&r.readyState!==x.OPEN?!1:(r.readyState=x.CLOSING,r._didClose(e||1e3,t||"Normal closure"),!0)},x.prototype.send=function(e){var t=this;if(t.readyState===x.CONNECTING)throw Error("INVALID_STATE_ERR");return t.readyState===x.OPEN&&t._transport.doSend(n.quote(""+e)),!0},x.prototype._applyInfo=function(t,r,i){var o=this;o._options.info=t,o._options.rtt=r,o._options.rto=n.countRTO(r),o._options.info.null_origin=!e.domain;var a=n.probeProtocols();o._protocols=n.detectProtocols(a,i,t),n.isSameOriginScheme(o._base_url)||2!==n.isXHRCorsCapable()||(o._protocols=["jsonp-polling"])};var E=x.websocket=function(e,r){var i=this,o=r+"/websocket";o="https"===o.slice(0,5)?"wss"+o.slice(5):"ws"+o.slice(4),i.ri=e,i.url=o;var a=t.WebSocket||t.MozWebSocket;i.ws=new a(i.url),i.ws.onmessage=function(e){i.ri._didMessage(e.data)},i.unload_ref=n.unload_add(function(){i.ws.close()}),i.ws.onclose=function(){i.ri._didMessage(n.closeFrame(1006,"WebSocket connection broken"))}};E.prototype.doSend=function(e){this.ws.send("["+e+"]")},E.prototype.doCleanup=function(){var e=this,t=e.ws;t&&(t.onmessage=t.onclose=null,t.close(),n.unload_del(e.unload_ref),e.unload_ref=e.ri=e.ws=null)},E.enabled=function(){return!(!t.WebSocket&&!t.MozWebSocket)},E.roundTrips=2;var T=function(){};T.prototype.send_constructor=function(e){var t=this;t.send_buffer=[],t.sender=e},T.prototype.doSend=function(e){var t=this;t.send_buffer.push(e),t.send_stop||t.send_schedule()},T.prototype.send_schedule_wait=function(){var e,t=this;t.send_stop=function(){t.send_stop=null,clearTimeout(e)},e=n.delay(25,function(){t.send_stop=null,t.send_schedule()})},T.prototype.send_schedule=function(){var e=this;if(e.send_buffer.length>0){var t="["+e.send_buffer.join(",")+"]";e.send_stop=e.sender(e.trans_url,t,function(t,n){e.send_stop=null,t===!1?e.ri._didClose(1006,"Sending error "+n):e.send_schedule_wait()}),e.send_buffer=[]}},T.prototype.send_destructor=function(){var e=this;e._send_stop&&e._send_stop(),e._send_stop=null};var C=function(t,r,i){var o=this;if(!("_send_form"in o)){var a=o._send_form=e.createElement("form"),s=o._send_area=e.createElement("textarea");s.name="d",a.style.display="none",a.style.position="absolute",a.method="POST",a.enctype="application/x-www-form-urlencoded",a.acceptCharset="UTF-8",a.appendChild(s),e.body.appendChild(a)}var a=o._send_form,s=o._send_area,l="a"+n.random_string(8);a.target=l,a.action=t+"/jsonp_send?i="+l;var u;try{u=e.createElement('<iframe name="'+l+'">')}catch(c){u=e.createElement("iframe"),u.name=l}u.id=l,a.appendChild(u),u.style.display="none";try{s.value=r}catch(d){n.log("Your browser is seriously broken. Go home! "+d.message)}a.submit();var f=function(){u.onerror&&(u.onreadystatechange=u.onerror=u.onload=null,n.delay(500,function(){u.parentNode.removeChild(u),u=null}),s.value="",i(!0))};return u.onerror=u.onload=f,u.onreadystatechange=function(){"complete"==u.readyState&&f()},f},M=function(e){return function(t,n,r){var i=new e("POST",t+"/xhr_send",n);return i.onfinish=function(e){r(200===e||204===e,"http status "+e)},function(e){r(!1,e)}}},A=function(t,r){var i,o,a=e.createElement("script"),s=function(e){o&&(o.parentNode.removeChild(o),o=null),a&&(clearTimeout(i),a.parentNode.removeChild(a),a.onreadystatechange=a.onerror=a.onload=a.onclick=null,a=null,r(e),r=null)},l=!1,u=null;if(a.id="a"+n.random_string(8),a.src=t,a.type="text/javascript",a.charset="UTF-8",a.onerror=function(){u||(u=setTimeout(function(){l||s(n.closeFrame(1006,"JSONP script loaded abnormally (onerror)"))},1e3))},a.onload=function(){s(n.closeFrame(1006,"JSONP script loaded abnormally (onload)"))},a.onreadystatechange=function(){if(/loaded|closed/.test(a.readyState)){if(a&&a.htmlFor&&a.onclick){l=!0;try{a.onclick()}catch(e){}}a&&s(n.closeFrame(1006,"JSONP script loaded abnormally (onreadystatechange)"))}},a.async===void 0&&e.attachEvent)if(/opera/i.test(navigator.userAgent))o=e.createElement("script"),o.text="try{var a = document.getElementById('"+a.id+"'); if(a)a.onerror();}catch(x){};",a.async=o.async=!1;else{try{a.htmlFor=a.id,a.event="onclick"}catch(c){}a.async=!0}a.async!==void 0&&(a.async=!0),i=setTimeout(function(){s(n.closeFrame(1006,"JSONP script loaded abnormally (timeout)"))},35e3);var d=e.getElementsByTagName("head")[0];return d.insertBefore(a,d.firstChild),o&&d.insertBefore(o,d.firstChild),s},N=x["jsonp-polling"]=function(e,t){n.polluteGlobalNamespace();var r=this;r.ri=e,r.trans_url=t,r.send_constructor(C),r._schedule_recv()};N.prototype=new T,N.prototype._schedule_recv=function(){var e=this,t=function(t){e._recv_stop=null,t&&(e._is_closing||e.ri._didMessage(t)),e._is_closing||e._schedule_recv()};e._recv_stop=I(e.trans_url+"/jsonp",A,t)},N.enabled=function(){return!0},N.need_body=!0,N.prototype.doCleanup=function(){var e=this;e._is_closing=!0,e._recv_stop&&e._recv_stop(),e.ri=e._recv_stop=null,e.send_destructor()};var I=function(e,r,i){var o="a"+n.random_string(6),a=e+"?c="+escape(s+"."+o),l=0,u=function(e){switch(l){case 0:delete t[s][o],i(e);break;case 1:i(e),l=2;break;case 2:delete t[s][o]}},c=r(a,u);t[s][o]=c;var d=function(){t[s][o]&&(l=1,t[s][o](n.closeFrame(1e3,"JSONP user aborted read")))};return d},D=function(){};D.prototype=new T,D.prototype.run=function(e,t,n,r,i){var o=this;o.ri=e,o.trans_url=t,o.send_constructor(M(i)),o.poll=new Q(e,r,t+n,i)},D.prototype.doCleanup=function(){var e=this;e.poll&&(e.poll.abort(),e.poll=null)};var O=x["xhr-streaming"]=function(e,t){this.run(e,t,"/xhr_streaming",rt,n.XHRCorsObject)};O.prototype=new D,O.enabled=function(){return t.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest&&!/opera/i.test(navigator.userAgent)},O.roundTrips=2,O.need_body=!0;var L=x["xdr-streaming"]=function(e,t){this.run(e,t,"/xhr_streaming",rt,n.XDRObject)};L.prototype=new D,L.enabled=function(){return!!t.XDomainRequest},L.roundTrips=2;var P=x["xhr-polling"]=function(e,t){this.run(e,t,"/xhr",rt,n.XHRCorsObject)};P.prototype=new D,P.enabled=O.enabled,P.roundTrips=2;var j=x["xdr-polling"]=function(e,t){this.run(e,t,"/xhr",rt,n.XDRObject)};j.prototype=new D,j.enabled=L.enabled,j.roundTrips=2;var R=function(){};R.prototype.i_constructor=function(e,t,r){var i=this;i.ri=e,i.origin=n.getOrigin(r),i.base_url=r,i.trans_url=t;var o=r+"/iframe.html";i.ri._options.devel&&(o+="?t="+ +new Date),i.window_id=n.random_string(8),o+="#"+i.window_id,i.iframeObj=n.createIframe(o,function(e){i.ri._didClose(1006,"Unable to load an iframe ("+e+")")}),i.onmessage_cb=n.bind(i.onmessage,i),n.attachMessage(i.onmessage_cb)},R.prototype.doCleanup=function(){var e=this;if(e.iframeObj){n.detachMessage(e.onmessage_cb);try{e.iframeObj.iframe.contentWindow&&e.postMessage("c")}catch(t){}e.iframeObj.cleanup(),e.iframeObj=null,e.onmessage_cb=e.iframeObj=null}},R.prototype.onmessage=function(e){var t=this;if(e.origin===t.origin){var n=e.data.slice(0,8),r=e.data.slice(8,9),i=e.data.slice(9);if(n===t.window_id)switch(r){case"s":t.iframeObj.loaded(),t.postMessage("s",JSON.stringify([x.version,t.protocol,t.trans_url,t.base_url]));break;case"t":t.ri._didMessage(i)}}},R.prototype.postMessage=function(e,t){var n=this;n.iframeObj.post(n.window_id+e+(t||""),n.origin)},R.prototype.doSend=function(e){this.postMessage("m",e)},R.enabled=function(){var e=navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Konqueror");return("function"==typeof t.postMessage||"object"==typeof t.postMessage)&&!e};var B,U=function(e,r){parent!==t?parent.postMessage(B+e+(r||""),"*"):n.log("Can't postMessage, no parent window.",e,r)},$=function(){};$.prototype._didClose=function(e,t){U("t",n.closeFrame(e,t))},$.prototype._didMessage=function(e){U("t",e)},$.prototype._doSend=function(e){this._transport.doSend(e)},$.prototype._doCleanup=function(){this._transport.doCleanup()},n.parent_origin=void 0,x.bootstrap_iframe=function(){var r;B=e.location.hash.slice(1);var i=function(e){if(e.source===parent&&(n.parent_origin===void 0&&(n.parent_origin=e.origin),e.origin===n.parent_origin)){var i=e.data.slice(0,8),o=e.data.slice(8,9),a=e.data.slice(9);if(i===B)switch(o){case"s":var s=JSON.parse(a),l=s[0],u=s[1],c=s[2],d=s[3];if(l!==x.version&&n.log('Incompatibile SockJS! Main site uses: "'+l+'", the iframe:'+' "'+x.version+'".'),!n.flatUrl(c)||!n.flatUrl(d))return n.log("Only basic urls are supported in SockJS"),void 0;if(!n.isSameOriginUrl(c)||!n.isSameOriginUrl(d))return n.log("Can't connect to different domain from within an iframe. ("+JSON.stringify([t.location.href,c,d])+")"),void 0;r=new $,r._transport=new $[u](r,c,d);break;case"m":r._doSend(a);break;case"c":r&&r._doCleanup(),r=null}}};n.attachMessage(i),U("s")};var F=function(e,t){var r=this;n.delay(function(){r.doXhr(e,t)})};F.prototype=new o(["finish"]),F.prototype.doXhr=function(e,t){var r=this,i=(new Date).getTime(),o=new t("GET",e+"/info"),a=n.delay(8e3,function(){o.ontimeout()});o.onfinish=function(e,t){if(clearTimeout(a),a=null,200===e){var n=(new Date).getTime()-i,o=JSON.parse(t);"object"!=typeof o&&(o={}),r.emit("finish",o,n)}else r.emit("finish")},o.ontimeout=function(){o.close(),r.emit("finish")}};var H=function(t){var r=this,i=function(){var e=new R;e.protocol="w-iframe-info-receiver";var n=function(t){if("string"==typeof t&&"m"===t.substr(0,1)){var n=JSON.parse(t.substr(1)),i=n[0],o=n[1];r.emit("finish",i,o)}else r.emit("finish");e.doCleanup(),e=null},i={_options:{},_didClose:n,_didMessage:n};e.i_constructor(i,t,t)};e.body?i():n.attachEvent("load",i)};H.prototype=new o(["finish"]);var q=function(){var e=this;n.delay(function(){e.emit("finish",{},2e3)})};q.prototype=new o(["finish"]);var V=function(e){if(n.isSameOriginUrl(e))return new F(e,n.XHRLocalObject);switch(n.isXHRCorsCapable()){case 1:return new F(e,n.XHRLocalObject);case 2:return n.isSameOriginScheme(e)?new F(e,n.XDRObject):new q;case 3:return new H(e);default:return new q}},J=$["w-iframe-info-receiver"]=function(e,t,r){var i=new F(r,n.XHRLocalObject);i.onfinish=function(t,n){e._didMessage("m"+JSON.stringify([t,n])),e._didClose()}};J.prototype.doCleanup=function(){};var z=x["iframe-eventsource"]=function(){var e=this;e.protocol="w-iframe-eventsource",e.i_constructor.apply(e,arguments)};z.prototype=new R,z.enabled=function(){return"EventSource"in t&&R.enabled()},z.need_body=!0,z.roundTrips=3;var W=$["w-iframe-eventsource"]=function(e,t){this.run(e,t,"/eventsource",Z,n.XHRLocalObject)};W.prototype=new D;var Y=x["iframe-xhr-polling"]=function(){var e=this;e.protocol="w-iframe-xhr-polling",e.i_constructor.apply(e,arguments)};Y.prototype=new R,Y.enabled=function(){return t.XMLHttpRequest&&R.enabled()},Y.need_body=!0,Y.roundTrips=3;var K=$["w-iframe-xhr-polling"]=function(e,t){this.run(e,t,"/xhr",rt,n.XHRLocalObject)};K.prototype=new D;var X=x["iframe-htmlfile"]=function(){var e=this;e.protocol="w-iframe-htmlfile",e.i_constructor.apply(e,arguments)};X.prototype=new R,X.enabled=function(){return R.enabled()},X.need_body=!0,X.roundTrips=3;var G=$["w-iframe-htmlfile"]=function(e,t){this.run(e,t,"/htmlfile",nt,n.XHRLocalObject)};G.prototype=new D;var Q=function(e,t,n,r){var i=this;i.ri=e,i.Receiver=t,i.recv_url=n,i.AjaxObject=r,i._scheduleRecv()};Q.prototype._scheduleRecv=function(){var e=this,t=e.poll=new e.Receiver(e.recv_url,e.AjaxObject),n=0;t.onmessage=function(t){n+=1,e.ri._didMessage(t.data)},t.onclose=function(n){e.poll=t=t.onmessage=t.onclose=null,e.poll_is_closing||("permanent"===n.reason?e.ri._didClose(1006,"Polling error ("+n.reason+")"):e._scheduleRecv())}},Q.prototype.abort=function(){var e=this;e.poll_is_closing=!0,e.poll&&e.poll.abort()};var Z=function(e){var t=this,r=new EventSource(e);r.onmessage=function(e){t.dispatchEvent(new i("message",{data:unescape(e.data)}))},t.es_close=r.onerror=function(e,o){var a=o?"user":2!==r.readyState?"network":"permanent";t.es_close=r.onmessage=r.onerror=null,r.close(),r=null,n.delay(200,function(){t.dispatchEvent(new i("close",{reason:a}))})}};Z.prototype=new r,Z.prototype.abort=function(){var e=this;e.es_close&&e.es_close({},!0)};var et,tt=function(){if(void 0===et)if("ActiveXObject"in t)try{et=!!new ActiveXObject("htmlfile")}catch(e){}else et=!1;return et},nt=function(e){var r=this;n.polluteGlobalNamespace(),r.id="a"+n.random_string(6,26),e+=(-1===e.indexOf("?")?"?":"&")+"c="+escape(s+"."+r.id);var o,a=tt()?n.createHtmlfile:n.createIframe;t[s][r.id]={start:function(){o.loaded()},message:function(e){r.dispatchEvent(new i("message",{data:e}))},stop:function(){r.iframe_close({},"network")}},r.iframe_close=function(e,n){o.cleanup(),r.iframe_close=o=null,delete t[s][r.id],r.dispatchEvent(new i("close",{reason:n}))},o=a(e,function(){r.iframe_close({},"permanent")})};nt.prototype=new r,nt.prototype.abort=function(){var e=this;e.iframe_close&&e.iframe_close({},"user")};var rt=function(e,t){var n=this,r=0;n.xo=new t("POST",e,null),n.xo.onchunk=function(e,t){if(200===e)for(;;){var o=t.slice(r),a=o.indexOf("\n");if(-1===a)break;r+=a+1;var s=o.slice(0,a);n.dispatchEvent(new i("message",{data:s}))}},n.xo.onfinish=function(e,t){n.xo.onchunk(e,t),n.xo=null;var r=200===e?"network":"permanent";n.dispatchEvent(new i("close",{reason:r}))}};return rt.prototype=new r,rt.prototype.abort=function(){var e=this;e.xo&&(e.xo.close(),e.dispatchEvent(new i("close",{reason:"user"})),e.xo=null)},x.getUtils=function(){return n},x.getIframeTransport=function(){return R},x}(),"_sockjs_onload"in window&&setTimeout(_sockjs_onload,1),"function"==typeof define&&define.amd&&define("sockjs",[],function(){return SockJS})}(),function(){Meteor._Stream=function(e){var t=this;t.rawUrl=e,t.socket=null,t.event_callbacks={},t.sent_update_available=!1,t._forcedToDisconnect=!1,t.CONNECT_TIMEOUT=1e4,t.HEARTBEAT_TIMEOUT=6e4,t.RETRY_BASE_TIMEOUT=1e3,t.RETRY_EXPONENT=2.2,t.RETRY_MAX_TIMEOUT=18e5,t.RETRY_MIN_TIMEOUT=10,t.RETRY_MIN_COUNT=2,t.RETRY_FUZZ=.5,t.current_status={status:"connecting",connected:!1,retryCount:0,retry_count:0},t.status_listeners=window.Deps&&new Deps.Dependency,t.status_changed=function(){t.status_listeners&&t.status_listeners.changed()},t.retry_timer=null,t.connection_timer=null,t.heartbeat_timer=null,t._launch_connection()},_.extend(Meteor._Stream,{_toSockjsUrl:function(e){var t=function(e,t){return e.length>=t.length&&e.substring(0,t.length)===t},n=function(e,t){return e.length>=t.length&&e.substring(e.length-t.length)===t},r=e.match(/^ddp(i?)\+sockjs:\/\//);if(r){var i=e.substr(r[0].length),o="i"===r[1]?"http":"https",a=i.indexOf("/"),s=-1===a?i:i.substr(0,a),l=-1===a?"":i.substr(a);return s=s.replace(/\*/g,function(){return Math.floor(10*Random.fraction())}),o+"://"+s+l}return-1!==e.indexOf("://")||t(e,"/")||(e="http://"+e),n(e,"/")?e+"sockjs":e+"/sockjs"}}),_.extend(Meteor._Stream.prototype,{on:function(e,t){var n=this;if("message"!==e&&"reset"!==e&&"update_available"!==e)throw Error("unknown event type: "+e);n.event_callbacks[e]||(n.event_callbacks[e]=[]),n.event_callbacks[e].push(t)},send:function(e){var t=this;t.current_status.connected&&t.socket.send(e)},status:function(){var e=this;return e.status_listeners&&e.status_listeners.depend(),e.current_status},reconnect:function(e){var t=this;return t.current_status.connected?(e&&e._force&&t._lostConnection(),void 0):("connecting"===t.current_status.status&&t._lostConnection(),t.retry_timer&&clearTimeout(t.retry_timer),t.retry_timer=null,t.current_status.retryCount-=1,t.current_status.retry_count=t.current_status.retryCount,t._retry_now(),void 0)},_connected:function(e){var t=this;if(t.connection_timer&&(clearTimeout(t.connection_timer),t.connection_timer=null),!t.current_status.connected){try{var n=JSON.parse(e)}catch(r){Meteor._debug("DEBUG: malformed welcome packet",e)}n&&n.server_id?__meteor_runtime_config__.serverId&&__meteor_runtime_config__.serverId!==n.server_id&&!t.sent_update_available&&(t.sent_update_available=!0,_.each(t.event_callbacks.update_available,function(e){e()})):Meteor._debug("DEBUG: invalid welcome packet",n),t.current_status.status="connected",t.current_status.connected=!0,t.current_status.retryCount=0,t.current_status.retry_count=t.current_status.retryCount,t.status_changed(),_.each(t.event_callbacks.reset,function(e){e()})}},_cleanupSocket:function(){var e=this;e._clearConnectionAndHeartbeatTimers(),e.socket&&(e.socket.onmessage=e.socket.onclose=e.socket.onerror=function(){},e.socket.close(),e.socket=null)},_clearConnectionAndHeartbeatTimers:function(){var e=this;e.connection_timer&&(clearTimeout(e.connection_timer),e.connection_timer=null),e.heartbeat_timer&&(clearTimeout(e.heartbeat_timer),e.heartbeat_timer=null)},forceDisconnect:function(e){var t=this;t._forcedToDisconnect=!0,t._cleanupSocket(),t.retry_timer&&(clearTimeout(t.retry_timer),t.retry_timer=null),t.current_status={status:"failed",connected:!1,retryCount:0,retry_count:0},e&&(t.current_status.reason=e),t.status_changed()},_lostConnection:function(){var e=this;e._cleanupSocket(),e._retry_later()},_heartbeat_timeout:function(){var e=this;Meteor._debug("Connection timeout. No heartbeat received."),e._lostConnection()},_heartbeat_received:function(){var e=this;e._forcedToDisconnect||(e.heartbeat_timer&&clearTimeout(e.heartbeat_timer),e.heartbeat_timer=setTimeout(_.bind(e._heartbeat_timeout,e),e.HEARTBEAT_TIMEOUT))},_retry_timeout:function(e){var t=this;if(t.RETRY_MIN_COUNT>e)return t.RETRY_MIN_TIMEOUT;var n=Math.min(t.RETRY_MAX_TIMEOUT,t.RETRY_BASE_TIMEOUT*Math.pow(t.RETRY_EXPONENT,e));return n*=Random.fraction()*t.RETRY_FUZZ+(1-t.RETRY_FUZZ/2)},_retry_later:function(){var e=this,t=e._retry_timeout(e.current_status.retryCount);e.retry_timer&&clearTimeout(e.retry_timer),e.retry_timer=setTimeout(_.bind(e._retry_now,e),t),e.current_status.status="waiting",e.current_status.connected=!1,e.current_status.retryTime=(new Date).getTime()+t,e.current_status.retry_time=e.current_status.retryTime,e.status_changed()},_retry_now:function(){var e=this;e._forcedToDisconnect||(e.current_status.retryCount+=1,e.current_status.retry_count=e.current_status.retryCount,e.current_status.status="connecting",e.current_status.connected=!1,delete e.current_status.retryTime,delete e.current_status.retry_time,e.status_changed(),e._launch_connection())
},_launch_connection:function(){var e=this;e._cleanupSocket(),e.socket=new SockJS(Meteor._Stream._toSockjsUrl(e.rawUrl),void 0,{debug:!1,protocols_whitelist:["xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"]}),e.socket.onmessage=function(t){e._heartbeat_received(),"connecting"===e.current_status.status?e._connected(t.data):e.current_status.connected&&_.each(e.event_callbacks.message,function(e){e(t.data)})},e.socket.onclose=function(){e._lostConnection()},e.socket.onerror=function(){Meteor._debug("stream error",_.toArray(arguments),(new Date).toDateString())},e.socket.onheartbeat=function(){e._heartbeat_received()},e.connection_timer&&clearTimeout(e.connection_timer),e.connection_timer=setTimeout(_.bind(e._lostConnection,e),e.CONNECT_TIMEOUT)}})}(),function(){EJSON={};var e={};EJSON.addType=function(t,n){if(_.has(e,t))throw Error("Type "+t+" already present");e[t]=n};var t=[{matchJSONValue:function(e){return _.has(e,"$date")&&1===_.size(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return _.has(e,"$binary")&&1===_.size(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&_.has(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:EJSON._base64Encode(e)}},fromJSONValue:function(e){return EJSON._base64Decode(e.$binary)}},{matchJSONValue:function(e){return _.has(e,"$escape")&&1===_.size(e)},matchObject:function(e){return _.isEmpty(e)||_.size(e)>2?!1:_.any(t,function(t){return t.matchJSONValue(e)})},toJSONValue:function(e){var t={};return _.each(e,function(e,n){t[n]=EJSON.toJSONValue(e)}),{$escape:t}},fromJSONValue:function(e){var t={};return _.each(e.$escape,function(e,n){t[n]=EJSON.fromJSONValue(e)}),t}},{matchJSONValue:function(e){return _.has(e,"$type")&&_.has(e,"$value")&&2===_.size(e)},matchObject:function(e){return EJSON._isCustomType(e)},toJSONValue:function(e){return{$type:e.typeName(),$value:e.toJSONValue()}},fromJSONValue:function(t){var n=t.$type,r=e[n];return r(t.$value)}}];EJSON._isCustomType=function(t){return t&&"function"==typeof t.toJSONValue&&"function"==typeof t.typeName&&_.has(e,t.typeName())};var n=EJSON._adjustTypesToJSONValue=function(e){if(null===e)return null;var t=r(e);return void 0!==t?t:(_.each(e,function(t,i){if("object"==typeof t||void 0===t){var o=r(t);return o?(e[i]=o,void 0):(n(t),void 0)}}),e)},r=function(e){for(var n=0;t.length>n;n++){var r=t[n];if(r.matchObject(e))return r.toJSONValue(e)}return void 0};EJSON.toJSONValue=function(e){var t=r(e);return void 0!==t?t:("object"==typeof e&&(e=EJSON.clone(e),n(e)),e)};var i=EJSON._adjustTypesFromJSONValue=function(e){if(null===e)return null;var t=o(e);return t!==e?t:(_.each(e,function(t,n){if("object"==typeof t){var r=o(t);if(t!==r)return e[n]=r,void 0;i(t)}}),e)},o=function(e){if("object"==typeof e&&null!==e&&2>=_.size(e)&&_.all(e,function(e,t){return"string"==typeof t&&"$"===t.substr(0,1)}))for(var n=0;t.length>n;n++){var r=t[n];if(r.matchJSONValue(e))return r.fromJSONValue(e)}return e};EJSON.fromJSONValue=function(e){var t=o(e);return t===e&&"object"==typeof e?(e=EJSON.clone(e),i(e),e):t},EJSON.stringify=function(e){return JSON.stringify(EJSON.toJSONValue(e))},EJSON.parse=function(e){return EJSON.fromJSONValue(JSON.parse(e))},EJSON.isBinary=function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill},EJSON.equals=function(e,t,n){var r,i=!(!n||!n.keyOrderSensitive);if(e===t)return!0;if(!e||!t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(EJSON.isBinary(e)&&EJSON.isBinary(t)){if(e.length!==t.length)return!1;for(r=0;e.length>r;r++)if(e[r]!==t[r])return!1;return!0}if("function"==typeof e.equals)return e.equals(t,n);if(e instanceof Array){if(!(t instanceof Array))return!1;if(e.length!==t.length)return!1;for(r=0;e.length>r;r++)if(!EJSON.equals(e[r],t[r],n))return!1;return!0}var o;if(i){var a=[];return _.each(t,function(e,t){a.push(t)}),r=0,o=_.all(e,function(e,i){return r>=a.length?!1:i!==a[r]?!1:EJSON.equals(e,t[a[r]],n)?(r++,!0):!1}),o&&r===a.length}return r=0,o=_.all(e,function(e,i){return _.has(t,i)?EJSON.equals(e,t[i],n)?(r++,!0):!1:!1}),o&&_.size(t)===r},EJSON.clone=function(e){var t;if("object"!=typeof e)return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(EJSON.isBinary(e)){for(t=EJSON.newBinary(e.length),n=0;e.length>n;n++)t[n]=e[n];return t}if(_.isArray(e)){t=e.slice(0);for(var n=0;e.length>n;n++)t[n]=EJSON.clone(t[n]);return t}return"function"==typeof e.clone?e.clone():(t={},_.each(e,function(e,n){t[n]=EJSON.clone(e)}),t)}}(),function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={},n=0;e.length>n;n++)t[e.charAt(n)]=n;EJSON._base64Encode=function(e){for(var t=[],n=null,i=null,o=null,a=null,s=0;e.length>s;s++)switch(s%3){case 0:n=63&e[s]>>2,i=(3&e[s])<<4;break;case 1:i|=15&e[s]>>4,o=(15&e[s])<<2;break;case 2:o|=3&e[s]>>6,a=63&e[s],t.push(r(n)),t.push(r(i)),t.push(r(o)),t.push(r(a)),n=null,i=null,o=null,a=null}return null!=n&&(t.push(r(n)),t.push(r(i)),null==o?t.push("="):t.push(r(o)),null==a&&t.push("=")),t.join("")};var r=function(t){return e.charAt(t)},i=function(e){return"="===e?-1:t[e]};EJSON.newBinary=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],n=0;e>n;n++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},EJSON._base64Decode=function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var n=EJSON.newBinary(t),r=null,o=null,a=null,s=0,l=0;e.length>l;l++){var u=e.charAt(l),c=i(u);switch(l%4){case 0:if(0>c)throw Error("invalid base64 string");r=c<<2;break;case 1:if(0>c)throw Error("invalid base64 string");r|=c>>4,n[s++]=r,o=(15&c)<<4;break;case 2:c>0&&(o|=c>>2,n[s++]=o,a=(3&c)<<6);break;case 3:c>0&&(n[s++]=a|c)}}return n}}(),function(){var e=function(e,t,n,r){return{key:e,value:t,next:n,prev:r}};OrderedDict=function(){var e=this;e._dict={},e._first=null,e._last=null,e._size=0;var t=_.toArray(arguments);e._stringify=function(e){return e},"function"==typeof t[0]&&(e._stringify=t.shift()),_.each(t,function(t){e.putBefore(t[0],t[1],null)})},_.extend(OrderedDict.prototype,{_k:function(e){return" "+this._stringify(e)},empty:function(){var e=this;return!e._first},size:function(){var e=this;return e._size},_linkEltIn:function(e){var t=this;e.next?(e.prev=e.next.prev,e.next.prev=e,e.prev&&(e.prev.next=e)):(e.prev=t._last,t._last&&(t._last.next=e),t._last=e),(null===t._first||t._first===e.next)&&(t._first=e)},_linkEltOut:function(e){var t=this;e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next),e===t._last&&(t._last=e.prev),e===t._first&&(t._first=e.next)},putBefore:function(t,n,r){var i=this;if(i._dict[i._k(t)])throw Error("Item "+t+" already present in OrderedDict");var o=r?e(t,n,i._dict[i._k(r)]):e(t,n,null);if(void 0===o.next)throw Error("could not find item to put this one before");i._linkEltIn(o),i._dict[i._k(t)]=o,i._size++},append:function(e,t){var n=this;n.putBefore(e,t,null)},remove:function(e){var t=this,n=t._dict[t._k(e)];if(void 0===n)throw Error("Item "+e+" not present in OrderedDict");return t._linkEltOut(n),t._size--,delete t._dict[t._k(e)],n.value},get:function(e){var t=this;return t.has(e)?t._dict[t._k(e)].value:void 0},has:function(e){var t=this;return _.has(t._dict,t._k(e))},forEach:function(e){for(var t=this,n=0,r=t._first;null!==r;){var i=e(r.value,r.key,n);if(i===OrderedDict.BREAK)return;r=r.next,n++}},first:function(){var e=this;return e.empty()?void 0:e._first.key},firstValue:function(){var e=this;return e.empty()?void 0:e._first.value},last:function(){var e=this;return e.empty()?void 0:e._last.key},lastValue:function(){var e=this;return e.empty()?void 0:e._last.value},prev:function(e){var t=this;if(t.has(e)){var n=t.get(e);if(n.prev)return n.prev.key}return null},next:function(e){var t=this;if(t.has(e)){var n=t.get(e);if(n.next)return n.next.key}return null},moveBefore:function(e,t){var n=this,r=n._dict[n._k(e)],i=t?n._dict[n._k(t)]:null;if(void 0===r)throw Error("Item to move is not present");if(void 0===i)throw Error("Could not find element to move this one before");i!==r.next&&(n._linkEltOut(r),r.next=i,n._linkEltIn(r))},indexOf:function(e){var t=this,n=null;return t.forEach(function(r,i,o){return t._k(i)===t._k(e)?(n=o,OrderedDict.BREAK):void 0}),n},_checkRep:function(){var e=this;_.each(e._dict,function(e,t){if(t.next===t)throw Error("Next is a loop");if(t.prev===t)throw Error("Prev is a loop")})}}),OrderedDict.BREAK={"break":!0}}(),function(){LocalCollection=function(){this.docs={},this.next_qid=1,this.queries={},this._savedOriginals=null,this.paused=!1},LocalCollection._applyChanges=function(e,t){_.each(t,function(t,n){void 0===t?delete e[n]:e[n]=t})},LocalCollection.MinimongoError=function(e){var t=this;t.name="MinimongoError",t.details=e},LocalCollection.MinimongoError.prototype=Error(),LocalCollection.prototype.find=function(e,t){return 0===arguments.length&&(e={}),new LocalCollection.Cursor(this,e,t)},LocalCollection.Cursor=function(e,t,n){var r=this;n||(n={}),this.collection=e,LocalCollection._selectorIsId(t)?(r.selector_id=LocalCollection._idStringify(t),r.selector_f=LocalCollection._compileSelector(t),r.sort_f=void 0):(r.selector_id=void 0,r.selector_f=LocalCollection._compileSelector(t),r.sort_f=n.sort?LocalCollection._compileSort(n.sort):null),r.skip=n.skip,r.limit=n.limit,r._transform=n.transform&&"undefined"!=typeof Deps?Deps._makeNonreactive(n.transform):n.transform,r.db_objects=null,r.cursor_pos=0,"undefined"!=typeof Deps&&(r.reactive=void 0===n.reactive?!0:n.reactive)},LocalCollection.Cursor.prototype.rewind=function(){var e=this;e.db_objects=null,e.cursor_pos=0},LocalCollection.prototype.findOne=function(e,t){return 0===arguments.length&&(e={}),t=t||{},t.limit=1,this.find(e,t).fetch()[0]},LocalCollection.Cursor.prototype.forEach=function(e){var t=this;for(null===t.db_objects&&(t.db_objects=t._getRawObjects(!0)),t.reactive&&t._depend({addedBefore:!0,removed:!0,changed:!0,movedBefore:!0});t.cursor_pos<t.db_objects.length;){var n=EJSON.clone(t.db_objects[t.cursor_pos++]);t._transform&&(n=t._transform(n)),e(n)}},LocalCollection.Cursor.prototype.getTransform=function(){var e=this;return e._transform},LocalCollection.Cursor.prototype.map=function(e){var t=this,n=[];return t.forEach(function(t){n.push(e(t))}),n},LocalCollection.Cursor.prototype.fetch=function(){var e=this,t=[];return e.forEach(function(e){t.push(e)}),t},LocalCollection.Cursor.prototype.count=function(){var e=this;return e.reactive&&e._depend({added:!0,removed:!0}),null===e.db_objects&&(e.db_objects=e._getRawObjects(!0)),e.db_objects.length},LocalCollection._isOrderedChanges=function(e){if(e.added&&e.addedBefore)throw Error("Please specify only one of added() and addedBefore()");return"function"==typeof e.addedBefore||"function"==typeof e.movedBefore},LocalCollection.LiveResultsSet=function(){},_.extend(LocalCollection.Cursor.prototype,{observe:function(e){var t=this;return LocalCollection._observeFromObserveChanges(t,e)},observeChanges:function(e){var t=this,n=LocalCollection._isOrderedChanges(e);if(!n&&(t.skip||t.limit))throw Error("must use ordered observe with skip or limit");var r,i={selector_f:t.selector_f,sort_f:n&&t.sort_f,results_snapshot:null,ordered:n,cursor:this,observeChanges:e.observeChanges};t.reactive&&(r=t.collection.next_qid++,t.collection.queries[r]=i),i.results=t._getRawObjects(n),t.collection.paused&&(i.results_snapshot=n?[]:{});var o=function(e){return e?function(){t.collection.paused||e.apply(this,arguments)}:function(){}};i.added=o(e.added),i.changed=o(e.changed),i.removed=o(e.removed),n&&(i.moved=o(e.moved),i.addedBefore=o(e.addedBefore),i.movedBefore=o(e.movedBefore)),e._suppress_initial||t.collection.paused||_.each(i.results,function(e){var t=EJSON.clone(e);delete t._id,n&&i.addedBefore(e._id,t,null),i.added(e._id,t)});var a=new LocalCollection.LiveResultsSet;return _.extend(a,{collection:t.collection,stop:function(){t.reactive&&delete t.collection.queries[r]}}),t.reactive&&Deps.active&&Deps.onInvalidate(function(){a.stop()}),a}}),LocalCollection.Cursor.prototype._getRawObjects=function(e){var t=this,n=e?[]:{};if(t.selector_id){if(t.skip)return n;if(_.has(t.collection.docs,t.selector_id)){var r=t.collection.docs[t.selector_id];e?n.push(r):n[t.selector_id]=r}return n}for(var i in t.collection.docs){var o=t.collection.docs[i];if(t.selector_f(o)&&(e?n.push(o):n[i]=o),t.limit&&!t.skip&&!t.sort_f&&n.length===t.limit)return n}if(!e)return n;t.sort_f&&n.sort(t.sort_f);var a=t.skip||0,s=t.limit?t.limit+a:n.length;return n.slice(a,s)},LocalCollection.Cursor.prototype._depend=function(e){var t=this;if(Deps.active){var n=new Deps.Dependency;n.depend();var r=_.bind(n.changed,n),i={_suppress_initial:!0};_.each(["added","changed","removed","addedBefore","movedBefore"],function(t){e[t]&&(i[t]=r)}),t.observeChanges(i)}},LocalCollection.prototype.insert=function(e){var t=this;e=EJSON.clone(e),_.has(e,"_id")||(e._id=LocalCollection._useOID?new LocalCollection._ObjectID:Random.id());var n=LocalCollection._idStringify(e._id);if(_.has(t.docs,e._id))throw new LocalCollection.MinimongoError("Duplicate _id '"+e._id+"'");t._saveOriginal(n,void 0),t.docs[n]=e;var r=[];for(var i in t.queries){var o=t.queries[i];o.selector_f(e)&&(o.cursor.skip||o.cursor.limit?r.push(i):LocalCollection._insertInResults(o,e))}_.each(r,function(e){t.queries[e]&&LocalCollection._recomputeResults(t.queries[e])})},LocalCollection.prototype.remove=function(e){var t=this,n=[],r=[],i=LocalCollection._compileSelector(e),o=LocalCollection._idsMatchedBySelector(e);if(o)_.each(o,function(e){var r=LocalCollection._idStringify(e);_.has(t.docs,r)&&i(t.docs[r])&&n.push(r)});else for(var a in t.docs){var s=t.docs[a];i(s)&&n.push(a)}for(var l=[],u=0;n.length>u;u++){var c=n[u],d=t.docs[c];_.each(t.queries,function(e,t){e.selector_f(d)&&(e.cursor.skip||e.cursor.limit?r.push(t):l.push({qid:t,doc:d}))}),t._saveOriginal(c,d),delete t.docs[c]}_.each(l,function(e){var n=t.queries[e.qid];n&&LocalCollection._removeFromResults(n,e.doc)}),_.each(r,function(e){var n=t.queries[e];n&&LocalCollection._recomputeResults(n)})},LocalCollection.prototype.update=function(e,t,n){var r=this;if(n||(n={}),n.upsert)throw Error("upsert not yet implemented");var i=LocalCollection._compileSelector(e),o={};_.each(r.queries,function(e,t){!e.cursor.skip&&!e.cursor.limit||e.paused||(o[t]=EJSON.clone(e.results))});var a={};for(var s in r.docs){var l=r.docs[s];if(i(l)&&(r._saveOriginal(s,l),r._modifyAndNotify(l,t,a),!n.multi))break}_.each(a,function(e,t){var n=r.queries[t];n&&LocalCollection._recomputeResults(n,o[t])})},LocalCollection.prototype._modifyAndNotify=function(e,t,n){var r=this,i={};for(var o in r.queries){var a=r.queries[o];i[o]=a.ordered?a.selector_f(e):_.has(a.results,LocalCollection._idStringify(e._id))}var s=EJSON.clone(e);LocalCollection._modify(e,t);for(o in r.queries){a=r.queries[o];var l=i[o],u=a.selector_f(e);a.cursor.skip||a.cursor.limit?(l||u)&&(n[o]=!0):l&&!u?LocalCollection._removeFromResults(a,e):!l&&u?LocalCollection._insertInResults(a,e):l&&u&&LocalCollection._updateInResults(a,e,s)}},LocalCollection._insertInResults=function(e,t){var n=EJSON.clone(t);if(delete n._id,e.ordered){if(e.sort_f){var r=LocalCollection._insertInSortedList(e.sort_f,e.results,t),i=e.results[r+1];i=i?i._id:null,e.addedBefore(t._id,n,i)}else e.addedBefore(t._id,n,null),e.results.push(t);e.added(t._id,n)}else e.added(t._id,n),e.results[LocalCollection._idStringify(t._id)]=t},LocalCollection._removeFromResults=function(e,t){if(e.ordered){var n=LocalCollection._findInOrderedResults(e,t);e.removed(t._id),e.results.splice(n,1)}else{var r=LocalCollection._idStringify(t._id);e.removed(t._id),delete e.results[r]}},LocalCollection._updateInResults=function(e,t,n){if(!EJSON.equals(t._id,n._id))throw Error("Can't change a doc's _id while updating");var r=LocalCollection._makeChangedFields(t,n);if(!e.ordered)return _.isEmpty(r)||(e.changed(t._id,r),e.results[LocalCollection._idStringify(t._id)]=t),void 0;var i=LocalCollection._findInOrderedResults(e,t);if(_.isEmpty(r)||e.changed(t._id,r),e.sort_f){e.results.splice(i,1);var o=LocalCollection._insertInSortedList(e.sort_f,e.results,t);if(i!==o){var a=e.results[o+1];a=a?a._id:null,e.movedBefore&&e.movedBefore(t._id,a)}}},LocalCollection._recomputeResults=function(e,t){t||(t=e.results),e.results=e.cursor._getRawObjects(e.ordered),e.paused||LocalCollection._diffQueryChanges(e.ordered,t,e.results,e)},LocalCollection._findInOrderedResults=function(e,t){if(!e.ordered)throw Error("Can't call _findInOrderedResults on unordered query");for(var n=0;e.results.length>n;n++)if(e.results[n]===t)return n;throw Error("object missing from query")},LocalCollection._insertInSortedList=function(e,t,n){if(0===t.length)return t.push(n),0;for(var r=0;t.length>r;r++)if(0>e(n,t[r]))return t.splice(r,0,n),r;return t.push(n),t.length-1},LocalCollection.prototype.saveOriginals=function(){var e=this;if(e._savedOriginals)throw Error("Called saveOriginals twice without retrieveOriginals");e._savedOriginals={}},LocalCollection.prototype.retrieveOriginals=function(){var e=this;if(!e._savedOriginals)throw Error("Called retrieveOriginals without saveOriginals");var t=e._savedOriginals;return e._savedOriginals=null,t},LocalCollection.prototype._saveOriginal=function(e,t){var n=this;n._savedOriginals&&(_.has(n._savedOriginals,e)||(n._savedOriginals[e]=EJSON.clone(t)))},LocalCollection.prototype.pauseObservers=function(){if(!this.paused){this.paused=!0;for(var e in this.queries){var t=this.queries[e];t.results_snapshot=EJSON.clone(t.results)}}},LocalCollection.prototype.resumeObservers=function(){if(this.paused){this.paused=!1;for(var e in this.queries){var t=this.queries[e];LocalCollection._diffQueryChanges(t.ordered,t.results_snapshot,t.results,t),t.results_snapshot=null}}},LocalCollection._idStringify=function(e){if(e instanceof LocalCollection._ObjectID)return e.valueOf();if("string"==typeof e)return""===e?e:"-"===e.substr(0,1)||"~"===e.substr(0,1)||LocalCollection._looksLikeObjectID(e)||"{"===e.substr(0,1)?"-"+e:e;if(void 0===e)return"-";if("object"==typeof e)throw Error("Meteor does not currently support objects other than ObjectID as ids");return"~"+JSON.stringify(e)},LocalCollection._idParse=function(e){return""===e?e:"-"===e?void 0:"-"===e.substr(0,1)?e.substr(1):"~"===e.substr(0,1)?JSON.parse(e.substr(1)):LocalCollection._looksLikeObjectID(e)?new LocalCollection._ObjectID(e):e},"undefined"!=typeof Meteor&&(Meteor.idParse=LocalCollection._idParse,Meteor.idStringify=LocalCollection._idStringify),LocalCollection._makeChangedFields=function(e,t){var n={};return LocalCollection._diffObjects(t,e,{leftOnly:function(e){n[e]=void 0},rightOnly:function(e,t){n[e]=t},both:function(e,t,r){EJSON.equals(t,r)||(n[e]=r)}}),n},LocalCollection._observeFromObserveChanges=function(e,t){var n=e.getTransform();if(n||(n=function(e){return e}),t.addedAt&&t.added)throw Error("Please specify only one of added() and addedAt()");if(t.changedAt&&t.changed)throw Error("Please specify only one of changed() and changedAt()");if(t.removed&&t.removedAt)throw Error("Please specify only one of removed() and removedAt()");return t.addedAt||t.movedTo||t.changedAt||t.removedAt?LocalCollection._observeOrderedFromObserveChanges(e,t,n):LocalCollection._observeUnorderedFromObserveChanges(e,t,n)},LocalCollection._observeUnorderedFromObserveChanges=function(e,t,n){var r={},i=!!t._suppress_initial,o=e.observeChanges({added:function(e,o){var a=LocalCollection._idStringify(e),s=EJSON.clone(o);s._id=e,r[a]=s,i||t.added&&t.added(n(s))},changed:function(e,o){var a=LocalCollection._idStringify(e),s=r[a],l=EJSON.clone(s);LocalCollection._applyChanges(s,o),i||t.changed&&t.changed(n(s),n(l))},removed:function(e){var o=LocalCollection._idStringify(e),a=r[o];delete r[o],i||t.removed&&t.removed(n(a))}});return i=!1,o},LocalCollection._observeOrderedFromObserveChanges=function(e,t,n){var r=new OrderedDict(LocalCollection._idStringify),i=!!t._suppress_initial,o=e.observeChanges({addedBefore:function(e,o,a){var s=EJSON.clone(o);if(s._id=e,r.putBefore(e,s,a?a:null),!i)if(t.addedAt){var l=r.indexOf(e);t.addedAt(n(EJSON.clone(s)),l,a)}else t.added&&t.added(n(EJSON.clone(s)))},changed:function(e,i){var o=r.get(e);if(!o)throw Error("Unknown id for changed: "+e);var a=EJSON.clone(o);if(LocalCollection._applyChanges(o,i),t.changedAt){var s=r.indexOf(e);t.changedAt(n(EJSON.clone(o)),n(a),s)}else t.changed&&t.changed(n(EJSON.clone(o)),n(a))},movedBefore:function(e,i){var o,a=r.get(e);if(t.movedTo&&(o=r.indexOf(e)),r.moveBefore(e,i?i:null),t.movedTo){var s=r.indexOf(e);t.movedTo(n(EJSON.clone(a)),o,s)}else t.moved&&t.moved(n(EJSON.clone(a)))},removed:function(e){var i,o=r.get(e);t.removedAt&&(i=r.indexOf(e)),r.remove(e),t.removedAt&&t.removedAt(n(o),i),t.removed&&t.removed(n(o))}});return i=!1,o}}(),function(){var e=function(e){return _.isArray(e)&&!EJSON.isBinary(e)},t=function(t,n){return e(t)?_.any(t,n):n(t)},n=function(t,n){return n(t)?!0:e(t)&&_.any(t,n)},r=function(e){var t=void 0;for(var n in e){var r="$"===n.substr(0,1);if(void 0===t)t=r;else if(t!==r)throw Error("Inconsistent selector: "+e)}return!!t},i=function(i){if(null==i)return function(e){return t(e,function(e){return null==e})};if(!_.isObject(i))return function(e){return t(e,function(e){return e===i})};if(i instanceof RegExp)return function(e){return void 0===e?!1:t(e,function(e){return i.test(e)})};if(e(i))return function(t){return e(t)?n(t,function(e){return LocalCollection._f._equal(i,e)}):!1};if(r(i)){var o=[];return _.each(i,function(e,t){if(!_.has(a,t))throw Error("Unrecognized operator: "+t);o.push(a[t](e,i.$options))}),function(e){return _.all(o,function(t){return t(e)})}}return function(e){return t(e,function(e){return LocalCollection._f._equal(i,e)})}},o={$and:function(t){if(!e(t)||_.isEmpty(t))throw Error("$and/$or/$nor must be nonempty array");var n=_.map(t,s);return function(e){return _.all(n,function(t){return t(e)})}},$or:function(t){if(!e(t)||_.isEmpty(t))throw Error("$and/$or/$nor must be nonempty array");var n=_.map(t,s);return function(e){return _.any(n,function(t){return t(e)})}},$nor:function(t){if(!e(t)||_.isEmpty(t))throw Error("$and/$or/$nor must be nonempty array");var n=_.map(t,s);return function(e){return _.all(n,function(t){return!t(e)})}},$where:function(e){return e instanceof Function||(e=Function("return "+e)),function(t){return e.call(t)}}},a={$in:function(t){if(!e(t))throw Error("Argument to $in must be array");return function(e){return n(e,function(e){return _.any(t,function(t){return LocalCollection._f._equal(t,e)})})}},$all:function(t){if(!e(t))throw Error("Argument to $all must be array");return function(n){return e(n)?_.all(t,function(e){return _.any(n,function(t){return LocalCollection._f._equal(e,t)})}):!1}},$lt:function(e){return function(n){return t(n,function(t){return 0>LocalCollection._f._cmp(t,e)})}},$lte:function(e){return function(n){return t(n,function(t){return 0>=LocalCollection._f._cmp(t,e)})}},$gt:function(e){return function(n){return t(n,function(t){return LocalCollection._f._cmp(t,e)>0})}},$gte:function(e){return function(n){return t(n,function(t){return LocalCollection._f._cmp(t,e)>=0})}},$ne:function(e){return function(t){return!n(t,function(t){return LocalCollection._f._equal(t,e)})}},$nin:function(t){if(!e(t))throw Error("Argument to $nin must be array");var n=a.$in(t);return function(e){return void 0===e?!0:!n(e)}},$exists:function(e){return function(t){return e===(void 0!==t)}},$mod:function(e){var n=e[0],r=e[1];return function(e){return t(e,function(e){return e%n===r})}},$size:function(t){return function(n){return e(n)&&t===n.length}},$type:function(e){return function(n){return void 0===n?!1:t(n,function(t){return LocalCollection._f._type(t)===e})}},$regex:function(e,n){if(void 0!==n){if(/[^gim]/.test(n))throw Error("Only the i, m, and g regexp options are supported");var r=e instanceof RegExp?e.source:e;e=RegExp(r,n)}else e instanceof RegExp||(e=RegExp(e));return function(n){return void 0===n?!1:t(n,function(t){return e.test(t)})}},$options:function(){return function(){return!0}},$elemMatch:function(t){var n=s(t);return function(t){return e(t)?_.any(t,function(e){return n(e)}):!1}},$not:function(e){var t=i(e);return function(e){return!t(e)}}};LocalCollection._f={_type:function(t){return"number"==typeof t?1:"string"==typeof t?2:"boolean"==typeof t?8:e(t)?4:null===t?10:t instanceof RegExp?11:"function"==typeof t?13:t instanceof Date?9:EJSON.isBinary(t)?5:t instanceof Meteor.Collection.ObjectID?7:3},_equal:function(e,t){return EJSON.equals(e,t,{keyOrderSensitive:!0})},_typeorder:function(e){return[-1,1,2,3,4,5,-1,6,7,8,0,9,-1,100,2,100,1,8,1][e]},_cmp:function(e,t){if(void 0===e)return void 0===t?0:-1;if(void 0===t)return 1;var n=LocalCollection._f._type(e),r=LocalCollection._f._type(t),i=LocalCollection._f._typeorder(n),o=LocalCollection._f._typeorder(r);if(i!==o)return o>i?-1:1;if(n!==r)throw Error("Missing type coercion logic in _cmp");if(7===n&&(n=r=2,e=e.toHexString(),t=t.toHexString()),9===n&&(n=r=1,e=e.getTime(),t=t.getTime()),1===n)return e-t;if(2===r)return t>e?-1:e===t?0:1;if(3===n){var a=function(e){var t=[];for(var n in e)t.push(n),t.push(e[n]);return t};return LocalCollection._f._cmp(a(e),a(t))}if(4===n)for(var s=0;;s++){if(s===e.length)return s===t.length?0:-1;if(s===t.length)return 1;var l=LocalCollection._f._cmp(e[s],t[s]);if(0!==l)return l}if(5===n){if(e.length!==t.length)return e.length-t.length;for(s=0;e.length>s;s++){if(e[s]<t[s])return-1;if(e[s]>t[s])return 1}return 0}if(8===n)return e?t?0:1:t?-1:0;if(10===n)return 0;if(11===n)throw Error("Sorting not supported on regular expression");if(13===n)throw Error("Sorting not supported on Javascript code");throw Error("Unknown type to sort")}},LocalCollection._matches=function(e,t){return LocalCollection._compileSelector(e)(t)},LocalCollection._makeLookupFunction=function(t){var n,r,i,o=t.indexOf(".");if(-1===o)n=t;else{n=t.substr(0,o);var a=t.substr(o+1);r=LocalCollection._makeLookupFunction(a),i=/^\d+(\.|$)/.test(a)}return function(t){if(null==t)return[void 0];var o=t[n];return r?e(o)&&0===o.length?[void 0]:((!e(o)||i)&&(o=[o]),Array.prototype.concat.apply([],_.map(o,r))):[o]}};var s=function(e){var t=[];return _.each(e,function(e,n){if("$"===n.substr(0,1)){if(!_.has(o,n))throw Error("Unrecognized logical operator: "+n);t.push(o[n](e))}else{var r=LocalCollection._makeLookupFunction(n),a=i(e);t.push(function(e){var t=r(e);return _.any(t,a)})}}),function(e){return _.all(t,function(t){return t(e)})}};LocalCollection._compileSelector=function(t){if(t instanceof Function)return function(e){return t.call(e)};if(LocalCollection._selectorIsId(t))return function(e){return EJSON.equals(e._id,t)};if(!t||"_id"in t&&!t._id)return function(){return!1};if("boolean"==typeof t||e(t)||EJSON.isBinary(t))throw Error("Invalid selector: "+t);return s(t)},LocalCollection._compileSort=function(t){var n=[];if(t instanceof Array)for(var r=0;t.length>r;r++)"string"==typeof t[r]?n.push({lookup:LocalCollection._makeLookupFunction(t[r]),ascending:!0}):n.push({lookup:LocalCollection._makeLookupFunction(t[r][0]),ascending:"desc"!==t[r][1]});else{if("object"!=typeof t)throw Error("Bad sort specification: ",JSON.stringify(t));for(var i in t)n.push({lookup:LocalCollection._makeLookupFunction(i),ascending:t[i]>=0})}if(0===n.length)return function(){return 0};var o=function(t,n){var r,i=!0;return _.each(t,function(t){e(t)||(t=[t]),e(t)&&0===t.length&&(t=[void 0]),_.each(t,function(e){if(i)r=e,i=!1;else{var t=LocalCollection._f._cmp(r,e);(n&&t>0||!n&&0>t)&&(r=e)}})}),r};return function(e,t){for(var r=0;n.length>r;++r){var i=n[r],a=o(i.lookup(e),i.ascending),s=o(i.lookup(t),i.ascending),l=LocalCollection._f._cmp(a,s);if(0!==l)return i.ascending?l:-l}return 0}}}(),function(){LocalCollection._modify=function(e,t){var n=!1;for(var r in t){n="$"===r.substr(0,1);break}var i;if(n){var i=EJSON.clone(e);for(var o in t){var a=LocalCollection._modifiers[o];if(!a)throw Error("Invalid modifier specified "+o);for(var s in t[o]){if(s.length&&"."===s[s.length-1])throw Error("Invalid mod field name, may not end in a period");var l=t[o][s],u=s.split("."),c=!!LocalCollection._noCreateModifiers[o],d="$rename"===o,f=LocalCollection._findModTarget(i,u,c,d),p=u.pop();a(f,p,l,s,i)}}}else{if(t._id&&!EJSON.equals(e._id,t._id))throw Error("Cannot change the _id of a document");for(var r in t){if("$"===r.substr(0,1))throw Error("When replacing document, field name may not start with '$'");if(/\./.test(r))throw Error("When replacing document, field name may not contain '.'")}i=t}_.each(_.keys(e),function(t){"_id"!==t&&delete e[t]});for(var r in i)e[r]=i[r]},LocalCollection._findModTarget=function(e,t,n,r){for(var i=0;t.length>i;i++){var o=i===t.length-1,a=t[i],s=/^[0-9]+$/.test(a);if(!(!n||"object"==typeof e&&a in e))return void 0;if(e instanceof Array){if(r)return null;if(!s)throw Error("can't append to array using string field name ["+a+"]");for(a=parseInt(a),o&&(t[i]=a);a>e.length;)e.push(null);if(!o)if(e.length===a)e.push({});else if("object"!=typeof e[a])throw Error("can't modify field '"+t[i+1]+"' of list value "+JSON.stringify(e[a]))}else o||a in e||(e[a]={});if(o)return e;e=e[a]}},LocalCollection._noCreateModifiers={$unset:!0,$pop:!0,$rename:!0,$pull:!0,$pullAll:!0},LocalCollection._modifiers={$inc:function(e,t,n){if("number"!=typeof n)throw Error("Modifier $inc allowed for numbers only");if(t in e){if("number"!=typeof e[t])throw Error("Cannot apply $inc modifier to non-number");e[t]+=n}else e[t]=n},$set:function(e,t,n){if("_id"===t&&!EJSON.equals(n,e._id))throw Error("Cannot change the _id of a document");e[t]=EJSON.clone(n)},$unset:function(e,t){void 0!==e&&(e instanceof Array?t in e&&(e[t]=null):delete e[t])},$push:function(e,t,n){var r=e[t];if(void 0===r)e[t]=[n];else{if(!(r instanceof Array))throw Error("Cannot apply $push modifier to non-array");r.push(EJSON.clone(n))}},$pushAll:function(e,t,n){if(!("object"==typeof n&&n instanceof Array))throw Error("Modifier $pushAll/pullAll allowed for arrays only");var r=e[t];if(void 0===r)e[t]=n;else{if(!(r instanceof Array))throw Error("Cannot apply $pushAll modifier to non-array");for(var i=0;n.length>i;i++)r.push(n[i])}},$addToSet:function(e,t,n){var r=e[t];if(void 0===r)e[t]=[n];else{if(!(r instanceof Array))throw Error("Cannot apply $addToSet modifier to non-array");var i=!1;if("object"==typeof n)for(var o in n){"$each"===o&&(i=!0);break}var a=i?n.$each:[n];_.each(a,function(e){for(var t=0;r.length>t;t++)if(LocalCollection._f._equal(e,r[t]))return;r.push(e)})}},$pop:function(e,t,n){if(void 0!==e){var r=e[t];if(void 0!==r){if(!(r instanceof Array))throw Error("Cannot apply $pop modifier to non-array");"number"==typeof n&&0>n?r.splice(0,1):r.pop()}}},$pull:function(e,t,n){if(void 0!==e){var r=e[t];if(void 0!==r){if(!(r instanceof Array))throw Error("Cannot apply $pull/pullAll modifier to non-array");var i=[];if("object"!=typeof n||n instanceof Array)for(var o=0;r.length>o;o++)LocalCollection._f._equal(r[o],n)||i.push(r[o]);else for(var a=LocalCollection._compileSelector(n),o=0;r.length>o;o++)a(r[o])||i.push(r[o]);e[t]=i}}},$pullAll:function(e,t,n){if(!("object"==typeof n&&n instanceof Array))throw Error("Modifier $pushAll/pullAll allowed for arrays only");if(void 0!==e){var r=e[t];if(void 0!==r){if(!(r instanceof Array))throw Error("Cannot apply $pull/pullAll modifier to non-array");for(var i=[],o=0;r.length>o;o++){for(var a=!1,s=0;n.length>s;s++)if(LocalCollection._f._equal(r[o],n[s])){a=!0;break}a||i.push(r[o])}e[t]=i}}},$rename:function(e,t,n,r,i){if(r===n)throw Error("$rename source must differ from target");if(null===e)throw Error("$rename source field invalid");if("string"!=typeof n)throw Error("$rename target must be a string");
if(void 0!==e){var o=e[t];delete e[t];var a=n.split("."),s=LocalCollection._findModTarget(i,a,!1,!0);if(null===s)throw Error("$rename target field invalid");var l=a.pop();s[l]=o}},$bit:function(){throw Error("$bit is not supported")}}}(),function(){LocalCollection._diffQueryChanges=function(e,t,n,r){e?LocalCollection._diffQueryOrderedChanges(t,n,r):LocalCollection._diffQueryUnorderedChanges(t,n,r)},LocalCollection._diffQueryUnorderedChanges=function(e,t,n){if(n.moved)throw Error("_diffQueryUnordered called with a moved observer!");_.each(t,function(t){if(_.has(e,t._id)){var r=e[t._id];n.changed&&!EJSON.equals(r,t)&&n.changed(t._id,LocalCollection._makeChangedFields(t,r))}else{var i=EJSON.clone(t);delete i._id,n.added&&n.added(t._id,i)}}),n.removed&&_.each(e,function(e){_.has(t,e._id)||n.removed(e._id)})},LocalCollection._diffQueryOrderedChanges=function(e,t,n){var r={};_.each(t,function(e){r[e._id]&&Meteor._debug("Duplicate _id in new_results"),r[e._id]=!0});var i={};_.each(e,function(e,t){e._id in i&&Meteor._debug("Duplicate _id in old_results"),i[e._id]=t});for(var o=[],a=0,s=t.length,l=Array(s),u=Array(s),c=function(e){return i[t[e]._id]},d=0;s>d;d++)if(void 0!==i[t[d]._id]){for(var f=a;f>0&&!(c(l[f-1])<c(d));)f--;u[d]=0===f?-1:l[f-1],l[f]=d,f+1>a&&(a=f+1)}for(var p=0===a?-1:l[a-1];p>=0;)o.push(p),p=u[p];o.reverse(),o.push(t.length),_.each(e,function(e){r[e._id]||n.removed&&n.removed(e._id)});var h=0;_.each(o,function(r){for(var o,a,s,l=t[r]?t[r]._id:null,u=h;r>u;u++)a=t[u],_.has(i,a._id)?(o=e[i[a._id]],s=LocalCollection._makeChangedFields(a,o),_.isEmpty(s)||n.changed&&n.changed(a._id,s),n.movedBefore&&n.movedBefore(a._id,l)):(s=EJSON.clone(a),delete s._id,n.addedBefore&&n.addedBefore(a._id,s,l),n.added&&n.added(a._id,s));l&&(a=t[r],o=e[i[a._id]],s=LocalCollection._makeChangedFields(a,o),_.isEmpty(s)||n.changed&&n.changed(a._id,s)),h=r+1})},LocalCollection._diffObjects=function(e,t,n){_.each(e,function(e,r){_.has(t,r)?n.both&&n.both(r,e,t[r]):n.leftOnly&&n.leftOnly(r,e)}),n.rightOnly&&_.each(t,function(t,r){_.has(e,r)||n.rightOnly(r,t)})}}(),function(){LocalCollection._looksLikeObjectID=function(e){return 24===e.length&&e.match(/^[0-9a-f]*$/)},LocalCollection._ObjectID=function(e){var t=this;if(e){if(e=e.toLowerCase(),!LocalCollection._looksLikeObjectID(e))throw Error("Invalid hexadecimal string for creating an ObjectID");t._str=e}else t._str=Random.hexString(24)},LocalCollection._ObjectID.prototype.toString=function(){var e=this;return'ObjectID("'+e._str+'")'},LocalCollection._ObjectID.prototype.equals=function(e){var t=this;return e instanceof LocalCollection._ObjectID&&t.valueOf()===e.valueOf()},LocalCollection._ObjectID.prototype.clone=function(){var e=this;return new LocalCollection._ObjectID(e._str)},LocalCollection._ObjectID.prototype.typeName=function(){return"oid"},LocalCollection._ObjectID.prototype.getTimestamp=function(){var e=this;return parseInt(e._str.substr(0,8),16)},LocalCollection._ObjectID.prototype.valueOf=LocalCollection._ObjectID.prototype.toJSONValue=LocalCollection._ObjectID.prototype.toHexString=function(){return this._str},LocalCollection._selectorIsId=function(e){return"string"==typeof e||"number"==typeof e||e instanceof LocalCollection._ObjectID},LocalCollection._selectorIsIdPerhapsAsObject=function(e){return LocalCollection._selectorIsId(e)||e&&"object"==typeof e&&e._id&&LocalCollection._selectorIsId(e._id)&&1===_.size(e)},LocalCollection._idsMatchedBySelector=function(e){if(LocalCollection._selectorIsId(e))return[e];if(!e)return null;if(_.has(e,"_id"))return LocalCollection._selectorIsId(e._id)?[e._id]:e._id&&e._id.$in&&_.isArray(e._id.$in)&&!_.isEmpty(e._id.$in)&&_.all(e._id.$in,LocalCollection._selectorIsId)?e._id.$in:null;if(e.$and&&_.isArray(e.$and))for(var t=0;e.$and.length>t;++t){var n=LocalCollection._idsMatchedBySelector(e.$and[t]);if(n)return n}return null},EJSON.addType("oid",function(e){return new LocalCollection._ObjectID(e)})}(),function(){Meteor._SUPPORTED_DDP_VERSIONS=["pre1"],Meteor._MethodInvocation=function(e){this.isSimulation=e.isSimulation,this.is_simulation=this.isSimulation,this._unblock=e.unblock||function(){},this._calledUnblock=!1,this.userId=e.userId,this._setUserId=e.setUserId||function(){},this._sessionData=e.sessionData},_.extend(Meteor._MethodInvocation.prototype,{unblock:function(){var e=this;e._calledUnblock=!0,e._unblock()},setUserId:function(e){var t=this;if(t._calledUnblock)throw Error("Can't call setUserId in a method after calling unblock");t.userId=e,t._setUserId(e)}}),Meteor._parseDDP=function(e){try{var t=JSON.parse(e)}catch(n){return Meteor._debug("Discarding message with invalid JSON",e),null}return null===t||"object"!=typeof t?(Meteor._debug("Discarding non-object DDP message",e),null):(_.has(t,"cleared")&&(_.has(t,"fields")||(t.fields={}),_.each(t.cleared,function(e){t.fields[e]=void 0}),delete t.cleared),_.each(["fields","params","result"],function(e){_.has(t,e)&&(t[e]=EJSON._adjustTypesFromJSONValue(t[e]))}),t)},Meteor._stringifyDDP=function(e){var t=EJSON.clone(e);if(_.has(e,"fields")){var n=[];_.each(e.fields,function(e,r){void 0===e&&(n.push(r),delete t.fields[r])}),_.isEmpty(n)||(t.cleared=n),_.isEmpty(t.fields)&&delete t.fields}if(_.each(["fields","params","result"],function(e){_.has(t,e)&&(t[e]=EJSON._adjustTypesToJSONValue(t[e]))}),e.id&&"string"!=typeof e.id)throw Error("Message id is not a string");return JSON.stringify(t)},Meteor._CurrentInvocation=new Meteor.EnvironmentVariable,Meteor.Error=function(e,t,n){var r=this;r.error=e,r.reason=t,r.details=n},Meteor.Error.prototype=Error()}(),function(){if(Meteor.isServer)var e=Npm.require(path.join("fibers","future"));Meteor._LivedataConnection=function(e,t){var n=this;t=_.extend({reloadOnUpdate:!1,reloadWithOutstanding:!1,supportedDDPVersions:Meteor._SUPPORTED_DDP_VERSIONS,onConnectionFailure:function(e){Meteor._debug("Failed DDP connection: "+e)},onConnected:function(){}},t),n.onReconnect=null,n._stream="object"==typeof e?e:new Meteor._Stream(e),n._lastSessionId=null,n._versionSuggestion=null,n._version=null,n._stores={},n._methodHandlers={},n._nextMethodId=1,n._supportedDDPVersions=t.supportedDDPVersions,n._methodInvokers={},n._outstandingMethodBlocks=[],n._documentsWrittenByStub={},n._serverDocuments={},n._afterUpdateCallbacks=[],n._messagesBufferedUntilQuiescence=[],n._methodsBlockingQuiescence={},n._subsBeingRevived={},n._resetStores=!1,n._updatesForUnknownStores={},n._retryMigrate=null,n._subscriptions={},n._sessionData={},n._userId=null,n._userIdDeps="undefined"!=typeof Deps&&new Deps.Dependency,t.reloadWithOutstanding||Meteor._reload.onMigrate(function(e){if(n._readyToMigrate())return[!0];if(n._retryMigrate)throw Error("Two migrations in progress?");return n._retryMigrate=e,!1}),n._stream.on("message",function(e){try{var r=Meteor._parseDDP(e)}catch(i){return Meteor._debug("Exception while parsing DDP",i),void 0}if(null===r||!r.msg)return Meteor._debug("discarding invalid livedata message",r),void 0;if("connected"===r.msg)n._version=n._versionSuggestion,t.onConnected(),n._livedata_connected(r);else if("failed"==r.msg)if(_.contains(n._supportedDDPVersions,r.version))n._versionSuggestion=r.version,n._stream.reconnect({_force:!0});else{var o="Version negotiation failed; server requested version "+r.version;n._stream.forceDisconnect(o),t.onConnectionFailure(o)}else _.include(["added","changed","removed","ready","updated"],r.msg)?n._livedata_data(r):"nosub"===r.msg?n._livedata_nosub(r):"result"===r.msg?n._livedata_result(r):"error"===r.msg?n._livedata_error(r):Meteor._debug("discarding unknown livedata message type",r)}),n._stream.on("reset",function(){var e={msg:"connect"};n._lastSessionId&&(e.session=n._lastSessionId),e.version=n._versionSuggestion||n._supportedDDPVersions[0],n._versionSuggestion=e.version,e.support=n._supportedDDPVersions,n._send(e),!_.isEmpty(n._outstandingMethodBlocks)&&_.isEmpty(n._outstandingMethodBlocks[0].methods)&&n._outstandingMethodBlocks.shift(),_.each(n._methodInvokers,function(e){e.sentMessage=!1}),n.onReconnect?n._callOnReconnectAndSendAppropriateOutstandingMethods():n._sendOutstandingMethods(),_.each(n._subscriptions,function(e,t){n._send({msg:"sub",id:t,name:e.name,params:e.params})})}),t.reloadOnUpdate&&n._stream.on("update_available",function(){Meteor._reload.reload()})};var t=function(e){var t=this;t.methodId=e.methodId,t.sentMessage=!1,t._callback=e.callback,t._connection=e.connection,t._message=e.message,t._onResultReceived=e.onResultReceived||function(){},t._wait=e.wait,t._methodResult=null,t._dataVisible=!1,t._connection._methodInvokers[t.methodId]=t};_.extend(t.prototype,{sendMessage:function(){var e=this;if(e.gotResult())throw Error("sendingMethod is called on method with result");e._dataVisible=!1,e.sentMessage=!0,e._wait&&(e._connection._methodsBlockingQuiescence[e.methodId]=!0),e._connection._send(e._message)},_maybeInvokeCallback:function(){var e=this;e._methodResult&&e._dataVisible&&(e._callback(e._methodResult[0],e._methodResult[1]),delete e._connection._methodInvokers[e.methodId],e._connection._outstandingMethodFinished())},receiveResult:function(e,t){var n=this;if(n.gotResult())throw Error("Methods should only receive results once");n._methodResult=[e,t],n._onResultReceived(e,t),n._maybeInvokeCallback()},dataVisible:function(){var e=this;e._dataVisible=!0,e._maybeInvokeCallback()},gotResult:function(){var e=this;return!!e._methodResult}}),_.extend(Meteor._LivedataConnection.prototype,{registerStore:function(e,t){var n=this;if(e in n._stores)return!1;var r={};_.each(["update","beginUpdate","endUpdate","saveOriginals","retrieveOriginals"],function(e){r[e]=function(){return t[e]?t[e].apply(t,arguments):void 0}}),n._stores[e]=r;var i=n._updatesForUnknownStores[e];return i&&(r.beginUpdate(i.length,!1),_.each(i,function(e){r.update(e)}),r.endUpdate(),delete n._updatesForUnknownStores[e]),!0},subscribe:function(e){var t=this,n=Array.prototype.slice.call(arguments,1),r={};if(n.length){var i=n[n.length-1];"function"==typeof i?r.onReady=n.pop():!i||"function"!=typeof i.onReady&&"function"!=typeof i.onError||(r=n.pop())}var o,a=_.find(t._subscriptions,function(t){return t.inactive&&t.name===e&&EJSON.equals(t.params,n)});a?(o=a.id,a.inactive=!1,r.onReady&&(a.ready||(a.readyCallback=r.onReady)),r.onError&&(a.errorCallback=r.onError)):(o=Random.id(),t._subscriptions[o]={id:o,name:e,params:n,inactive:!1,ready:!1,readyDeps:"undefined"!=typeof Deps&&new Deps.Dependency,readyCallback:r.onReady,errorCallback:r.onError},t._send({msg:"sub",id:o,name:e,params:n}));var s={stop:function(){_.has(t._subscriptions,o)&&(t._send({msg:"unsub",id:o}),delete t._subscriptions[o])},ready:function(){if(!_.has(t._subscriptions,o))return!1;var e=t._subscriptions[o];return e.readyDeps&&e.readyDeps.depend(),e.ready}};return Deps.active&&Deps.onInvalidate(function(){_.has(t._subscriptions,o)&&(t._subscriptions[o].inactive=!0),Deps.afterFlush(function(){_.has(t._subscriptions,o)&&t._subscriptions[o].inactive&&s.stop()})}),s},methods:function(e){var t=this;_.each(e,function(e,n){if(t._methodHandlers[n])throw Error("A method named '"+n+"' is already defined");t._methodHandlers[n]=e})},call:function(e){var t=Array.prototype.slice.call(arguments,1);if(t.length&&"function"==typeof t[t.length-1])var n=t.pop();return this.apply(e,t,n)},apply:function(n,r,i,o){var a=this;o||"function"!=typeof i||(o=i,i={}),i=i||{},o&&(o=Meteor.bindEnvironment(o,function(e){Meteor._debug("Exception while delivering result of invoking '"+n+"'",e,e.stack)}));var s=function(){var e;return function(){return void 0===e&&(e=""+a._nextMethodId++),e}}();if(Meteor.isClient){var l=Meteor._CurrentInvocation.get(),u=l&&l.isSimulation,c=a._methodHandlers[n];if(c){var d=function(e){a.setUserId(e)},f=new Meteor._MethodInvocation({isSimulation:!0,userId:a.userId(),setUserId:d,sessionData:a._sessionData});u||a._saveOriginals();try{var p=Meteor._CurrentInvocation.withValue(f,function(){return c.apply(f,EJSON.clone(r))})}catch(h){var m=h}u||a._retrieveAndStoreOriginals(s())}if(u){if(o)return o(m,p),void 0;if(m)throw m;return p}m&&!m.expected&&Meteor._debug("Exception while simulating the effect of invoking '"+n+"'",m,m.stack)}if(!o)if(Meteor.isClient)o=function(){};else{var g=new e;o=function(e,t){g["return"]([e,t])}}var v=new t({methodId:s(),callback:o,connection:a,onResultReceived:i.onResultReceived,wait:!!i.wait,message:{msg:"method",method:n,params:r,id:s()}});if(i.wait?a._outstandingMethodBlocks.push({wait:!0,methods:[v]}):((_.isEmpty(a._outstandingMethodBlocks)||_.last(a._outstandingMethodBlocks).wait)&&a._outstandingMethodBlocks.push({wait:!1,methods:[]}),_.last(a._outstandingMethodBlocks).methods.push(v)),1===a._outstandingMethodBlocks.length&&v.sendMessage(),g){var y=g.wait();if(y[0])throw y[0];return y[1]}return void 0},_saveOriginals:function(){var e=this;_.each(e._stores,function(e){e.saveOriginals()})},_retrieveAndStoreOriginals:function(e){var t=this;if(t._documentsWrittenByStub[e])throw Error("Duplicate methodId in _retrieveAndStoreOriginals");var n=[];_.each(t._stores,function(r,i){var o=r.retrieveOriginals();_.each(o,function(r,o){if("string"!=typeof o)throw Error("id is not a string");n.push({collection:i,id:o});var a=Meteor._ensure(t._serverDocuments,i,o);a.writtenByStubs?a.writtenByStubs[e]=!0:(a.document=r,a.flushCallbacks=[],a.writtenByStubs={},a.writtenByStubs[e]=!0)})}),_.isEmpty(n)||(t._documentsWrittenByStub[e]=n)},_unsubscribeAll:function(){var e=this;_.each(_.clone(e._subscriptions),function(t,n){e._send({msg:"unsub",id:n}),delete e._subscriptions[n]})},_send:function(e){var t=this;t._stream.send(Meteor._stringifyDDP(e))},status:function(){var e=this;return e._stream.status.apply(e._stream,arguments)},reconnect:function(){var e=this;return e._stream.reconnect.apply(e._stream,arguments)},userId:function(){var e=this;return e._userIdDeps&&e._userIdDeps.depend(),e._userId},setUserId:function(e){var t=this;t._userId!==e&&(t._userId=e,t._userIdDeps&&t._userIdDeps.changed())},_waitingForQuiescence:function(){var e=this;return!_.isEmpty(e._subsBeingRevived)||!_.isEmpty(e._methodsBlockingQuiescence)},_anyMethodsAreOutstanding:function(){var e=this;return _.any(_.pluck(e._methodInvokers,"sentMessage"))},_livedata_connected:function(e){var t=this;if(t._lastSessionId&&(t._resetStores=!0),"string"==typeof e.session){var n=t._lastSessionId===e.session;t._lastSessionId=e.session}n||(t._updatesForUnknownStores={},t._resetStores&&(t._documentsWrittenByStub={},t._serverDocuments={}),t._afterUpdateCallbacks=[],t._subsBeingRevived={},_.each(t._subscriptions,function(e,n){e.ready&&(t._subsBeingRevived[n]=!0)}),t._methodsBlockingQuiescence={},t._resetStores&&_.each(t._methodInvokers,function(e){e.gotResult()?t._afterUpdateCallbacks.push(_.bind(e.dataVisible,e)):e.sentMessage&&(t._methodsBlockingQuiescence[e.methodId]=!0)}),t._messagesBufferedUntilQuiescence=[],t._waitingForQuiescence()||(t._resetStores&&(_.each(t._stores,function(e){e.beginUpdate(0,!0),e.endUpdate()}),t._resetStores=!1),t._runAfterUpdateCallbacks()))},_processOneDataMessage:function(e,t){var n=this;n["_process_"+e.msg](e,t)},_livedata_data:function(e){var t=this,n={};if(t._waitingForQuiescence()){if(t._messagesBufferedUntilQuiescence.push(e),_.each(e.subs||[],function(e){delete t._subsBeingRevived[e]}),_.each(e.methods||[],function(e){delete t._methodsBlockingQuiescence[e]}),t._waitingForQuiescence())return;_.each(t._messagesBufferedUntilQuiescence,function(e){t._processOneDataMessage(e,n)}),t._messagesBufferedUntilQuiescence=[]}else t._processOneDataMessage(e,n);(t._resetStores||!_.isEmpty(n))&&(_.each(t._stores,function(e,r){e.beginUpdate(_.has(n,r)?n[r].length:0,t._resetStores)}),t._resetStores=!1,_.each(n,function(e,n){var r=t._stores[n];r?_.each(e,function(e){r.update(e)}):(_.has(t._updatesForUnknownStores,n)||(t._updatesForUnknownStores[n]=[]),Array.prototype.push.apply(t._updatesForUnknownStores[n],e))}),_.each(t._stores,function(e){e.endUpdate()})),t._runAfterUpdateCallbacks()},_runAfterUpdateCallbacks:function(){var e=this,t=e._afterUpdateCallbacks;e._afterUpdateCallbacks=[],_.each(t,function(e){e()})},_pushUpdate:function(e,t,n){_.has(e,t)||(e[t]=[]),e[t].push(n)},_process_added:function(e,t){var n=this,r=Meteor._get(n._serverDocuments,e.collection,e.id);if(r){if(void 0!==r.document)throw Error("It doesn't make sense to be adding something we know exists: "+e.id);r.document=e.fields||{},r.document._id=Meteor.idParse(e.id)}else n._pushUpdate(t,e.collection,e)},_process_changed:function(e,t){var n=this,r=Meteor._get(n._serverDocuments,e.collection,e.id);if(r){if(void 0===r.document)throw Error("It doesn't make sense to be changing something we don't think exists: "+e.id);LocalCollection._applyChanges(r.document,e.fields)}else n._pushUpdate(t,e.collection,e)},_process_removed:function(e,t){var n=this,r=Meteor._get(n._serverDocuments,e.collection,e.id);if(r){if(void 0===r.document)throw Error("It doesn't make sense to be deleting something we don't know exists: "+e.id);r.document=void 0}else n._pushUpdate(t,e.collection,{msg:"removed",collection:e.collection,id:e.id})},_process_updated:function(e,t){var n=this;_.each(e.methods,function(e){_.each(n._documentsWrittenByStub[e],function(r){var i=Meteor._get(n._serverDocuments,r.collection,r.id);if(!i)throw Error("Lost serverDoc for "+JSON.stringify(r));if(!i.writtenByStubs[e])throw Error("Doc "+JSON.stringify(r)+" not written by  method "+e);delete i.writtenByStubs[e],_.isEmpty(i.writtenByStubs)&&(n._pushUpdate(t,r.collection,{msg:"replace",id:r.id,replace:i.document}),_.each(i.flushCallbacks,function(e){e()}),delete n._serverDocuments[r.collection][r.id])}),delete n._documentsWrittenByStub[e];var r=n._methodInvokers[e];if(!r)throw Error("No callback invoker for method "+e);n._runWhenAllServerDocsAreFlushed(_.bind(r.dataVisible,r))})},_process_ready:function(e){var t=this;_.each(e.subs,function(e){t._runWhenAllServerDocsAreFlushed(function(){var n=t._subscriptions[e];n&&(n.ready||(n.readyCallback&&n.readyCallback(),n.ready=!0,n.readyDeps&&n.readyDeps.changed()))})})},_runWhenAllServerDocsAreFlushed:function(e){var t=this,n=function(){t._afterUpdateCallbacks.push(e)},r=0,i=function(){--r,0===r&&n()};_.each(t._serverDocuments,function(e){_.each(e,function(e){var n=_.any(e.writtenByStubs,function(e,n){var r=t._methodInvokers[n];return r&&r.sentMessage});n&&(++r,e.flushCallbacks.push(i))})}),0===r&&n()},_livedata_nosub:function(e){var t=this;if(_.has(t._subscriptions,e.id)){var n=t._subscriptions[e.id].errorCallback;delete t._subscriptions[e.id],n&&e.error&&n(new Meteor.Error(e.error.error,e.error.reason,e.error.details))}},_livedata_result:function(e){var t=this;if(_.isEmpty(t._outstandingMethodBlocks))return Meteor._debug("Received method result but no methods outstanding"),void 0;for(var n,r=t._outstandingMethodBlocks[0].methods,i=0;r.length>i&&(n=r[i],n.methodId!==e.id);i++);return n?(r.splice(i,1),_.has(e,"error")?n.receiveResult(new Meteor.Error(e.error.error,e.error.reason,e.error.details)):n.receiveResult(void 0,e.result),void 0):(Meteor._debug("Can't match method response to original method call",e),void 0)},_outstandingMethodFinished:function(){var e=this;if(!e._anyMethodsAreOutstanding()){if(!_.isEmpty(e._outstandingMethodBlocks)){var t=e._outstandingMethodBlocks.shift();if(!_.isEmpty(t.methods))throw Error("No methods outstanding but nonempty block: "+JSON.stringify(t));_.isEmpty(e._outstandingMethodBlocks)||e._sendOutstandingMethods()}e._maybeMigrate()}},_sendOutstandingMethods:function(){var e=this;_.isEmpty(e._outstandingMethodBlocks)||_.each(e._outstandingMethodBlocks[0].methods,function(e){e.sendMessage()})},_livedata_error:function(e){Meteor._debug("Received error from server: ",e.reason),e.offendingMessage&&Meteor._debug("For: ",e.offendingMessage)},_callOnReconnectAndSendAppropriateOutstandingMethods:function(){var e=this,t=e._outstandingMethodBlocks;if(e._outstandingMethodBlocks=[],e.onReconnect(),!_.isEmpty(t)){if(_.isEmpty(e._outstandingMethodBlocks))return e._outstandingMethodBlocks=t,e._sendOutstandingMethods(),void 0;_.last(e._outstandingMethodBlocks).wait||t[0].wait||(_.each(t[0].methods,function(t){_.last(e._outstandingMethodBlocks).methods.push(t),1===e._outstandingMethodBlocks.length&&t.sendMessage()}),t.shift()),_.each(t,function(t){e._outstandingMethodBlocks.push(t)})}},_readyToMigrate:function(){var e=this;return _.isEmpty(e._methodInvokers)},_maybeMigrate:function(){var e=this;e._retryMigrate&&e._readyToMigrate()&&(e._retryMigrate(),e._retryMigrate=null)}}),_.extend(Meteor,{connect:function(e,t){var n=new Meteor._LivedataConnection(e,{reloadOnUpdate:t});return Meteor._LivedataConnection._allConnections.push(n),n}}),Meteor._LivedataConnection._allConnections=[],Meteor._LivedataConnection._allSubscriptionsReady=function(){return _.all(Meteor._LivedataConnection._allConnections,function(e){return _.all(e._subscriptions,function(e){return e.ready})})}}(),function(){var e="/";"undefined"!=typeof __meteor_runtime_config__&&__meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL&&(e=__meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL),_.extend(Meteor,{default_connection:Meteor.connect(e,!0),refresh:function(){}}),_.each(["subscribe","methods","call","apply","status","reconnect"],function(e){Meteor[e]=_.bind(Meteor.default_connection[e],Meteor.default_connection)})}(),function(){Meteor._LocalCollectionDriver=function(){var e=this;e.collections={}},_.extend(Meteor._LocalCollectionDriver.prototype,{open:function(e){var t=this;return e?(e in t.collections||(t.collections[e]=new LocalCollection),t.collections[e]):new LocalCollection}}),Meteor._LocalCollectionDriver=new Meteor._LocalCollectionDriver}(),function(){Meteor.Collection=function(e,t){var n=this;switch(t&&t.methods&&(t={manager:t}),t=_.extend({manager:void 0,idGeneration:"STRING",transform:null,_driver:void 0,_preventAutopublish:!1},t),t.idGeneration){case"MONGO":n._makeNewID=function(){return new Meteor.Collection.ObjectID};break;case"STRING":default:n._makeNewID=function(){return Random.id()}}if(n._transform=t.transform?Deps._makeNonreactive(t.transform):null,e||null===e||Meteor._debug("Warning: creating anonymous collection. It will not be saved or synchronized over the network. (Pass null for the collection name to turn off this warning.)"),n._manager=e&&(t.manager||(Meteor.isClient?Meteor.default_connection:Meteor.default_server)),t._driver||(t._driver=e&&n._manager===Meteor.default_server&&Meteor._RemoteCollectionDriver?Meteor._RemoteCollectionDriver:Meteor._LocalCollectionDriver),n._collection=t._driver.open(e),n._name=e,e&&n._manager.registerStore){var r=n._manager.registerStore(e,{beginUpdate:function(e,t){(e>1||t)&&n._collection.pauseObservers(),t&&n._collection.remove({})},update:function(e){var t=Meteor.idParse(e.id),r=n._collection.findOne(t);if("replace"===e.msg){var i=e.replace;return i?r?n._collection.update(t,i):n._collection.insert(i):r&&n._collection.remove(t),void 0}if("added"===e.msg){if(r){debugger;throw Error("Expected not to find a document already present for an add")}n._collection.insert(_.extend({_id:t},e.fields))}else if("removed"===e.msg){if(!r)throw Error("Expected to find a document already present for removed");n._collection.remove(t)}else{if("changed"!==e.msg)throw Error("I don't know how to deal with this message");if(!r)throw Error("Expected to find a document to change");if(!_.isEmpty(e.fields)){var o={};_.each(e.fields,function(e,t){void 0===e?(o.$unset||(o.$unset={}),o.$unset[t]=1):(o.$set||(o.$set={}),o.$set[t]=e)}),n._collection.update(t,o)}}},endUpdate:function(){n._collection.resumeObservers()},saveOriginals:function(){n._collection.saveOriginals()},retrieveOriginals:function(){return n._collection.retrieveOriginals()}});if(!r)throw Error("There is already a collection named '"+e+"'")}n._defineMutationMethods(),!t._preventAutopublish&&n._manager&&n._manager.onAutopublish&&n._manager.onAutopublish(function(){var e=function(){return n.find()};n._manager.publish(null,e,{is_auto:!0})})},_.extend(Meteor.Collection.prototype,{_getFindSelector:function(e){return 0==e.length?{}:e[0]},_getFindOptions:function(e){var t=this;return 2>e.length?{transform:t._transform}:_.extend({transform:t._transform},e[1])},find:function(){var e=this,t=_.toArray(arguments);return e._collection.find(e._getFindSelector(t),e._getFindOptions(t))},findOne:function(){var e=this,t=_.toArray(arguments);return e._collection.findOne(e._getFindSelector(t),e._getFindOptions(t))}}),Meteor.Collection._rewriteSelector=function(e){if(LocalCollection._selectorIsId(e)&&(e={_id:e}),!e||"_id"in e&&!e._id)return{_id:Random.id()};var t={};return _.each(e,function(e,n){if(e instanceof RegExp){t[n]={$regex:e.source};var r="";e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),r&&(t[n].$options=r)}else t[n]=e}),t};var e=function(e,t){if(!LocalCollection._selectorIsIdPerhapsAsObject(e))throw new Meteor.Error(403,"Not permitted. Untrusted code may only "+t+" documents by ID.")};_.each(["insert","update","remove"],function(t){Meteor.Collection.prototype[t]=function(){var n,r,i=this,o=_.toArray(arguments);if(o.length&&o[o.length-1]instanceof Function&&(n=o.pop()),Meteor.isClient&&!n&&(n=function(e){e&&Meteor._debug(t+" failed: "+(e.reason||e.stack))}),"insert"===t){if(!o.length)throw Error("insert requires an argument");if(o[0]=_.extend({},o[0]),"_id"in o[0]){if(r=o[0]._id,!("string"==typeof r||r instanceof Meteor.Collection.ObjectID))throw Error("Meteor requires document _id fields to be strings or ObjectIDs")}else r=o[0]._id=i._makeNewID()}else o[0]=Meteor.Collection._rewriteSelector(o[0]);if(i._manager&&i._manager!==Meteor.default_server){var a=Meteor._CurrentInvocation.get(),s=a&&a.isSimulation;s||"insert"===t||e(o[0],t),n?i._manager.apply(i._prefix+t,o,function(e){n(e,!e&&r)}):i._manager.apply(i._prefix+t,o)}else{try{i._collection[t].apply(i._collection,o)}catch(l){if(n)return n(l),null;throw l}n&&n(null,r)}return r}}),Meteor.Collection.prototype._ensureIndex=function(e,t){var n=this;if(!n._collection._ensureIndex)throw Error("Can only call _ensureIndex on server collections");n._collection._ensureIndex(e,t)},Meteor.Collection.prototype._dropIndex=function(e){var t=this;if(!t._collection._dropIndex)throw Error("Can only call _dropIndex on server collections");t._collection._dropIndex(e)},Meteor.Collection.ObjectID=LocalCollection._ObjectID,function(){var e=function(e,t){var n=["insert","update","remove","fetch","transform"];_.each(_.keys(t),function(t){if(!_.contains(n,t))throw Error(e+": Invalid key: "+t)});var r=this;if(r._restricted=!0,_.each(["insert","update","remove"],function(n){if(t[n]){if(!(t[n]instanceof Function))throw Error(e+": Value for `"+n+"` must be a function");r._transform&&(t[n].transform=r._transform),t.transform&&(t[n].transform=Deps._makeNonreactive(t.transform)),r._validators[n][e].push(t[n])}}),t.update||t.remove||t.fetch){if(t.fetch&&!(t.fetch instanceof Array))throw Error(e+": Value for `fetch` must be an array");r._updateFetch(t.fetch)}};Meteor.Collection.prototype.allow=function(t){e.call(this,"allow",t)},Meteor.Collection.prototype.deny=function(t){e.call(this,"deny",t)}}(),Meteor.Collection.prototype._defineMutationMethods=function(){var t=this;if(t._restricted=!1,t._insecure=void 0,t._validators={insert:{allow:[],deny:[]},update:{allow:[],deny:[]},remove:{allow:[],deny:[]},fetch:[],fetchAllFields:!1},t._name&&(t._prefix="/"+t._name+"/",t._manager)){var n={};_.each(["insert","update","remove"],function(r){n[t._prefix+r]=function(){try{if(this.isSimulation)return t._collection[r].apply(t._collection,_.toArray(arguments)),void 0;if("insert"!==r&&e(arguments[0],r),t._restricted){if(0===t._validators[r].allow.length)throw new Meteor.Error(403,"Access denied. No allow validators set on restricted collection for method '"+r+"'.");var n="_validated"+r.charAt(0).toUpperCase()+r.slice(1),i=[this.userId].concat(_.toArray(arguments));t[n].apply(t,i)}else{if(!t._isInsecure())throw new Meteor.Error(403,"Access denied");t._collection[r].apply(t._collection,_.toArray(arguments))}}catch(o){throw"MongoError"===o.name||"MinimongoError"===o.name?new Meteor.Error(409,""+o):o}}}),t._manager.methods(n)}},Meteor.Collection.prototype._updateFetch=function(e){var t=this;t._validators.fetchAllFields||(e?t._validators.fetch=_.union(t._validators.fetch,e):(t._validators.fetchAllFields=!0,t._validators.fetch=null))},Meteor.Collection.prototype._isInsecure=function(){var e=this;return void 0===e._insecure?Meteor.Collection.insecure:e._insecure};var t=function(e,t){var n=t;return e.transform&&(n=e.transform(EJSON.clone(t))),n};Meteor.Collection.prototype._validatedInsert=function(e,n){var r=this;if(_.any(r._validators.insert.deny,function(r){return r(e,t(r,n))}))throw new Meteor.Error(403,"Access denied");if(_.all(r._validators.insert.allow,function(r){return!r(e,t(r,n))}))throw new Meteor.Error(403,"Access denied");r._collection.insert.call(r._collection,n)};var n=function(e,t){return e.transform?e.transform(t):t};Meteor.Collection.prototype._validatedUpdate=function(e,t,i,o){var a=this;if(!LocalCollection._selectorIsIdPerhapsAsObject(t))throw Error("validated update should be of a single ID");var s=[];_.each(i,function(e,t){if("$"!==t.charAt(0))throw new Meteor.Error(403,"Access denied. In a restricted collection you can only update documents, not replace them. Use a Mongo update operator, such as '$set'.");if(!_.has(r,t))throw new Meteor.Error(403,"Access denied. Operator "+t+" not allowed in a restricted collection.");_.each(_.keys(e),function(e){-1!==e.indexOf(".")&&(e=e.substring(0,e.indexOf("."))),_.contains(s,e)||s.push(e)})});var l={transform:null};a._validators.fetchAllFields||(l.fields={},_.each(a._validators.fetch,function(e){l.fields[e]=1}));var u=a._collection.findOne(t,l);if(u){var c;if(_.any(a._validators.update.deny,function(t){return c||(c=n(t,u)),t(e,c,s,i)}))throw new Meteor.Error(403,"Access denied");if(_.all(a._validators.update.allow,function(t){return c||(c=n(t,u)),!t(e,c,s,i)}))throw new Meteor.Error(403,"Access denied");a._collection.update.call(a._collection,t,i,o)}};var r={$inc:1,$set:1,$unset:1,$addToSet:1,$pop:1,$pullAll:1,$pull:1,$pushAll:1,$push:1,$bit:1};Meteor.Collection.prototype._validatedRemove=function(e,t){var r=this,i={transform:null};r._validators.fetchAllFields||(i.fields={},_.each(r._validators.fetch,function(e){i.fields[e]=1}));var o=r._collection.findOne(t,i);if(o){if(_.any(r._validators.remove.deny,function(t){return t(e,n(t,o))}))throw new Meteor.Error(403,"Access denied");if(_.all(r._validators.remove.allow,function(t){return!t(e,n(t,o))}))throw new Meteor.Error(403,"Access denied");r._collection.remove.call(r._collection,t)}}}(),function(){(function(e,t){function n(e){var t=ht[e]={};return Q.each(e.split(tt),function(e,n){t[n]=!0}),t}function r(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(gt,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:mt.test(r)?Q.parseJSON(r):r}catch(o){}Q.data(e,n,r)}else r=t}return r}function i(e){var t;for(t in e)if(("data"!==t||!Q.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function o(){return!1}function a(){return!0}function s(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function l(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function u(e,t,n){if(t=t||0,Q.isFunction(t))return Q.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return Q.grep(e,function(e){return e===t===n});if("string"==typeof t){var r=Q.grep(e,function(e){return 1===e.nodeType});if(jt.test(t))return Q.filter(t,r,!n);t=Q.filter(t,r)}return Q.grep(e,function(e){return Q.inArray(e,t)>=0===n})}function c(e){var t=Ut.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function d(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function f(e,t){if(1===t.nodeType&&Q.hasData(e)){var n,r,i,o=Q._data(e),a=Q._data(t,o),s=o.events;if(s){delete a.handle,a.events={};
for(n in s)for(r=0,i=s[n].length;i>r;r++)Q.event.add(t,n,s[n][r])}a.data&&(a.data=Q.extend({},a.data))}}function p(e,t){var n;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),Q.support.html5Clone&&e.innerHTML&&!Q.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Kt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.selected=e.defaultSelected:"input"===n||"textarea"===n?t.defaultValue=e.defaultValue:"script"===n&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(Q.expando))}function h(e){return e.getElementsByTagName!==t?e.getElementsByTagName("*"):e.querySelectorAll!==t?e.querySelectorAll("*"):[]}function m(e){Kt.test(e.type)&&(e.defaultChecked=e.checked)}function g(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=_n.length;i--;)if(t=_n[i]+n,t in e)return t;return r}function v(e,t){return e=t||e,"none"===Q.css(e,"display")||!Q.contains(e.ownerDocument,e)}function _(e,t){for(var n,r,i=[],o=0,a=e.length;a>o;o++)n=e[o],n.style&&(i[o]=Q._data(n,"olddisplay"),t?(i[o]||"none"!==n.style.display||(n.style.display=""),""===n.style.display&&v(n)&&(i[o]=Q._data(n,"olddisplay",S(n.nodeName)))):(r=nn(n,"display"),i[o]||"none"===r||Q._data(n,"olddisplay",r)));for(o=0;a>o;o++)n=e[o],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?i[o]||"":"none"));return e}function y(e,t,n){var r=dn.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function b(e,t,n,r){for(var i=n===(r?"border":"content")?4:"width"===t?1:0,o=0;4>i;i+=2)"margin"===n&&(o+=Q.css(e,n+vn[i],!0)),r?("content"===n&&(o-=parseFloat(nn(e,"padding"+vn[i]))||0),"margin"!==n&&(o-=parseFloat(nn(e,"border"+vn[i]+"Width"))||0)):(o+=parseFloat(nn(e,"padding"+vn[i]))||0,"padding"!==n&&(o+=parseFloat(nn(e,"border"+vn[i]+"Width"))||0));return o}function w(e,t,n){var r="width"===t?e.offsetWidth:e.offsetHeight,i=!0,o=Q.support.boxSizing&&"border-box"===Q.css(e,"boxSizing");if(0>=r||null==r){if(r=nn(e,t),(0>r||null==r)&&(r=e.style[t]),fn.test(r))return r;i=o&&(Q.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+b(e,t,n||(o?"border":"content"),i)+"px"}function S(e){if(hn[e])return hn[e];var t=Q("<"+e+">").appendTo(F.body),n=t.css("display");return t.remove(),("none"===n||""===n)&&(rn=F.body.appendChild(rn||Q.extend(F.createElement("iframe"),{frameBorder:0,width:0,height:0})),on&&rn.createElement||(on=(rn.contentWindow||rn.contentDocument).document,on.write("<!doctype html><html><body>"),on.close()),t=on.body.appendChild(on.createElement(e)),n=nn(t,"display"),F.body.removeChild(rn)),hn[e]=n,n}function k(e,t,n,r){var i;if(Q.isArray(t))Q.each(t,function(t,i){n||wn.test(e)?r(e,i):k(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==Q.type(t))r(e,t);else for(i in t)k(e+"["+i+"]",t[i],n,r)}function x(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i,o,a=t.toLowerCase().split(tt),s=0,l=a.length;if(Q.isFunction(n))for(;l>s;s++)r=a[s],o=/^\+/.test(r),o&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[o?"unshift":"push"](n)}}function E(e,n,r,i,o,a){o=o||n.dataTypes[0],a=a||{},a[o]=!0;for(var s,l=e[o],u=0,c=l?l.length:0,d=e===Rn;c>u&&(d||!s);u++)s=l[u](n,r,i),"string"==typeof s&&(!d||a[s]?s=t:(n.dataTypes.unshift(s),s=E(e,n,r,i,s,a)));return!d&&s||a["*"]||(s=E(e,n,r,i,"*",a)),s}function T(e,n){var r,i,o=Q.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((o[r]?e:i||(i={}))[r]=n[r]);i&&Q.extend(!0,e,i)}function C(e,n,r){var i,o,a,s,l=e.contents,u=e.dataTypes,c=e.responseFields;for(o in c)o in r&&(n[c[o]]=r[o]);for(;"*"===u[0];)u.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(o in l)if(l[o]&&l[o].test(i)){u.unshift(o);break}if(u[0]in r)a=u[0];else{for(o in r){if(!u[0]||e.converters[o+" "+u[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==u[0]&&u.unshift(a),r[a]):t}function M(e,t){var n,r,i,o,a=e.dataTypes.slice(),s=a[0],l={},u=0;if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a[1])for(n in e.converters)l[n.toLowerCase()]=e.converters[n];for(;i=a[++u];)if("*"!==i){if("*"!==s&&s!==i){if(n=l[s+" "+i]||l["* "+i],!n)for(r in l)if(o=r.split(" "),o[1]===i&&(n=l[s+" "+o[0]]||l["* "+o[0]])){n===!0?n=l[r]:l[r]!==!0&&(i=o[0],a.splice(u--,0,i));break}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(c){return{state:"parsererror",error:n?c:"No conversion from "+s+" to "+i}}}s=i}return{state:"success",data:t}}function A(){try{return new e.XMLHttpRequest}catch(t){}}function N(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function I(){return setTimeout(function(){Yn=t},0),Yn=Q.now()}function D(e,t){Q.each(t,function(t,n){for(var r=(er[t]||[]).concat(er["*"]),i=0,o=r.length;o>i;i++)if(r[i].call(e,t,n))return})}function O(e,t,n){var r,i=0,o=Zn.length,a=Q.Deferred().always(function(){delete s.elem}),s=function(){for(var t=Yn||I(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),i=0,o=l.tweens.length;o>i;i++)l.tweens[i].run(r);return a.notifyWith(e,[l,r,n]),1>r&&o?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:Q.extend({},t),opts:Q.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Yn||I(),duration:n.duration,tweens:[],createTween:function(t,n){var r=Q.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){for(var n=0,r=t?l.tweens.length:0;r>n;n++)l.tweens[n].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),u=l.props;for(L(u,l.opts.specialEasing);o>i;i++)if(r=Zn[i].call(l,e,u,l.opts))return r;return D(l,u),Q.isFunction(l.opts.start)&&l.opts.start.call(e,l),Q.fx.timer(Q.extend(s,{anim:l,queue:l.opts.queue,elem:e})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function L(e,t){var n,r,i,o,a;for(n in e)if(r=Q.camelCase(n),i=t[r],o=e[n],Q.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=Q.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function P(e,t,n){var r,i,o,a,s,l,u,c,d=this,f=e.style,p={},h=[],m=e.nodeType&&v(e);n.queue||(u=Q._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,c=u.empty.fire,u.empty.fire=function(){u.unqueued||c()}),u.unqueued++,d.always(function(){d.always(function(){u.unqueued--,Q.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===Q.css(e,"display")&&"none"===Q.css(e,"float")&&(Q.support.inlineBlockNeedsLayout&&"inline"!==S(e.nodeName)?f.zoom=1:f.display="inline-block")),n.overflow&&(f.overflow="hidden",Q.support.shrinkWrapBlocks||d.done(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(r in t)if(o=t[r],Xn.exec(o)){if(delete t[r],o===(m?"hide":"show"))continue;h.push(r)}if(a=h.length)for(s=Q._data(e,"fxshow")||Q._data(e,"fxshow",{}),m?Q(e).show():d.done(function(){Q(e).hide()}),d.done(function(){var t;Q.removeData(e,"fxshow",!0);for(t in p)Q.style(e,t,p[t])}),r=0;a>r;r++)i=h[r],l=d.createTween(i,m?s[i]:0),p[i]=s[i]||Q.style(e,i),i in s||(s[i]=l.start,m&&(l.end=l.start,l.start="width"===i||"height"===i?1:0))}function j(e,t,n,r,i){return new j.prototype.init(e,t,n,r,i)}function R(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=vn[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function B(e){return Q.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var U,$,F=e.document,H=e.location,q=e.navigator,V=e.jQuery,J=e.$,z=Array.prototype.push,W=Array.prototype.slice,Y=Array.prototype.indexOf,K=Object.prototype.toString,X=Object.prototype.hasOwnProperty,G=String.prototype.trim,Q=function(e,t){return new Q.fn.init(e,t,U)},Z=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,et=/\S/,tt=/\s+/,nt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rt=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,it=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ot=/^[\],:{}\s]*$/,at=/(?:^|:|,)(?:\s*\[)+/g,st=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,lt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,ut=/^-ms-/,ct=/-([\da-z])/gi,dt=function(e,t){return(t+"").toUpperCase()},ft=function(){F.addEventListener?(F.removeEventListener("DOMContentLoaded",ft,!1),Q.ready()):"complete"===F.readyState&&(F.detachEvent("onreadystatechange",ft),Q.ready())},pt={};Q.fn=Q.prototype={constructor:Q,init:function(e,n,r){var i,o,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:rt.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1])return n=n instanceof Q?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:F,e=Q.parseHTML(i[1],a,!0),it.test(i[1])&&Q.isPlainObject(n)&&this.attr.call(e,n,!0),Q.merge(this,e);if(o=F.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return r.find(e);this.length=1,this[0]=o}return this.context=F,this.selector=e,this}return Q.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),Q.makeArray(e,this))},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return W.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=Q.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,"find"===t?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return Q.each(this,e,t)},ready:function(e){return Q.ready.promise().done(e),this},eq:function(e){return e=+e,-1===e?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(W.apply(this,arguments),"slice",W.call(arguments).join(","))},map:function(e){return this.pushStack(Q.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:z,sort:[].sort,splice:[].splice},Q.fn.init.prototype=Q.fn,Q.extend=Q.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||Q.isFunction(s)||(s={}),u===l&&(s=this,--l);u>l;l++)if(null!=(e=arguments[l]))for(n in e)r=s[n],i=e[n],s!==i&&(c&&i&&(Q.isPlainObject(i)||(o=Q.isArray(i)))?(o?(o=!1,a=r&&Q.isArray(r)?r:[]):a=r&&Q.isPlainObject(r)?r:{},s[n]=Q.extend(c,a,i)):i!==t&&(s[n]=i));return s},Q.extend({noConflict:function(t){return e.$===Q&&(e.$=J),t&&e.jQuery===Q&&(e.jQuery=V),Q},isReady:!1,readyWait:1,holdReady:function(e){e?Q.readyWait++:Q.ready(!0)},ready:function(e){if(e===!0?!--Q.readyWait:!Q.isReady){if(!F.body)return setTimeout(Q.ready,1);Q.isReady=!0,e!==!0&&--Q.readyWait>0||($.resolveWith(F,[Q]),Q.fn.trigger&&Q(F).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===Q.type(e)},isArray:Array.isArray||function(e){return"array"===Q.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":pt[K.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==Q.type(e)||e.nodeType||Q.isWindow(e))return!1;try{if(e.constructor&&!X.call(e,"constructor")&&!X.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||X.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){var r;return e&&"string"==typeof e?("boolean"==typeof t&&(n=t,t=0),t=t||F,(r=it.exec(e))?[t.createElement(r[1])]:(r=Q.buildFragment([e],t,n?null:[]),Q.merge([],(r.cacheable?Q.clone(r.fragment):r.fragment).childNodes))):null},parseJSON:function(n){return n&&"string"==typeof n?(n=Q.trim(n),e.JSON&&e.JSON.parse?e.JSON.parse(n):ot.test(n.replace(st,"@").replace(lt,"]").replace(at,""))?Function("return "+n)():(Q.error("Invalid JSON: "+n),t)):null},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||Q.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&et.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ut,"ms-").replace(ct,dt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,o=0,a=e.length,s=a===t||Q.isFunction(e);if(r)if(s){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;a>o&&n.apply(e[o++],r)!==!1;);else if(s){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;a>o&&n.call(e[o],o,e[o++])!==!1;);return e},trim:G&&!G.call("ï»¿ ")?function(e){return null==e?"":G.call(e)}:function(e){return null==e?"":(e+"").replace(nt,"")},makeArray:function(e,t){var n,r=t||[];return null!=e&&(n=Q.type(e),null==e.length||"string"===n||"function"===n||"regexp"===n||Q.isWindow(e)?z.call(r,e):Q.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(Y)return Y.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else for(;n[o]!==t;)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,n,r){var i,o,a=[],s=0,l=e.length,u=e instanceof Q||l!==t&&"number"==typeof l&&(l>0&&e[0]&&e[l-1]||0===l||Q.isArray(e));if(u)for(;l>s;s++)i=n(e[s],s,r),null!=i&&(a[a.length]=i);else for(o in e)i=n(e[o],o,r),null!=i&&(a[a.length]=i);return a.concat.apply([],a)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(r=e[n],n=e,e=r),Q.isFunction(e)?(i=W.call(arguments,2),o=function(){return e.apply(n,i.concat(W.call(arguments)))},o.guid=e.guid=e.guid||Q.guid++,o):t},access:function(e,n,r,i,o,a,s){var l,u=null==r,c=0,d=e.length;if(r&&"object"==typeof r){for(c in r)Q.access(e,n,c,r[c],1,a,i);o=1}else if(i!==t){if(l=s===t&&Q.isFunction(i),u&&(l?(l=n,n=function(e,t,n){return l.call(Q(e),n)}):(n.call(e,i),n=null)),n)for(;d>c;c++)n(e[c],r,l?i.call(e[c],c,n(e[c],r)):i,s);o=1}return o?e:u?n.call(e):d?n(e[0],r):a},now:function(){return(new Date).getTime()}}),Q.ready.promise=function(t){if(!$)if($=Q.Deferred(),"complete"===F.readyState)setTimeout(Q.ready,1);else if(F.addEventListener)F.addEventListener("DOMContentLoaded",ft,!1),e.addEventListener("load",Q.ready,!1);else{F.attachEvent("onreadystatechange",ft),e.attachEvent("onload",Q.ready);var n=!1;try{n=null==e.frameElement&&F.documentElement}catch(r){}n&&n.doScroll&&function i(){if(!Q.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}Q.ready()}}()}return $.promise(t)},Q.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){pt["[object "+t+"]"]=t.toLowerCase()}),U=Q(F);var ht={};Q.Callbacks=function(e){e="string"==typeof e?ht[e]||n(e):Q.extend({},e);var r,i,o,a,s,l,u=[],c=!e.once&&[],d=function(t){for(r=e.memory&&t,i=!0,l=a||0,a=0,s=u.length,o=!0;u&&s>l;l++)if(u[l].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}o=!1,u&&(c?c.length&&d(c.shift()):r?u=[]:f.disable())},f={add:function(){if(u){var t=u.length;(function n(t){Q.each(t,function(t,r){var i=Q.type(r);"function"!==i||e.unique&&f.has(r)?r&&r.length&&"string"!==i&&n(r):u.push(r)})})(arguments),o?s=u.length:r&&(a=t,d(r))}return this},remove:function(){return u&&Q.each(arguments,function(e,t){for(var n;(n=Q.inArray(t,u,n))>-1;)u.splice(n,1),o&&(s>=n&&s--,l>=n&&l--)}),this},has:function(e){return Q.inArray(e,u)>-1},empty:function(){return u=[],this},disable:function(){return u=c=r=t,this},disabled:function(){return!u},lock:function(){return c=t,r||f.disable(),this},locked:function(){return!c},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!c||(o?c.push(t):d(t)),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!i}};return f},Q.extend({Deferred:function(e){var t=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Q.Deferred(function(n){Q.each(t,function(t,r){var o=r[0],a=e[t];i[r[1]](Q.isFunction(a)?function(){var e=a.apply(this,arguments);e&&Q.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===i?n:this,[e])}:n[o])}),e=null}).promise()},promise:function(e){return null!=e?Q.extend(e,r):r}},i={};return r.pipe=r.then,Q.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=a.fire,i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,o=W.call(arguments),a=o.length,s=1!==a||e&&Q.isFunction(e.promise)?a:0,l=1===s?e:Q.Deferred(),u=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?W.call(arguments):i,r===t?l.notifyWith(n,r):--s||l.resolveWith(n,r)}};if(a>1)for(t=Array(a),n=Array(a),r=Array(a);a>i;i++)o[i]&&Q.isFunction(o[i].promise)?o[i].promise().done(u(i,r,o)).fail(l.reject).progress(u(i,n,t)):--s;return s||l.resolveWith(r,o),l.promise()}}),Q.support=function(){var n,r,i,o,a,s,l,u,c,d,f,p=F.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=p.getElementsByTagName("*"),i=p.getElementsByTagName("a")[0],i.style.cssText="top:1px;float:left;opacity:.5",!r||!r.length)return{};o=F.createElement("select"),a=o.appendChild(F.createElement("option")),s=p.getElementsByTagName("input")[0],n={leadingWhitespace:3===p.firstChild.nodeType,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:"/a"===i.getAttribute("href"),opacity:/^0.5/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:"on"===s.value,optSelected:a.selected,getSetAttribute:"t"!==p.className,enctype:!!F.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==F.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===F.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},s.checked=!0,n.noCloneChecked=s.cloneNode(!0).checked,o.disabled=!0,n.optDisabled=!a.disabled;try{delete p.test}catch(h){n.deleteExpando=!1}if(!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",f=function(){n.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",f)),s=F.createElement("input"),s.value="t",s.setAttribute("type","radio"),n.radioValue="t"===s.value,s.setAttribute("checked","checked"),s.setAttribute("name","t"),p.appendChild(s),l=F.createDocumentFragment(),l.appendChild(p.lastChild),n.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,n.appendChecked=s.checked,l.removeChild(s),l.appendChild(p),p.attachEvent)for(c in{submit:!0,change:!0,focusin:!0})u="on"+c,d=u in p,d||(p.setAttribute(u,"return;"),d="function"==typeof p[u]),n[c+"Bubbles"]=d;return Q(function(){var r,i,o,a,s="padding:0;margin:0;border:0;display:block;overflow:hidden;",l=F.getElementsByTagName("body")[0];l&&(r=F.createElement("div"),r.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",l.insertBefore(r,l.firstChild),i=F.createElement("div"),r.appendChild(i),i.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=i.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",d=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",n.reliableHiddenOffsets=d&&0===o[0].offsetHeight,i.innerHTML="",i.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",n.boxSizing=4===i.offsetWidth,n.doesNotIncludeMarginInBodyOffset=1!==l.offsetTop,e.getComputedStyle&&(n.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,n.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,a=F.createElement("div"),a.style.cssText=i.style.cssText=s,a.style.marginRight=a.style.width="0",i.style.width="1px",i.appendChild(a),n.reliableMarginRight=!parseFloat((e.getComputedStyle(a,null)||{}).marginRight)),i.style.zoom!==t&&(i.innerHTML="",i.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",n.inlineBlockNeedsLayout=3===i.offsetWidth,i.style.display="block",i.style.overflow="visible",i.innerHTML="<div></div>",i.firstChild.style.width="5px",n.shrinkWrapBlocks=3!==i.offsetWidth,r.style.zoom=1),l.removeChild(r),r=i=o=a=null)}),l.removeChild(p),r=i=o=a=s=l=p=null,n}();var mt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,gt=/([A-Z])/g;Q.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(Q.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?Q.cache[e[Q.expando]]:e[Q.expando],!!e&&!i(e)},data:function(e,n,r,i){if(Q.acceptData(e)){var o,a,s=Q.expando,l="string"==typeof n,u=e.nodeType,c=u?Q.cache:e,d=u?e[s]:e[s]&&s;if(d&&c[d]&&(i||c[d].data)||!l||r!==t)return d||(u?e[s]=d=Q.deletedIds.pop()||Q.guid++:d=s),c[d]||(c[d]={},u||(c[d].toJSON=Q.noop)),("object"==typeof n||"function"==typeof n)&&(i?c[d]=Q.extend(c[d],n):c[d].data=Q.extend(c[d].data,n)),o=c[d],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[Q.camelCase(n)]=r),l?(a=o[n],null==a&&(a=o[Q.camelCase(n)])):a=o,a}},removeData:function(e,t,n){if(Q.acceptData(e)){var r,o,a,s=e.nodeType,l=s?Q.cache:e,u=s?e[Q.expando]:Q.expando;if(l[u]){if(t&&(r=n?l[u]:l[u].data)){Q.isArray(t)||(t in r?t=[t]:(t=Q.camelCase(t),t=t in r?[t]:t.split(" ")));for(o=0,a=t.length;a>o;o++)delete r[t[o]];if(!(n?i:Q.isEmptyObject)(r))return}(n||(delete l[u].data,i(l[u])))&&(s?Q.cleanData([e],!0):Q.support.deleteExpando||l!=l.window?delete l[u]:l[u]=null)}}},_data:function(e,t,n){return Q.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&Q.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),Q.fn.extend({data:function(e,n){var i,o,a,s,l,u=this[0],c=0,d=null;if(e===t){if(this.length&&(d=Q.data(u),1===u.nodeType&&!Q._data(u,"parsedAttrs"))){for(a=u.attributes,l=a.length;l>c;c++)s=a[c].name,s.indexOf("data-")||(s=Q.camelCase(s.substring(5)),r(u,s,d[s]));Q._data(u,"parsedAttrs",!0)}return d}return"object"==typeof e?this.each(function(){Q.data(this,e)}):(i=e.split(".",2),i[1]=i[1]?"."+i[1]:"",o=i[1]+"!",Q.access(this,function(n){return n===t?(d=this.triggerHandler("getData"+o,[i[0]]),d===t&&u&&(d=Q.data(u,e),d=r(u,e,d)),d===t&&i[1]?this.data(i[0]):d):(i[1]=n,this.each(function(){var t=Q(this);t.triggerHandler("setData"+o,i),Q.data(this,e,n),t.triggerHandler("changeData"+o,i)}),t)},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){Q.removeData(this,e)})}}),Q.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=Q._data(e,n),r&&(!i||Q.isArray(r)?i=Q._data(e,n,Q.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=Q.queue(e,t),r=n.length,i=n.shift(),o=Q._queueHooks(e,t),a=function(){Q.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Q._data(e,n)||Q._data(e,n,{empty:Q.Callbacks("once memory").add(function(){Q.removeData(e,t+"queue",!0),Q.removeData(e,n,!0)})})}}),Q.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?Q.queue(this[0],e):n===t?this:this.each(function(){var t=Q.queue(this,e,n);Q._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&Q.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Q.dequeue(this,e)})},delay:function(e,t){return e=Q.fx?Q.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=Q.Deferred(),a=this,s=this.length,l=function(){--i||o.resolveWith(a,[a])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";s--;)r=Q._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(l));return l(),o.promise(n)}});var vt,_t,yt,bt=/[\t\r\n]/g,wt=/\r/g,St=/^(?:button|input)$/i,kt=/^(?:button|input|object|select|textarea)$/i,xt=/^a(?:rea|)$/i,Et=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Tt=Q.support.getSetAttribute;Q.fn.extend({attr:function(e,t){return Q.access(this,Q.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Q.removeAttr(this,e)})},prop:function(e,t){return Q.access(this,Q.prop,e,t,arguments.length>1)},removeProp:function(e){return e=Q.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a,s;if(Q.isFunction(e))return this.each(function(t){Q(this).addClass(e.call(this,t,this.className))});if(e&&"string"==typeof e)for(t=e.split(tt),n=0,r=this.length;r>n;n++)if(i=this[n],1===i.nodeType)if(i.className||1!==t.length){for(o=" "+i.className+" ",a=0,s=t.length;s>a;a++)0>o.indexOf(" "+t[a]+" ")&&(o+=t[a]+" ");i.className=Q.trim(o)}else i.className=e;return this},removeClass:function(e){var n,r,i,o,a,s,l;if(Q.isFunction(e))return this.each(function(t){Q(this).removeClass(e.call(this,t,this.className))});if(e&&"string"==typeof e||e===t)for(n=(e||"").split(tt),s=0,l=this.length;l>s;s++)if(i=this[s],1===i.nodeType&&i.className){for(r=(" "+i.className+" ").replace(bt," "),o=0,a=n.length;a>o;o++)for(;r.indexOf(" "+n[o]+" ")>=0;)r=r.replace(" "+n[o]+" "," ");i.className=e?Q.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return Q.isFunction(e)?this.each(function(n){Q(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var i,o=0,a=Q(this),s=t,l=e.split(tt);i=l[o++];)s=r?s:!a.hasClass(i),a[s?"addClass":"removeClass"](i);else("undefined"===n||"boolean"===n)&&(this.className&&Q._data(this,"__className__",this.className),this.className=this.className||e===!1?"":Q._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(bt," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=Q.isFunction(e),this.each(function(r){var o,a=Q(this);1===this.nodeType&&(o=i?e.call(this,r,a.val()):e,null==o?o="":"number"==typeof o?o+="":Q.isArray(o)&&(o=Q.map(o,function(e){return null==e?"":e+""})),n=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==t||(this.value=o))});if(o)return n=Q.valHooks[o.type]||Q.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(o,"value"))!==t?r:(r=o.value,"string"==typeof r?r.replace(wt,""):null==r?"":r)}}}),Q.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r,i,o=e.selectedIndex,a=[],s=e.options,l="select-one"===e.type;if(0>o)return null;for(n=l?o:0,r=l?o+1:s.length;r>n;n++)if(i=s[n],!(!i.selected||(Q.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&Q.nodeName(i.parentNode,"optgroup"))){if(t=Q(i).val(),l)return t;a.push(t)}return l&&!a.length&&s.length?Q(s[o]).val():a},set:function(e,t){var n=Q.makeArray(t);return Q(e).find("option").each(function(){this.selected=Q.inArray(Q(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var o,a,s,l=e.nodeType;if(e&&3!==l&&8!==l&&2!==l)return i&&Q.isFunction(Q.fn[n])?Q(e)[n](r):e.getAttribute===t?Q.prop(e,n,r):(s=1!==l||!Q.isXMLDoc(e),s&&(n=n.toLowerCase(),a=Q.attrHooks[n]||(Et.test(n)?_t:vt)),r!==t?null===r?(Q.removeAttr(e,n),t):a&&"set"in a&&s&&(o=a.set(e,r,n))!==t?o:(e.setAttribute(n,r+""),r):a&&"get"in a&&s&&null!==(o=a.get(e,n))?o:(o=e.getAttribute(n),null===o?t:o))},removeAttr:function(e,t){var n,r,i,o,a=0;if(t&&1===e.nodeType)for(r=t.split(tt);r.length>a;a++)i=r[a],i&&(n=Q.propFix[i]||i,o=Et.test(i),o||Q.attr(e,i,""),e.removeAttribute(Tt?i:n),o&&n in e&&(e[n]=!1))},attrHooks:{type:{set:function(e,t){if(St.test(e.nodeName)&&e.parentNode)Q.error("type property can't be changed");else if(!Q.support.radioValue&&"radio"===t&&Q.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return vt&&Q.nodeName(e,"button")?vt.get(e,t):t in e?e.value:null},set:function(e,n,r){return vt&&Q.nodeName(e,"button")?vt.set(e,n,r):(e.value=n,t)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!Q.isXMLDoc(e),a&&(n=Q.propFix[n]||n,o=Q.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):kt.test(e.nodeName)||xt.test(e.nodeName)&&e.href?0:t}}}}),_t={get:function(e,n){var r,i=Q.prop(e,n);return i===!0||"boolean"!=typeof i&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?Q.removeAttr(e,n):(r=Q.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},Tt||(yt={name:!0,id:!0,coords:!0},vt=Q.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(yt[n]?""!==r.value:r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=F.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},Q.each(["width","height"],function(e,n){Q.attrHooks[n]=Q.extend(Q.attrHooks[n],{set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}})}),Q.attrHooks.contenteditable={get:vt.get,set:function(e,t,n){""===t&&(t="false"),vt.set(e,t,n)}}),Q.support.hrefNormalized||Q.each(["href","src","width","height"],function(e,n){Q.attrHooks[n]=Q.extend(Q.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null===r?t:r}})}),Q.support.style||(Q.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),Q.support.optSelected||(Q.propHooks.selected=Q.extend(Q.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),Q.support.enctype||(Q.propFix.enctype="encoding"),Q.support.checkOn||Q.each(["radio","checkbox"],function(){Q.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]=Q.extend(Q.valHooks[this],{set:function(e,n){return Q.isArray(n)?e.checked=Q.inArray(Q(e).val(),n)>=0:t}})});var Ct=/^(?:textarea|input|select)$/i,Mt=/^([^\.]*|)(?:\.(.+)|)$/,At=/(?:^|\s)hover(\.\S+|)\b/,Nt=/^key/,It=/^(?:mouse|contextmenu)|click/,Dt=/^(?:focusinfocus|focusoutblur)$/,Ot=function(e){return Q.event.special.hover?e:e.replace(At,"mouseenter$1 mouseleave$1")};Q.event={add:function(e,n,r,i,o){var a,s,l,u,c,d,f,p,h,m,g;if(3!==e.nodeType&&8!==e.nodeType&&n&&r&&(a=Q._data(e))){for(r.handler&&(h=r,r=h.handler,o=h.selector),r.guid||(r.guid=Q.guid++),l=a.events,l||(a.events=l={}),s=a.handle,s||(a.handle=s=function(e){return Q===t||e&&Q.event.triggered===e.type?t:Q.event.dispatch.apply(s.elem,arguments)
},s.elem=e),n=Q.trim(Ot(n)).split(" "),u=0;n.length>u;u++)c=Mt.exec(n[u])||[],d=c[1],f=(c[2]||"").split(".").sort(),g=Q.event.special[d]||{},d=(o?g.delegateType:g.bindType)||d,g=Q.event.special[d]||{},p=Q.extend({type:d,origType:c[1],data:i,handler:r,guid:r.guid,selector:o,needsContext:o&&Q.expr.match.needsContext.test(o),namespace:f.join(".")},h),m=l[d],m||(m=l[d]=[],m.delegateCount=0,g.setup&&g.setup.call(e,i,f,s)!==!1||(e.addEventListener?e.addEventListener(d,s,!1):e.attachEvent&&e.attachEvent("on"+d,s))),g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),o?m.splice(m.delegateCount++,0,p):m.push(p),Q.event.global[d]=!0;e=null}},global:{},remove:function(e,t,n,r,i){var o,a,s,l,u,c,d,f,p,h,m,g=Q.hasData(e)&&Q._data(e);if(g&&(f=g.events)){for(t=Q.trim(Ot(t||"")).split(" "),o=0;t.length>o;o++)if(a=Mt.exec(t[o])||[],s=l=a[1],u=a[2],s){for(p=Q.event.special[s]||{},s=(r?p.delegateType:p.bindType)||s,h=f[s]||[],c=h.length,u=u?RegExp("(^|\\.)"+u.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null,d=0;h.length>d;d++)m=h[d],!i&&l!==m.origType||n&&n.guid!==m.guid||u&&!u.test(m.namespace)||r&&r!==m.selector&&("**"!==r||!m.selector)||(h.splice(d--,1),m.selector&&h.delegateCount--,p.remove&&p.remove.call(e,m));0===h.length&&c!==h.length&&(p.teardown&&p.teardown.call(e,u,g.handle)!==!1||Q.removeEvent(e,s,g.handle),delete f[s])}else for(s in f)Q.event.remove(e,s+t[o],n,r,!0);Q.isEmptyObject(f)&&(delete g.handle,Q.removeData(e,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,i,o){if(!i||3!==i.nodeType&&8!==i.nodeType){var a,s,l,u,c,d,f,p,h,m,g=n.type||n,v=[];if(!Dt.test(g+Q.event.triggered)&&(g.indexOf("!")>=0&&(g=g.slice(0,-1),s=!0),g.indexOf(".")>=0&&(v=g.split("."),g=v.shift(),v.sort()),i&&!Q.event.customEvent[g]||Q.event.global[g]))if(n="object"==typeof n?n[Q.expando]?n:new Q.Event(g,n):new Q.Event(g),n.type=g,n.isTrigger=!0,n.exclusive=s,n.namespace=v.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,d=0>g.indexOf(":")?"on"+g:"",i){if(n.result=t,n.target||(n.target=i),r=null!=r?Q.makeArray(r):[],r.unshift(n),f=Q.event.special[g]||{},!f.trigger||f.trigger.apply(i,r)!==!1){if(h=[[i,f.bindType||g]],!o&&!f.noBubble&&!Q.isWindow(i)){for(m=f.delegateType||g,u=Dt.test(m+g)?i:i.parentNode,c=i;u;u=u.parentNode)h.push([u,m]),c=u;c===(i.ownerDocument||F)&&h.push([c.defaultView||c.parentWindow||e,m])}for(l=0;h.length>l&&!n.isPropagationStopped();l++)u=h[l][0],n.type=h[l][1],p=(Q._data(u,"events")||{})[n.type]&&Q._data(u,"handle"),p&&p.apply(u,r),p=d&&u[d],p&&Q.acceptData(u)&&p.apply&&p.apply(u,r)===!1&&n.preventDefault();return n.type=g,o||n.isDefaultPrevented()||f._default&&f._default.apply(i.ownerDocument,r)!==!1||"click"===g&&Q.nodeName(i,"a")||!Q.acceptData(i)||d&&i[g]&&("focus"!==g&&"blur"!==g||0!==n.target.offsetWidth)&&!Q.isWindow(i)&&(c=i[d],c&&(i[d]=null),Q.event.triggered=g,i[g](),Q.event.triggered=t,c&&(i[d]=c)),n.result}}else{a=Q.cache;for(l in a)a[l].events&&a[l].events[g]&&Q.event.trigger(n,r,a[l].handle.elem,!0)}}},dispatch:function(n){n=Q.event.fix(n||e.event);var r,i,o,a,s,l,u,c,d,f=(Q._data(this,"events")||{})[n.type]||[],p=f.delegateCount,h=W.call(arguments),m=!n.exclusive&&!n.namespace,g=Q.event.special[n.type]||{},v=[];if(h[0]=n,n.delegateTarget=this,!g.preDispatch||g.preDispatch.call(this,n)!==!1){if(p&&(!n.button||"click"!==n.type))for(o=n.target;o!=this;o=o.parentNode||this)if(o.disabled!==!0||"click"!==n.type){for(s={},u=[],r=0;p>r;r++)c=f[r],d=c.selector,s[d]===t&&(s[d]=c.needsContext?Q(d,this).index(o)>=0:Q.find(d,this,null,[o]).length),s[d]&&u.push(c);u.length&&v.push({elem:o,matches:u})}for(f.length>p&&v.push({elem:this,matches:f.slice(p)}),r=0;v.length>r&&!n.isPropagationStopped();r++)for(l=v[r],n.currentTarget=l.elem,i=0;l.matches.length>i&&!n.isImmediatePropagationStopped();i++)c=l.matches[i],(m||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))&&(n.data=c.data,n.handleObj=c,a=((Q.event.special[c.origType]||{}).handle||c.handler).apply(l.elem,h),a!==t&&(n.result=a,a===!1&&(n.preventDefault(),n.stopPropagation())));return g.postDispatch&&g.postDispatch.call(this,n),n.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,a=n.button,s=n.fromElement;return null==e.pageX&&null!=n.clientX&&(r=e.target.ownerDocument||F,i=r.documentElement,o=r.body,e.pageX=n.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?n.toElement:s),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[Q.expando])return e;var t,n,r=e,i=Q.event.fixHooks[e.type]||{},o=i.props?this.props.concat(i.props):this.props;for(e=Q.Event(r),t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||F),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,i.filter?i.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){Q.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=Q.extend(new Q.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?Q.event.trigger(i,null,t):Q.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},Q.event.handle=Q.event.dispatch,Q.removeEvent=F.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,n,r){var i="on"+n;e.detachEvent&&(e[i]===t&&(e[i]=null),e.detachEvent(i,r))},Q.Event=function(e,n){return this instanceof Q.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?a:o):this.type=e,n&&Q.extend(this,n),this.timeStamp=e&&e.timeStamp||Q.now(),this[Q.expando]=!0,t):new Q.Event(e,n)},Q.Event.prototype={preventDefault:function(){this.isDefaultPrevented=a;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=a;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()},isDefaultPrevented:o,isPropagationStopped:o,isImmediatePropagationStopped:o},Q.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){Q.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return o.selector,(!i||i!==r&&!Q.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),Q.support.submitBubbles||(Q.event.special.submit={setup:function(){return Q.nodeName(this,"form")?!1:(Q.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=Q.nodeName(n,"input")||Q.nodeName(n,"button")?n.form:t;r&&!Q._data(r,"_submit_attached")&&(Q.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),Q._data(r,"_submit_attached",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&Q.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return Q.nodeName(this,"form")?!1:(Q.event.remove(this,"._submit"),t)}}),Q.support.changeBubbles||(Q.event.special.change={setup:function(){return Ct.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(Q.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),Q.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),Q.event.simulate("change",this,e,!0)})),!1):(Q.event.add(this,"beforeactivate._change",function(e){var t=e.target;Ct.test(t.nodeName)&&!Q._data(t,"_change_attached")&&(Q.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||Q.event.simulate("change",this.parentNode,e,!0)}),Q._data(t,"_change_attached",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return Q.event.remove(this,"._change"),!Ct.test(this.nodeName)}}),Q.support.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){Q.event.simulate(t,e.target,Q.event.fix(e),!0)};Q.event.special[t]={setup:function(){0===n++&&F.addEventListener(e,r,!0)},teardown:function(){0===--n&&F.removeEventListener(e,r,!0)}}}),Q.fn.extend({on:function(e,n,r,i,a){var s,l;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(l in e)this.on(l,n,r,e[l],a);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=o;else if(!i)return this;return 1===a&&(s=i,i=function(e){return Q().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=Q.guid++)),this.each(function(){Q.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,a;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,Q(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(a in e)this.off(a,n,e[a]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=o),this.each(function(){Q.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return Q(this.context).on(e,this.selector,t,n),this},die:function(e,t){return Q(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){Q.event.trigger(e,t,this)})},triggerHandler:function(e,n){return this[0]?Q.event.trigger(e,n,this[0],!0):t},toggle:function(e){var t=arguments,n=e.guid||Q.guid++,r=0,i=function(n){var i=(Q._data(this,"lastToggle"+e.guid)||0)%r;return Q._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};for(i.guid=n;t.length>r;)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Q.fn[t]=function(e,n){return null==n&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Nt.test(t)&&(Q.event.fixHooks[t]=Q.event.keyHooks),It.test(t)&&(Q.event.fixHooks[t]=Q.event.mouseHooks)}),function(e,t){function n(e,t,n,r){n=n||[],t=t||I;var i,o,a,s,l=t.nodeType;if(!e||"string"!=typeof e)return n;if(1!==l&&9!==l)return[];if(a=w(t),!a&&!r&&(i=nt.exec(e)))if(s=i[1]){if(9===l){if(o=t.getElementById(s),!o||!o.parentNode)return n;if(o.id===s)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&S(t,o)&&o.id===s)return n.push(o),n}else{if(i[2])return j.apply(n,R.call(t.getElementsByTagName(e),0)),n;if((s=i[3])&&ft&&t.getElementsByClassName)return j.apply(n,R.call(t.getElementsByClassName(s),0)),n}return m(e.replace(G,"$1"),t,n,r,a)}function r(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function i(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function o(e){return U(function(t){return t=+t,U(function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function a(e,t,n){if(e===t)return n;for(var r=e.nextSibling;r;){if(r===t)return-1;r=r.nextSibling}return 1}function s(e,t){var r,i,o,a,s,l,u,c=H[A][e];if(c)return t?0:c.slice(0);for(s=e,l=[],u=y.preFilter;s;){(!r||(i=Z.exec(s)))&&(i&&(s=s.slice(i[0].length)),l.push(o=[])),r=!1,(i=et.exec(s))&&(o.push(r=new N(i.shift())),s=s.slice(r.length),r.type=i[0].replace(G," "));for(a in y.filter)!(i=st[a].exec(s))||u[a]&&!(i=u[a](i,I,!0))||(o.push(r=new N(i.shift())),s=s.slice(r.length),r.type=a,r.matches=i);if(!r)break}return t?s.length:s?n.error(e):H(e,l).slice(0)}function l(e,t,n){var r=t.dir,i=n&&"parentNode"===t.dir,o=L++;return t.first?function(t,n,o){for(;t=t[r];)if(i||1===t.nodeType)return e(t,n,o)}:function(t,n,a){if(a){for(;t=t[r];)if((i||1===t.nodeType)&&e(t,n,a))return t}else for(var s,l=O+" "+o+" ",u=l+v;t=t[r];)if(i||1===t.nodeType){if((s=t[A])===u)return t.sizset;if("string"==typeof s&&0===s.indexOf(l)){if(t.sizset)return t}else{if(t[A]=u,e(t,n,a))return t.sizset=!0,t;t.sizset=!1}}}}function u(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function c(e,t,n,r,i){for(var o,a=[],s=0,l=e.length,u=null!=t;l>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),u&&t.push(s));return a}function d(e,t,n,r,i,o){return r&&!r[A]&&(r=d(r)),i&&!i[A]&&(i=d(i,o)),U(function(o,a,s,l){if(!o||!i){var u,d,f,p=[],m=[],g=a.length,v=o||h(t||"*",s.nodeType?[s]:s,[],o),_=!e||!o&&t?v:c(v,p,e,s,l),y=n?i||(o?e:g||r)?[]:a:_;if(n&&n(_,y,s,l),r)for(f=c(y,m),r(f,[],s,l),u=f.length;u--;)(d=f[u])&&(y[m[u]]=!(_[m[u]]=d));if(o)for(u=e&&y.length;u--;)(d=y[u])&&(o[p[u]]=!(a[p[u]]=d));else y=c(y===a?y.splice(g,y.length):y),i?i(null,a,y,l):j.apply(a,y)}})}function f(e){for(var t,n,r,i=e.length,o=y.relative[e[0].type],a=o||y.relative[" "],s=o?1:0,c=l(function(e){return e===t},a,!0),p=l(function(e){return B.call(t,e)>-1},a,!0),h=[function(e,n,r){return!o&&(r||n!==T)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];i>s;s++)if(n=y.relative[e[s].type])h=[l(u(h),n)];else{if(n=y.filter[e[s].type].apply(null,e[s].matches),n[A]){for(r=++s;i>r&&!y.relative[e[r].type];r++);return d(s>1&&u(h),s>1&&e.slice(0,s-1).join("").replace(G,"$1"),n,r>s&&f(e.slice(s,r)),i>r&&f(e=e.slice(r)),i>r&&e.join(""))}h.push(n)}return u(h)}function p(e,t){var r=t.length>0,i=e.length>0,o=function(a,s,l,u,d){var f,p,h,m=[],g=0,_="0",b=a&&[],w=null!=d,S=T,k=a||i&&y.find.TAG("*",d&&s.parentNode||s),x=O+=null==S?1:Math.E;for(w&&(T=s!==I&&s,v=o.el);null!=(f=k[_]);_++){if(i&&f){for(p=0;h=e[p];p++)if(h(f,s,l)){u.push(f);break}w&&(O=x,v=++o.el)}r&&((f=!h&&f)&&g--,a&&b.push(f))}if(g+=_,r&&_!==g){for(p=0;h=t[p];p++)h(b,m,s,l);if(a){if(g>0)for(;_--;)b[_]||m[_]||(m[_]=P.call(u));m=c(m)}j.apply(u,m),w&&!a&&m.length>0&&g+t.length>1&&n.uniqueSort(u)}return w&&(O=x,T=S),b};return o.el=0,r?U(o):o}function h(e,t,r,i){for(var o=0,a=t.length;a>o;o++)n(e,t[o],r,i);return r}function m(e,t,n,r,i){var o,a,l,u,c,d=s(e);if(d.length,!r&&1===d.length){if(a=d[0]=d[0].slice(0),a.length>2&&"ID"===(l=a[0]).type&&9===t.nodeType&&!i&&y.relative[a[1].type]){if(t=y.find.ID(l.matches[0].replace(at,""),t,i)[0],!t)return n;e=e.slice(a.shift().length)}for(o=st.POS.test(e)?-1:a.length-1;o>=0&&(l=a[o],!y.relative[u=l.type]);o--)if((c=y.find[u])&&(r=c(l.matches[0].replace(at,""),rt.test(a[0].type)&&t.parentNode||t,i))){if(a.splice(o,1),e=r.length&&a.join(""),!e)return j.apply(n,R.call(r,0)),n;break}}return k(e,d)(r,t,i,n,rt.test(e)),n}function g(){}var v,_,y,b,w,S,k,x,E,T,C=!0,M="undefined",A=("sizcache"+Math.random()).replace(".",""),N=String,I=e.document,D=I.documentElement,O=0,L=0,P=[].pop,j=[].push,R=[].slice,B=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},U=function(e,t){return e[A]=null==t||t,e},$=function(){var e={},t=[];return U(function(n,r){return t.push(n)>y.cacheLength&&delete e[t.shift()],e[n]=r},e)},F=$(),H=$(),q=$(),V="[\\x20\\t\\r\\n\\f]",J="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",z=J.replace("w","w#"),W="([*^$|!~]?=)",Y="\\["+V+"*("+J+")"+V+"*(?:"+W+V+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+z+")|)|)"+V+"*\\]",K=":("+J+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+Y+")|[^:]|\\\\.)*|.*))\\)|)",X=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+V+"*((?:-\\d)?\\d*)"+V+"*\\)|)(?=[^-]|$)",G=RegExp("^"+V+"+|((?:^|[^\\\\])(?:\\\\.)*)"+V+"+$","g"),Z=RegExp("^"+V+"*,"+V+"*"),et=RegExp("^"+V+"*([\\x20\\t\\r\\n\\f>+~])"+V+"*"),tt=RegExp(K),nt=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,rt=/[\x20\t\r\n\f]*[+~]/,it=/h\d/i,ot=/input|select|textarea|button/i,at=/\\(?!\\)/g,st={ID:RegExp("^#("+J+")"),CLASS:RegExp("^\\.("+J+")"),NAME:RegExp("^\\[name=['\"]?("+J+")['\"]?\\]"),TAG:RegExp("^("+J.replace("w","w*")+")"),ATTR:RegExp("^"+Y),PSEUDO:RegExp("^"+K),POS:RegExp(X,"i"),CHILD:RegExp("^:(only|nth|first|last)-child(?:\\("+V+"*(even|odd|(([+-]|)(\\d*)n|)"+V+"*(?:([+-]|)"+V+"*(\\d+)|))"+V+"*\\)|)","i"),needsContext:RegExp("^"+V+"*[>+~]|"+X,"i")},lt=function(e){var t=I.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},ut=lt(function(e){return e.appendChild(I.createComment("")),!e.getElementsByTagName("*").length}),ct=lt(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==M&&"#"===e.firstChild.getAttribute("href")}),dt=lt(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),ft=lt(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),pt=lt(function(e){e.id=A+0,e.innerHTML="<a name='"+A+"'></a><div name='"+A+"'></div>",D.insertBefore(e,D.firstChild);var t=I.getElementsByName&&I.getElementsByName(A).length===2+I.getElementsByName(A+0).length;return _=!I.getElementById(A),D.removeChild(e),t});try{R.call(D.childNodes,0)[0].nodeType}catch(ht){R=function(e){for(var t,n=[];t=this[e];e++)n.push(t);return n}}n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){return n(t,null,null,[e]).length>0},b=n.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=b(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=b(t);return n},w=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},S=n.contains=D.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&1===r.nodeType&&n.contains&&n.contains(r))}:D.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},n.attr=function(e,t){var n,r=w(e);return r||(t=t.toLowerCase()),(n=y.attrHandle[t])?n(e):r||dt?e.getAttribute(t):(n=e.getAttributeNode(t),n?"boolean"==typeof e[t]?e[t]?t:null:n.specified?n.value:null:null)},y=n.selectors={cacheLength:50,createPseudo:U,match:st,attrHandle:ct?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:_?function(e,t,n){if(typeof t.getElementById!==M&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==M&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==M&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:ut?function(e,n){return typeof n.getElementsByTagName!==M?n.getElementsByTagName(e):t}:function(e,t){var n=t.getElementsByTagName(e);if("*"===e){for(var r,i=[],o=0;r=n[o];o++)1===r.nodeType&&i.push(r);return i}return n},NAME:pt&&function(e,n){return typeof n.getElementsByName!==M?n.getElementsByName(name):t},CLASS:ft&&function(e,n,r){return typeof n.getElementsByClassName===M||r?t:n.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(at,""),e[3]=(e[4]||e[5]||"").replace(at,""),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1]?(e[2]||n.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*("even"===e[2]||"odd"===e[2])),e[4]=+(e[6]+e[7]||"odd"===e[2])):e[2]&&n.error(e[0]),e},PSEUDO:function(e){var t,n;return st.CHILD.test(e[0])?null:(e[3]?e[2]=e[3]:(t=e[4])&&(tt.test(t)&&(n=s(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t),e.slice(0,3))}},filter:{ID:_?function(e){return e=e.replace(at,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace(at,""),function(t){var n=typeof t.getAttributeNode!==M&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(at,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=F[A][e];return t||(t=F(e,RegExp("(^|"+V+")"+e+"("+V+"|$)"))),function(e){return t.test(e.className||typeof e.getAttribute!==M&&e.getAttribute("class")||"")}},ATTR:function(e,t,r){return function(i){var o=n.attr(i,e);return null==o?"!="===t:t?(o+="","="===t?o===r:"!="===t?o!==r:"^="===t?r&&0===o.indexOf(r):"*="===t?r&&o.indexOf(r)>-1:"$="===t?r&&o.substr(o.length-r.length)===r:"~="===t?(" "+o+" ").indexOf(r)>-1:"|="===t?o===r||o.substr(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,n,r){return"nth"===e?function(e){var t,i,o=e.parentNode;if(1===n&&0===r)return!0;if(o)for(i=0,t=o.firstChild;t&&(1!==t.nodeType||(i++,e!==t));t=t.nextSibling);return i-=r,i===n||0===i%n&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":for(;n=n.previousSibling;)if(1===n.nodeType)return!1;if("first"===e)return!0;n=t;case"last":for(;n=n.nextSibling;)if(1===n.nodeType)return!1;return!0}}},PSEUDO:function(e,t){var r,i=y.pseudos[e]||y.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return i[A]?i(t):i.length>1?(r=[e,e,"",t],y.setFilters.hasOwnProperty(e.toLowerCase())?U(function(e,n){for(var r,o=i(e,t),a=o.length;a--;)r=B.call(e,o[a]),e[r]=!(n[r]=o[a])}):function(e){return i(e,0,r)}):i}},pseudos:{not:U(function(e){var t=[],n=[],r=k(e.replace(G,"$1"));return r[A]?U(function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:U(function(e){return function(t){return n(e,t).length>0}}),contains:U(function(e){return function(t){return(t.textContent||t.innerText||b(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!y.pseudos.empty(e)},empty:function(e){var t;for(e=e.firstChild;e;){if(e.nodeName>"@"||3===(t=e.nodeType)||4===t)return!1;e=e.nextSibling}return!0},header:function(e){return it.test(e.nodeName)},text:function(e){var t,n;return"input"===e.nodeName.toLowerCase()&&"text"===(t=e.type)&&(null==(n=e.getAttribute("type"))||n.toLowerCase()===t)},radio:r("radio"),checkbox:r("checkbox"),file:r("file"),password:r("password"),image:r("image"),submit:i("submit"),reset:i("reset"),button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return ot.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return!(e!==t.activeElement||t.hasFocus&&!t.hasFocus()||!e.type&&!e.href)},active:function(e){return e===e.ownerDocument.activeElement},first:o(function(){return[0]}),last:o(function(e,t){return[t-1]}),eq:o(function(e,t,n){return[0>n?n+t:n]}),even:o(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:o(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:o(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:o(function(e,t,n){for(var r=0>n?n+t:n;t>++r;)e.push(r);return e})}},x=D.compareDocumentPosition?function(e,t){return e===t?(E=!0,0):(e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t):e.compareDocumentPosition)?-1:1}:function(e,t){if(e===t)return E=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],o=[],s=e.parentNode,l=t.parentNode,u=s;if(s===l)return a(e,t);if(!s)return-1;if(!l)return 1;for(;u;)i.unshift(u),u=u.parentNode;for(u=l;u;)o.unshift(u),u=u.parentNode;n=i.length,r=o.length;for(var c=0;n>c&&r>c;c++)if(i[c]!==o[c])return a(i[c],o[c]);return c===n?a(e,o[c],-1):a(i[c],t,1)},[0,0].sort(x),C=!E,n.uniqueSort=function(e){var t,n=1;if(E=C,e.sort(x),E)for(;t=e[n];n++)t===e[n-1]&&e.splice(n--,1);return e},n.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},k=n.compile=function(e,t){var n,r=[],i=[],o=q[A][e];if(!o){for(t||(t=s(e)),n=t.length;n--;)o=f(t[n]),o[A]?r.push(o):i.push(o);o=q(e,p(i,r))}return o},I.querySelectorAll&&function(){var e,t=m,r=/'|\\/g,i=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,o=[":focus"],a=[":active",":focus"],l=D.matchesSelector||D.mozMatchesSelector||D.webkitMatchesSelector||D.oMatchesSelector||D.msMatchesSelector;lt(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||o.push("\\["+V+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||o.push(":checked")}),lt(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&o.push("[*^$]="+V+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||o.push(":enabled",":disabled")}),o=RegExp(o.join("|")),m=function(e,n,i,a,l){if(!(a||l||o&&o.test(e))){var u,c,d=!0,f=A,p=n,h=9===n.nodeType&&e;if(1===n.nodeType&&"object"!==n.nodeName.toLowerCase()){for(u=s(e),(d=n.getAttribute("id"))?f=d.replace(r,"\\$&"):n.setAttribute("id",f),f="[id='"+f+"'] ",c=u.length;c--;)u[c]=f+u[c].join("");p=rt.test(e)&&n.parentNode||n,h=u.join(",")}if(h)try{return j.apply(i,R.call(p.querySelectorAll(h),0)),i}catch(m){}finally{d||n.removeAttribute("id")}}return t(e,n,i,a,l)},l&&(lt(function(t){e=l.call(t,"div");try{l.call(t,"[test!='']:sizzle"),a.push("!=",K)}catch(n){}}),a=RegExp(a.join("|")),n.matchesSelector=function(t,r){if(r=r.replace(i,"='$1']"),!(w(t)||a.test(r)||o&&o.test(r)))try{var s=l.call(t,r);if(s||e||t.document&&11!==t.document.nodeType)return s}catch(u){}return n(r,null,null,[t]).length>0})}(),y.pseudos.nth=y.pseudos.eq,y.filters=g.prototype=y.pseudos,y.setFilters=new g,n.attr=Q.attr,Q.find=n,Q.expr=n.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=n.uniqueSort,Q.text=n.getText,Q.isXMLDoc=n.isXML,Q.contains=n.contains}(e);var Lt=/Until$/,Pt=/^(?:parents|prev(?:Until|All))/,jt=/^.[^:#\[\.,]*$/,Rt=Q.expr.match.needsContext,Bt={children:!0,contents:!0,next:!0,prev:!0};Q.fn.extend({find:function(e){var t,n,r,i,o,a,s=this;if("string"!=typeof e)return Q(e).filter(function(){for(t=0,n=s.length;n>t;t++)if(Q.contains(s[t],this))return!0});for(a=this.pushStack("","find",e),t=0,n=this.length;n>t;t++)if(r=a.length,Q.find(e,this[t],a),t>0)for(i=r;a.length>i;i++)for(o=0;r>o;o++)if(a[o]===a[i]){a.splice(i--,1);break}return a},has:function(e){var t,n=Q(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(Q.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(u(this,e,!1),"not",e)},filter:function(e){return this.pushStack(u(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"==typeof e?Rt.test(e)?Q(e,this.context).index(this[0])>=0:Q.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var n,r=0,i=this.length,o=[],a=Rt.test(e)||"string"!=typeof e?Q(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n.ownerDocument&&n!==t&&11!==n.nodeType;){if(a?a.index(n)>-1:Q.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}return o=o.length>1?Q.unique(o):o,this.pushStack(o,"closest",e)},index:function(e){return e?"string"==typeof e?Q.inArray(this[0],Q(e)):Q.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n="string"==typeof e?Q(e,t):Q.makeArray(e&&e.nodeType?[e]:e),r=Q.merge(this.get(),n);return this.pushStack(s(n[0])||s(r[0])?r:Q.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Q.fn.andSelf=Q.fn.addBack,Q.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Q.dir(e,"parentNode")},parentsUntil:function(e,t,n){return Q.dir(e,"parentNode",n)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return Q.dir(e,"nextSibling")},prevAll:function(e){return Q.dir(e,"previousSibling")},nextUntil:function(e,t,n){return Q.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return Q.dir(e,"previousSibling",n)},siblings:function(e){return Q.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Q.sibling(e.firstChild)},contents:function(e){return Q.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:Q.merge([],e.childNodes)}},function(e,t){Q.fn[e]=function(n,r){var i=Q.map(this,t,n);return Lt.test(e)||(r=n),r&&"string"==typeof r&&(i=Q.filter(r,i)),i=this.length>1&&!Bt[e]?Q.unique(i):i,this.length>1&&Pt.test(e)&&(i=i.reverse()),this.pushStack(i,e,W.call(arguments).join(","))}}),Q.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?Q.find.matchesSelector(t[0],e)?[t[0]]:[]:Q.find.matches(e,t)},dir:function(e,n,r){for(var i=[],o=e[n];o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!Q(o).is(r));)1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Ut="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",$t=/ jQuery\d+="(?:null|\d+)"/g,Ft=/^\s+/,Ht=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,qt=/<([\w:]+)/,Vt=/<tbody/i,Jt=/<|&#?\w+;/,zt=/<(?:script|style|link)/i,Wt=/<(?:script|object|embed|option|style)/i,Yt=RegExp("<(?:"+Ut+")[\\s/>]","i"),Kt=/^(?:checkbox|radio)$/,Xt=/checked\s*(?:[^=]|=\s*.checked.)/i,Gt=/\/(java|ecma)script/i,Qt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Zt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},en=c(F),tn=en.appendChild(F.createElement("div"));Zt.optgroup=Zt.option,Zt.tbody=Zt.tfoot=Zt.colgroup=Zt.caption=Zt.thead,Zt.th=Zt.td,Q.support.htmlSerialize||(Zt._default=[1,"X<div>","</div>"]),Q.fn.extend({text:function(e){return Q.access(this,function(e){return e===t?Q.text(this):this.empty().append((this[0]&&this[0].ownerDocument||F).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(Q.isFunction(e))return this.each(function(t){Q(this).wrapAll(e.call(this,t))});if(this[0]){var t=Q(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return Q.isFunction(e)?this.each(function(t){Q(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Q(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Q.isFunction(e);return this.each(function(n){Q(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)
}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!s(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=Q.clean(arguments);return this.pushStack(Q.merge(e,this),"before",this.selector)}},after:function(){if(!s(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=Q.clean(arguments);return this.pushStack(Q.merge(this,e),"after",this.selector)}},remove:function(e,t){for(var n,r=0;null!=(n=this[r]);r++)(!e||Q.filter(e,[n]).length)&&(t||1!==n.nodeType||(Q.cleanData(n.getElementsByTagName("*")),Q.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&Q.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Q.clone(this,e,t)})},html:function(e){return Q.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace($t,""):t;if(!("string"!=typeof e||zt.test(e)||!Q.support.htmlSerialize&&Yt.test(e)||!Q.support.leadingWhitespace&&Ft.test(e)||Zt[(qt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Ht,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(Q.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return s(this[0])?this.length?this.pushStack(Q(Q.isFunction(e)?e():e),"replaceWith",e):this:Q.isFunction(e)?this.each(function(t){var n=Q(this),r=n.html();n.replaceWith(e.call(this,t,r))}):("string"!=typeof e&&(e=Q(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;Q(this).remove(),t?Q(t).before(e):Q(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,o,a,s,l=0,u=e[0],c=[],f=this.length;if(!Q.support.checkClone&&f>1&&"string"==typeof u&&Xt.test(u))return this.each(function(){Q(this).domManip(e,n,r)});if(Q.isFunction(u))return this.each(function(i){var o=Q(this);e[0]=u.call(this,i,n?o.html():t),o.domManip(e,n,r)});if(this[0]){if(i=Q.buildFragment(e,this,c),a=i.fragment,o=a.firstChild,1===a.childNodes.length&&(a=o),o)for(n=n&&Q.nodeName(o,"tr"),s=i.cacheable||f-1;f>l;l++)r.call(n&&Q.nodeName(this[l],"table")?d(this[l],"tbody"):this[l],l===s?a:Q.clone(a,!0,!0));a=o=null,c.length&&Q.each(c,function(e,t){t.src?Q.ajax?Q.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):Q.error("no ajax"):Q.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Qt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),Q.buildFragment=function(e,n,r){var i,o,a,s=e[0];return n=n||F,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,!(1===e.length&&"string"==typeof s&&512>s.length&&n===F&&"<"===s.charAt(0))||Wt.test(s)||!Q.support.checkClone&&Xt.test(s)||!Q.support.html5Clone&&Yt.test(s)||(o=!0,i=Q.fragments[s],a=i!==t),i||(i=n.createDocumentFragment(),Q.clean(e,n,i,r),o&&(Q.fragments[s]=a&&i)),{fragment:i,cacheable:o}},Q.fragments={},Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Q.fn[e]=function(n){var r,i=0,o=[],a=Q(n),s=a.length,l=1===this.length&&this[0].parentNode;if((null==l||l&&11===l.nodeType&&1===l.childNodes.length)&&1===s)return a[t](this[0]),this;for(;s>i;i++)r=(i>0?this.clone(!0):this).get(),Q(a[i])[t](r),o=o.concat(r);return this.pushStack(o,e,a.selector)}}),Q.extend({clone:function(e,t,n){var r,i,o,a;if(Q.support.html5Clone||Q.isXMLDoc(e)||!Yt.test("<"+e.nodeName+">")?a=e.cloneNode(!0):(tn.innerHTML=e.outerHTML,tn.removeChild(a=tn.firstChild)),!(Q.support.noCloneEvent&&Q.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Q.isXMLDoc(e)))for(p(e,a),r=h(e),i=h(a),o=0;r[o];++o)i[o]&&p(r[o],i[o]);if(t&&(f(e,a),n))for(r=h(e),i=h(a),o=0;r[o];++o)f(r[o],i[o]);return r=i=null,a},clean:function(e,n,r,i){var o,a,s,l,u,d,f,p,h,g,v,_=n===F&&en,y=[];for(n&&n.createDocumentFragment!==t||(n=F),o=0;null!=(s=e[o]);o++)if("number"==typeof s&&(s+=""),s){if("string"==typeof s)if(Jt.test(s)){for(_=_||c(n),f=n.createElement("div"),_.appendChild(f),s=s.replace(Ht,"<$1></$2>"),l=(qt.exec(s)||["",""])[1].toLowerCase(),u=Zt[l]||Zt._default,d=u[0],f.innerHTML=u[1]+s+u[2];d--;)f=f.lastChild;if(!Q.support.tbody)for(p=Vt.test(s),h="table"!==l||p?"<table>"!==u[1]||p?[]:f.childNodes:f.firstChild&&f.firstChild.childNodes,a=h.length-1;a>=0;--a)Q.nodeName(h[a],"tbody")&&!h[a].childNodes.length&&h[a].parentNode.removeChild(h[a]);!Q.support.leadingWhitespace&&Ft.test(s)&&f.insertBefore(n.createTextNode(Ft.exec(s)[0]),f.firstChild),s=f.childNodes,f.parentNode.removeChild(f)}else s=n.createTextNode(s);s.nodeType?y.push(s):Q.merge(y,s)}if(f&&(s=f=_=null),!Q.support.appendChecked)for(o=0;null!=(s=y[o]);o++)Q.nodeName(s,"input")?m(s):s.getElementsByTagName!==t&&Q.grep(s.getElementsByTagName("input"),m);if(r)for(g=function(e){return!e.type||Gt.test(e.type)?i?i.push(e.parentNode?e.parentNode.removeChild(e):e):r.appendChild(e):t},o=0;null!=(s=y[o]);o++)Q.nodeName(s,"script")&&g(s)||(r.appendChild(s),s.getElementsByTagName!==t&&(v=Q.grep(Q.merge([],s.getElementsByTagName("script")),g),y.splice.apply(y,[o+1,0].concat(v)),o+=v.length));return y},cleanData:function(e,t){for(var n,r,i,o,a=0,s=Q.expando,l=Q.cache,u=Q.support.deleteExpando,c=Q.event.special;null!=(i=e[a]);a++)if((t||Q.acceptData(i))&&(r=i[s],n=r&&l[r])){if(n.events)for(o in n.events)c[o]?Q.event.remove(i,o):Q.removeEvent(i,o,n.handle);l[r]&&(delete l[r],u?delete i[s]:i.removeAttribute?i.removeAttribute(s):i[s]=null,Q.deletedIds.push(r))}}}),function(){var e,t;Q.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||0>e.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=Q.uaMatch(q.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),Q.browser=t,Q.sub=function(){function e(t,n){return new e.fn.init(t,n)}Q.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(n,r){return r&&r instanceof Q&&!(r instanceof e)&&(r=e(r)),Q.fn.init.call(this,n,r,t)},e.fn.init.prototype=e.fn;var t=e(F);return e}}();var nn,rn,on,an=/alpha\([^)]*\)/i,sn=/opacity=([^)]*)/,ln=/^(top|right|bottom|left)$/,un=/^(none|table(?!-c[ea]).+)/,cn=/^margin/,dn=RegExp("^("+Z+")(.*)$","i"),fn=RegExp("^("+Z+")(?!px)[a-z%]+$","i"),pn=RegExp("^([-+])=("+Z+")","i"),hn={},mn={position:"absolute",visibility:"hidden",display:"block"},gn={letterSpacing:0,fontWeight:400},vn=["Top","Right","Bottom","Left"],_n=["Webkit","O","Moz","ms"],yn=Q.fn.toggle;Q.fn.extend({css:function(e,n){return Q.access(this,function(e,n,r){return r!==t?Q.style(e,n,r):Q.css(e,n)},e,n,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e,t){var n="boolean"==typeof e;return Q.isFunction(e)&&Q.isFunction(t)?yn.apply(this,arguments):this.each(function(){(n?e:v(this))?Q(this).show():Q(this).hide()})}}),Q.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=nn(e,"opacity");return""===n?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":Q.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=Q.camelCase(n),u=e.style;if(n=Q.cssProps[l]||(Q.cssProps[l]=g(u,l)),s=Q.cssHooks[n]||Q.cssHooks[l],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:u[n];if(a=typeof r,"string"===a&&(o=pn.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(Q.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||Q.cssNumber[l]||(r+="px"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{u[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,l=Q.camelCase(n);return n=Q.cssProps[l]||(Q.cssProps[l]=g(e.style,l)),s=Q.cssHooks[n]||Q.cssHooks[l],s&&"get"in s&&(o=s.get(e,!0,i)),o===t&&(o=nn(e,n)),"normal"===o&&n in gn&&(o=gn[n]),r||i!==t?(a=parseFloat(o),r||Q.isNumeric(a)?a||0:o):o},swap:function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=o[i];return r}}),e.getComputedStyle?nn=function(t,n){var r,i,o,a,s=e.getComputedStyle(t,null),l=t.style;return s&&(r=s[n],""!==r||Q.contains(t.ownerDocument,t)||(r=Q.style(t,n)),fn.test(r)&&cn.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=r,r=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),r}:F.documentElement.currentStyle&&(nn=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],o=e.style;return null==i&&o&&o[t]&&(i=o[t]),fn.test(i)&&!ln.test(t)&&(n=o.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),o.left="fontSize"===t?"1em":i,i=o.pixelLeft+"px",o.left=n,r&&(e.runtimeStyle.left=r)),""===i?"auto":i}),Q.each(["height","width"],function(e,n){Q.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&un.test(nn(e,"display"))?Q.swap(e,mn,function(){return w(e,n,i)}):w(e,n,i):t},set:function(e,t,r){return y(e,t,r?b(e,n,r,Q.support.boxSizing&&"border-box"===Q.css(e,"boxSizing")):0)}}}),Q.support.opacity||(Q.cssHooks.opacity={get:function(e,t){return sn.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=Q.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,t>=1&&""===Q.trim(o.replace(an,""))&&n.removeAttribute&&(n.removeAttribute("filter"),r&&!r.filter)||(n.filter=an.test(o)?o.replace(an,i):o+" "+i)}}),Q(function(){Q.support.reliableMarginRight||(Q.cssHooks.marginRight={get:function(e,n){return Q.swap(e,{display:"inline-block"},function(){return n?nn(e,"marginRight"):t})}}),!Q.support.pixelPosition&&Q.fn.position&&Q.each(["top","left"],function(e,t){Q.cssHooks[t]={get:function(e,n){if(n){var r=nn(e,t);return fn.test(r)?Q(e).position()[t]+"px":r}}}})}),Q.expr&&Q.expr.filters&&(Q.expr.filters.hidden=function(e){return 0===e.offsetWidth&&0===e.offsetHeight||!Q.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||nn(e,"display"))},Q.expr.filters.visible=function(e){return!Q.expr.filters.hidden(e)}),Q.each({margin:"",padding:"",border:"Width"},function(e,t){Q.cssHooks[e+t]={expand:function(n){var r,i="string"==typeof n?n.split(" "):[n],o={};for(r=0;4>r;r++)o[e+vn[r]+t]=i[r]||i[r-2]||i[0];return o}},cn.test(e)||(Q.cssHooks[e+t].set=y)});var bn=/%20/g,wn=/\[\]$/,Sn=/\r?\n/g,kn=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,xn=/^(?:select|textarea)/i;Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?Q.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||xn.test(this.nodeName)||kn.test(this.type))}).map(function(e,t){var n=Q(this).val();return null==n?null:Q.isArray(n)?Q.map(n,function(e){return{name:t.name,value:e.replace(Sn,"\r\n")}}):{name:t.name,value:n.replace(Sn,"\r\n")}}).get()}}),Q.param=function(e,n){var r,i=[],o=function(e,t){t=Q.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(e)||e.jquery&&!Q.isPlainObject(e))Q.each(e,function(){o(this.name,this.value)});else for(r in e)k(r,e[r],n,o);return i.join("&").replace(bn,"+")};var En,Tn,Cn=/#.*$/,Mn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,An=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Nn=/^(?:GET|HEAD)$/,In=/^\/\//,Dn=/\?/,On=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Ln=/([?&])_=[^&]*/,Pn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,jn=Q.fn.load,Rn={},Bn={},Un=["*/"]+["*"];try{Tn=H.href}catch($n){Tn=F.createElement("a"),Tn.href="",Tn=Tn.href}En=Pn.exec(Tn.toLowerCase())||[],Q.fn.load=function(e,n,r){if("string"!=typeof e&&jn)return jn.apply(this,arguments);if(!this.length)return this;var i,o,a,s=this,l=e.indexOf(" ");return l>=0&&(i=e.slice(l,e.length),e=e.slice(0,l)),Q.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(o="POST"),Q.ajax({url:e,type:o,dataType:"html",data:n,complete:function(e,t){r&&s.each(r,a||[e.responseText,t,e])}}).done(function(e){a=arguments,s.html(i?Q("<div>").append(e.replace(On,"")).find(i):e)}),this},Q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){Q.fn[t]=function(e){return this.on(t,e)}}),Q.each(["get","post"],function(e,n){Q[n]=function(e,r,i,o){return Q.isFunction(r)&&(o=o||i,i=r,r=t),Q.ajax({type:n,url:e,data:r,success:i,dataType:o})}}),Q.extend({getScript:function(e,n){return Q.get(e,t,n,"script")},getJSON:function(e,t,n){return Q.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?T(e,Q.ajaxSettings):(t=e,e=Q.ajaxSettings),T(e,t),e},ajaxSettings:{url:Tn,isLocal:An.test(En[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Un},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:x(Rn),ajaxTransport:x(Bn),ajax:function(e,n){function r(e,n,r,a){var u,d,_,y,w,k=n;2!==b&&(b=2,l&&clearTimeout(l),s=t,o=a||"",S.readyState=e>0?4:0,r&&(y=C(f,S,r)),e>=200&&300>e||304===e?(f.ifModified&&(w=S.getResponseHeader("Last-Modified"),w&&(Q.lastModified[i]=w),w=S.getResponseHeader("Etag"),w&&(Q.etag[i]=w)),304===e?(k="notmodified",u=!0):(u=M(f,y),k=u.state,d=u.data,_=u.error,u=!_)):(_=k,(!k||e)&&(k="error",0>e&&(e=0))),S.status=e,S.statusText=(n||k)+"",u?m.resolveWith(p,[d,k,S]):m.rejectWith(p,[S,k,_]),S.statusCode(v),v=t,c&&h.trigger("ajax"+(u?"Success":"Error"),[S,f,u?d:_]),g.fireWith(p,[S,k]),c&&(h.trigger("ajaxComplete",[S,f]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var i,o,a,s,l,u,c,d,f=Q.ajaxSetup({},n),p=f.context||f,h=p!==f&&(p.nodeType||p instanceof Q)?Q(p):Q.event,m=Q.Deferred(),g=Q.Callbacks("once memory"),v=f.statusCode||{},_={},y={},b=0,w="canceled",S={readyState:0,setRequestHeader:function(e,t){if(!b){var n=e.toLowerCase();e=y[n]=y[n]||e,_[e]=t}return this},getAllResponseHeaders:function(){return 2===b?o:null},getResponseHeader:function(e){var n;if(2===b){if(!a)for(a={};n=Mn.exec(o);)a[n[1].toLowerCase()]=n[2];n=a[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return b||(f.mimeType=e),this},abort:function(e){return e=e||w,s&&s.abort(e),r(0,e),this}};if(m.promise(S),S.success=S.done,S.error=S.fail,S.complete=g.add,S.statusCode=function(e){if(e){var t;if(2>b)for(t in e)v[t]=[v[t],e[t]];else t=e[S.status],S.always(t)}return this},f.url=((e||f.url)+"").replace(Cn,"").replace(In,En[1]+"//"),f.dataTypes=Q.trim(f.dataType||"*").toLowerCase().split(tt),null==f.crossDomain&&(u=Pn.exec(f.url.toLowerCase())||!1,f.crossDomain=u&&u.join(":")+(u[3]?"":"http:"===u[1]?80:443)!==En.join(":")+(En[3]?"":"http:"===En[1]?80:443)),f.data&&f.processData&&"string"!=typeof f.data&&(f.data=Q.param(f.data,f.traditional)),E(Rn,f,n,S),2===b)return S;if(c=f.global,f.type=f.type.toUpperCase(),f.hasContent=!Nn.test(f.type),c&&0===Q.active++&&Q.event.trigger("ajaxStart"),!f.hasContent&&(f.data&&(f.url+=(Dn.test(f.url)?"&":"?")+f.data,delete f.data),i=f.url,f.cache===!1)){var k=Q.now(),x=f.url.replace(Ln,"$1_="+k);f.url=x+(x===f.url?(Dn.test(f.url)?"&":"?")+"_="+k:"")}(f.data&&f.hasContent&&f.contentType!==!1||n.contentType)&&S.setRequestHeader("Content-Type",f.contentType),f.ifModified&&(i=i||f.url,Q.lastModified[i]&&S.setRequestHeader("If-Modified-Since",Q.lastModified[i]),Q.etag[i]&&S.setRequestHeader("If-None-Match",Q.etag[i])),S.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Un+"; q=0.01":""):f.accepts["*"]);for(d in f.headers)S.setRequestHeader(d,f.headers[d]);if(f.beforeSend&&(f.beforeSend.call(p,S,f)===!1||2===b))return S.abort();w="abort";for(d in{success:1,error:1,complete:1})S[d](f[d]);if(s=E(Bn,f,n,S)){S.readyState=1,c&&h.trigger("ajaxSend",[S,f]),f.async&&f.timeout>0&&(l=setTimeout(function(){S.abort("timeout")},f.timeout));try{b=1,s.send(_,r)}catch(T){if(!(2>b))throw T;r(-1,T)}}else r(-1,"No Transport");return S},active:0,lastModified:{},etag:{}});var Fn=[],Hn=/\?/,qn=/(=)\?(?=&|$)|\?\?/,Vn=Q.now();Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Fn.pop()||Q.expando+"_"+Vn++;return this[e]=!0,e}}),Q.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,l=n.data,u=n.url,c=n.jsonp!==!1,d=c&&qn.test(u),f=c&&!d&&"string"==typeof l&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&qn.test(l);return"jsonp"===n.dataTypes[0]||d||f?(o=n.jsonpCallback=Q.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a=e[o],d?n.url=u.replace(qn,"$1"+o):f?n.data=l.replace(qn,"$1"+o):c&&(n.url+=(Hn.test(u)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||Q.error(o+" was not called"),s[0]},n.dataTypes[0]="json",e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,Fn.push(o)),s&&Q.isFunction(a)&&a(s[0]),s=a=t}),"script"):t}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return Q.globalEval(e),e}}}),Q.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),Q.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=F.head||F.getElementsByTagName("head")[0]||F.documentElement;return{send:function(i,o){n=F.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){(i||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Jn,zn=e.ActiveXObject?function(){for(var e in Jn)Jn[e](0,1)}:!1,Wn=0;Q.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&A()||N()}:A,function(e){Q.extend(Q.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(Q.ajaxSettings.xhr()),Q.support.ajax&&Q.ajaxTransport(function(n){if(!n.crossDomain||Q.support.cors){var r;return{send:function(i,o){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)l.setRequestHeader(s,i[s])}catch(u){}l.send(n.hasContent&&n.data||null),r=function(e,i){var s,u,c,d,f;try{if(r&&(i||4===l.readyState))if(r=t,a&&(l.onreadystatechange=Q.noop,zn&&delete Jn[a]),i)4!==l.readyState&&l.abort();else{s=l.status,c=l.getAllResponseHeaders(),d={},f=l.responseXML,f&&f.documentElement&&(d.xml=f);try{d.text=l.responseText}catch(e){}try{u=l.statusText}catch(p){u=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=d.text?200:404}}catch(h){i||o(-1,h)}d&&o(s,u,d,c)},n.async?4===l.readyState?setTimeout(r,0):(a=++Wn,zn&&(Jn||(Jn={},Q(e).unload(zn)),Jn[a]=r),l.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var Yn,Kn,Xn=/^(?:toggle|show|hide)$/,Gn=RegExp("^(?:([-+])=|)("+Z+")([a-z%]*)$","i"),Qn=/queueHooks$/,Zn=[P],er={"*":[function(e,t){var n,r,i=this.createTween(e,t),o=Gn.exec(t),a=i.cur(),s=+a||0,l=1,u=20;if(o){if(n=+o[2],r=o[3]||(Q.cssNumber[e]?"":"px"),"px"!==r&&s){s=Q.css(i.elem,e,!0)||n||1;do l=l||".5",s/=l,Q.style(i.elem,e,s+r);while(l!==(l=i.cur()/a)&&1!==l&&--u)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};Q.Animation=Q.extend(O,{tweener:function(e,t){Q.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],er[n]=er[n]||[],er[n].unshift(t)},prefilter:function(e,t){t?Zn.unshift(e):Zn.push(e)}}),Q.Tween=j,j.prototype={constructor:j,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(Q.cssNumber[n]?"":"px")},cur:function(){var e=j.propHooks[this.prop];return e&&e.get?e.get(this):j.propHooks._default.get(this)},run:function(e){var t,n=j.propHooks[this.prop];return this.pos=t=this.options.duration?Q.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):j.propHooks._default.set(this),this}},j.prototype.init.prototype=j.prototype,j.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Q.css(e.elem,e.prop,!1,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Q.fx.step[e.prop]?Q.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Q.cssProps[e.prop]]||Q.cssHooks[e.prop])?Q.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},j.propHooks.scrollTop=j.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Q.each(["toggle","show","hide"],function(e,t){var n=Q.fn[t];Q.fn[t]=function(r,i,o){return null==r||"boolean"==typeof r||!e&&Q.isFunction(r)&&Q.isFunction(i)?n.apply(this,arguments):this.animate(R(t,!0),r,i,o)}}),Q.fn.extend({fadeTo:function(e,t,n,r){return this.filter(v).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=Q.isEmptyObject(e),o=Q.speed(t,n,r),a=function(){var t=O(this,Q.extend({},e),o);i&&t.stop(!0)};return i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=Q.timers,a=Q._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Qn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&Q.dequeue(this,e)})}}),Q.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Q.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),Q.speed=function(e,t,n){var r=e&&"object"==typeof e?Q.extend({},e):{complete:n||!n&&t||Q.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Q.isFunction(t)&&t};return r.duration=Q.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in Q.fx.speeds?Q.fx.speeds[r.duration]:Q.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){Q.isFunction(r.old)&&r.old.call(this),r.queue&&Q.dequeue(this,r.queue)},r},Q.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Q.timers=[],Q.fx=j.prototype.init,Q.fx.tick=function(){for(var e,t=Q.timers,n=0;t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||Q.fx.stop()},Q.fx.timer=function(e){e()&&Q.timers.push(e)&&!Kn&&(Kn=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.interval=13,Q.fx.stop=function(){clearInterval(Kn),Kn=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fx.step={},Q.expr&&Q.expr.filters&&(Q.expr.filters.animated=function(e){return Q.grep(Q.timers,function(t){return e===t.elem}).length});var tr=/^(?:body|html)$/i;Q.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){Q.offset.setOffset(this,e,t)});var n,r,i,o,a,s,l,u={top:0,left:0},c=this[0],d=c&&c.ownerDocument;if(d)return(r=d.body)===c?Q.offset.bodyOffset(c):(n=d.documentElement,Q.contains(n,c)?(c.getBoundingClientRect!==t&&(u=c.getBoundingClientRect()),i=B(d),o=n.clientTop||r.clientTop||0,a=n.clientLeft||r.clientLeft||0,s=i.pageYOffset||n.scrollTop,l=i.pageXOffset||n.scrollLeft,{top:u.top+s-o,left:u.left+l-a}):u)},Q.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return Q.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(Q.css(e,"marginTop"))||0,n+=parseFloat(Q.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=Q.css(e,"position");"static"===r&&(e.style.position="relative");var i,o,a=Q(e),s=a.offset(),l=Q.css(e,"top"),u=Q.css(e,"left"),c=("absolute"===r||"fixed"===r)&&Q.inArray("auto",[l,u])>-1,d={},f={};c?(f=a.position(),i=f.top,o=f.left):(i=parseFloat(l)||0,o=parseFloat(u)||0),Q.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(d.top=t.top-s.top+i),null!=t.left&&(d.left=t.left-s.left+o),"using"in t?t.using.call(e,d):a.css(d)}},Q.fn.extend({position:function(){if(this[0]){var e=this[0],t=this.offsetParent(),n=this.offset(),r=tr.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(Q.css(e,"marginTop"))||0,n.left-=parseFloat(Q.css(e,"marginLeft"))||0,r.top+=parseFloat(Q.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(Q.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||F.body;e&&!tr.test(e.nodeName)&&"static"===Q.css(e,"position");)e=e.offsetParent;return e||F.body})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);Q.fn[e]=function(i){return Q.access(this,function(e,i,o){var a=B(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?Q(a).scrollLeft():o,r?o:Q(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}}),Q.each({Height:"height",Width:"width"},function(e,n){Q.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){Q.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return Q.access(this,function(n,r,i){var o;return Q.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?Q.css(n,r,i,s):Q.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=Q,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return Q})})(window)}(),function(){DomUtils={};var e=function(e,t){if(!document.querySelectorAll)throw Error("This browser doesn't support querySelectorAll.");var n=t;return f(t,"DomUtils_findAllBySelector_scope",function(t){var r=_.map(e.split(","),function(e){return t+" "+e}).join(",");return n.querySelectorAll(r)})},t=window.Sizzle||window.jQuery&&window.jQuery.find||e,n=document.createElement("div");n.innerHTML="   <link/><table></table><select><!----></select>";var r=document.createElement("div");r.innerHTML="<select><option selected>Foo</option></select>",r.firstChild.setAttribute("name","myname");var i={leadingWhitespaceKilled:3!==n.firstChild.nodeType,tbodyInsertion:n.getElementsByTagName("tbody").length>0,tagsLost:0===n.getElementsByTagName("link").length,commentsLost:!n.getElementsByTagName("select")[0].firstChild,selectValueMustBeFromAttribute:"Foo"!==r.firstChild.value,mustSetNameInCreateElement:r.firstChild.outerHTML&&-1===r.firstChild.outerHTML.indexOf("myname")},o={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};_.extend(o,{optgroup:o.option,tbody:o.thead,tfoot:o.thead,colgroup:o.thead,caption:o.thead,th:o.td}),i.tagsLost&&(o._default=[1,"div<div>","</div>"]);var a=/^\s+/,s=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,l=/<([\w:]+)/,u=/<tbody/i,c=/<|&#?\w+;/;DomUtils.htmlToFragment=function(e){var t=document,n=t.createDocumentFragment();if(e.length)if(c.test(e)){e=e.replace(s,"<$1></$2>");var r=l.exec(e),d=r?r[1].toLowerCase():"",f=o[d]||o._default,p=f[1]+e+f[2];i.commentsLost&&(p=p.replace(/<\s*(select|option)\b/gi,'<ins domutilsrealtagname="$1"'),p=p.replace(/<\/\s*(select|option)\b/gi,"</ins"));var h=t.createElement("div");h.innerHTML=p;for(var m=f[0];m--;)h=h.lastChild;if(i.tbodyInsertion&&!u.test(e)){var g=h.getElementsByTagName("tbody");_.each(g,function(e){e.firstChild||e.parentNode.removeChild(e)})}if(i.leadingWhitespaceKilled){var v=a.exec(e);v&&h.insertBefore(t.createTextNode(v[0]),h.firstChild)}if(i.commentsLost){var y=[];_.each(h.getElementsByTagName("ins"),function(e){e.getAttribute("domutilsrealtagname")&&y.push(e)}),_.each(y,function(e){var t=e.getAttribute("domutilsrealtagname");i.mustSetNameInCreateElement&&e.getAttribute("name")&&(t="<"+t+" name='"+_.escape(e.getAttribute("name"))+"'/>");var n=document.createElement(t);e.removeAttribute("domutilsrealtagname");for(var r=e.attributes,o=0;r.length>o;++o){var a=r.item(o);if(a.specified){var s=a.name.toLowerCase(),l=a.value+"";"selected"===s&&""===l&&(l="selected"),n.setAttribute(s,l)}}for(;e.firstChild;)n.appendChild(e.firstChild);e.parentNode.replaceChild(n,e)})}for(;h.firstChild;)n.appendChild(h.firstChild)}else n.appendChild(t.createTextNode(e));else;return n},DomUtils.fragmentToHtml=function(e){return e=e.cloneNode(!0),DomUtils.fragmentToContainer(e).innerHTML},DomUtils.fragmentToContainer=function(e){for(var t=document,n=e.firstChild;n&&1!==n.nodeType;)n=n.nextSibling;var r=t.createElement("div");if(n){var i=n.nodeName,a=o[i]||o._default;r.innerHTML=a[1]+a[2];for(var s=a[0];s--;)r=r.lastChild;r.appendChild(e)}else r.appendChild(e);return r},DomUtils.elementContains=function(e,t){return 1!==e.nodeType?!1:e===t?!1:e.compareDocumentPosition?16&e.compareDocumentPosition(t):(t=t.parentNode,t&&1===t.nodeType?e===t?!0:e.contains(t):!1)},DomUtils.findAll=function(e,n){if(11===e.nodeType){for(var r=e,i=DomUtils.fragmentToContainer(r),o=t(n,i);i.firstChild;)r.appendChild(i.firstChild);return o}return t(n,e)},DomUtils.find=function(e,t){var n=DomUtils.findAll(e,t);return n.length?n[0]:null};var d=function(e,t,n){return DomUtils.elementContains(e,t)?!1:0>=DomUtils.compareElementIndex(t,e)&&0>=DomUtils.compareElementIndex(e,n)};DomUtils.findAllClipped=function(e,t,n,r){for(;n!==r&&1!==n.nodeType;)n=n.nextSibling;for(;n!==r&&1!==r.nodeType;)r=r.previousSibling;if(1!==n.nodeType)return[];var i=DomUtils.findAll(e,t);return _.reject(i,function(e){return!d(e,n,r)})},DomUtils.findClipped=function(e,t,n,r){var i=DomUtils.findAllClipped(e,t,n,r);return i.length?i[0]:null};var f=function(e,t,n){var r=!1;e.getAttribute("id")||(e.setAttribute("id",t),r=!0);try{var i=e.getAttribute("id").replace(/'/g,"\\$&");return n("[id='"+i+"']")}finally{r&&e.removeAttribute("id")}},p=function(e,t,n,r,i){for(var o=n.split(","),a=0,s=o.length;s>a;a++){var l=f(e,"DomUtils_matchesSelector_target",function(o){var a,s=n.match(/\S.*?(?=\s*$)/)[0],l=s+o;return a=r?DomUtils.findClipped(t,l,r,i):DomUtils.find(t,l),a===e});if(l)return!0}return!1};DomUtils.matchesSelector=function(e,t,n){return p(e,t,n)},DomUtils.matchesSelectorClipped=function(e,t,n,r,i){return p(e,t,n,r,i)},DomUtils.compareElementIndex=function(e,t){if(e===t)return 0;if(e.compareDocumentPosition){var n=e.compareDocumentPosition(t);return 24&n?0:4&n?-1:1}return e.contains(t)||t.contains(e)?0:e.sourceIndex<t.sourceIndex?-1:1},DomUtils.wrapFragmentForContainer=function(e,t){if(t&&"TABLE"===t.nodeName&&_.any(e.childNodes,function(e){return"TR"===e.nodeName
})){var n=document.createElement("TBODY");n.appendChild(e),e.appendChild(n)}},DomUtils.isInDocument=function(e){return e===document?!0:(1!==e.nodeType&&(e=e.parentNode),e&&1===e.nodeType?e===document.body?!0:DomUtils.elementContains(document.body,e):!1)},DomUtils.rangeToHtml=function(e,t){for(var n=document.createDocumentFragment(),r=e,i=t.nextSibling;r&&r!==i;r=r.nextSibling)n.appendChild(r.cloneNode(!0));return DomUtils.fragmentToHtml(n)},DomUtils.outerHtml=function(e){return DomUtils.rangeToHtml(e,e)},DomUtils.setElementValue=function(e,t){if(e.value=t,e.value!==t&&"SELECT"===e.nodeName)for(var n=DomUtils.findAll(e,"option"),r=0;n.length>r;++r)if(DomUtils.getElementValue(n[r])===t)return n[r].selected=!0,void 0},DomUtils.getElementValue=function(e){if(!i.selectValueMustBeFromAttribute)return e.value;if("OPTION"===e.nodeName){var t=e.attributes.value;return!t||t.specified?e.value:e.text}return"SELECT"===e.nodeName?0>e.selectedIndex?null:DomUtils.getElementValue(e.options[e.selectedIndex]):e.value}}(),function(){var e=function(){var e=document.createTextNode("");try{e.test=123}catch(t){}return 123!==e.test?!1:document.documentMode?!1:!0}(),t=function(t,n){if(e)return[t,n];if(3===t.nodeType){var r=document.createComment("IE");t.parentNode.insertBefore(r,t),t=r}if(3===n.nodeType){var r=document.createComment("IE");n.parentNode.insertBefore(r,n.nextSibling),n=r}return[t,n]};LiveRange=function(e,r,i,o){if(11===r.nodeType)i=r.lastChild,r=r.firstChild;else if(!r.parentNode)throw Error("LiveRange start and end must have a parent");i=i||r,this.tag=e;var a=t(r,i);r=this._ensureTag(a[0]),i=this._ensureTag(a[1]);var s=n(r[e][0],!0,i,r,o),l=n(i[e][1],!1,r,i,o);this._insertEntries(r,0,s,[this]),this._insertEntries(i,1,l,[this])};var n=function(e,t,n,r,i){for(var o,a=t?n.parentNode.lastChild:r,s=t?!i:i,l=0,u=a;e.length>=l;l++){for(var c=e[l],d=c&&(t?c._end:c._start);u!==d&&u!==n;)u=u.previousSibling;if(d===n){if(o=l,s)break}else if(u===n){o=l;break}}return o};LiveRange.prototype._ensureTag=function(e){return this.tag in e||(e[this.tag]=[[],[]]),e};var r=function(){var e=document.createElement("DIV"),t=!1;try{e.test=12,delete e.test,t=!0}catch(n){}return t}();LiveRange._cleanNode=function(e,t,n){var i=t[e];!i||i[0].length+i[1].length&&!n||(r?delete t[e]:t.removeAttribute(e))},LiveRange.prototype.destroy=function(e){var t=this;if(e){if(this.visit(function(e,t){e&&(t._start=null,t._end=null)},function(e,n){if(!e)for(var r=n.firstChild;r;r=r.nextSibling)LiveRange._cleanNode(t.tag,r,!0)}),this._removeEntries(this._start,0,this._startIndex),this._removeEntries(this._end,1,0,this._endIndex+1),this._start!==this._end){for(var n=this._start.nextSibling;n!==this._end;n=n.nextSibling)LiveRange._cleanNode(t.tag,n,!0);this._start[t.tag]&&this._removeEntries(this._start,1),this._end[t.tag]&&this._removeEntries(this._end,0)}this._start=this._end=null}else this._removeEntries(this._start,0,this._startIndex,this._startIndex+1),this._removeEntries(this._end,1,this._endIndex,this._endIndex+1),this._start=this._end=null},LiveRange.prototype.firstNode=function(){return this._start},LiveRange.prototype.lastNode=function(){return this._end},LiveRange.prototype.containerNode=function(){return this._start.parentNode},LiveRange.prototype.visit=function(e,t){e=e||function(){},t=t||function(){};var n=this.tag,r=function(i,o,a){for(var s=a||0,l=o.nextSibling,u=i;u&&u!==l;u=u.nextSibling){var c=u[n]&&u[n][0];if(c&&c.length>s){var d=c[s],f=d._start,p=d._end;e(!0,d)!==!1&&r(f,p,s+1),e(!1,d),u=p}else t(!0,u)!==!1&&u.firstChild&&r(u.firstChild,u.lastChild),t(!1,u);s=0}};r(this._start,this._end,this._startIndex+1)},LiveRange.prototype._removeEntries=function(e,t,n,r){var i=e[this.tag][t];n=n||0,r=r||0===r?r:i.length;for(var o=i.splice(n,r-n),a=n;i.length>a;a++)t?i[a]._endIndex=a:i[a]._startIndex=a;return i.length||LiveRange._cleanNode(this.tag,e),o},LiveRange.prototype._insertEntries=function(e,t,n,r){var i=e[this.tag][t];Array.prototype.splice.apply(i,[n,0].concat(r));for(var o=n;i.length>o;o++)t?(i[o]._end=e,i[o]._endIndex=o):(i[o]._start=e,i[o]._startIndex=o)},LiveRange.prototype.replaceContents=function(e){if(!e.firstChild)throw Error("replaceContents requires non-empty fragment");return this.operate(function(t,n){t.parentNode.insertBefore(e,t);for(var r=t.ownerDocument.createDocumentFragment(),i=t;;){var o=i.nextSibling;if(r.appendChild(i),i===n)break;if(i=o,!i)throw Error("LiveRanges must begin and end on siblings in order")}return r})},LiveRange.prototype.operate=function(e){var n=this._start,r=this._end,i=this._removeEntries(n,0,0,this._startIndex+1),o=this._removeEntries(r,1,this._endIndex),a=n.parentNode,s=n.previousSibling,l=r.nextSibling,u=null;u=e(n,r);var c=s?s.nextSibling:a.firstChild,d=l?l.previousSibling:a.lastChild;if(!c||c===l)throw Error("Ranges must contain at least one element");var f=t(c,d);return c=this._ensureTag(f[0]),d=this._ensureTag(f[1]),this._insertEntries(c,0,0,i),this._insertEntries(d,1,d[this.tag][1].length,o),u},LiveRange.transplantTag=function(e,t,n){if(n[e]){t[e]=n[e],n[e]=null;for(var r=t[e][0],i=t[e][1],o=0;r.length>o;o++)r[o]._start=t;for(var o=0;i.length>o;o++)i[o]._end=t}},LiveRange.transplantRange=function(e,t,n){n._ensureTag(e),t!==e&&n._ensureTag(t),n._insertEntries(e,0,0,n._start[n.tag][0].slice(0,n._startIndex+1)),n._insertEntries(t,1,0,n._end[n.tag][1].slice(n._endIndex))},LiveRange.prototype.insertBefore=function(e){var t=e.firstChild;t&&(this._start.parentNode.insertBefore(e,this._start),this._ensureTag(t),this._insertEntries(t,0,0,this._removeEntries(this._start,0,0,this._startIndex)))},LiveRange.prototype.insertAfter=function(e){var t=e.lastChild;t&&(this._end.parentNode.insertBefore(e,this._end.nextSibling),this._ensureTag(t),this._insertEntries(t,1,t[this.tag][1].length,this._removeEntries(this._end,1,this._endIndex+1)))},LiveRange.prototype.extract=function(){if(this._startIndex>0&&this._start[this.tag][0][this._startIndex-1]._end===this._end)return null;var e=this._start.previousSibling,t=this._end.nextSibling,n=this._start.parentNode;this._startIndex>0&&(this._ensureTag(t),this._insertEntries(t,0,0,this._removeEntries(this._start,0,0,this._startIndex))),this._endIndex<this._end[this.tag][1].length-1&&(this._ensureTag(e),this._insertEntries(e,1,e[this.tag][1].length,this._removeEntries(this._end,1,this._endIndex+1)));for(var r,i=document.createDocumentFragment();r=e?e.nextSibling:n.firstChild,r&&r!==t;)i.appendChild(r);return i},LiveRange.prototype.findParent=function(e){var t=i(this.tag,this._end,this._endIndex);return t?t:e?null:LiveRange.findRange(this.tag,this.containerNode())},LiveRange.findRange=function(e,t){var n=i(e,t);return n?n:t.parentNode?LiveRange.findRange(e,t.parentNode):null};var i=function(e,t,n){if(n===void 0&&(n=-1),t[e]&&t[e][1].length>n+1)return t[e][1][n+1];for(var r=t.nextSibling;r;){var n=0,i=r[e]&&r[e][0];if(i&&i.length){var o=i[0];r=o._end,n=o._endIndex+1}if(r[e]&&r[e][1].length>n)return r[e][1][n];r=r.nextSibling}return null}}(),function(){var e,t=[],n=function(){return!1},r=function(){return!0},i=function(e){var t=e.stopPropagation,i=e.preventDefault;e.isPropagationStopped=n,e.isImmediatePropagationStopped=n,e.isDefaultPrevented=n,e.stopPropagation=function(){e.isPropagationStopped=r,t?t.call(e):e.cancelBubble=!0},e.preventDefault=function(){e.isDefaultPrevented=r,i?i.call(e):e.returnValue=!1},e.stopImmediatePropagation=function(){e.stopPropagation(),e.isImmediatePropagationStopped=r};var o=e.type;if(void 0===e.metaKey&&(e.metaKey=e.ctrlKey),/^key/.test(o))null==e.which&&(e.which=null!=e.charCode?e.charCode:e.keyCode);else if(/^(?:mouse|contextmenu)|click/.test(o)&&(!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),!e.which&&void 0!==e.button)){var a=e.button;e.which=1&a?1:2&a?3:4&a?2:0}return e},o=function(e){e=i(e),_.each(t,function(t){t.types[e.type]&&(!t._checkIECompliance||e.currentTarget["_uevents_test_eventtype_"+e.type])&&t.handler.call(null,e)})},a=function(){return e||(e=document.addEventListener?new UniversalEventListener._impl.w3c(o):new UniversalEventListener._impl.ie(o)),e},s={};UniversalEventListener=function(e,n){this.handler=e,this.types={},this.impl=a(),this._checkIECompliance=n,t.push(this)},_.extend(UniversalEventListener.prototype,{addType:function(e){this.types[e]||(this.types[e]=!0,s[e]=(s[e]||0)+1,1===s[e]&&this.impl.addType(e))},removeType:function(e){this.types[e]&&(delete this.types[e],s[e]--,s[e]||this.impl.removeType(e))},installHandler:function(e,t){1===e.nodeType&&(this.impl.installHandler(e,t),this._checkIECompliance&&(e["_uevents_test_eventtype_"+t]=e,e.firstChild&&_.each(e.getElementsByTagName("*"),function(e){e["_uevents_test_eventtype_"+t]=e})))},destroy:function(){var e=this;t=_.without(t,e),_.each(_.keys(e.types),function(t){e.removeType(t)})}})}(),function(){var e=0,t=1,n=2;UniversalEventListener._impl=UniversalEventListener._impl||{},UniversalEventListener._impl.w3c=function(t){this.deliver=t,this.typeCounts={},this.boundHandler=_.bind(this.handler,this),this.boundCapturer=_.bind(this.capturer,this),this.focusBlurMode="onfocusin"in document.createElement("DIV")?e:n,this.simulateMouseEnterLeave=!window.opera},_.extend(UniversalEventListener._impl.w3c.prototype,{addType:function(e){this._listen(this._expandEventType(e))},removeType:function(e){this._unlisten(this._expandEventType(e))},installHandler:function(){},_expandEventType:function(e){var r=[e];return this.focusBlurMode===t?"focus"===e?r.push("focusin"):"blur"===e&&r.push("focusout"):this.focusBlurMode===n&&("focusin"===e?r.push("focus"):"focusout"===e&&r.push("blur")),this.simulateMouseEnterLeave&&("mouseenter"===e?r.push("mouseover"):"mouseleave"===e&&r.push("mouseout")),r},_listen:function(e){var t=this;_.each(e,function(e){1===(t.typeCounts[e]=(t.typeCounts[e]||0)+1)&&document.addEventListener(e,t.boundCapturer,!0)})},_unlisten:function(e){var t=this;_.each(e,function(e){--t.typeCounts[e]||document.removeEventListener(e,t.boundCapturer,!0)})},capturer:function(e){3===e.target.nodeType&&(e.target=e.target.parentNode);var t=e.type,n=e.bubbles,r=e.target;r.addEventListener(t,this.boundHandler,!1);var i;if(n){i=[];for(var o=r.parentNode;o;o=o.parentNode)o.addEventListener(t,this.boundHandler,!1),i.push(o)}setTimeout(function(){r.removeEventListener(t,this.boundHandler,!1),n&&_.each(i,function(e){e.removeEventListener(t,this.boundHandler,!1)})},0)},handler:function(e){var r=function(e,t,n,r,i){var o=document.createEvent("UIEvents");o.initUIEvent(e,n,r,window,i),o.synthetic=!0,t.dispatchEvent(o)};if(e.currentTarget===e.target&&(this.focusBlurMode===t?"focusin"===e.type?r("focus",e.target,!1):"focusout"===e.type&&r("blur",e.target,!1):this.focusBlurMode===n&&("focus"===e.type?r("focusin",e.target,!0):"blur"===e.type&&r("focusout",e.target,!0))),this.focusBlurMode===t){if(("focus"===e.type||"blur"===e.type)&&!e.synthetic)return}else if(this.focusBlurMode===n&&("focusin"===e.type||"focusout"===e.type)&&!e.synthetic)return;(!this.simulateMouseEnterLeave||"mouseenter"!==e.type&&"mouseleave"!==e.type||e.synthetic)&&(this.deliver(e),!this.simulateMouseEnterLeave||e.relatedTarget&&(e.currentTarget===e.relatedTarget||DomUtils.elementContains(e.currentTarget,e.relatedTarget))||("mouseover"===e.type?r("mouseenter",e.currentTarget,!1):"mouseout"===e.type&&r("mouseleave",e.currentTarget,!1)))}})}(),function(){UniversalEventListener._impl=UniversalEventListener._impl||{},UniversalEventListener._impl.ie=function(e){var t=this;this.deliver=e,this.curriedHandler=function(){t.handler.call(this,t)},document.attachEvent("ondatasetcomplete",function(){var e=window.event,t=e&&e.srcElement;e.synthetic&&t&&"FORM"===t.nodeName&&e.returnValue!==!1&&t.submit()})},_.extend(UniversalEventListener._impl.ie.prototype,{addType:function(){},removeType:function(){},installHandler:function(e,t){var n="on"+t;if(1===e.nodeType){this._install(e,n);for(var r=e.getElementsByTagName("*"),i=0,o=r.length;o>i;i++)this._install(r[i],n)}},_install:function(e,t){var n=[t];"onfocus"===t?n.push("onfocusin"):"onblur"===t?n.push("onfocusout"):"onchange"===t?("INPUT"!==e.nodeName||"checkbox"!==e.type&&"radio"!==e.type||(n=["onpropertychange"]),n.push("oncellchange")):"onsubmit"===t&&n.push(e,"ondatasetcomplete");for(var r=0;n.length>r;r++)e[n[r]]=this.curriedHandler},handler:function(e){var t=function(e,t){var n=document.createEventObject();return n.synthetic=!0,t.fireEvent(e,n),n.returnValue},n=window.event,r=n.type,i=n.srcElement||document;if(n.target=i,1===this.nodeType){n.currentTarget=this;var o=this;if(o!==i||n.synthetic||("focusin"===r?t("onfocus",o):"focusout"===r?t("onblur",o):"change"===r?t("oncellchange",o):"propertychange"===r?"checked"===n.propertyName&&t("oncellchange",o):"submit"===r&&t("ondatasetcomplete",o)),("focus"===r||"blur"===n.type||"change"===n.type||"submit"===n.type)&&!n.synthetic)return"submit"===n.type&&(n.returnValue=!1),void 0;"cellchange"===r&&n.synthetic&&(r=n.type="change"),"datasetcomplete"===r&&n.synthetic&&(r=n.type="submit"),e.deliver(n)}}})}(),function(){Spark={},Spark._currentRenderer=function(){var e=null;return{get:function(){return e},withValue:function(t,n){var r=e;e=t;try{return n()}finally{e=r}}}}(),Spark._TAG="_spark_"+Random.id(),Spark._ANNOTATION_NOTIFY="notify",Spark._ANNOTATION_DATA="data",Spark._ANNOTATION_ISOLATE="isolate",Spark._ANNOTATION_EVENTS="events",Spark._ANNOTATION_WATCH="watch",Spark._ANNOTATION_LABEL="label",Spark._ANNOTATION_LANDMARK="landmark",Spark._ANNOTATION_LIST="list",Spark._ANNOTATION_LIST_ITEM="item",Spark._checkIECompliance=!1,Spark._globalPreserves={};var e=function(e,t,n,r){var i=new LiveRange(Spark._TAG,t,n,r);return i.type=e,i},t=function(e,t){for(var n=LiveRange.findRange(Spark._TAG,t);n&&n.type!==e;)n=n.findParent();return n},n=function(e,t){do t=t.findParent();while(t&&t.type!==e);return t},r=function(e,t){for(var n=new LiveRange(Spark._TAG,e,t,!0),r=n;r;r=r.findParent())r.type===Spark._ANNOTATION_WATCH&&r.notify();n.destroy()},i=!1,o=function(e){var t=i;i=!0;try{return e()}finally{i=t}};Spark._Renderer=function(){this.annotations={},this._branchNotes={},this.currentBranch=this.newLabelStack(),this.landmarkRanges=[],this.pc=new l},_.extend(Spark._Renderer.prototype,{annotate:function(t,n,r){if("function"!=typeof r){var i=r;r=function(e){e&&_.extend(e,i)}}var o=(n||"")+":"+Random.id();return this.annotations[o]=function(t,i){if(!t||!n)return r(null),void 0;var o=e(n,t,i);r(o)},"<$"+o+">"+t+"</$"+o+">"},newLabelStack:function(){var e=[this._branchNotes];return{pushLabel:function(t){var n=e[e.length-1],r="_"+t;e.push(n[r]=n[r]||{})},popLabel:function(){e.pop()},getNotes:function(){var t=e[e.length-1];return t},mark:function(t){for(var n=e.length-1;n>=0&&!e[n][t];n--)e[n][t]=!0}}},materialize:function(e){var t=this,n=Spark._currentRenderer.withValue(t,e);n=t.annotate(n);var r,i={},o=function(e){for(var t=e.firstChild;t;){var n=t.nextSibling;if(8===t.nodeType){var r=i[t.nodeValue];if(r===!1)throw Error("Spark HTML fragments may only be used once. Second use in "+DomUtils.fragmentToHtml(e));r&&(i[t.nodeValue]=!1,DomUtils.wrapFragmentForContainer(r,t.parentNode),t.parentNode.replaceChild(r,t))}else 1===t.nodeType&&o(t);t=n}},a=[[]],l=[],u=/<(\/?)\$([^<>]+)>|<|[^<]+/g;u.lastIndex=0;for(var c;c=u.exec(n);){var d=!c[1],f=c[2],p=t.annotations[f];if(p===!1)throw Error("Spark HTML fragments may be used only once. Second use of: "+DomUtils.fragmentToHtml(i[f]));if(p)if(d)l.push(f),a.push([]);else{var h=l.pop();if(h!==f)throw Error("Range mismatch: "+h+" / "+f);var m=DomUtils.htmlToFragment(a.pop().join(""));if(o(m),m.firstChild||m.appendChild(document.createComment("empty")),p(m.firstChild,m.lastChild),t.annotations[f]=!1,!l.length){r=m;break}i[f]=m,a[a.length-1].push("<!--"+f+"-->")}else a[a.length-1].push(c[0])}return s(r,t.landmarkRanges),t.landmarkRanges=[],_.each(t.annotations,function(e){e&&e()}),t.annotations={},_.each(DomUtils.findAll(r,"[value], textarea, select"),function(e){e._sparkOriginalRenderedValue=[DomUtils.getElementValue(e)]}),_.each(DomUtils.findAll(r,"input[type=checkbox], input[type=radio]"),function(e){e._sparkOriginalRenderedChecked=[!!e.checked]}),r}});var a=function(e){return function(){var t=Spark._currentRenderer.get(),n=_.toArray(arguments);return t?(n.push(t),e.apply(null,n)):n.pop()}},s=function(e,t){var i=new LiveRange(Spark._TAG,e),o=!1;i.finalize=function(){o=!0},Deps.afterFlush(function(){if(!o){if(!DomUtils.isInDocument(i.firstNode())){for(var e=i.firstNode();e.parentNode;)e=e.parentNode;if(!e._protect)return Spark.finalize(e),void 0}_.each(t,function(e){e.isPreservedConstant||e.rendered.call(e.landmark)});for(var a=i;a=n(Spark._ANNOTATION_LANDMARK,a);)a.rendered.call(a.landmark);r(i.firstNode(),i.lastNode()),i.destroy()}})};Spark.render=function(e){var t=new Spark._Renderer,n=t.materialize(e);return n};var l=function(){this.roots=[],this.regionPreservations=[]};_.extend(l.prototype,{addRoot:function(e,t,n,r){var i=this;i.roots.push({context:r,preserve:e,fromRange:t,toRange:n})},addConstantRegion:function(e,t){var n=this;n.regionPreservations.push({type:"region",fromStart:e.firstNode(),fromEnd:e.lastNode(),newRange:t})},computePreservations:function(e,t){var n=this,r=_.clone(n.regionPreservations),i=function(e,t,n,r,i){e=e||t.containerNode();var o=DomUtils.findAllClipped(e,r,t.firstNode(),t.lastNode());_.each(o,function(e){var t=n(e);t&&i(e,t)})};_.each(n.roots,function(e){e.fromNodesByLabel={},_.each(e.preserve,function(t,n){e.fromNodesByLabel[n]={},i(e.context,e.fromRange,t,n,function(t,r){e.fromNodesByLabel[n][r]=t})})});var o=new LiveRange(Spark._TAG,t.firstNode(),t.lastNode()),a=document.createDocumentFragment();a.appendChild(document.createComment(""));var s=o.replaceContents(a),l=new LiveRange(Spark._TAG,s);e.insertBefore(s),_.each(n.roots,function(e){_.each(e.preserve,function(t,n){i(e.context,e.toRange,t,n,function(t,i){var o=e.fromNodesByLabel[n][i];o&&(r.push({type:"node",from:o,to:t}),e.fromNodesByLabel[n][i]=null)})})});var u=l.extract();return l.destroy(),o.replaceContents(u),o.destroy(),r}}),Spark.renderToRange=function(e,t){var n=e.firstNode();if(n&&n.parentNode){var r=new Spark._Renderer,i=function(e,t){var n=r.newLabelStack();e.visit(function(e,r){r.type===Spark._ANNOTATION_LABEL?e?n.pushLabel(r.label):n.popLabel():r.type===Spark._ANNOTATION_LANDMARK&&e&&t(r,n.getNotes())})};i(e,function(e,t){t.originalRange=e});var a=DomUtils.findAllClipped(e.containerNode(),"input[type=radio]",e.firstNode(),e.lastNode());_.each(a,function(e){e._currentChecked=[!!e.checked]});var s=r.materialize(t);DomUtils.wrapFragmentForContainer(s,e.containerNode());var l=new LiveRange(Spark._TAG,s),u=r.pc;i(l,function(e,t){t.originalRange&&(e.constant&&u.addConstantRegion(t.originalRange,e),u.addRoot(e.preserve,t.originalRange,e))});for(var c=e;(c=c.findParent())&&c.firstNode().parentNode;)c.type===Spark._ANNOTATION_LANDMARK,c&&u.addRoot(c.preserve,e,l,c.containerNode());u.addRoot(Spark._globalPreserves,e,l);var d=u.computePreservations(e,l);l.destroy();var f={};o(function(){e.operate(function(e,t){Spark.finalize(e,t),Spark._patch(e.parentNode,s,e.previousSibling,t.nextSibling,d,f)})}),_.each(f.regionPreservations,function(e){e.isPreservedConstant=!0})}},Spark.finalize=function(e,t){if(!e.parentNode&&11!==e.nodeType){var n=document.createDocumentFragment();n.appendChild(e),e=n,t=null}var r=new LiveRange(Spark._TAG,e,t);r.visit(function(e,t){e&&t.finalize&&t.finalize()}),r.destroy(!0)},Spark.setDataContext=a(function(e,t,n){return n.annotate(t,Spark._ANNOTATION_DATA,{data:e})}),Spark.getDataContext=function(e){var n=t(Spark._ANNOTATION_DATA,e);return n&&n.data};var u=null,c=function(){return u||(u=new UniversalEventListener(function(e){if(!i){for(var r=[],o=t(Spark._ANNOTATION_EVENTS,e.currentTarget);o;)r.push(o),o=n(Spark._ANNOTATION_EVENTS,o);_.each(r,function(t){t.handler(e)})}},Spark._checkIECompliance)),u};Spark.attachEvents=a(function(e,t,r){var i=c(),o={};_.each(e,function(e,t){"function"==typeof e&&(e=[e]);var n=t.split(/,\s+/);_.each(n,function(t){var n=t.split(/\s+/);if(0!==n.length){var r=n.shift(),i=n.join(" ");o[r]=o[r]||[],_.each(e,function(e){o[r].push({selector:i,callback:e})})}})});var a=_.keys(o),s=function(e){_.each(a,function(t){for(var n=e.firstNode(),r=e.lastNode().nextSibling;n&&n!==r;n=n.nextSibling)i.installHandler(n,t)})};t=r.annotate(t,Spark._ANNOTATION_WATCH,{notify:function(){s(this)}});var l=!1;return t=r.annotate(t,Spark._ANNOTATION_EVENTS,function(e){e&&(_.each(a,function(e){i.addType(e)}),s(e),e.finalize=function(){l=!0},e.handler=function(t){for(var r=o[t.type]||[],i=0;r.length>i;i++){if(l||t.isImmediatePropagationStopped())return;var a=r[i],s=a.callback,u=a.selector;if(u){if(!DomUtils.matchesSelectorClipped(t.currentTarget,e.containerNode(),u,e.firstNode(),e.lastNode()))continue}else if(t.currentTarget!==t.target)continue;var c=Spark.getDataContext(t.currentTarget)||{},d=n(Spark._ANNOTATION_LANDMARK,e),f=d&&d.landmark,p=s.call(c,t,f);p===!1&&(t.stopImmediatePropagation(),t.preventDefault())}})})}),Spark.isolate=function(e){var t=Spark._currentRenderer.get();if(!t)return e();var n,r,i=!0;return Deps.autorun(function(o){i?(r=t.annotate(e(),Spark._ANNOTATION_ISOLATE,function(e){e?(n=e,n.finalize=function(){o.stop()}):o.stop()}),i=!1):Spark.renderToRange(n,e)}),r};var d,f=function(e,t){_.each(t,function(t,n){void 0===t?delete e[n]:e[n]=t})};d="undefined"!=typeof LocalCollection?function(e){return null===e?e:LocalCollection._idStringify(e)}:function(e){return e},Spark.list=function(t,r,i){i=i||function(){return""};var a={},s={};_.each(["addedBefore","removed","movedBefore","changed"],function(e){s[e]=function(){return a[e].apply(null,arguments)}});var l=new OrderedDict(d);_.extend(a,{addedBefore:function(e,t,n){var r=EJSON.clone(t);r._id=e;var i={doc:r,liveRange:null};l.putBefore(e,i,n)}});var u,c=t.observeChanges(s),p=Spark._currentRenderer.get(),h=p?_.bind(p.annotate,p):function(e){return e},m=function(e){return t.getTransform&&t.getTransform()?t.getTransform()(EJSON.clone(e)):e},g="";l.empty()?g=i():l.forEach(function(e){g+=h(r(m(e.doc)),Spark._ANNOTATION_LIST_ITEM,function(t){e.liveRange=t})});var v=!1,y=function(){c.stop(),v=!0};g=h(g,Spark._ANNOTATION_LIST,function(e){e?(u=e,u.finalize=y):y()}),p||y();var b=function(){for(var e=u;e=n(Spark._ANNOTATION_LANDMARK,e);)e.rendered.call(e.landmark)},w=function(e){Deps.afterFlush(function(){v||o(e)})};return _.extend(a,{addedBefore:function(t,n,i){w(function(){var o=EJSON.clone(n);o._id=t;var a=Spark.render(_.bind(r,null,m(o)));DomUtils.wrapFragmentForContainer(a,u.containerNode());var s=e(Spark._ANNOTATION_LIST_ITEM,a);l.empty()?Spark.finalize(u.replaceContents(a)):null===i?l.lastValue().liveRange.insertAfter(a):l.get(i).liveRange.insertBefore(a),l.putBefore(t,{doc:o,liveRange:s},i)})},removed:function(e){w(function(){if(l.first()===l.last()){var t=Spark.render(i);DomUtils.wrapFragmentForContainer(t,u.containerNode()),Spark.finalize(u.replaceContents(t))}else Spark.finalize(l.get(e).liveRange.extract());l.remove(e),b()})},movedBefore:function(e,t){w(function(){var n=l.get(e).liveRange.extract();null===t?l.lastValue().liveRange.insertAfter(n):l.get(t).liveRange.insertBefore(n),l.moveBefore(e,t),b()})},changed:function(e,t){w(function(){var n=l.get(e);if(!n)throw Error("Unknown id for changed: "+e);f(n.doc,t),Spark.renderToRange(n.liveRange,_.bind(r,null,m(n.doc)))})}}),g};var p=1;Spark.Landmark=function(){this.id=p++,this._range=null},_.extend(Spark.Landmark.prototype,{firstNode:function(){return this._range.firstNode()},lastNode:function(){return this._range.lastNode()},find:function(e){var t=this._range;return DomUtils.findClipped(t.containerNode(),e,t.firstNode(),t.lastNode())},findAll:function(e){var t=this._range;return DomUtils.findAllClipped(t.containerNode(),e,t.firstNode(),t.lastNode())},hasDom:function(){return!!this._range}}),Spark.UNIQUE_LABEL=["UNIQUE_LABEL"],Spark.labelBranch=function(e,t){var n=Spark._currentRenderer.get();if(!n||null===e)return t();e===Spark.UNIQUE_LABEL&&(e=Random.id()),n.currentBranch.pushLabel(e);var r=t(),i=n.currentBranch.getNotes().occupied;return n.currentBranch.popLabel(),i?n.annotate(r,Spark._ANNOTATION_LABEL,{label:e}):r},Spark.createLandmark=function(e,t){var n=Spark._currentRenderer.get();if(!n){var r=new Spark.Landmark;e.created&&e.created.call(r);var i=t(r);return e.destroyed&&e.destroyed.call(r),i}var o={};_.isArray(e.preserve)?_.each(e.preserve,function(e){o[e]=!0}):o=e.preserve||{};for(var a in o)"function"!=typeof o[a]&&(o[a]=function(){return!0});n.currentBranch.mark("occupied");var r,s=n.currentBranch.getNotes();if(s.originalRange){if(s.originalRange.superceded)throw Error("Can't create second landmark in same branch");s.originalRange.superceded=!0,r=s.originalRange.landmark}else r=new Spark.Landmark,e.created&&Deps.nonreactive(function(){e.created.call(r)});s.landmark=r;var i=t(r);return n.annotate(i,Spark._ANNOTATION_LANDMARK,function(t){return t?(_.extend(t,{preserve:o,constant:!!e.constant,rendered:e.rendered||function(){},destroyed:e.destroyed||function(){},landmark:r,finalize:function(){this.superceded||(this.landmark._range=null,this.destroyed.call(this.landmark))}}),r._range=t,n.landmarkRanges.push(t),void 0):(e.destroyed&&e.destroyed.call(r),void 0)})},Spark._getEnclosingLandmark=function(e){var n=t(Spark._ANNOTATION_LANDMARK,e);return n?n.landmark:null}}(),function(){Spark._patch=function(e,t,n,r,i,o){var a=function(e,t){LiveRange.transplantTag(Spark._TAG,e,t)},s=new Spark._Patcher(e,t,n,r),l=function(e,t,n,r){for(var i=t?t.nextSibling:e.firstChild;i&&i!==n;i=i.nextSibling)r(i)!==!1&&i.firstChild&&l(i,null,null,r)};o=o||{};var u=o.regionPreservations=o.regionPreservations||[],c=null;return l(t,null,null,function(e){var t=_.find(i,function(t){return"region"===t.type&&t.newRange.firstNode()===e})||_.find(i,function(t){return"node"===t.type&&t.to===e});if(t){var n="region"===t.type?t.fromStart:t.from;if(!c||0>DomUtils.compareElementIndex(c,n))if("region"===t.type)s.match(t.fromStart,t.newRange.firstNode(),a,!0)&&(s.skipToSiblings(t.fromEnd,t.newRange.lastNode()),LiveRange.transplantRange(t.fromStart,t.fromEnd,t.newRange),u.push(t.newRange));else if("node"===t.type&&s.match(n,e,a))return c=n,(n.firstChild||e.firstChild)&&"TEXTAREA"!==n.nodeName&&"SELECT"!==n.nodeName&&Spark._patch(n,e,null,null,i),!1}return!0}),s.finish(),o},Spark._Patcher=function(e,t,n,r){this.tgtParent=e,this.srcParent=t,this.tgtBefore=n,this.tgtAfter=r,this.lastKeptTgtNode=null,this.lastKeptSrcNode=null},Spark._Patcher.prototype.match=function(e,t,n,r){var i=this.lastKeptTgtNode,o=this.lastKeptSrcNode,a=e,s=t;if(!a!=!s)return!1;var l=!i,u=!a;if(!l){for(;!(i.parentNode===this.tgtParent||a&&DomUtils.elementContains(i.parentNode,a));)this._replaceNodes(i,null,o,null),i=i.parentNode,o=o.parentNode;if(this.lastKeptTgtNode=i,this.lastKeptSrcNode=o,!u&&(DomUtils.elementContains(o,s)||o.parentNode!==this.srcParent&&!DomUtils.elementContains(o.parentNode,s)))return!1}if(u)this._replaceNodes(i,null,o,null,this.tgtParent,this.srcParent);else{if(!r&&a.nodeName!==s.nodeName)return!1;for(var c=a.parentNode,d=s.parentNode;c!==(l?this.tgtParent:i.parentNode);c=c.parentNode,d=d.parentNode){if(d===(l?this.srcParent:o.parentNode))return!1;if(c.nodeName!==d.nodeName)return!1}if(d!==(l?this.srcParent:o.parentNode))return!1;for(var f=!0;;){if(f&&r||(1===a.nodeType&&Spark._Patcher._copyAttributes(a,s),n&&n(a,s)),f=!1,(l?this.tgtParent:i.parentNode)===a.parentNode){this._replaceNodes(i,a,o,s);break}this._replaceNodes(null,a,null,s),a=a.parentNode,s=s.parentNode}}return this.lastKeptTgtNode=e,this.lastKeptSrcNode=t,!0},Spark._Patcher.prototype.skipToSiblings=function(e,t){var n=this.lastKeptTgtNode,r=this.lastKeptSrcNode;return n&&n.parentNode===e.parentNode?r&&r.parentNode===t.parentNode?(this.lastKeptTgtNode=e,this.lastKeptSrcNode=t,!0):!1:!1},Spark._Patcher.prototype.finish=function(){return this.match(null,null)},Spark._Patcher.prototype._replaceNodes=function(e,t,n,r,i,o){var a=i||(e||t).parentNode,s=o||(n||r).parentNode;a===this.tgtParent&&(e=e||this.tgtBefore,t=t||this.tgtAfter),s===this.srcParent&&(n=n||this.srcBefore,r=r||this.srcAfter);for(var l;(l=e?e.nextSibling:a.firstChild)&&l!==t;)a.removeChild(l);for(var u;(u=n?n.nextSibling:s.firstChild)&&u!==r;)a.insertBefore(u,t||null)},Spark._Patcher._copyAttributes=function(e,t){var n=t.attributes,r=e.attributes,i=e===document.activeElement;e.style.cssText&&(e.style.cssText="");var o=!1,a=null;if("INPUT"===e.nodeName&&(o="radio"===e.type,o||"checkbox"===e.type)){var s=!!e._sparkOriginalRenderedChecked&&e._sparkOriginalRenderedChecked[0],l=!!t._sparkOriginalRenderedChecked&&t._sparkOriginalRenderedChecked[0],u=e._currentChecked?e._currentChecked[0]:e.checked;s===l?a=u:(a=l,e._sparkOriginalRenderedChecked=[a])}for(var c=r.length-1;c>=0;c--){var d=r[c];if(d.specified){var f=d.name;if(r[f]&&"id"!==f&&"type"!==f&&(!o||"name"!==f)&&"value"!==f&&"src"!==f){var p=e[f];(!p||"object"!=typeof p&&!/^jQuery/.test(f))&&e.removeAttributeNode(d)}}}if(e.mergeAttributes){var h=t._sparkOriginalRenderedValue;t.removeAttribute("_sparkOriginalRenderedValue"),e.mergeAttributes(t),h&&(t._sparkOriginalRenderedValue=h),t.name&&(e.name=t.name)}else for(var c=0,m=n.length;m>c;c++){var g=n.item(c);if(g.specified){var f=g.name.toLowerCase(),v=g.value+"";if("type"===f);else if("checked"===f);else if("style"===f)e.style.cssText=t.style.cssText;else if("class"===f)e.className=t.className;else if("value"===f);else if("src"===f)t.src!==e.src&&(e.src=t.src);else try{e.setAttribute(f,v)}catch(_){throw Error("Error copying attribute '"+f+"': "+_)}}}var y=function(e){return e._sparkOriginalRenderedValue?e._sparkOriginalRenderedValue[0]:null},b=y(t),w=y(e),S=DomUtils.getElementValue(e);if("SELECT"===e.nodeName){for(;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.insertBefore(t.firstChild,null);DomUtils.setElementValue(e,S)}b===w||S!==b&&i||(S!==b&&DomUtils.setElementValue(e,b),e._sparkOriginalRenderedValue=[b]),null!==a&&(e.checked!==a&&(e.checked=a),e.defaultChecked=a,a?e.setAttribute("checked","checked"):e.removeAttribute("checked"))}}(),function(){Meteor.render=function(e){return Spark.render(function(){return Spark.isolate("function"==typeof e?e:function(){return e+""})})},Meteor.renderList=function(e,t,n){return Spark.render(function(){return Spark.list(e,function(e){return Spark.labelBranch(e._id||null,function(){return Spark.isolate(_.bind(t,null,e))})},function(){return n?Spark.isolate(n):""})})}}(),function(){Spark._labelFromIdOrName=function(e){var t=null;if(1===e.nodeType)if(e.getAttribute("id"))t="#"+e.getAttribute("id");else if(e.getAttribute("name"))for(t=e.getAttribute("name"),"INPUT"!==e.nodeName||"radio"!==e.type&&"checkbox"!==e.type||!e.value||(t=t+":"+e.value);e.parentNode&&1===e.parentNode.nodeType;){if(e=e.parentNode,e.id){t="#"+e.id+"/"+t;break}e.getAttribute("name")&&(t=e.getAttribute("name")+"/"+t)}return t}}(),function(){Meteor._partials={},Meteor._hook_handlebars=function(){Meteor._hook_handlebars=function(){};var e=Handlebars._default_helpers.each;Handlebars._default_helpers.each=function(t,n){return t&&"observeChanges"in t?Spark.list(t,function(e){return Spark.labelBranch(e&&e._id||Spark.UNIQUE_LABEL,function(){var t=Spark.isolate(_.bind(n.fn,null,e));return Spark.setDataContext(e,t)})},function(){return n.inverse?Spark.isolate(n.inverse):""}):e.call(this,t,n)},_.extend(Handlebars._default_helpers,{isolate:function(e){var t=this;return Spark.isolate(function(){return e.fn(t)})},constant:function(e){var t=this;return Spark.createLandmark({constant:!0},function(){return e.fn(t)})}})};var e={},t=function(t){var n=e[t.id]||(e[t.id]={find:function(e){if(!t.hasDom())throw Error("Template not in DOM");return t.find(e)},findAll:function(e){if(!t.hasDom())throw Error("Template not in DOM");return t.findAll(e)}});return n.firstNode=t.hasDom()?t.firstNode():null,n.lastNode=t.hasDom()?t.lastNode():null,n};Meteor._template_decl_methods={_tmpl_data:null,events:function(e){var t=this._tmpl_data.events=this._tmpl_data.events||{};
_.each(e,function(e,n){t[n]=t[n]||[],t[n].push(e)})},preserve:function(e){var t=this._tmpl_data.preserve=this._tmpl_data.preserve||{};_.isArray(e)?_.each(e,function(e){t[e]=!0}):_.extend(t,e)},helpers:function(e){var t=this._tmpl_data.helpers=this._tmpl_data.helpers||{};for(var n in e)t[n]=e[n]}},Meteor._def_template=function(n,r){Meteor._hook_handlebars(),window.Template=window.Template||{};var i=function(o){var a=n&&Template[n]||{},s=a._tmpl_data||{},l=Spark.labelBranch("Template."+n,function(){var l=Spark.createLandmark({preserve:s.preserve||{},created:function(){var e=t(this);e.data=o,a.created&&a.created.call(e)},rendered:function(){var e=t(this);e.data=o,a.rendered&&a.rendered.call(e)},destroyed:function(){a.destroyed&&a.destroyed.call(t(this)),delete e[this.id]}},function(){var e=Spark.isolate(function(){return r(o,{helpers:_.extend({},i,s.helpers||{}),partials:Meteor._partials,name:n})}),l=function(e){var n={};return _.each(e,function(e,r){"function"==typeof e&&(e=[e]),n[r]=_.map(e,function(e){return function(n,r){return e.call(this,n,t(r))}})}),n},u=a.events!==Meteor._template_decl_methods.events?a.events:s.events;return a.events&&(e=Spark.attachEvents(l(u),e)),e});return l=Spark.setDataContext(o,l)});return l};if(_.extend(i,Handlebars.helpers),n){if(Template[n])throw Error("There are multiple templates named '"+n+"'. Each template needs a unique name.");Template[n]=i,_.extend(i,Meteor._template_decl_methods),i._tmpl_data={},Meteor._partials[n]=i}return i}}(),function(){var e=[],t="loaded"===document.readyState||"complete"==document.readyState,n=function(){for(t=!0;e.length;)e.shift()()};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("load",n)),Meteor.startup=function(n){var r=!document.addEventListener&&document.documentElement.doScroll;if(r&&window===top){try{r("left")}catch(i){return setTimeout(function(){Meteor.startup(n)},50),void 0}n()}else t?n():e.push(n)}}(),function(){Handlebars={},Handlebars.json_ast_to_func=function(e){return function(t,n){return Handlebars.evaluate(e,t,n)}},Handlebars._default_helpers={"with":function(e,t){return!e||e instanceof Array&&!e.length?t.inverse(this):t.fn(e)},each:function(e,t){var n=this;return e&&e.length>0?_.map(e,function(e){var n=e&&e._id||("string"==typeof e?e:null)||Spark.UNIQUE_LABEL;return Spark.labelBranch(n,function(){return t.fn(e)})}).join(""):Spark.labelBranch("else",function(){return t.inverse(n)})},"if":function(e,t){return!e||e instanceof Array&&!e.length?t.inverse(this):t.fn(this)},unless:function(e,t){return!e||e instanceof Array&&!e.length?t.fn(this):t.inverse(this)}},Handlebars.registerHelper=function(e,t){if(e in Handlebars._default_helpers)throw Error("There is already a helper '"+e+"'");Handlebars._default_helpers[e]=t},Handlebars._escape=function(){var e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","&":"&amp;"},t=function(t){return e[t]};return function(e){return e.replace(/[&<>"'`]/g,t)}}(),Handlebars._defaultThis=function(){return this}(),Handlebars.evaluate=function(e,t,n){n=n||{};var r=_.extend({},Handlebars._default_helpers);_.extend(r,n.helpers||{});var i=n.partials||{},o=function(e,t){if("object"!=typeof t)return t;for(var n=0;t[0]>n;n++){if(!e.parent)throw Error("Too many '..' segments");e=e.parent}if(1===t.length)return e.data;var i=!1;""===t[1]&&(t.splice(1,1),i=!0);var o,a=e.data;if(0===t[0]&&r.hasOwnProperty(t[1])&&!i)o=r[t[1]];else{if(!o instanceof Object&&function(){}[t[1]]!==void 0&&!i)throw Error("Can't call a helper '"+t[1]+"' because "+"it is a built-in function property in JavaScript");o=e.data&&e.data[t[1]]}for(var n=2;t.length>n;n++){if("function"==typeof o&&(o=o.call(a),a=o),void 0===o||null===o){o="";break}o=o[t[n]]}return"function"==typeof o?_.bind(o,a):o},a=function(e,t,n,r){n=n||{},t=t.slice(0);var i=t[t.length-1],a={};"object"!=typeof i||i instanceof Array||_.each(t.pop(),function(t,n){var r=o(e,t);a[n]="function"==typeof r?r():r});for(var s=function(t,n){for(var r=t.slice(1),i=0;r.length>i;i++)"function"==typeof r[i]&&(r[i]=r[i]());return n&&r.push(n),t[0].apply(e.data,r)},l=Array(t.length),u=0;t.length>u;u++)l[u]=o(e,t[u]);if("function"!=typeof l[0])return l[0];if(r&&l.length>1){var c=l[1];"function"==typeof c&&(c=s(l.slice(1),{hash:a})),l=[l[0],c],n.hash={}}else n.hash=a;return s(l,n)},s=function(e,t,n){var r,o=[],l=function(e){return"string"==typeof e?e:null===e?"null":void 0===e?"":""+e},u=function(e,t){return function(n){return(n||Handlebars._defaultThis)===(t||Handlebars._defaultThis)?e(n):Spark.setDataContext(n,e(n))}},c=function(e){return e instanceof Handlebars.SafeString?""+e:Handlebars._escape(l(e))},d=function(){return(n?n+".":"")+r},f=function(e,t){return Spark.labelBranch(e+"@"+d(),t)};return _.each(t,function(t,n){if(r=n,"string"==typeof t)o.push(t);else if("{"===t[0])o.push(f(t[1],function(){return c(a(e,t[1]))}));else if("!"===t[0])o.push(f(t[1],function(){return l(a(e,t[1]||""))}));else if("#"===t[0]){var p=d(),h=u(function(n){return s({parent:e,data:n},t[2],p)},e.data);h.fn=h,h.inverse=u(function(n){return s({parent:e,data:n},t[3]||[],p)},e.data);var m=f(t[1],function(){return l(a(e,t[1],h,!0))});o.push(m)}else{if(">"!==t[0])throw Error("bad element in template");var g=t[1];if(!(g in i))throw Error("No such template '"+g+"'");var m=f(g,function(){return l(i[g](e.data))});o.push(m)}}),o.join("")},l=(n.name||"")+"#";return s({data:t,parent:null},e,l)},Handlebars.SafeString=function(e){this.string=e},Handlebars.SafeString.prototype.toString=function(){return""+this.string}}(),function(){Meteor.is_client=Meteor.isClient,Meteor.is_server=Meteor.isServer,Meteor.autosubscribe=Deps.autorun,Meteor.flush=Deps.flush,Meteor.autorun=Deps.autorun,Deps.depend=function(e){return e.depend()},Meteor.uuid=function(){for(var e="0123456789abcdef",t=[],n=0;36>n;n++)t[n]=Random.choice(e);t[14]="4",t[19]=e.substr(8|3&parseInt(t[19],16),1),t[8]=t[13]=t[18]=t[23]="-";var r=t.join("");return r}}(),function(){(function(){var e,t=this,n=t.Backbone,r=Array.prototype.slice,i=Array.prototype.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="0.9.2";var o=t._;o||"undefined"==typeof require||(o=require("underscore"));var a=t.jQuery||t.Zepto||t.ender;e.setDomLibrary=function(e){a=e},e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=/\s+/,l=e.Events={on:function(e,t,n){var r,i,o,a,l;if(!t)return this;for(e=e.split(s),r=this._callbacks||(this._callbacks={});i=e.shift();)l=r[i],o=l?l.tail:{},o.next=a={},o.context=n,o.callback=t,r[i]={tail:a,next:l?l.next:o};return this},off:function(e,t,n){var r,i,a,l,u,c;if(i=this._callbacks){if(!(e||t||n))return delete this._callbacks,this;for(e=e?e.split(s):o.keys(i);r=e.shift();)if(a=i[r],delete i[r],a&&(t||n))for(l=a.tail;(a=a.next)!==l;)u=a.callback,c=a.context,(t&&u!==t||n&&c!==n)&&this.on(r,u,c);return this}},trigger:function(e){var t,n,i,o,a,l,u;if(!(i=this._callbacks))return this;for(l=i.all,e=e.split(s),u=r.call(arguments,1);t=e.shift();){if(n=i[t])for(o=n.tail;(n=n.next)!==o;)n.callback.apply(n.context||this,u);if(n=l)for(o=n.tail,a=[t].concat(u);(n=n.next)!==o;)n.callback.apply(n.context||this,a)}return this}};l.bind=l.on,l.unbind=l.off;var u=e.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e)),(n=T(this,"defaults"))&&(e=o.extend({},n,e)),t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=o.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=o.clone(this.attributes),this.initialize.apply(this,arguments)};o.extend(u.prototype,l,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return o.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=o.escape(null==n?"":""+n)},has:function(e){return null!=this.get(e)},set:function(e,t,n){var r,i,a;if(o.isObject(e)||null==e?(r=e,n=t):(r={},r[e]=t),n||(n={}),!r)return this;if(r instanceof u&&(r=r.attributes),n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var s=n.changes={},l=this.attributes,c=this._escapedAttributes,d=this._previousAttributes||{};for(i in r)a=r[i],(!o.isEqual(l[i],a)||n.unset&&o.has(l,i))&&(delete c[i],(n.silent?this._silent:s)[i]=!0),n.unset?delete l[i]:l[i]=a,o.isEqual(d[i],a)&&o.has(l,i)==o.has(d,i)?(delete this.changed[i],delete this._pending[i]):(this.changed[i]=a,n.silent||(this._pending[i]=!0));return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(o.clone(this.attributes),e)},fetch:function(t){t=t?o.clone(t):{};var n=this,r=t.success;return t.success=function(e,i,o){return n.set(n.parse(e,o),t)?(r&&r(n,e),void 0):!1},t.error=e.wrapError(t.error,n,t),(this.sync||e.sync).call(this,"read",this,t)},save:function(t,n,r){var i,a;if(o.isObject(t)||null==t?(i=t,r=n):(i={},i[t]=n),r=r?o.clone(r):{},r.wait){if(!this._validate(i,r))return!1;a=o.clone(this.attributes)}var s=o.extend({},r,{silent:!0});if(i&&!this.set(i,r.wait?s:r))return!1;var l=this,u=r.success;r.success=function(e,t,n){var a=l.parse(e,n);return r.wait&&(delete r.wait,a=o.extend(i||{},a)),l.set(a,r)?(u?u(l,e):l.trigger("sync",l,e,r),void 0):!1},r.error=e.wrapError(r.error,l,r);var c=this.isNew()?"create":"update",d=(this.sync||e.sync).call(this,c,this,r);return r.wait&&this.set(a,s),d},destroy:function(t){t=t?o.clone(t):{};var n=this,r=t.success,i=function(){n.trigger("destroy",n,n.collection,t)};if(this.isNew())return i(),!1;t.success=function(e){t.wait&&i(),r?r(n,e):n.trigger("sync",n,e,t)},t.error=e.wrapError(t.error,n,t);var a=(this.sync||e.sync).call(this,"delete",this,t);return t.wait||i(),a},url:function(){var e=T(this,"urlRoot")||T(this.collection,"url")||C();return this.isNew()?e:e+("/"==e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=o.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;for(;!o.isEmpty(this._pending);){this._pending={},this.trigger("change",this,e);for(var n in this.changed)this._pending[n]||this._silent[n]||delete this.changed[n];this._previousAttributes=o.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?o.has(this.changed,e):!o.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?o.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e)o.isEqual(r[i],t=e[i])||((n||(n={}))[i]=t);return n},previous:function(e){return arguments.length&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return o.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=o.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var c=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};o.extend(c.prototype,l,{model:u,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,r,a,s,l,u,c={},d={},f=[];for(t||(t={}),e=o.isArray(e)?e.slice():[e],n=0,a=e.length;a>n;n++){if(!(s=e[n]=this._prepareModel(e[n],t)))throw Error("Can't add an invalid model to a collection");l=s.cid,u=s.id,c[l]||this._byCid[l]||null!=u&&(d[u]||this._byId[u])?f.push(n):c[l]=d[u]=s}for(n=f.length;n--;)e.splice(f[n],1);for(n=0,a=e.length;a>n;n++)(s=e[n]).on("all",this._onModelEvent,this),this._byCid[s.cid]=s,null!=s.id&&(this._byId[s.id]=s);if(this.length+=a,r=null!=t.at?t.at:this.models.length,i.apply(this.models,[r,0].concat(e)),this.comparator&&this.sort({silent:!0}),t.silent)return this;for(n=0,a=this.models.length;a>n;n++)c[(s=this.models[n]).cid]&&(t.index=n,s.trigger("add",s,this,t));return this},remove:function(e,t){var n,r,i,a;for(t||(t={}),e=o.isArray(e)?e.slice():[e],n=0,r=e.length;r>n;n++)a=this.getByCid(e[n])||this.get(e[n]),a&&(delete this._byId[a.id],delete this._byCid[a.cid],i=this.indexOf(a),this.models.splice(i,1),this.length--,t.silent||(t.index=i,a.trigger("remove",a,this,t)),this._removeReference(a));return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,o.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return o.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(e||(e={}),!this.comparator)throw Error("Cannot sort a set without a comparator");var t=o.bind(this.comparator,this);return 1==this.comparator.length?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return o.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,o.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var n=this,r=t.success;return t.success=function(e,i,o){n[t.add?"add":"reset"](n.parse(e,o),t),r&&r(n,e)},t.error=e.wrapError(t.error,n,t),(this.sync||e.sync).call(this,"read",this,t)},create:function(e,t){var n=this;if(t=t?o.clone(t):{},e=this._prepareModel(e,t),!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,o){t.wait&&n.add(i,t),r?r(i,o):i.trigger("sync",e,o,t)},e.save(null,t),e},parse:function(e){return e},chain:function(){return o(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){if(t||(t={}),e instanceof u)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){("add"!=e&&"remove"!=e||n==this)&&("destroy"==e&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments))}});var d=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];o.each(d,function(e){c.prototype[e]=function(){return o[e].apply(o,[this.models].concat(o.toArray(arguments)))}});var f=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,h=/\*\w+/g,m=/[-[\]{}()+?.,\\^$|#\s]/g;o.extend(f.prototype,l,{initialize:function(){},route:function(t,n,r){return e.history||(e.history=new g),o.isRegExp(t)||(t=this._routeToRegExp(t)),r||(r=this[n]),e.history.route(t,o.bind(function(i){var o=this._extractParameters(t,i);r&&r.apply(this,o),this.trigger.apply(this,["route:"+n].concat(o)),e.history.trigger("route",this,n,o)},this)),this},navigate:function(t,n){e.history.navigate(t,n)},_bindRoutes:function(){if(this.routes){var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;r>n;n++)this.route(e[n][0],e[n][1],this[e[n][1]])}},_routeToRegExp:function(e){return e=e.replace(m,"\\$&").replace(p,"([^/]+)").replace(h,"(.*?)"),RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var g=e.History=function(){this.handlers=[],o.bindAll(this,"checkUrl")},v=/^[#\/]/,_=/msie [\w.]+/;g.started=!1,o.extend(g.prototype,l,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(v,"")},start:function(e){if(g.started)throw Error("Backbone.history has already been started");if("undefined"==typeof window)throw Error("Backbone.History is client-only, can't start on the server");g.started=!0,this.options=o.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=_.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);r&&(this.iframe=a('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?a(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?a(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,s=i.pathname==this.options.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(v,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){a(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),g.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e==this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e==this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=o.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return n},navigate:function(e,t){if(!g.started)return!1;t&&t!==!0||(t={trigger:t});var n=(e||"").replace(v,"");this.fragment!=n&&(this._hasPushState?(0!=n.indexOf(this.options.root)&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e))},_updateHash:function(e,t,n){n?e.replace((""+e).replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var y=e.View=function(e){this.cid=o.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName"];o.extend(y.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&a(r).attr(t),n&&a(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof a?e:a(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=T(this,"events"))){this.undelegateEvents();for(var t in e){var n=e[t];if(o.isFunction(n)||(n=this[e[t]]),!n)throw Error('Method "'+e[t]+'" does not exist');var r=t.match(b),i=r[1],a=r[2];n=o.bind(n,this),i+=".delegateEvents"+this.cid,""===a?this.$el.bind(i,n):this.$el.delegate(a,i,n)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=o.extend({},this.options,e));for(var t=0,n=w.length;n>t;t++){var r=w[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var e=T(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}}});var S=function(e,t){var n=E(this,e,t);return n.extend=this.extend,n};u.extend=c.extend=f.extend=y.extend=S;var k={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(t,n,r){var i=k[t];r||(r={});var s={type:i,dataType:"json"};return r.url||(s.url=T(n,"url")||C()),r.data||!n||"create"!=t&&"update"!=t||(s.contentType="application/json",s.data=JSON.stringify(n.toJSON())),e.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),e.emulateHTTP&&("PUT"===i||"DELETE"===i)&&(e.emulateJSON&&(s.data._method=i),s.type="POST",s.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",i)}),"GET"===s.type||e.emulateJSON||(s.processData=!1),a.ajax(o.extend(s,r))},e.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var x=function(){},E=function(e,t,n){var r;return r=t&&t.hasOwnProperty("constructor")?t.constructor:function(){e.apply(this,arguments)},o.extend(r,e),x.prototype=e.prototype,r.prototype=new x,t&&o.extend(r.prototype,t),n&&o.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},T=function(e,t){return e&&e[t]?o.isFunction(e[t])?e[t]():e[t]:null},C=function(){throw Error('A "url" property or function must be specified')}}).call(this)}(),function(){window.localStorage||(window.localStorage=function(){if($.browser.msie){var e=document.createElement("span");e.style.behavior='url("#default#userData")',e.id="localstorage-polyfill-helper",e.style.display="none",document.getElementsByTagName("head")[0].appendChild(e);var t="localStorage";return e.load(t),{setItem:function(n,r){e.setAttribute(n,r),e.save(t)},removeItem:function(n){e.removeAttribute(n),e.save(t)},getItem:function(n){return e.load(t),e.getAttribute(n)}}}return Meteor._debug("You are running a browser with no localStorage or userData support. Logging in from one tab will not cause another tab to be logged in."),{_data:{},setItem:function(e,t){this._data[e]=t},removeItem:function(e){delete this._data[e]},getItem:function(e){return this._data[e]}}}())}(),function(){"undefined"==typeof Accounts&&(Accounts={});var e;e=window.location.hash.match(/^\#\/reset-password\/(.*)$/),e&&(Accounts._preventAutoLogin=!0,Accounts._resetPasswordToken=e[1],window.location.hash=""),e=window.location.hash.match(/^\#\/verify-email\/(.*)$/),e&&(Accounts._preventAutoLogin=!0,Accounts._verifyEmailToken=e[1],window.location.hash=""),e=window.location.hash.match(/^\#\/enroll-account\/(.*)$/),e&&(Accounts._preventAutoLogin=!0,Accounts._enrollAccountToken=e[1],window.location.hash="")}(),function(){"undefined"==typeof Accounts&&(Accounts={}),Accounts._options||(Accounts._options={}),Accounts.config=function(e){var t=["sendVerificationEmail","forbidClientAccountCreation"];_.each(_.keys(e),function(e){if(!_.contains(t,e))throw Error("Accounts.config: Invalid key: "+e)}),_.each(t,function(t){if(t in e){if(t in Accounts._options)throw Error("Can't set `"+t+"` more than once");Accounts._options[t]=e[t]}})},Meteor.users=new Meteor.Collection("users",{_preventAutopublish:!0}),Accounts.loginServiceConfiguration=new Meteor.Collection("meteor_accounts_loginServiceConfiguration",{_preventAutopublish:!0}),Accounts.ConfigError=function(e){this.message=e},Accounts.ConfigError.prototype=Error(),Accounts.ConfigError.prototype.name="Accounts.ConfigError",Accounts.LoginCancelledError=function(e){this.message=e},Accounts.LoginCancelledError.numericError=145546287,Accounts.LoginCancelledError.prototype=Error(),Accounts.LoginCancelledError.prototype.name="Accounts.LoginCancelledError"}(),function(){Meteor.userId=function(){return Meteor.default_connection.userId()};var e=!1,t=new Deps.Dependency;Accounts._setLoggingIn=function(n){e!==n&&(e=n,t.changed())},Meteor.loggingIn=function(){return t.depend(),e},Meteor.user=function(){var e=Meteor.userId();return e?Meteor.users.findOne(e):null},Accounts.callLoginMethod=function(e){e=_.extend({methodName:"login",methodArguments:[],_suppressLoggingIn:!1},e),_.each(["validateResult","userCallback"],function(t){e[t]||(e[t]=function(){})});var t=!1,n=function(n,r){Meteor.default_connection.onReconnect=!n&&r&&r.token?function(){t=!0,Accounts.callLoginMethod({methodArguments:[{resume:r.token}],_suppressLoggingIn:!0,userCallback:function(t){t&&Accounts._makeClientLoggedOut(),e.userCallback(t)}})}:null},r=function(n,r){if(!t){if(Accounts._setLoggingIn(!1),n||!r)return n=n||Error("No result from call to "+e.methodName),e.userCallback(n),void 0;try{e.validateResult(r)}catch(i){return e.userCallback(i),void 0}Accounts._makeClientLoggedIn(r.id,r.token),e.userCallback()}};e._suppressLoggingIn||Accounts._setLoggingIn(!0),Meteor.apply(e.methodName,e.methodArguments,{wait:!0,onResultReceived:n},r)},Accounts._makeClientLoggedOut=function(){Accounts._unstoreLoginToken(),Meteor.default_connection.setUserId(null),Meteor.default_connection.onReconnect=null},Accounts._makeClientLoggedIn=function(e,t){Accounts._storeLoginToken(e,t),Meteor.default_connection.setUserId(e)},Meteor.logout=function(e){Meteor.apply("logout",[],{wait:!0},function(t){t?e&&e(t):(Accounts._makeClientLoggedOut(),e&&e())})},"undefined"!=typeof Handlebars&&(Handlebars.registerHelper("currentUser",function(){return Meteor.user()}),Handlebars.registerHelper("loggingIn",function(){return Meteor.loggingIn()}));var n=!1,r=new Deps.Dependency;Meteor.subscribe("meteor.loginServiceConfiguration",function(){n=!0,r.changed()}),Accounts.loginServicesConfigured=function(){return n?!0:(r.depend(),!1)}}(),function(){var e="Meteor.loginToken",t="Meteor.userId";if(Accounts._isolateLoginTokenForTest=function(){e+=Random.id(),t+=Random.id()},Accounts._storeLoginToken=function(n,r){localStorage.setItem(t,n),localStorage.setItem(e,r),Accounts._lastLoginTokenWhenPolled=r},Accounts._unstoreLoginToken=function(){localStorage.removeItem(t),localStorage.removeItem(e),Accounts._lastLoginTokenWhenPolled=null},Accounts._storedLoginToken=function(){return localStorage.getItem(e)},Accounts._storedUserId=function(){return localStorage.getItem(t)},Meteor.loginWithToken=function(e,t){Accounts.callLoginMethod({methodArguments:[{resume:e}],userCallback:t})},!Accounts._preventAutoLogin){var n=Accounts._storedLoginToken();if(n){var r=Accounts._storedUserId();r&&Meteor.default_connection.setUserId(r),Meteor.loginWithToken(n,function(e){e&&(Meteor._debug("Error logging in with token: "+e),Accounts._makeClientLoggedOut())})}}Accounts._lastLoginTokenWhenPolled=n,Accounts._pollStoredLoginToken=function(){if(!Accounts._preventAutoLogin){var e=Accounts._storedLoginToken();Accounts._lastLoginTokenWhenPolled!=e&&(e?Meteor.loginWithToken(e):Meteor.logout()),Accounts._lastLoginTokenWhenPolled=e}},Accounts._enableAutoLogin=function(){Accounts._preventAutoLogin=!1,Accounts._pollStoredLoginToken()},setInterval(Accounts._pollStoredLoginToken,3e3)}(),function(){Accounts.ui||(Accounts.ui={}),Accounts.ui._options||(Accounts.ui._options={requestPermissions:{},requestOfflineToken:{}}),Accounts.ui.config=function(e){var t=["passwordSignupFields","requestPermissions","requestOfflineToken"];if(_.each(_.keys(e),function(e){if(!_.contains(t,e))throw Error("Accounts.ui.config: Invalid key: "+e)}),e.passwordSignupFields){if(!_.contains(["USERNAME_AND_EMAIL","USERNAME_AND_OPTIONAL_EMAIL","USERNAME_ONLY","EMAIL_ONLY"],e.passwordSignupFields))throw Error("Accounts.ui.config: Invalid option for `passwordSignupFields`: "+e.passwordSignupFields);if(Accounts.ui._options.passwordSignupFields)throw Error("Accounts.ui.config: Can't set `passwordSignupFields` more than once");Accounts.ui._options.passwordSignupFields=e.passwordSignupFields}e.requestPermissions&&_.each(e.requestPermissions,function(e,t){if(Accounts.ui._options.requestPermissions[t])throw Error("Accounts.ui.config: Can't set `requestPermissions` more than once for "+t);if(!(e instanceof Array))throw Error("Accounts.ui.config: Value for `requestPermissions` must be an array");Accounts.ui._options.requestPermissions[t]=e}),e.requestOfflineToken&&_.each(e.requestOfflineToken,function(e,t){if("google"!==t)throw Error("Accounts.ui.config: `requestOfflineToken` only supported for Google login at the moment.");if(Accounts.ui._options.requestOfflineToken[t])throw Error("Accounts.ui.config: Can't set `requestOfflineToken` more than once for "+t);Accounts.ui._options.requestOfflineToken[t]=e})},Accounts.ui._passwordSignupFields=function(){return Accounts.ui._options.passwordSignupFields||"EMAIL_ONLY"}}(),function(){Meteor._def_template("_loginButtons",Handlebars.json_ast_to_func(['<div id="login-buttons" class="login-buttons-dropdown-align-',["{",[[0,"align"]]],'">\n    ',["#",[[0,"if"],[0,"currentUser"]],["\n      ",["#",[[0,"if"],[0,"loggingIn"]],["\n        ","\n        ",["#",[[0,"if"],[0,"dropdown"]],["\n          ",[">","_loginButtonsLoggingIn"],"\n        "],['\n          <div class="login-buttons-with-only-one-button">\n            ',[">","_loginButtonsLoggingInSingleLoginButton"],"\n          </div>\n        "]],"\n      "],["\n        ",[">","_loginButtonsLoggedIn"],"\n      "]],"\n    "],["\n      ",[">","_loginButtonsLoggedOut"],"\n    "]],"\n  </div>"])),Meteor._def_template("_loginButtonsLoggedIn",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"dropdown"]],["\n    ",[">","_loginButtonsLoggedInDropdown"],"\n  "],['\n    <div class="login-buttons-with-only-one-button">\n      ',[">","_loginButtonsLoggedInSingleLogoutButton"],"\n    </div>\n  "]]])),Meteor._def_template("_loginButtonsLoggedOut",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"services"]],[" ","\n    ",["#",[[0,"if"],[0,"configurationLoaded"]],["\n      ",["#",[[0,"if"],[0,"dropdown"]],[" ","\n        ",[">","_loginButtonsLoggedOutDropdown"],"\n      "],["\n        ",["#",[[0,"with"],[0,"singleService"]],[" ",'\n          <div class="login-buttons-with-only-one-button">\n            ',["#",[[0,"if"],[0,"loggingIn"]],["\n              ",[">","_loginButtonsLoggingInSingleLoginButton"],"\n            "],["\n              ",[">","_loginButtonsLoggedOutSingleLoginButton"],"\n            "]],"\n          </div>\n        "]],"\n      "]],"\n    "]],"\n  "],['\n    <div class="no-services">No login services configured</div>\n  ']]])),Meteor._def_template("_loginButtonsMessages",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"errorMessage"]],['\n    <div class="message error-message">',["{",[[0,"errorMessage"]]],"</div>\n  "]],"\n  ",["#",[[0,"if"],[0,"infoMessage"]],['\n    <div class="message info-message">',["{",[[0,"infoMessage"]]],"</div>\n  "]]])),Meteor._def_template("_loginButtonsLoggingIn",Handlebars.json_ast_to_func([[">","_loginButtonsLoggingInPadding"],'\n  <div class="loading">&nbsp;</div>\n  ',[">","_loginButtonsLoggingInPadding"]])),Meteor._def_template("_loginButtonsLoggingInPadding",Handlebars.json_ast_to_func([["#",[[0,"unless"],[0,"dropdown"]],["\n    ",'\n    <div class="login-buttons-padding">\n      <div class="login-button single-login-button" style="visibility: hidden;" id="login-buttons-logout">&nbsp;</div>\n    </div>\n  '],["\n    ",'\n    <div class="login-buttons-padding" />\n  ']]]))
}(),function(){Meteor._def_template("_loginButtonsLoggedOutSingleLoginButton",Handlebars.json_ast_to_func(['<div class="login-text-and-button">\n    <div class="login-button single-login-button ',["#",[[0,"unless"],[0,"configured"]],["configure-button"]],'"\n         id="login-buttons-',["{",[[0,"name"]]],'">\n      <div class="login-image" id="login-buttons-image-',["{",[[0,"name"]]],'"></div>\n      ',["#",[[0,"if"],[0,"configured"]],['\n        <span class="text-besides-image sign-in-text-',["{",[[0,"name"]]],'">Sign in with ',["{",[[0,"capitalizedName"]]],"</span>\n      "],['\n        <span class="text-besides-image configure-text-',["{",[[0,"name"]]],'">Configure ',["{",[[0,"capitalizedName"]]]," Login</span>\n      "]],"\n    </div>\n  </div>"])),Meteor._def_template("_loginButtonsLoggingInSingleLoginButton",Handlebars.json_ast_to_func(['<div class="login-text-and-button">\n    ',[">","_loginButtonsLoggingIn"],"\n  </div>"])),Meteor._def_template("_loginButtonsLoggedInSingleLogoutButton",Handlebars.json_ast_to_func(['<div class="login-text-and-button">\n    <div class="login-display-name">\n      ',["{",[[0,"displayName"]]],'\n    </div>\n    <div class="login-button single-login-button" id="login-buttons-logout">Sign Out</div>\n  </div>']))}(),function(){Meteor._def_template("_loginButtonsLoggedInDropdown",Handlebars.json_ast_to_func(['<div class="login-link-and-dropdown-list">\n    <a class="login-link-text" id="login-name-link">\n      ',["{",[[0,"displayName"]]]," â–¾\n    </a>\n\n    ",["#",[[0,"if"],[0,"dropdownVisible"]],['\n      <div id="login-dropdown-list" class="accounts-dialog">\n        <a class="login-close-text">Close</a>\n        <div class="login-close-text-clear"></div>\n\n        ',["#",[[0,"if"],[0,"inMessageOnlyFlow"]],["\n          ",[">","_loginButtonsMessages"],"\n        "],["\n          ",["#",[[0,"if"],[0,"inChangePasswordFlow"]],["\n            ",[">","_loginButtonsChangePassword"],"\n          "],["\n            ",[">","_loginButtonsLoggedInDropdownActions"],"\n          "]],"\n        "]],"\n      </div>\n    "]],"\n  </div>"])),Meteor._def_template("_loginButtonsLoggedInDropdownActions",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"allowChangingPassword"]],['\n    <div class="login-button" id="login-buttons-open-change-password">\n      Change password\n    </div>\n  ']],'\n\n  <div class="login-button" id="login-buttons-logout">\n    Sign out\n  </div>\n\n  ',[">","_loginButtonsMessages"]])),Meteor._def_template("_loginButtonsLoggedOutDropdown",Handlebars.json_ast_to_func(['<div class="login-link-and-dropdown-list ',["{",[[0,"additionalClasses"]]],'">\n    ',["#",[[0,"if"],[0,"dropdownVisible"]],["\n      ",'\n      <a class="login-link-text" id="login-sign-in-link">Sign in â–¾</a>\n      <div id="login-dropdown-list" class="accounts-dialog">\n        <a class="login-close-text">Close</a>\n        ',["#",[[0,"if"],[0,"loggingIn"]],["\n          ",[">","_loginButtonsLoggingIn"],"\n        "]],'\n        <div class="login-close-text-clear"></div>\n        ',[">","_loginButtonsLoggedOutAllServices"],"\n      </div>\n    "],["\n      ",["#",[[0,"if"],[0,"loggingIn"]],["\n        ","\n        ",[">","_loginButtonsLoggingIn"],"\n      "],['\n        <a class="login-link-text" id="login-sign-in-link">Sign in â–¾</a>\n      ']],"\n    "]],"\n  </div>"])),Meteor._def_template("_loginButtonsLoggedOutAllServices",Handlebars.json_ast_to_func([["#",[[0,"each"],[0,"services"]],["\n    ",["#",[[0,"if"],[0,"isPasswordService"]],["\n      ",["#",[[0,"if"],[0,"hasOtherServices"]],[" ","\n        ",[">","_loginButtonsLoggedOutPasswordServiceSeparator"],"\n      "]],"\n      ",[">","_loginButtonsLoggedOutPasswordService"],"\n    "],["\n      ",[">","_loginButtonsLoggedOutSingleLoginButton"],"\n    "]],"\n  "]],"\n\n  ",["#",[[0,"unless"],[0,"hasPasswordService"]],["\n    ",[">","_loginButtonsMessages"],"\n  "]]])),Meteor._def_template("_loginButtonsLoggedOutPasswordServiceSeparator",Handlebars.json_ast_to_func(['<div class="or">\n    <span class="hline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>\n    <span class="or-text">or</span>\n    <span class="hline">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>\n  </div>'])),Meteor._def_template("_loginButtonsLoggedOutPasswordService",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"inForgotPasswordFlow"]],["\n    ",[">","_forgotPasswordForm"],"\n  "],['\n    <div class="login-form login-password-form">\n      ',["#",[[0,"each"],[0,"fields"]],["\n        ",[">","_loginButtonsFormField"],"\n      "]],"\n\n      ",[">","_loginButtonsMessages"],'\n\n      <div class="login-button login-button-form-submit" id="login-buttons-password">\n        ',["#",[[0,"if"],[0,"inSignupFlow"]],["\n          Create account\n        "],["\n          Sign in\n        "]],"\n      </div>\n\n      ",["#",[[0,"if"],[0,"inLoginFlow"]],["\n        ",["#",[[0,"if"],[0,"showCreateAccountLink"]],['\n          <div class="additional-link-container">\n            <a id="signup-link" class="additional-link">Create account</a>\n          </div>\n        ']],"\n\n        ",["#",[[0,"if"],[0,"showForgotPasswordLink"]],['\n          <div class="additional-link-container">\n            <a id="forgot-password-link" class="additional-link">Forgot password</a>\n          </div>\n        ']],"\n      "]],"\n\n      ",["#",[[0,"if"],[0,"inSignupFlow"]],["\n        ",[">","_loginButtonsBackToLoginLink"],"\n      "]],"\n    </div>\n  "]]])),Meteor._def_template("_forgotPasswordForm",Handlebars.json_ast_to_func(['<div class="login-form">\n    <div id="forgot-password-email-label-and-input"> ','\n      <label id="forgot-password-email-label" for="forgot-password-email">Email</label>\n      <input id="forgot-password-email" type="email"/>\n    </div>\n\n    ',[">","_loginButtonsMessages"],'\n\n    <div class="login-button login-button-form-submit" id="login-buttons-forgot-password">\n      Reset password\n    </div>\n\n    ',[">","_loginButtonsBackToLoginLink"],"\n  </div>"])),Meteor._def_template("_loginButtonsBackToLoginLink",Handlebars.json_ast_to_func(['<div class="additional-link-container">\n    <a id="back-to-login-link" class="additional-link">Sign in</a>\n  </div>'])),Meteor._def_template("_loginButtonsFormField",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"visible"]],['\n    <div id="login-',["{",[[0,"fieldName"]]],'-label-and-input">\n      <label id="login-',["{",[[0,"fieldName"]]],'-label" for="login-',["{",[[0,"fieldName"]]],'">\n        ',["{",[[0,"fieldLabel"]]],'\n      </label>\n      <input id="login-',["{",[[0,"fieldName"]]],'" type="',["{",[[0,"inputType"]]],'" />\n    </div>\n  ']]])),Meteor._def_template("_loginButtonsChangePassword",Handlebars.json_ast_to_func([["#",[[0,"each"],[0,"fields"]],["\n    ",[">","_loginButtonsFormField"],"\n  "]],"\n\n  ",[">","_loginButtonsMessages"],'\n\n  <div class="login-button login-button-form-submit" id="login-buttons-do-change-password">\n    Change password\n  </div>']))}(),function(){Meteor.startup(function(){document.body.appendChild(Spark.render(Meteor._def_template(null,Handlebars.json_ast_to_func([[">","_resetPasswordDialog"],"\n  ",[">","_enrollAccountDialog"],"\n  ",[">","_justVerifiedEmailDialog"],"\n  ",[">","_configureLoginServiceDialog"],"\n\n  <!-- if we're not showing a dropdown, we need some other place to show messages -->\n  ",[">","_loginButtonsMessagesDialog"]]))))}),Meteor._def_template("_resetPasswordDialog",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"inResetPasswordFlow"]],['\n    <div class="hide-background"></div>\n\n    <div class="accounts-dialog accounts-centered-dialog">\n      <label id="reset-password-new-password-label" for="reset-password-new-password">\n        New password\n      </label>\n\n      <div>\n        <input id="reset-password-new-password" type="password" />\n      </div>\n\n      ',[">","_loginButtonsMessages"],'\n\n      <div class="login-button login-button-form-submit" id="login-buttons-reset-password-button">\n        Set password\n      </div>\n\n      <a class="accounts-close" id="login-buttons-cancel-reset-password">&times;</a>\n    </div>\n  ']]])),Meteor._def_template("_enrollAccountDialog",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"inEnrollAccountFlow"]],['\n    <div class="hide-background"></div>\n\n    <div class="accounts-dialog accounts-centered-dialog">\n      <label id="enroll-account-password-label" for="enroll-account-password">\n        Choose a password\n      </label>\n\n      <div>\n        <input id="enroll-account-password" type="password" />\n      </div>\n\n      ',[">","_loginButtonsMessages"],'\n\n      <div class="login-button login-button-form-submit" id="login-buttons-enroll-account-button">\n        Create account\n      </div>\n\n      <a class="accounts-close" id="login-buttons-cancel-enroll-account">&times;</a>\n    </div>\n  ']]])),Meteor._def_template("_justVerifiedEmailDialog",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"visible"]],['\n    <div class="accounts-dialog accounts-centered-dialog">\n      Email verified\n      <div class="login-button" id="just-verified-dismiss-button">Dismiss</div>\n    </div>\n  ']]])),Meteor._def_template("_configureLoginServiceDialog",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"visible"]],['\n    <div id="configure-login-service-dialog" class="accounts-dialog accounts-centered-dialog">\n      ',["!",[[0,"configurationSteps"]]],'\n\n      <p>\n        Now, copy over some details.\n      </p>\n      <p>\n        <table>\n          <colgroup>\n            <col span="1" class="configuration_labels">\n            <col span="1" class="configuration_inputs">\n          </colgroup>\n          ',["#",[[0,"each"],[0,"configurationFields"]],['\n            <tr>\n              <td>\n                <label for="configure-login-service-dialog-',["{",[[0,"property"]]],'">',["{",[[0,"label"]]],'</label>\n              </td>\n              <td>\n                <input id="configure-login-service-dialog-',["{",[[0,"property"]]],'" type="text" />\n              </td>\n            </tr>\n          ']],'\n        </table>\n      </p>\n      <div class="new-section">\n        <div class="login-button configure-login-service-dismiss-button">\n          I\'ll do this later\n        </div>\n        <a class="accounts-close configure-login-service-dismiss-button">&times;</a>\n\n        ',["#",[[0,"isolate"]],['\n          <div class="login-button login-button-configure ',["#",[[0,"if"],[0,"saveDisabled"]],["login-button-disabled"]],'"\n             id="configure-login-service-dialog-save-configuration">\n            Save Configuration\n          </div>\n        ']],"\n      </div>\n    </div>\n  "]]])),Meteor._def_template("_loginButtonsMessagesDialog",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"visible"]],['\n    <div class="accounts-dialog accounts-centered-dialog" id="login-buttons-message-dialog">\n      ',[">","_loginButtonsMessages"],'\n      <div class="login-button" id="messages-dialog-dismiss-button">Dismiss</div>\n    </div>\n  ']]]))}(),function(){var e=["dropdownVisible","inSignupFlow","inForgotPasswordFlow","inChangePasswordFlow","inMessageOnlyFlow","errorMessage","infoMessage","resetPasswordToken","enrollAccountToken","justVerifiedEmail","configureLoginServiceDialogVisible","configureLoginServiceDialogServiceName","configureLoginServiceDialogSaveDisabled"],t=function(t){if(!_.contains(e,t))throw Error("Invalid key in loginButtonsSession: "+t)},n="Meteor.loginButtons.";Accounts._loginButtonsSession={set:function(e,n){if(t(e),_.contains(["errorMessage","infoMessage"],e))throw Error("Don't set errorMessage or infoMessage directly. Instead, use errorMessage() or infoMessage().");this._set(e,n)},_set:function(e,t){Session.set(n+e,t)},get:function(e){return t(e),Session.get(n+e)},closeDropdown:function(){this.set("inSignupFlow",!1),this.set("inForgotPasswordFlow",!1),this.set("inChangePasswordFlow",!1),this.set("inMessageOnlyFlow",!1),this.set("dropdownVisible",!1),this.resetMessages()},infoMessage:function(e){this._set("errorMessage",null),this._set("infoMessage",e),this.ensureMessageVisible()},errorMessage:function(e){this._set("errorMessage",e),this._set("infoMessage",null),this.ensureMessageVisible()},isMessageDialogVisible:function(){return this.get("resetPasswordToken")||this.get("enrollAccountToken")||this.get("justVerifiedEmail")},ensureMessageVisible:function(){this.isMessageDialogVisible()||this.set("dropdownVisible",!0)},resetMessages:function(){this._set("errorMessage",null),this._set("infoMessage",null)},configureService:function(e){this.set("configureLoginServiceDialogVisible",!0),this.set("configureLoginServiceDialogServiceName",e),this.set("configureLoginServiceDialogSaveDisabled",!0)}}}(),function(){Accounts._loginButtons||(Accounts._loginButtons={});var e=Accounts._loginButtonsSession;Handlebars.registerHelper("loginButtons",function(e){return"right"===e.hash.align?new Handlebars.SafeString(Template._loginButtons({align:"right"})):new Handlebars.SafeString(Template._loginButtons({align:"left"}))}),Template._loginButtons.events({"click #login-buttons-logout":function(){Meteor.logout(function(){e.closeDropdown()})}}),Template._loginButtons.preserve({"input[id]":Spark._labelFromIdOrName}),Template._loginButtonsLoggedOut.dropdown=function(){return Accounts._loginButtons.dropdown()},Template._loginButtonsLoggedOut.services=function(){return Accounts._loginButtons.getLoginServices()},Template._loginButtonsLoggedOut.singleService=function(){var e=Accounts._loginButtons.getLoginServices();if(1!==e.length)throw Error("Shouldn't be rendering this template with more than one configured service");return e[0]},Template._loginButtonsLoggedOut.configurationLoaded=function(){return Accounts.loginServicesConfigured()},Template._loginButtonsLoggedIn.dropdown=function(){return Accounts._loginButtons.dropdown()},Template._loginButtonsLoggedInSingleLogoutButton.displayName=function(){return Accounts._loginButtons.displayName()},Template._loginButtonsMessages.errorMessage=function(){return e.get("errorMessage")},Template._loginButtonsMessages.infoMessage=function(){return e.get("infoMessage")},Template._loginButtonsLoggingInPadding.dropdown=function(){return Accounts._loginButtons.dropdown()},Accounts._loginButtons.displayName=function(){var e=Meteor.user();return e?e.profile&&e.profile.name?e.profile.name:e.username?e.username:e.emails&&e.emails[0]&&e.emails[0].address?e.emails[0].address:"":""},Accounts._loginButtons.getLoginServices=function(){var e=[];return _.each(_.keys(Meteor),function(t){var n;if(n=t.match(/^loginWith(.*)/)){var r=n[1].toLowerCase();Accounts[r]&&e.push(n[1].toLowerCase())}}),e.sort(),_.contains(e,"password")&&(e=_.without(e,"password").concat(["password"])),_.map(e,function(e){return{name:e}})},Accounts._loginButtons.hasPasswordService=function(){return Accounts.password},Accounts._loginButtons.dropdown=function(){return Accounts._loginButtons.hasPasswordService()||Accounts._loginButtons.getLoginServices().length>1},Accounts._loginButtons.validateUsername=function(t){return t.length>=3?!0:(e.errorMessage("Username must be at least 3 characters long"),!1)},Accounts._loginButtons.validateEmail=function(t){return"USERNAME_AND_OPTIONAL_EMAIL"===Accounts.ui._passwordSignupFields()&&""===t?!0:-1!==t.indexOf("@")?!0:(e.errorMessage("Invalid email"),!1)},Accounts._loginButtons.validatePassword=function(t){return t.length>=6?!0:(e.errorMessage("Password must be at least 6 characters long"),!1)}}(),function(){var e=Accounts._loginButtonsSession;Template._loginButtonsLoggedOutSingleLoginButton.events({"click .login-button":function(){var n=this.name;e.resetMessages();var r=function(t){t?t instanceof Accounts.LoginCancelledError||(t instanceof Accounts.ConfigError?e.configureService(n):e.errorMessage(t.reason||"Unknown error")):e.closeDropdown()},i=Meteor["loginWith"+t(n)],o={};Accounts.ui._options.requestPermissions[n]&&(o.requestPermissions=Accounts.ui._options.requestPermissions[n]),Accounts.ui._options.requestOfflineToken[n]&&(o.requestOfflineToken=Accounts.ui._options.requestOfflineToken[n]),i(o,r)}}),Template._loginButtonsLoggedOutSingleLoginButton.configured=function(){return!!Accounts.loginServiceConfiguration.findOne({service:this.name})},Template._loginButtonsLoggedOutSingleLoginButton.capitalizedName=function(){return"github"===this.name?"GitHub":t(this.name)};var t=function(e){return e=null==e?"":e+"",e.charAt(0).toUpperCase()+e.slice(1)}}(),function(){var e=Accounts._loginButtonsSession;Template._loginButtons.events({"click #login-name-link, click #login-sign-in-link":function(){e.set("dropdownVisible",!0),Deps.flush(),u()},"click .login-close-text":function(){e.closeDropdown()}}),Template._loginButtonsLoggedInDropdown.events({"click #login-buttons-open-change-password":function(){e.resetMessages(),e.set("inChangePasswordFlow",!0)}}),Template._loginButtonsLoggedInDropdown.displayName=function(){return Accounts._loginButtons.displayName()},Template._loginButtonsLoggedInDropdown.inChangePasswordFlow=function(){return e.get("inChangePasswordFlow")},Template._loginButtonsLoggedInDropdown.inMessageOnlyFlow=function(){return e.get("inMessageOnlyFlow")},Template._loginButtonsLoggedInDropdown.dropdownVisible=function(){return e.get("dropdownVisible")},Template._loginButtonsLoggedInDropdownActions.allowChangingPassword=function(){var e=Meteor.user();return e.username||e.emails&&e.emails[0]&&e.emails[0].address},Template._loginButtonsLoggedOutDropdown.events({"click #login-buttons-password":function(){r()},"keypress #forgot-password-email":function(e){13===e.keyCode&&a()},"click #login-buttons-forgot-password":function(){a()},"click #signup-link":function(){e.resetMessages();var r=n("login-username"),i=n("login-email"),o=n("login-username-or-email");t("login-password"),e.set("inSignupFlow",!0),e.set("inForgotPasswordFlow",!1),Deps.flush(),null!==r?document.getElementById("login-username").value=r:null!==i?document.getElementById("login-email").value=i:null!==o&&(-1===o.indexOf("@")?document.getElementById("login-username").value=o:document.getElementById("login-email").value=o);var a=document.getElementById("login-dropdown-list");a.style.display="none",a.offsetHeight,a.style.display="block"},"click #forgot-password-link":function(){e.resetMessages();var t=n("login-email"),r=n("login-username-or-email");e.set("inSignupFlow",!1),e.set("inForgotPasswordFlow",!0),Deps.flush(),null!==t?document.getElementById("forgot-password-email").value=t:null!==r&&-1!==r.indexOf("@")&&(document.getElementById("forgot-password-email").value=r)},"click #back-to-login-link":function(){e.resetMessages();var t=n("login-username"),r=n("login-email")||n("forgot-password-email");e.set("inSignupFlow",!1),e.set("inForgotPasswordFlow",!1),Deps.flush(),document.getElementById("login-username")&&(document.getElementById("login-username").value=t),document.getElementById("login-email")&&(document.getElementById("login-email").value=r),document.getElementById("login-username-or-email")&&(document.getElementById("login-username-or-email").value=r||t)},"keypress #login-username, keypress #login-email, keypress #login-username-or-email, keypress #login-password, keypress #login-password-again":function(e){13===e.keyCode&&r()}}),Template._loginButtonsLoggedOutDropdown.additionalClasses=function(){return Accounts.password?e.get("inSignupFlow")?"login-form-create-account":e.get("inForgotPasswordFlow")?"login-form-forgot-password":"login-form-sign-in":!1},Template._loginButtonsLoggedOutDropdown.dropdownVisible=function(){return e.get("dropdownVisible")},Template._loginButtonsLoggedOutDropdown.hasPasswordService=function(){return Accounts._loginButtons.hasPasswordService()},Template._loginButtonsLoggedOutAllServices.services=function(){return Accounts._loginButtons.getLoginServices()},Template._loginButtonsLoggedOutAllServices.isPasswordService=function(){return"password"===this.name},Template._loginButtonsLoggedOutAllServices.hasOtherServices=function(){return Accounts._loginButtons.getLoginServices().length>1},Template._loginButtonsLoggedOutAllServices.hasPasswordService=function(){return Accounts._loginButtons.hasPasswordService()},Template._loginButtonsLoggedOutPasswordService.fields=function(){var t=[{fieldName:"username-or-email",fieldLabel:"Username or Email",visible:function(){return _.contains(["USERNAME_AND_EMAIL","USERNAME_AND_OPTIONAL_EMAIL"],Accounts.ui._passwordSignupFields())}},{fieldName:"username",fieldLabel:"Username",visible:function(){return"USERNAME_ONLY"===Accounts.ui._passwordSignupFields()}},{fieldName:"email",fieldLabel:"Email",inputType:"email",visible:function(){return"EMAIL_ONLY"===Accounts.ui._passwordSignupFields()}},{fieldName:"password",fieldLabel:"Password",inputType:"password",visible:function(){return!0}}],n=[{fieldName:"username",fieldLabel:"Username",visible:function(){return _.contains(["USERNAME_AND_EMAIL","USERNAME_AND_OPTIONAL_EMAIL","USERNAME_ONLY"],Accounts.ui._passwordSignupFields())}},{fieldName:"email",fieldLabel:"Email",inputType:"email",visible:function(){return _.contains(["USERNAME_AND_EMAIL","EMAIL_ONLY"],Accounts.ui._passwordSignupFields())}},{fieldName:"email",fieldLabel:"Email (optional)",inputType:"email",visible:function(){return"USERNAME_AND_OPTIONAL_EMAIL"===Accounts.ui._passwordSignupFields()}},{fieldName:"password",fieldLabel:"Password",inputType:"password",visible:function(){return!0}},{fieldName:"password-again",fieldLabel:"Password (again)",inputType:"password",visible:function(){return _.contains(["USERNAME_AND_OPTIONAL_EMAIL","USERNAME_ONLY"],Accounts.ui._passwordSignupFields())}}];return e.get("inSignupFlow")?n:t},Template._loginButtonsLoggedOutPasswordService.inForgotPasswordFlow=function(){return e.get("inForgotPasswordFlow")},Template._loginButtonsLoggedOutPasswordService.inLoginFlow=function(){return!e.get("inSignupFlow")&&!e.get("inForgotPasswordFlow")},Template._loginButtonsLoggedOutPasswordService.inSignupFlow=function(){return e.get("inSignupFlow")},Template._loginButtonsLoggedOutPasswordService.showCreateAccountLink=function(){return!Accounts._options.forbidClientAccountCreation},Template._loginButtonsLoggedOutPasswordService.showForgotPasswordLink=function(){return _.contains(["USERNAME_AND_EMAIL","USERNAME_AND_OPTIONAL_EMAIL","EMAIL_ONLY"],Accounts.ui._passwordSignupFields())},Template._loginButtonsFormField.inputType=function(){return this.inputType||"text"},Template._loginButtonsChangePassword.events({"keypress #login-old-password, keypress #login-password, keypress #login-password-again":function(e){13===e.keyCode&&s()},"click #login-buttons-do-change-password":function(){s()}}),Template._loginButtonsChangePassword.fields=function(){return[{fieldName:"old-password",fieldLabel:"Current Password",inputType:"password",visible:function(){return!0}},{fieldName:"password",fieldLabel:"New Password",inputType:"password",visible:function(){return!0}},{fieldName:"password-again",fieldLabel:"New Password (again)",inputType:"password",visible:function(){return _.contains(["USERNAME_AND_OPTIONAL_EMAIL","USERNAME_ONLY"],Accounts.ui._passwordSignupFields())}}]};var t=function(e){var t=document.getElementById(e);return t?t.value:null},n=function(e){var t=document.getElementById(e);return t?t.value.replace(/^\s*|\s*$/g,""):null},r=function(){e.get("inSignupFlow")?o():i()},i=function(){e.resetMessages();var r,i=n("login-username"),o=n("login-email"),a=n("login-username-or-email"),s=t("login-password");if(null!==i){if(!Accounts._loginButtons.validateUsername(i))return;r={username:i}}else if(null!==o){if(!Accounts._loginButtons.validateEmail(o))return;r={email:o}}else{if(null===a)throw Error("Unexpected -- no element to use as a login user selector");if(!Accounts._loginButtons.validateUsername(a))return;r=a}Meteor.loginWithPassword(r,s,function(t){t?e.errorMessage(t.reason||"Unknown error"):e.closeDropdown()})},o=function(){e.resetMessages();var r={},i=n("login-username");if(null!==i){if(!Accounts._loginButtons.validateUsername(i))return;r.username=i}var o=n("login-email");if(null!==o){if(!Accounts._loginButtons.validateEmail(o))return;r.email=o}var a=t("login-password");Accounts._loginButtons.validatePassword(a)&&(r.password=a,l()&&Accounts.createUser(r,function(t){t?e.errorMessage(t.reason||"Unknown error"):e.closeDropdown()}))},a=function(){e.resetMessages();var t=n("forgot-password-email");-1!==t.indexOf("@")?Accounts.forgotPassword({email:t},function(t){t?e.errorMessage(t.reason||"Unknown error"):e.infoMessage("Email sent")}):e.errorMessage("Invalid email")},s=function(){e.resetMessages();var n=t("login-old-password"),r=t("login-password");Accounts._loginButtons.validatePassword(r)&&l()&&Accounts.changePassword(n,r,function(t){t?e.errorMessage(t.reason||"Unknown error"):(e.set("inChangePasswordFlow",!1),e.set("inMessageOnlyFlow",!0),e.infoMessage("Password changed"))})},l=function(){var n=t("login-password-again");if(null!==n){var r=t("login-password");if(r!==n)return e.errorMessage("Passwords don't match"),!1}return!0},u=function(){for(var e=document.getElementById("login-dropdown-list").parentNode;"BODY"!==e.nodeName;e=e.parentNode)0===e.style.zIndex&&(e.style.zIndex=1)}}(),function(){var e=Accounts._loginButtonsSession;Accounts._resetPasswordToken&&e.set("resetPasswordToken",Accounts._resetPasswordToken),Accounts._enrollAccountToken&&e.set("enrollAccountToken",Accounts._enrollAccountToken),Meteor.startup(function(){Accounts._verifyEmailToken&&Accounts.verifyEmail(Accounts._verifyEmailToken,function(t){Accounts._enableAutoLogin(),t||e.set("justVerifiedEmail",!0)})}),Template._resetPasswordDialog.events({"click #login-buttons-reset-password-button":function(){t()},"keypress #reset-password-new-password":function(e){13===e.keyCode&&t()},"click #login-buttons-cancel-reset-password":function(){e.set("resetPasswordToken",null),Accounts._enableAutoLogin()}});var t=function(){e.resetMessages();var t=document.getElementById("reset-password-new-password").value;Accounts._loginButtons.validatePassword(t)&&Accounts.resetPassword(e.get("resetPasswordToken"),t,function(t){t?e.errorMessage(t.reason||"Unknown error"):(e.set("resetPasswordToken",null),Accounts._enableAutoLogin())})};Template._resetPasswordDialog.inResetPasswordFlow=function(){return e.get("resetPasswordToken")},Template._enrollAccountDialog.events({"click #login-buttons-enroll-account-button":function(){n()},"keypress #enroll-account-password":function(e){13===e.keyCode&&n()},"click #login-buttons-cancel-enroll-account":function(){e.set("enrollAccountToken",null),Accounts._enableAutoLogin()}});var n=function(){e.resetMessages();var t=document.getElementById("enroll-account-password").value;Accounts._loginButtons.validatePassword(t)&&Accounts.resetPassword(e.get("enrollAccountToken"),t,function(t){t?e.errorMessage(t.reason||"Unknown error"):(e.set("enrollAccountToken",null),Accounts._enableAutoLogin())})};Template._enrollAccountDialog.inEnrollAccountFlow=function(){return e.get("enrollAccountToken")},Template._justVerifiedEmailDialog.events({"click #just-verified-dismiss-button":function(){e.set("justVerifiedEmail",!1)}}),Template._justVerifiedEmailDialog.visible=function(){return e.get("justVerifiedEmail")},Template._loginButtonsMessagesDialog.events({"click #messages-dialog-dismiss-button":function(){e.resetMessages()}}),Template._loginButtonsMessagesDialog.visible=function(){var t=e.get("infoMessage")||e.get("errorMessage");return!Accounts._loginButtons.dropdown()&&t},Template._configureLoginServiceDialog.events({"click .configure-login-service-dismiss-button":function(){e.set("configureLoginServiceDialogVisible",!1)},"click #configure-login-service-dialog-save-configuration":function(){if(e.get("configureLoginServiceDialogVisible")&&!e.get("configureLoginServiceDialogSaveDisabled")){var t=e.get("configureLoginServiceDialogServiceName"),n={service:t};_.each(o(),function(e){n[e.property]=document.getElementById("configure-login-service-dialog-"+e.property).value.replace(/^\s*|\s*$/g,"")}),Meteor.call("configureLoginService",n,function(n){n?Meteor._debug("Error configuring login service "+t,n):e.set("configureLoginServiceDialogVisible",!1)})}},"input, keyup input":function(e){0===e.target.id.indexOf("configure-login-service-dialog")&&r()}});var r=function(){var t=_.any(o(),function(e){return""===document.getElementById("configure-login-service-dialog-"+e.property).value});e.set("configureLoginServiceDialogSaveDisabled",t)},i=function(){var t=e.get("configureLoginServiceDialogServiceName");return Template["configureLoginServiceDialogFor"+a(t)]},o=function(){var e=i();return e.fields()};Template._configureLoginServiceDialog.configurationFields=function(){return o()},Template._configureLoginServiceDialog.visible=function(){return e.get("configureLoginServiceDialogVisible")},Template._configureLoginServiceDialog.configurationSteps=function(){return i()()},Template._configureLoginServiceDialog.saveDisabled=function(){return e.get("configureLoginServiceDialogSaveDisabled")};var a=function(e){return e=null==e?"":e+"",e.charAt(0).toUpperCase()+e.slice(1)}}(),function(){Meteor._srp===void 0&&(Meteor._srp={}),Meteor._srp.BigInteger=function(){function e(e,t,n){null!=e&&("number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function t(){return new e(null)}function n(e,t,n,r,i,o){for(var a=16383&t,s=t>>14;--o>=0;){var l=16383&this[e],u=this[e++]>>14,c=s*l+u*a;l=a*l+((16383&c)<<14)+n[r]+i,i=(l>>28)+(c>>14)+s*u,n[r++]=268435455&l}return i}function r(e){return Zt.charAt(e)}function i(e,t){var n=en[e.charCodeAt(t)];return null==n?-1:n}function o(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function a(e){this.t=1,this.s=0>e?-1:0,e>0?this[0]=e:-1>e?this[0]=e+DV:this.t=0}function s(e){var n=t();return n.fromInt(e),n}function l(t,n){var r;if(16==n)r=4;else if(8==n)r=3;else if(256==n)r=8;else if(2==n)r=1;else if(32==n)r=5;else{if(4!=n)return this.fromRadix(t,n),void 0;r=2}this.t=0,this.s=0;for(var o=t.length,a=!1,s=0;--o>=0;){var l=8==r?255&t[o]:i(t,o);0>l?"-"==t.charAt(o)&&(a=!0):(a=!1,0==s?this[this.t++]=l:s+r>this.DB?(this[this.t-1]|=(l&(1<<this.DB-s)-1)<<s,this[this.t++]=l>>this.DB-s):this[this.t-1]|=l<<s,s+=r,s>=this.DB&&(s-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),a&&e.ZERO.subTo(this,this)}function u(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function c(e){if(0>this.s)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,i=(1<<t)-1,o=!1,a="",s=this.t,l=this.DB-s*this.DB%t;if(s-->0)for(this.DB>l&&(n=this[s]>>l)>0&&(o=!0,a=r(n));s>=0;)t>l?(n=(this[s]&(1<<l)-1)<<t-l,n|=this[--s]>>(l+=this.DB-t)):(n=this[s]>>(l-=t)&i,0>=l&&(l+=this.DB,--s)),n>0&&(o=!0),o&&(a+=r(n));return o?a:"0"}function d(){var n=t();return e.ZERO.subTo(this,n),n}function f(){return 0>this.s?this.negate():this}function p(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(t=n-e.t,0!=t)return t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0}function h(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function m(){return 0>=this.t?0:this.DB*(this.t-1)+h(this[this.t-1]^this.s&this.DM)}function g(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function v(e,t){for(var n=e;this.t>n;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function _(e,t){var n,r=e%this.DB,i=this.DB-r,o=(1<<i)-1,a=Math.floor(e/this.DB),s=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)t[n+a+1]=this[n]>>i|s,s=(this[n]&o)<<r;for(n=a-1;n>=0;--n)t[n]=0;t[a]=s,t.t=this.t+a+1,t.s=this.s,t.clamp()}function y(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)return t.t=0,void 0;var r=e%this.DB,i=this.DB-r,o=(1<<r)-1;t[0]=this[n]>>r;
for(var a=n+1;this.t>a;++a)t[a-n-1]|=(this[a]&o)<<i,t[a-n]=this[a]>>r;r>0&&(t[this.t-n-1]|=(this.s&o)<<i),t.t=this.t-n,t.clamp()}function b(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);i>n;)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;this.t>n;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e.t>n;)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=0>r?-1:0,-1>r?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()}function w(t,n){var r=this.abs(),i=t.abs(),o=r.t;for(n.t=o+i.t;--o>=0;)n[o]=0;for(o=0;i.t>o;++o)n[o+r.t]=r.am(0,i[o],n,o,0,r.t);n.s=0,n.clamp(),this.s!=t.s&&e.ZERO.subTo(n,n)}function S(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e[n]=0;for(n=0;t.t-1>n;++n){var r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function k(n,r,i){var o=n.abs();if(!(0>=o.t)){var a=this.abs();if(a.t<o.t)return null!=r&&r.fromInt(0),null!=i&&this.copyTo(i),void 0;null==i&&(i=t());var s=t(),l=this.s,u=n.s,c=this.DB-h(o[o.t-1]);c>0?(o.lShiftTo(c,s),a.lShiftTo(c,i)):(o.copyTo(s),a.copyTo(i));var d=s.t,f=s[d-1];if(0!=f){var p=f*(1<<this.F1)+(d>1?s[d-2]>>this.F2:0),m=this.FV/p,g=(1<<this.F1)/p,v=1<<this.F2,_=i.t,y=_-d,b=null==r?t():r;for(s.dlShiftTo(y,b),i.compareTo(b)>=0&&(i[i.t++]=1,i.subTo(b,i)),e.ONE.dlShiftTo(d,b),b.subTo(s,s);d>s.t;)s[s.t++]=0;for(;--y>=0;){var w=i[--_]==f?this.DM:Math.floor(i[_]*m+(i[_-1]+v)*g);if(w>(i[_]+=s.am(0,w,i,y,0,d)))for(s.dlShiftTo(y,b),i.subTo(b,i);i[_]<--w;)i.subTo(b,i)}null!=r&&(i.drShiftTo(d,r),l!=u&&e.ZERO.subTo(r,r)),i.t=d,i.clamp(),c>0&&i.rShiftTo(c,i),0>l&&e.ZERO.subTo(i,i)}}}function x(n){var r=t();return this.abs().divRemTo(n,null,r),0>this.s&&r.compareTo(e.ZERO)>0&&n.subTo(r,r),r}function E(e){this.m=e}function T(e){return 0>e.s||e.compareTo(this.m)>=0?e.mod(this.m):e}function C(e){return e}function M(e){e.divRemTo(this.m,null,e)}function A(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function N(e,t){e.squareTo(t),this.reduce(t)}function I(){if(1>this.t)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return t=15&t*(2-(15&e)*t),t=255&t*(2-(255&e)*t),t=65535&t*(2-(65535&(65535&e)*t)),t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function D(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function O(n){var r=t();return n.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),0>n.s&&r.compareTo(e.ZERO)>0&&this.m.subTo(r,r),r}function L(e){var n=t();return e.copyTo(n),this.reduce(n),n}function P(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;this.m.t>t;++t){var n=32767&e[t],r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,r,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function j(e,t){e.squareTo(t),this.reduce(t)}function R(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function B(){return 0==(this.t>0?1&this[0]:this.s)}function U(n,r){if(n>4294967295||1>n)return e.ONE;var i=t(),o=t(),a=r.convert(this),s=h(n)-1;for(a.copyTo(i);--s>=0;)if(r.sqrTo(i,o),(n&1<<s)>0)r.mulTo(o,a,i);else{var l=i;i=o,o=l}return r.revert(i)}function $(e,t){var n;return n=256>e||t.isEven()?new E(t):new D(t),this.exp(e,n)}function F(){var e=t();return this.copyTo(e),e}function H(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function q(){return 0==this.t?this.s:this[0]<<24>>24}function V(){return 0==this.t?this.s:this[0]<<16>>16}function J(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function z(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1}function W(e){if(null==e&&(e=10),0==this.signum()||2>e||e>36)return"0";var n=this.chunkSize(e),r=Math.pow(e,n),i=s(r),o=t(),a=t(),l="";for(this.divRemTo(i,o,a);o.signum()>0;)l=(r+a.intValue()).toString(e).substr(1)+l,o.divRemTo(i,o,a);return a.intValue().toString(e)+l}function Y(t,n){this.fromInt(0),null==n&&(n=10);for(var r=this.chunkSize(n),o=Math.pow(n,r),a=!1,s=0,l=0,u=0;t.length>u;++u){var c=i(t,u);0>c?"-"==t.charAt(u)&&0==this.signum()&&(a=!0):(l=n*l+c,++s>=r&&(this.dMultiply(o),this.dAddOffset(l,0),s=0,l=0))}s>0&&(this.dMultiply(Math.pow(n,s)),this.dAddOffset(l,0)),a&&e.ZERO.subTo(this,this)}function K(t,n,r){if("number"==typeof n)if(2>t)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),rt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(n);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var i=[],o=7&t;i.length=(t>>3)+1,n.nextBytes(i),o>0?i[0]&=(1<<o)-1:i[0]=0,this.fromString(i,256)}}function X(){var e=this.t,t=[];t[0]=this.s;var n,r=this.DB-e*this.DB%8,i=0;if(e-->0)for(this.DB>r&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)8>r?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=255&this[e]>>(r-=8),0>=r&&(r+=this.DB,--e)),0!=(128&n)&&(n|=-256),0==i&&(128&this.s)!=(128&n)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function G(e){return 0==this.compareTo(e)}function Q(e){return 0>this.compareTo(e)?this:e}function Z(e){return this.compareTo(e)>0?this:e}function et(e,t,n){var r,i,o=Math.min(e.t,this.t);for(r=0;o>r;++r)n[r]=t(this[r],e[r]);if(e.t<this.t){for(i=e.s&this.DM,r=o;this.t>r;++r)n[r]=t(this[r],i);n.t=this.t}else{for(i=this.s&this.DM,r=o;e.t>r;++r)n[r]=t(i,e[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()}function tt(e,t){return e&t}function nt(e){var n=t();return this.bitwiseTo(e,tt,n),n}function rt(e,t){return e|t}function it(e){var n=t();return this.bitwiseTo(e,rt,n),n}function ot(e,t){return e^t}function at(e){var n=t();return this.bitwiseTo(e,ot,n),n}function st(e,t){return e&~t}function lt(e){var n=t();return this.bitwiseTo(e,st,n),n}function ut(){for(var e=t(),n=0;this.t>n;++n)e[n]=this.DM&~this[n];return e.t=this.t,e.s=~this.s,e}function ct(e){var n=t();return 0>e?this.rShiftTo(-e,n):this.lShiftTo(e,n),n}function dt(e){var n=t();return 0>e?this.lShiftTo(-e,n):this.rShiftTo(e,n),n}function ft(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function pt(){for(var e=0;this.t>e;++e)if(0!=this[e])return e*this.DB+ft(this[e]);return 0>this.s?this.t*this.DB:-1}function ht(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function mt(){for(var e=0,t=this.s&this.DM,n=0;this.t>n;++n)e+=ht(this[n]^t);return e}function gt(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)}function vt(t,n){var r=e.ONE.shiftLeft(t);return this.bitwiseTo(r,n,r),r}function _t(e){return this.changeBit(e,rt)}function yt(e){return this.changeBit(e,st)}function bt(e){return this.changeBit(e,ot)}function wt(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);i>n;)r+=this[n]+e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;this.t>n;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e.t>n;)r+=e[n],t[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=0>r?-1:0,r>0?t[n++]=r:-1>r&&(t[n++]=this.DV+r),t.t=n,t.clamp()}function St(e){var n=t();return this.addTo(e,n),n}function kt(e){var n=t();return this.subTo(e,n),n}function xt(e){var n=t();return this.multiplyTo(e,n),n}function Et(e){var n=t();return this.divRemTo(e,n,null),n}function Tt(e){var n=t();return this.divRemTo(e,null,n),n}function Ct(e){var n=t(),r=t();return this.divRemTo(e,n,r),[n,r]}function Mt(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function At(e,t){for(;t>=this.t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}function Nt(){}function It(e){return e}function Dt(e,t,n){e.multiplyTo(t,n)}function Ot(e,t){e.squareTo(t)}function Lt(e){return this.exp(e,new Nt)}function Pt(e,t,n){var r=Math.min(this.t+e.t,t);for(n.s=0,n.t=r;r>0;)n[--r]=0;var i;for(i=n.t-this.t;i>r;++r)n[r+this.t]=this.am(0,e[r],n,r,0,this.t);for(i=Math.min(e.t,t);i>r;++r)this.am(0,e[r],n,r,0,t-r);n.clamp()}function jt(e,t,n){--t;var r=n.t=this.t+e.t-t;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(t-this.t,0);e.t>r;++r)n[this.t+r-t]=this.am(t-r,e[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)}function Rt(n){this.r2=t(),this.q3=t(),e.ONE.dlShiftTo(2*n.t,this.r2),this.mu=this.r2.divide(n),this.m=n}function Bt(e){if(0>e.s||e.t>2*this.m.t)return e.mod(this.m);if(0>e.compareTo(this.m))return e;var n=t();return e.copyTo(n),this.reduce(n),n}function Ut(e){return e}function $t(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>e.compareTo(this.r2);)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Ft(e,t){e.squareTo(t),this.reduce(t)}function Ht(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function qt(e,n){var r,i,o=e.bitLength(),a=s(1);if(0>=o)return a;r=18>o?1:48>o?3:144>o?4:768>o?5:6,i=8>o?new E(n):n.isEven()?new Rt(n):new D(n);var l=[],u=3,c=r-1,d=(1<<r)-1;if(l[1]=i.convert(this),r>1){var f=t();for(i.sqrTo(l[1],f);d>=u;)l[u]=t(),i.mulTo(f,l[u-2],l[u]),u+=2}var p,m,g=e.t-1,v=!0,_=t();for(o=h(e[g])-1;g>=0;){for(o>=c?p=e[g]>>o-c&d:(p=(e[g]&(1<<o+1)-1)<<c-o,g>0&&(p|=e[g-1]>>this.DB+o-c)),u=r;0==(1&p);)p>>=1,--u;if(0>(o-=u)&&(o+=this.DB,--g),v)l[p].copyTo(a),v=!1;else{for(;u>1;)i.sqrTo(a,_),i.sqrTo(_,a),u-=2;u>0?i.sqrTo(a,_):(m=a,a=_,_=m),i.mulTo(_,l[p],a)}for(;g>=0&&0==(e[g]&1<<o);)i.sqrTo(a,_),m=a,a=_,_=m,0>--o&&(o=this.DB-1,--g)}return i.revert(a)}function Vt(e){var t=0>this.s?this.negate():this.clone(),n=0>e.s?e.negate():e.clone();if(0>t.compareTo(n)){var r=t;t=n,n=r}var i=t.getLowestSetBit(),o=n.getLowestSetBit();if(0>o)return t;for(o>i&&(o=i),o>0&&(t.rShiftTo(o,t),n.rShiftTo(o,n));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return o>0&&n.lShiftTo(o,n),n}function Jt(e){if(0>=e)return 0;var t=this.DV%e,n=0>this.s?e-1:0;if(this.t>0)if(0==t)n=this[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this[r])%e;return n}function zt(t){var n=t.isEven();if(this.isEven()&&n||0==t.signum())return e.ZERO;for(var r=t.clone(),i=this.clone(),o=s(1),a=s(0),l=s(0),u=s(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),n?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;i.isEven();)i.rShiftTo(1,i),n?(l.isEven()&&u.isEven()||(l.addTo(this,l),u.subTo(t,u)),l.rShiftTo(1,l)):u.isEven()||u.subTo(t,u),u.rShiftTo(1,u);r.compareTo(i)>=0?(r.subTo(i,r),n&&o.subTo(l,o),a.subTo(u,a)):(i.subTo(r,i),n&&l.subTo(o,l),u.subTo(a,u))}return 0!=i.compareTo(e.ONE)?e.ZERO:u.compareTo(t)>=0?u.subtract(t):0>u.signum()?(u.addTo(t,u),0>u.signum()?u.add(t):u):u}function Wt(e){var t,n=this.abs();if(1==n.t&&n[0]<=tn[tn.length-1]){for(t=0;tn.length>t;++t)if(n[0]==tn[t])return!0;return!1}if(n.isEven())return!1;for(t=1;tn.length>t;){for(var r=tn[t],i=t+1;tn.length>i&&nn>r;)r*=tn[i++];for(r=n.modInt(r);i>t;)if(0==r%tn[t++])return!1}return n.millerRabin(e)}function Yt(n){var r=this.subtract(e.ONE),i=r.getLowestSetBit();if(0>=i)return!1;var o=r.shiftRight(i);n=n+1>>1,n>tn.length&&(n=tn.length);for(var a=t(),s=0;n>s;++s){a.fromInt(tn[s]);var l=a.modPow(o,this);if(0!=l.compareTo(e.ONE)&&0!=l.compareTo(r)){for(var u=1;i>u++&&0!=l.compareTo(r);)if(l=l.modPowInt(2,this),0==l.compareTo(e.ONE))return!1;if(0!=l.compareTo(r))return!1}}return!0}var Kt;e.prototype.am=n,Kt=28,e.prototype.DB=Kt,e.prototype.DM=(1<<Kt)-1,e.prototype.DV=1<<Kt;var Xt=52;e.prototype.FV=Math.pow(2,Xt),e.prototype.F1=Xt-Kt,e.prototype.F2=2*Kt-Xt;var Gt,Qt,Zt="0123456789abcdefghijklmnopqrstuvwxyz",en=[];for(Gt="0".charCodeAt(0),Qt=0;9>=Qt;++Qt)en[Gt++]=Qt;for(Gt="a".charCodeAt(0),Qt=10;36>Qt;++Qt)en[Gt++]=Qt;for(Gt="A".charCodeAt(0),Qt=10;36>Qt;++Qt)en[Gt++]=Qt;E.prototype.convert=T,E.prototype.revert=C,E.prototype.reduce=M,E.prototype.mulTo=A,E.prototype.sqrTo=N,D.prototype.convert=O,D.prototype.revert=L,D.prototype.reduce=P,D.prototype.mulTo=R,D.prototype.sqrTo=j,e.prototype.copyTo=o,e.prototype.fromInt=a,e.prototype.fromString=l,e.prototype.clamp=u,e.prototype.dlShiftTo=g,e.prototype.drShiftTo=v,e.prototype.lShiftTo=_,e.prototype.rShiftTo=y,e.prototype.subTo=b,e.prototype.multiplyTo=w,e.prototype.squareTo=S,e.prototype.divRemTo=k,e.prototype.invDigit=I,e.prototype.isEven=B,e.prototype.exp=U,e.prototype.toString=c,e.prototype.negate=d,e.prototype.abs=f,e.prototype.compareTo=p,e.prototype.bitLength=m,e.prototype.mod=x,e.prototype.modPowInt=$,e.ZERO=s(0),e.ONE=s(1),Nt.prototype.convert=It,Nt.prototype.revert=It,Nt.prototype.mulTo=Dt,Nt.prototype.sqrTo=Ot,Rt.prototype.convert=Bt,Rt.prototype.revert=Ut,Rt.prototype.reduce=$t,Rt.prototype.mulTo=Ht,Rt.prototype.sqrTo=Ft;var tn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],nn=(1<<26)/tn[tn.length-1];return e.prototype.chunkSize=J,e.prototype.toRadix=W,e.prototype.fromRadix=Y,e.prototype.fromNumber=K,e.prototype.bitwiseTo=et,e.prototype.changeBit=vt,e.prototype.addTo=wt,e.prototype.dMultiply=Mt,e.prototype.dAddOffset=At,e.prototype.multiplyLowerTo=Pt,e.prototype.multiplyUpperTo=jt,e.prototype.modInt=Jt,e.prototype.millerRabin=Yt,e.prototype.clone=F,e.prototype.intValue=H,e.prototype.byteValue=q,e.prototype.shortValue=V,e.prototype.signum=z,e.prototype.toByteArray=X,e.prototype.equals=G,e.prototype.min=Q,e.prototype.max=Z,e.prototype.and=nt,e.prototype.or=it,e.prototype.xor=at,e.prototype.andNot=lt,e.prototype.not=ut,e.prototype.shiftLeft=ct,e.prototype.shiftRight=dt,e.prototype.getLowestSetBit=pt,e.prototype.bitCount=mt,e.prototype.testBit=gt,e.prototype.setBit=_t,e.prototype.clearBit=yt,e.prototype.flipBit=bt,e.prototype.add=St,e.prototype.subtract=kt,e.prototype.multiply=xt,e.prototype.divide=Et,e.prototype.remainder=Tt,e.prototype.divideAndRemainder=Ct,e.prototype.modPow=qt,e.prototype.modInverse=zt,e.prototype.pow=Lt,e.prototype.gcd=Vt,e.prototype.isProbablePrime=Wt,e}()}(),function(){Meteor._srp===void 0&&(Meteor._srp={}),Meteor._srp.SHA256=function(){function e(e){function t(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function n(e,t){return e>>>t|e<<32-t}function r(e,t){return e>>>t}function i(e,t,n){return e&t^~e&n}function o(e,t,n){return e&t^e&n^t&n}function a(e){return n(e,2)^n(e,13)^n(e,22)}function s(e){return n(e,6)^n(e,11)^n(e,25)}function l(e){return n(e,7)^n(e,18)^r(e,3)}function u(e){return n(e,17)^n(e,19)^r(e,10)}function c(e,n){var r,c,d,f,p,h,m,g,v,_,y,b,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],S=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],k=Array(64);e[n>>5]|=128<<24-n%32,e[(n+64>>9<<4)+15]=n;for(var v=0;e.length>v;v+=16){r=S[0],c=S[1],d=S[2],f=S[3],p=S[4],h=S[5],m=S[6],g=S[7];for(var _=0;64>_;_++)k[_]=16>_?e[_+v]:t(t(t(u(k[_-2]),k[_-7]),l(k[_-15])),k[_-16]),y=t(t(t(t(g,s(p)),i(p,h,m)),w[_]),k[_]),b=t(a(r),o(r,c,d)),g=m,m=h,h=p,p=t(f,y),f=d,d=c,c=r,r=t(y,b);S[0]=t(r,S[0]),S[1]=t(c,S[1]),S[2]=t(d,S[2]),S[3]=t(f,S[3]),S[4]=t(p,S[4]),S[5]=t(h,S[5]),S[6]=t(m,S[6]),S[7]=t(g,S[7])}return S}function d(e){for(var t=[],n=(1<<h)-1,r=0;e.length*h>r;r+=h)t[r>>5]|=(e.charCodeAt(r/h)&n)<<24-r%32;return t}function f(e){for(var t="",n=0;e.length>n;n++){var r=e.charCodeAt(n);128>r?t+=String.fromCharCode(r):r>127&&2048>r?(t+=String.fromCharCode(192|r>>6),t+=String.fromCharCode(128|63&r)):(t+=String.fromCharCode(224|r>>12),t+=String.fromCharCode(128|63&r>>6),t+=String.fromCharCode(128|63&r))}return t}function p(e){for(var t=m?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;4*e.length>r;r++)n+=t.charAt(15&e[r>>2]>>8*(3-r%4)+4)+t.charAt(15&e[r>>2]>>8*(3-r%4));return n}var h=8,m=0;return e=f(e),p(c(d(e),e.length*h))}return e}()}(),function(){Meteor._srp===void 0&&(Meteor._srp={}),Meteor._srp.generateVerifier=function(t,n){var r=e(n),i=n&&n.identity||Random.id(),o=n&&n.salt||Random.id(),a=r.hash(o+r.hash(i+":"+t)),s=new Meteor._srp.BigInteger(a,16),l=r.g.modPow(s,r.N);return{identity:i,salt:o,verifier:l.toString(16)}},Meteor._srp.Client=function(n,r){var i=this;i.params=e(r),i.password=n;var o,a,s=i.params.N,l=i.params.g;if(r&&r.a){if("string"==typeof r.a)o=new Meteor._srp.BigInteger(r.a,16);else{if(!(r.a instanceof Meteor._srp.BigInteger))throw Error("Invalid parameter: a");o=r.a}if(a=l.modPow(o,s),0===a.mod(s))throw Error("Invalid parameter: a: A mod N == 0.")}else for(;!a||0===a.mod(s);)o=t(),a=l.modPow(o,s);i.a=o,i.A=a,i.Astr=a.toString(16)},Meteor._srp.Client.prototype.startExchange=function(){var e=this;return{A:e.Astr}},Meteor._srp.Client.prototype.respondToChallenge=function(e){var t=this,n=t.params.N,r=t.params.g,i=t.params.k,o=t.params.hash;if(t.identity=e.identity,t.salt=e.salt,t.Bstr=e.B,t.B=new Meteor._srp.BigInteger(t.Bstr,16),0===t.B.mod(n))throw Error("Server sent invalid key: B mod N == 0.");var a=new Meteor._srp.BigInteger(o(t.Astr+t.Bstr),16),s=new Meteor._srp.BigInteger(o(t.salt+o(t.identity+":"+t.password)),16),l=i.multiply(r.modPow(s,n)),u=t.a.add(a.multiply(s)),c=t.B.subtract(l).modPow(u,n),d=o(t.Astr+t.Bstr+c.toString(16)),f=o(t.Astr+d+c.toString(16));return t.S=c,t.HAMK=f,{M:d}},Meteor._srp.Client.prototype.verifyConfirmation=function(e){var t=this;return t.HAMK&&e.HAMK===t.HAMK},Meteor._srp.Server=function(n,r){var i=this;i.params=e(r),i.verifier=n;var o,a,s=i.params.N,l=i.params.g,u=i.params.k,c=new Meteor._srp.BigInteger(i.verifier.verifier,16);if(r&&r.b){if("string"==typeof r.b)o=new Meteor._srp.BigInteger(r.b,16);else{if(!(r.b instanceof Meteor._srp.BigInteger))throw Error("Invalid parameter: b");o=r.b}if(a=u.multiply(c).add(l.modPow(o,s)).mod(s),0===a.mod(s))throw Error("Invalid parameter: b: B mod N == 0.")}else for(;!a||0===a.mod(s);)o=t(),a=u.multiply(c).add(l.modPow(o,s)).mod(s);i.b=o,i.B=a,i.Bstr=a.toString(16)},Meteor._srp.Server.prototype.issueChallenge=function(e){var t=this;if(t.Astr=e.A,t.A=new Meteor._srp.BigInteger(t.Astr,16),0===t.A.mod(t.params.N))throw Error("Client sent invalid key: A mod N == 0.");var n=t.params.N,r=t.params.hash,i=new Meteor._srp.BigInteger(r(t.Astr+t.Bstr),16),o=new Meteor._srp.BigInteger(t.verifier.verifier,16),a=t.A.multiply(o.modPow(i,n));return t.S=a.modPow(t.b,n),t.M=r(t.Astr+t.Bstr+t.S.toString(16)),t.HAMK=r(t.Astr+t.M+t.S.toString(16)),{identity:t.verifier.identity,salt:t.verifier.salt,B:t.Bstr}},Meteor._srp.Server.prototype.verifyResponse=function(e){var t=this;return e.M!==t.M?null:{HAMK:t.HAMK}},Meteor._srp._defaults={hash:function(e){return Meteor._srp.SHA256(e).toLowerCase()},N:new Meteor._srp.BigInteger("EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",16),g:new Meteor._srp.BigInteger("2")},Meteor._srp._defaults.k=new Meteor._srp.BigInteger(Meteor._srp._defaults.hash(Meteor._srp._defaults.N.toString(16)+Meteor._srp._defaults.g.toString(16)),16);var e=function(e){if(!e)return Meteor._srp._defaults;var t=_.extend({},Meteor._srp._defaults);return _.each(["N","g","k"],function(n){if(e[n])if("string"==typeof e[n])t[n]=new Meteor._srp.BigInteger(e[n],16);else{if(!(e[n]instanceof Meteor._srp.BigInteger))throw Error("Invalid parameter: "+n);t[n]=e[n]}}),e.hash&&(t.hash=function(t){return e.hash(t).toLowerCase()}),!e.k&&(e.N||e.g||e.hash)&&(t.k=t.hash(t.N.toString(16)+t.g.toString(16))),t},t=function(){return new Meteor._srp.BigInteger(Random.hexString(36),16)}}(),function(){Accounts.createUser=function(e,t){if(e=_.clone(e),!e.password)throw Error("Must set options.password");var n=Meteor._srp.generateVerifier(e.password);delete e.password,e.srp=n,Accounts.callLoginMethod({methodName:"createUser",methodArguments:[e],userCallback:t})},Meteor.loginWithPassword=function(e,t,n){var r=new Meteor._srp.Client(t),i=r.startExchange();"string"==typeof e&&(e=-1===e.indexOf("@")?{username:e}:{email:e}),i.user=e,Accounts._setLoggingIn(!0),Meteor.apply("beginPasswordExchange",[i],function(e,t){if(e||!t)return Accounts._setLoggingIn(!1),e=e||Error("No result from call to beginPasswordExchange"),n&&n(e),void 0;var i=r.respondToChallenge(t);Accounts.callLoginMethod({methodArguments:[{srp:i}],validateResult:function(e){if(!r.verifyConfirmation({HAMK:e.HAMK}))throw Error("Server is cheating!")},userCallback:n})})},Accounts.changePassword=function(e,t,n){if(!Meteor.user())return n&&n(Error("Must be logged in to change password.")),void 0;var r=Meteor._srp.generateVerifier(t);if(e){var i=new Meteor._srp.Client(e),o=i.startExchange();o.user={id:Meteor.user()._id},Meteor.apply("beginPasswordExchange",[o],function(e,t){if(e||!t)return n&&n(e||Error("No result from call to beginPasswordExchange")),void 0;var o=i.respondToChallenge(t);o.srp=r,Meteor.apply("changePassword",[o],function(e,t){e||!t?n&&n(e||Error("No result from changePassword.")):i.verifyConfirmation(t)?n&&n():n&&n(Error("Old password verification failed."))})})}else Meteor.apply("changePassword",[{srp:r}],function(e,t){e||!t?n&&n(e||Error("No result from changePassword.")):n&&n()})},Accounts.forgotPassword=function(e,t){if(!e.email)throw Error("Must pass options.email");Meteor.call("forgotPassword",e,t)},Accounts.resetPassword=function(e,t,n){if(!e)throw Error("Need to pass token");if(!t)throw Error("Need to pass newPassword");var r=Meteor._srp.generateVerifier(t);Accounts.callLoginMethod({methodName:"resetPassword",methodArguments:[e,r],userCallback:n})},Accounts.verifyEmail=function(e,t){if(!e)throw Error("Need to pass token");Accounts.callLoginMethod({methodName:"verifyEmail",methodArguments:[e],userCallback:t})}}(),function(){Accounts.password={}}(),function(){Accounts.oauth={}}(),function(){Accounts.oauth.initiateLogin=function(n,r,i,o){var a=t(r,o&&o.width||650,o&&o.height||331),s=setInterval(function(){(a.closed||void 0===a.closed)&&(clearInterval(s),e(n,i))},100)};var e=function(e,t){Accounts.callLoginMethod({methodArguments:[{oauth:{state:e}}],userCallback:t&&function(e){e&&e instanceof Meteor.Error&&e.error===Accounts.LoginCancelledError.numericError?t(new Accounts.LoginCancelledError(e.details)):t(e)}})},t=function(e,t,n){var r=window.screenX!==void 0?window.screenX:window.screenLeft,i=window.screenY!==void 0?window.screenY:window.screenTop,o=window.outerWidth!==void 0?window.outerWidth:document.body.clientWidth,a=window.outerHeight!==void 0?window.outerHeight:document.body.clientHeight-22,s=r+(o-t)/2,l=i+(a-n)/2,u="width="+t+",height="+n+",left="+s+",top="+l,c=window.open(e,"Login",u);return c.focus&&c.focus(),c}}(),function(){Accounts.oauth1={}}(),function(){Meteor.http=Meteor.http||{},Meteor.http._encodeParams=function(e){var t=[];return _.each(e,function(e,n){t.length&&t.push("&"),t.push(Meteor.http._encodeString(n),"=",Meteor.http._encodeString(e))}),t.join("").replace(/%20/g,"+")},Meteor.http._encodeString=function(e){return encodeURIComponent(e).replace(/[!'()]/g,escape).replace(/\*/g,"%2A")},Meteor.http._buildUrl=function(e,t,n,r){var i=e,o=t?t.slice(1):null;if("string"==typeof n&&(o=n+""),r){o=o||"";var a=Meteor.http._encodeParams(r);o&&a&&(o+="&"),o+=a}var s=i;return null!==o&&(s+="?"+o),s},Meteor.http._populateData=function(e){var t=(e.headers["content-type"]||";").split(";")[0];if(_.include(["application/json","text/javascript"],t))try{e.data=JSON.parse(e.content)}catch(n){e.data=null}else e.data=null},Meteor.http.get=function(){return Meteor.http.call.apply(this,["GET"].concat(_.toArray(arguments)))},Meteor.http.post=function(){return Meteor.http.call.apply(this,["POST"].concat(_.toArray(arguments)))},Meteor.http.put=function(){return Meteor.http.call.apply(this,["PUT"].concat(_.toArray(arguments)))},Meteor.http.del=function(){return Meteor.http.call.apply(this,["DELETE"].concat(_.toArray(arguments)))}}(),function(){Meteor.http=Meteor.http||{},Meteor.http.call=function(e,t,n,r){if(r||"function"!=typeof n||(r=n,n=null),n=n||{},"function"!=typeof r)throw Error("Can't make a blocking HTTP call from the client; callback required.");e=(e||"").toUpperCase();var i={},o=n.content;n.data&&(o=JSON.stringify(n.data),i["Content-Type"]="application/json");var a,s;o||"GET"===e||"HEAD"===e?a=n.params:s=n.params;var l=/^(.*?)(\?.*)?$/.exec(t);if(t=Meteor.http._buildUrl(l[1],l[2],n.query,a),n.followRedirects===!1)throw Error("Option followRedirects:false not supported on client.");var u,c;if(n.auth){var d=n.auth.indexOf(":");if(0>d)throw Error('auth option should be of the form "username:password"');u=n.auth.substring(0,d),c=n.auth.substring(d+1)}s&&(o=Meteor.http._encodeParams(s)),_.extend(i,n.headers||{}),r=function(e){return function(t,n){n=n||{},n.error=t,e(t,n)}}(r),r=_.once(r);try{var f;if("undefined"!=typeof XMLHttpRequest)f=new XMLHttpRequest;else{if("undefined"==typeof ActiveXObject)throw Error("Can't create XMLHttpRequest");f=new ActiveXObject("Microsoft.XMLHttp")}f.open(e,t,!0,u,c);for(var p in i)f.setRequestHeader(p,i[p]);var h,m=!1;n.timeout&&(h=Meteor.setTimeout(function(){m=!0,f.abort()},n.timeout)),f.onreadystatechange=function(){if(4===f.readyState)if(h&&Meteor.clearTimeout(h),m)r(Error("timeout"));else if(f.status){var e={};e.statusCode=f.status,e.content=f.responseText,e.headers={};var t=f.getAllResponseHeaders();""===t&&f.getResponseHeader("content-type")&&(t="content-type: "+f.getResponseHeader("content-type"));var n=t.split(/\r?\n/);_.each(n,function(t){var n=/^(.*?):(?:\s+)(.*)$/.exec(t);n&&3===n.length&&(e.headers[n[1].toLowerCase()]=n[2])}),Meteor.http._populateData(e);var i=null;f.status>=400&&(i=Error("failed")),r(i,e)}else r(Error("network"))},f.send(o)}catch(g){r(g)}}}(),function(){Meteor._def_template("configureLoginServiceDialogForTwitter",Handlebars.json_ast_to_func(['<p>\n    First, you\'ll need to register your app on Twitter. Follow these steps:\n  </p>\n  <ol>\n    <li>\n      Visit <a href="https://dev.twitter.com/apps/new" target="_blank">https://dev.twitter.com/apps/new</a>\n    </li>\n    <li>\n      Set Callback URL to: <span class="url">',["{",[[0,"siteUrl"]]],"_oauth/twitter?close</span>\n    </li>\n  </ol>"]))}(),function(){Template.configureLoginServiceDialogForTwitter.siteUrl=function(){return Meteor.absoluteUrl({replaceLocalhost:!0})},Template.configureLoginServiceDialogForTwitter.fields=function(){return[{property:"consumerKey",label:"Consumer key"},{property:"secret",label:"Consumer secret"}]}}(),function(){Accounts.twitter||(Accounts.twitter={}),Accounts.twitter._urls={requestToken:"https://api.twitter.com/oauth/request_token",authorize:"https://api.twitter.com/oauth/authorize",accessToken:"https://api.twitter.com/oauth/access_token",authenticate:"https://api.twitter.com/oauth/authenticate"}}(),function(){Meteor.loginWithTwitter=function(e,t){t||"function"!=typeof e||(t=e,e={});var n=Accounts.loginServiceConfiguration.findOne({service:"twitter"});if(!n)return t&&t(new Accounts.ConfigError("Service not configured")),void 0;var r=Random.id(),i=Meteor.absoluteUrl("_oauth/twitter?close&state="+r),o="/_oauth/twitter/?requestTokenAndRedirect="+encodeURIComponent(i)+"&state="+r;Accounts.oauth.initiateLogin(r,o,t)}}(),function(){(function(){function e(t,n){if("function"==typeof t)return e("*",t);if("function"==typeof n)for(var i=new r(t),o=1;arguments.length>o;++o)e.callbacks.push(i.middleware(arguments[o]));else"string"==typeof t?e.show(t,n):e.start(t)}function t(t){h.pathname+h.search!=t.canonicalPath&&(e.stop(),t.unhandled=!0,window.location=t.canonicalPath)}function n(e,t){"/"==e[0]&&0!=e.indexOf(p)&&(e=p+e);var n=e.indexOf("?");this.canonicalPath=e,this.path=e.replace(p,"")||"/",this.title=document.title,this.state=t||{},this.state.path=e,this.querystring=~n?e.slice(n+1):"",this.pathname=~n?e.slice(0,n):e,this.params=[]}function r(e,t){t=t||{},this.path=e,this.method="GET",this.regexp=i(e,this.keys=[],t.sensitive,t.strict)}function i(e,t,n,r){return e instanceof RegExp?e:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(r?"":"/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,n,r,i,o,a){return t.push({name:i,optional:!!a}),n=n||"",""+(a?"":n)+"(?:"+(a?n:"")+(r||"")+(o||r&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)"),RegExp("^"+e+"$",n?"":"i"))}function o(t){if(t.state){var n=t.state.path;e.replace(n,t.state)}}function a(t){if(s(t)&&!(t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){for(var n=t.target||t.srcElement;n&&"A"!=n.nodeName;)n=n.parentNode;if(n&&"A"==n.nodeName){var r=n.href,i=n.pathname+n.search;if("/"!==i[0]&&(i="/"+i),!n.hash&&"#"!=n.getAttribute("href")&&l(r)){var o=i;i=i.replace(p,""),p&&o==i||(t.preventDefault?t.preventDefault():t.returnValue=!1,e.show(o))}}}}function s(e){return e=e||window.event,null==e.which?0==e.button:1==e.which}function l(e){var t=h.protocol+"//"+h.hostname;return h.port&&(t+=":"+h.port),0==e.indexOf(t)}function u(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function c(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}var d,f=!0,p="",h=history.location||window.location;e.callbacks=[],e.base=function(e){return 0==arguments.length?p:(p=e,void 0)},e.start=function(t){t=t||{},d||(d=!0,!1===t.dispatch&&(f=!1),!1!==t.popstate&&u(window,"popstate",o),!1!==t.click&&u(document,"click",a),f&&e.replace(h.pathname+h.search,null,!0,f))},e.stop=function(){d=!1,c(document,"click",a),c(window,"popstate",o)},e.show=function(t,r,i){var o=new n(t,r);return!1!==i&&e.dispatch(o),o.unhandled||o.pushState(),o},e.replace=function(t,r,i,o){var a=new n(t,r);return a.init=i,null==o&&(o=!0),o&&e.dispatch(a),a.save(),a},e.dispatch=function(n){function r(){var o=e.callbacks[i++];return o?(o(n,r),void 0):t(n)}var i=0;r()},e.Context=n,n.prototype.pushState=function(){history.pushState(this.state,this.title,this.canonicalPath)},n.prototype.save=function(){history.replaceState(this.state,this.title,this.canonicalPath)},e.Route=r,r.prototype.middleware=function(e){var t=this;return function(n,r){return t.match(n.path,n.params)?e(n,r):(r(),void 0)}},r.prototype.match=function(e,t){var n=this.keys,r=e.indexOf("?"),i=~r?e.slice(0,r):e,o=this.regexp.exec(i);if(!o)return!1;for(var a=1,s=o.length;s>a;++a){var l=n[a-1],u="string"==typeof o[a]?decodeURIComponent(o[a]):o[a];l?t[l.name]=void 0!==t[l.name]?t[l.name]:u:t.push(u)}return!0},"undefined"==typeof module?window.page=e:module.exports=e})()}(),function(){(function(){var e=function(){this._page=null,this._autorunHandle=null,this._filters={},this._activeFilters=[],this._pageDeps=new Deps.Dependency};e.prototype._setPageFn=function(e,t){var n=this;n._autorunHandle&&n._autorunHandle.stop(),n._autorunHandle=Deps.autorun(function(){n.beforeRouting(t);var r=[];for(key in t.params)r.push(t.params[key]);var i=n._page;n._page=n._applyFilters(e.apply(t,r)),i!==n._page&&n._pageDeps.changed()})},e.prototype.add=function(e,t){var n=this;
_.isObject(e)&&!_.isRegExp(e)?_.each(e,function(e,t){n.add(t,e)}):(_.isFunction(t)||(t=_.bind(_.identity,null,t)),page(e,_.bind(n._setPageFn,n,t)))},e.prototype.page=function(){return Deps.depend(this._pageDeps),this._page},e.prototype.to=function(e){page(e)},e.prototype.filters=function(e){_.extend(this._filters,e)},e.prototype.filter=function(e,t){var n=this;return _.isObject(e)?_.each(e,function(e,t){n.filter(t,e)}):(t=t||{},t.name=e,t.only&&!_.isArray(t.only)&&(t.only=[t.only]),t.except&&!_.isArray(t.except)&&(t.except=[t.except]),n._activeFilters.push(t),void 0)},e.prototype.resetFilters=function(){this._activeFilters=[]},e.prototype._applyFilters=function(e){var t=this;return _.reduce(t._activeFilters,function(e,n){return t._applyFilter(e,n)},e)},e.prototype._applyFilter=function(e,t){var n=!0;return t.only?n=_.include(t.only,e):t.except&&(n=!_.include(t.except,e)),n?this._filters[t.name](e):e},e.prototype.beforeRouting=function(){},Meteor.Router=new e,Meteor.startup(function(){page()})})()}(),function(){"undefined"!=typeof Handlebars&&Handlebars.registerHelper("renderPage",function(e){return _.isString(e)||(e=Meteor.Router.page()),Template[e]?new Handlebars.SafeString(Template[e]()):void 0})}(),function(){(function(e,t){function n(e,t,n){this._d=e,this._isUTC=!!t,this._a=e._a||null,e._a=null,this._lang=n||!1}function r(e){var t=this._data={},n=e.years||e.y||0,r=e.months||e.M||0,o=e.weeks||e.w||0,a=e.days||e.d||0,s=e.hours||e.h||0,l=e.minutes||e.m||0,u=e.seconds||e.s||0,c=e.milliseconds||e.ms||0;this._milliseconds=c+1e3*u+6e4*l+36e5*s,this._days=a+7*o,this._months=r+12*n,t.milliseconds=c%1e3,u+=i(c/1e3),t.seconds=u%60,l+=i(u/60),t.minutes=l%60,s+=i(l/60),t.hours=s%24,a+=i(s/24),a+=7*o,t.days=a%30,r+=i(a/30),t.months=r%12,n+=i(r/12),t.years=n,this._lang=!1}function i(e){return 0>e?Math.ceil(e):Math.floor(e)}function o(e,t){for(var n=e+"";t>n.length;)n="0"+n;return n}function a(e,t,n){var r,i=t._milliseconds,o=t._days,a=t._months;i&&e._d.setTime(+e+i*n),o&&e.date(e.date()+o*n),a&&(r=e.date(),e.date(1).month(e.month()+a*n).date(Math.min(r,e.daysInMonth())))}function s(e){return"[object Array]"===Object.prototype.toString.call(e)}function l(e,t){var n,r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0;for(n=0;r>n;n++)~~e[n]!==~~t[n]&&o++;return o+i}function u(t,n){var r,i;for(r=1;7>r;r++)t[r]=null==t[r]?2===r?1:0:t[r];return t[7]=n,i=new e(0),n?(i.setUTCFullYear(t[0],t[1],t[2]),i.setUTCHours(t[3],t[4],t[5],t[6])):(i.setFullYear(t[0],t[1],t[2]),i.setHours(t[3],t[4],t[5],t[6])),i._a=t,i}function c(e,t){var n,r,i=[];for(!t&&D&&(t=require("./lang/"+e)),n=0;O.length>n;n++)t[O[n]]=t[O[n]]||N.en[O[n]];for(n=0;12>n;n++)r=T([2e3,n]),i[n]=RegExp("^"+(t.months[n]||t.months(r,""))+"|^"+(t.monthsShort[n]||t.monthsShort(r,"")).replace(".",""),"i");return t.monthsParse=t.monthsParse||i,N[e]=t,t}function d(e){var t="string"==typeof e&&e||e&&e._lang||null;return t?N[t]||c(t):T}function f(e){return Z[e]?"'+("+Z[e]+")+'":e.replace(R,"").replace(/\\?'/g,"\\'")}function p(e){return d().longDateFormat[e]||e}function h(e){var t="var a,b;return '"+e.replace(P,f)+"';",n=Function;return new n("t","v","o","p","m",t)}function m(e,t){function n(n,i){return r[n].call?r[n](e,t):r[n][i]}for(var r=d(e);j.test(t);)t=t.replace(j,p);return Q[t]||(Q[t]=h(t)),Q[t](e,n,r.ordinal,o,r.meridiem)}function g(e){switch(e){case"DDDD":return F;case"YYYY":return H;case"S":case"SS":case"SSS":case"DDD":return $;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return q;case"Z":case"ZZ":return V;case"T":return J;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return U;default:return RegExp(e.replace("\\",""))}}function v(e,t,n,r){var i;switch(e){case"M":case"MM":n[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":for(i=0;12>i;i++)if(d().monthsParse[i].test(t)){n[1]=i;break}break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(n[2]=~~t);break;case"YY":t=~~t,n[0]=t+(t>70?1900:2e3);break;case"YYYY":n[0]=~~Math.abs(t);break;case"a":case"A":r.isPm="pm"===(t+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":n[3]=~~t;break;case"m":case"mm":n[4]=~~t;break;case"s":case"ss":n[5]=~~t;break;case"S":case"SS":case"SSS":n[6]=~~(1e3*("0."+t));break;case"Z":case"ZZ":r.isUTC=!0,i=(t+"").match(K),i&&i[1]&&(r.tzh=~~i[1]),i&&i[2]&&(r.tzm=~~i[2]),i&&"+"===i[0]&&(r.tzh=-r.tzh,r.tzm=-r.tzm)}}function _(e,t){var n,r,i=[0,0,1,0,0,0,0],o={tzh:0,tzm:0},a=t.match(P);for(n=0;a.length>n;n++)r=(g(a[n]).exec(e)||[])[0],e=e.replace(g(a[n]),""),v(a[n],r,i,o);return o.isPm&&12>i[3]&&(i[3]+=12),o.isPm===!1&&12===i[3]&&(i[3]=0),i[3]+=o.tzh,i[4]+=o.tzm,u(i,o.isUTC)}function y(e,t){var r,i,o,a,s,u=e.match(B)||[],c=99;for(o=0;t.length>o;o++)a=_(e,t[o]),i=m(new n(a),t[o]).match(B)||[],s=l(u,i),c>s&&(c=s,r=a);return r}function b(t){var n,r="YYYY-MM-DDT";if(z.exec(t)){for(n=0;4>n;n++)if(Y[n][1].exec(t)){r+=Y[n][0];break}return V.exec(t)?_(t,r+" Z"):_(t,r)}return new e(t)}function w(e,t,n,r,i){var o=i.relativeTime[e];return"function"==typeof o?o(t||1,!!n,e,r):o.replace(/%d/i,t||1)}function S(e,t,n){var r=A(Math.abs(e)/1e3),i=A(r/60),o=A(i/60),a=A(o/24),s=A(a/365),l=45>r&&["s",r]||1===i&&["m"]||45>i&&["mm",i]||1===o&&["h"]||22>o&&["hh",o]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",A(a/30)]||1===s&&["y"]||["yy",s];return l[2]=t,l[3]=e>0,l[4]=n,w.apply({},l)}function k(e,t){T.fn[e]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),this):this._d["get"+n+t]()}}function x(e){T.duration.fn[e]=function(){return this._data[e]}}function E(e,t){T.duration.fn["as"+e]=function(){return+this/t}}for(var T,C,M="1.7.0",A=Math.round,N={},I="en",D="undefined"!=typeof module&&module.exports,O="months|monthsShort|weekdays|weekdaysShort|weekdaysMin|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),L=/^\/?Date\((\-?\d+)/i,P=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?)/g,j=/(LT|LL?L?L?)/g,R=/(^\[)|(\\)|\]$/g,B=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,U=/\d\d?/,$=/\d{1,3}/,F=/\d{3}/,H=/\d{1,4}/,q=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,V=/Z|[\+\-]\d\d:?\d\d/i,J=/T/i,z=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,W="YYYY-MM-DDTHH:mm:ssZ",Y=[["HH:mm:ss.S",/T\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],K=/([\+\-]|\d\d)/gi,X="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),G={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Q={},Z={M:"(a=t.month()+1)",MMM:'v("monthsShort",t.month())',MMMM:'v("months",t.month())',D:"(a=t.date())",DDD:"(a=new Date(t.year(),t.month(),t.date()),b=new Date(t.year(),0,1),a=~~(((a-b)/864e5)+1.5))",d:"(a=t.day())",dd:'v("weekdaysMin",t.day())',ddd:'v("weekdaysShort",t.day())',dddd:'v("weekdays",t.day())',w:"(a=new Date(t.year(),t.month(),t.date()-t.day()+5),b=new Date(a.getFullYear(),0,4),a=~~((a-b)/864e5/7+1.5))",YY:"p(t.year()%100,2)",YYYY:"p(t.year(),4)",a:"m(t.hours(),t.minutes(),!0)",A:"m(t.hours(),t.minutes(),!1)",H:"t.hours()",h:"t.hours()%12||12",m:"t.minutes()",s:"t.seconds()",S:"~~(t.milliseconds()/100)",SS:"p(~~(t.milliseconds()/10),2)",SSS:"p(t.milliseconds(),3)",Z:'((a=-t.zone())<0?((a=-a),"-"):"+")+p(~~(a/60),2)+":"+p(~~a%60,2)',ZZ:'((a=-t.zone())<0?((a=-a),"-"):"+")+p(~~(10*a/6),4)'},et="DDD w M D d".split(" "),tt="M D H h m s w".split(" ");et.length;)C=et.pop(),Z[C+"o"]=Z[C]+"+o(a)";for(;tt.length;)C=tt.pop(),Z[C+C]="p("+Z[C]+",2)";for(Z.DDDD="p("+Z.DDD+",3)",T=function(r,i){if(null===r||""===r)return null;var o,a;return T.isMoment(r)?new n(new e(+r._d),r._isUTC,r._lang):(i?o=s(i)?y(r,i):_(r,i):(a=L.exec(r),o=r===t?new e:a?new e(+a[1]):r instanceof e?r:s(r)?u(r):"string"==typeof r?b(r):new e(r)),new n(o))},T.utc=function(e,t){return s(e)?new n(u(e,!0),!0):("string"!=typeof e||V.exec(e)||(e+=" +0000",t&&(t+=" Z")),T(e,t).utc())},T.unix=function(e){return T(1e3*e)},T.duration=function(e,t){var n,i=T.isDuration(e),o="number"==typeof e,a=i?e._data:o?{}:e;return o&&(t?a[t]=e:a.milliseconds=e),n=new r(a),i&&(n._lang=e._lang),n},T.humanizeDuration=function(e,t,n){return T.duration(e,t===!0?null:t).humanize(t===!0?!0:n)},T.version=M,T.defaultFormat=W,T.lang=function(e,t){var n;if(!e)return I;if((t||!N[e])&&c(e,t),N[e]){for(n=0;O.length>n;n++)T[O[n]]=N[e][O[n]];T.monthsParse=N[e].monthsParse,I=e}},T.langData=d,T.isMoment=function(e){return e instanceof n},T.isDuration=function(e){return e instanceof r},T.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"}}),T.fn=n.prototype={clone:function(){return T(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return""+this._d},toDate:function(){return this._d},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds(),!!this._isUTC]},isValid:function(){return this._a?!l(this._a,(this._a[7]?T.utc(this):this).toArray()):!isNaN(this._d.getTime())},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){return m(this,e?e:T.defaultFormat)},add:function(e,t){var n=t?T.duration(+t,e):T.duration(e);return a(this,n,1),this},subtract:function(e,t){var n=t?T.duration(+t,e):T.duration(e);return a(this,n,-1),this},diff:function(e,t,n){var r,i=this._isUTC?T(e).utc():T(e).local(),o=6e4*(this.zone()-i.zone()),a=this._d-i._d-o,s=this.year()-i.year(),l=this.month()-i.month(),u=this.date()-i.date();return r="months"===t?12*s+l+u/30:"years"===t?s+(l+u/30)/12:"seconds"===t?a/1e3:"minutes"===t?a/6e4:"hours"===t?a/36e5:"days"===t?a/864e5:"weeks"===t?a/6048e5:a,n?r:A(r)},from:function(e,t){return T.duration(this.diff(e)).lang(this._lang).humanize(!t)},fromNow:function(e){return this.from(T(),e)},calendar:function(){var e=this.diff(T().sod(),"days",!0),t=this.lang().calendar,n=t.sameElse,r=-6>e?n:-1>e?t.lastWeek:0>e?t.lastDay:1>e?t.sameDay:2>e?t.nextDay:7>e?t.nextWeek:n;return this.format("function"==typeof r?r.apply(this):r)},isLeapYear:function(){var e=this.year();return 0===e%4&&0!==e%100||0===e%400},isDST:function(){return this.zone()<T([this.year()]).zone()||this.zone()<T([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==e?t:this.add({d:e-t})},startOf:function(e){switch(e.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},sod:function(){return this.clone().startOf("day")},eod:function(){return this.clone().endOf("day")},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return T.utc([this.year(),this.month()+1,0]).date()},lang:function(e){return e===t?d(this):(this._lang=e,this)}},C=0;X.length>C;C++)k(X[C].toLowerCase(),X[C]);k("year","FullYear"),T.duration.fn=r.prototype={weeks:function(){return i(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(e){var t=+this,n=this.lang().relativeTime,r=S(t,!e,this.lang());return e&&(r=(0>=t?n.past:n.future).replace(/%s/i,r)),r},lang:T.fn.lang};for(C in G)G.hasOwnProperty(C)&&(E(C,G[C]),x(C.toLowerCase()));E("Weeks",6048e5),D&&(module.exports=T),"undefined"==typeof ender&&(this.moment=T),"function"==typeof define&&define.amd&&define("moment",[],function(){return T})}).call(this,Date)}(),function(){(function(e,t){var n={};n===void 0&&(n={}),"function"!=typeof t&&(t=function(){return n}),function(){var e=function(){for(var e=arguments[0],t=1,n=arguments[t];n;)e=e.slice(0,-1)+n.slice(1),n=arguments[++t];return e},t=function(e){return"(?:"+e+")"},r="[A-Za-z]",i="[0-9]",o=e(i,"[A-Fa-f]"),a=t("%"+o+o),s="[\\:\\/\\?\\#\\[\\]\\@]",l="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",u=e(s,l),c=e(r,i,"[\\-\\.\\_\\~]"),d=t(r+e(r,i,"[\\+\\-\\.]")+"*"),f=t(t(a+"|"+e(c,l,"[\\:]"))+"*"),p=t(t("25[0-5]")+"|"+t("2[0-4]"+i)+"|"+t("1"+i+i)+"|"+t("[1-9]"+i)+"|"+i),h=t(p+"\\."+p+"\\."+p+"\\."+p),m=t(o+"{1,4}"),g=(t(t(m+"\\:"+m)+"|"+h),t(e(c,l,"[\\:]")+"+")),v=t("v"+o+"+\\."+e(c,l,"[\\:]")+"+"),_=t("\\["+t(g+"|"+v)+"\\]"),y=t(t(a+"|"+e(c,l))+"*"),b=t(_+"|"+h+"|"+y),w=t(i+"*"),S=t(t(f+"@")+"?"+b+t("\\:"+w)+"?"),k=t(a+"|"+e(c,l,"[\\:\\@]")),x=t(k+"*"),E=t(k+"+"),T=t(t(a+"|"+e(c,l,"[\\@]"))+"+"),C=t(t("\\/"+x)+"*"),M=t("\\/"+t(E+C)+"?"),A=t(T+C),N=t(E+C),I=t(""),D=(t(C+"|"+M+"|"+A+"|"+N+"|"+I),t(t(k+"|[\\/\\?]")+"*")),O=t(t(k+"|[\\/\\?]")+"*"),L=t(t("\\/\\/"+S+C)+"|"+M+"|"+N+"|"+I),P=t(d+"\\:"+L+t("\\?"+D)+"?"+t("\\#"+O)+"?"),j=t(t("\\/\\/"+S+C)+"|"+M+"|"+A+"|"+I),R=t(j+t("\\?"+D)+"?"+t("\\#"+O)+"?"),B=(t(P+"|"+R),t(d+"\\:"+L+t("\\?"+D)+"?"),RegExp("^"+t("("+P+")|("+R+")")+"$")),U=RegExp("^("+d+")\\:"+t(t("\\/\\/("+t("("+f+")@")+"?("+b+")"+t("\\:("+w+")")+"?)")+"?("+C+"|"+M+"|"+N+"|"+I+")")+t("\\?("+D+")")+"?"+t("\\#("+O+")")+"?$"),$=RegExp("^(){0}"+t(t("\\/\\/("+t("("+f+")@")+"?("+b+")"+t("\\:("+w+")")+"?)")+"?("+C+"|"+M+"|"+A+"|"+I+")")+t("\\?("+D+")")+"?"+t("\\#("+O+")")+"?$"),F=(RegExp("^("+d+")\\:"+t(t("\\/\\/("+t("("+f+")@")+"?("+b+")"+t("\\:("+w+")")+"?)")+"?("+C+"|"+M+"|"+N+"|"+I+")")+t("\\?("+D+")")+"?$"),RegExp("^"+t("\\#("+O+")")+"?$"),RegExp("^"+t("("+f+")@")+"?("+b+")"+t("\\:("+w+")")+"?$"),RegExp(e("[^]",r,i,"[\\+\\-\\.]"),"g")),H=RegExp(e("[^\\%\\:]",c,l),"g"),q=RegExp(e("[^\\%]",c,l),"g"),V=RegExp(e("[^\\%\\/\\:\\@]",c,l),"g"),J=RegExp(e("[^\\%\\/\\@]",c,l),"g"),z=RegExp(e("[^\\%]",c,l,"[\\:\\@\\/\\?]"),"g"),W=z,Y=RegExp(e("[^]",c,l),"g"),K=RegExp(c,"g"),X=(RegExp(e("[^\\%]",c,u),"g"),RegExp(a+"+","g")),G=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/i,Q=/^\.\.?\//,Z=/^\/\.(\/|$)/,et=/^\/\.\.(\/|$)/,tt=/^\/?.*?(?=\/|$)/,nt=void 0==="".match(/(){0}/)[1],rt=function(e){var t=e.charCodeAt(0);return 128>t?"%"+t.toString(16).toUpperCase():t>127&&2048>t?"%"+(192|t>>6).toString(16).toUpperCase()+"%"+(128|63&t).toString(16).toUpperCase():"%"+(224|t>>12).toString(16).toUpperCase()+"%"+(128|63&t>>6).toString(16).toUpperCase()+"%"+(128|63&t).toString(16).toUpperCase()},it=function(e){for(var t,n,r="",i=0;e.length>i;)t=parseInt(e.substr(i+1,2),16),128>t?(n=String.fromCharCode(t),r+=n.match(K)?n:e.substr(i,3),i+=3):t>191&&224>t?(r+=e.substr(i,6),i+=6):(r+=e.substr(i,9),i+=9);return r},ot=function(e){for(var t,n,r,i="",o=0;e.length>o;)t=parseInt(e.substr(o+1,2),16),128>t?(i+=String.fromCharCode(t),o+=3):t>191&&224>t?(n=parseInt(e.substr(o+4,2),16),i+=String.fromCharCode((31&t)<<6|63&n),o+=6):(n=parseInt(e.substr(o+4,2),16),r=parseInt(e.substr(o+7,2),16),i+=String.fromCharCode((15&t)<<12|(63&n)<<6|63&r),o+=9);return i},at=function(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()},st=function(){this.errors=[]},lt={};st.prototype={scheme:void 0,authority:void 0,userinfo:void 0,host:void 0,port:void 0,path:void 0,query:void 0,fragment:void 0,reference:void 0,errors:void 0},lt.SCHEMES={},lt.parse=function(e,t){var n,r,i=new st;return e=e?""+e:"",t=t||{},"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e),n=e.match(B),n&&(n=n[1]?e.match(U):e.match($)),n||(t.tolerant||i.errors.push("URI is not strictly valid."),n=e.match(G)),n?(nt?(i.scheme=n[1],i.authority=n[2],i.userinfo=n[3],i.host=n[4],i.port=parseInt(n[5],10),i.path=n[6]||"",i.query=n[7],i.fragment=n[8],isNaN(i.port)&&(i.port=n[5])):(i.scheme=n[1]||void 0,i.authority=-1!==e.indexOf("//")?n[2]:void 0,i.userinfo=-1!==e.indexOf("@")?n[3]:void 0,i.host=-1!==e.indexOf("//")?n[4]:void 0,i.port=parseInt(n[5],10),i.path=n[6]||"",i.query=-1!==e.indexOf("?")?n[7]:void 0,i.fragment=-1!==e.indexOf("#")?n[8]:void 0,isNaN(i.port)&&(i.port=e.match(/\/\/.*\:(?:\/|\?|\#|$)/)?n[4]:void 0)),i.reference=i.scheme||i.authority||i.path||i.query?i.scheme?i.fragment?"uri":"absolute":"relative":"same-document",t.reference&&"suffix"!==t.reference&&t.reference!==i.reference&&i.errors.push("URI is not a "+t.reference+" reference."),r=lt.SCHEMES[i.scheme||t.scheme],r&&r.parse&&r.parse(i,t)):i.errors.push("URI can not be parsed."),i},lt._recomposeAuthority=function(e){var t=[];return(void 0!==e.userinfo||void 0!==e.host||"number"==typeof e.port)&&(void 0!==e.userinfo&&(t.push((""+e.userinfo).replace(H,rt)),t.push("@")),void 0!==e.host&&t.push((""+e.host).toLowerCase().replace(q,rt)),"number"==typeof e.port&&(t.push(":"),t.push(e.port.toString(10)))),t.length?t.join(""):void 0},lt.removeDotSegments=function(e){for(var t,n=[];e.length;)e.match(Q)?e=e.replace(Q,""):e.match(Z)?e=e.replace(Z,"/"):e.match(et)?(e=e.replace(et,"/"),n.pop()):"."===e||".."===e?e="":(t=e.match(tt)[0],e=e.slice(t.length),n.push(t));return n.join("")},lt.serialize=function(e,t){var n,r,i=[];return t=t||{},n=lt.SCHEMES[e.scheme||t.scheme],n&&n.serialize&&n.serialize(e,t),"suffix"!==t.reference&&e.scheme&&(i.push((""+e.scheme).toLowerCase().replace(F,"")),i.push(":")),e.authority=lt._recomposeAuthority(e),void 0!==e.authority&&("suffix"!==t.reference&&i.push("//"),i.push(e.authority),e.path&&"/"!==e.path.charAt(0)&&i.push("/")),e.path&&(r=lt.removeDotSegments((""+e.path).replace(/%2E/gi,".")),r=e.scheme?r.replace(V,rt):r.replace(J,rt),void 0===e.authority&&(r=r.replace(/^\/\//,"/%2F")),i.push(r)),e.query&&(i.push("?"),i.push((""+e.query).replace(z,rt))),e.fragment&&(i.push("#"),i.push((""+e.fragment).replace(W,rt))),i.join("").replace(X,it).replace(/%[0-9A-Fa-f]{2}/g,function(e){return e.toUpperCase()})},lt.resolveComponents=function(e,t,n,r){var i=new st;return r||(e=lt.parse(lt.serialize(e,n),n),t=lt.parse(lt.serialize(t,n),n)),n=n||{},!n.tolerant&&t.scheme?(i.scheme=t.scheme,i.authority=t.authority,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=lt.removeDotSegments(t.path),i.query=t.query):(void 0!==t.authority?(i.authority=t.authority,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=lt.removeDotSegments(t.path),i.query=t.query):(t.path?("/"===t.path.charAt(0)?i.path=lt.removeDotSegments(t.path):(i.path=void 0===e.authority||e.path?e.path?e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:t.path:"/"+t.path,i.path=lt.removeDotSegments(i.path)),i.query=t.query):(i.path=e.path,i.query=void 0!==t.query?t.query:e.query),i.authority=e.authority,i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=t.fragment,i},lt.resolve=function(e,t,n){return lt.serialize(lt.resolveComponents(lt.parse(e,n),lt.parse(t,n),n,!0),n)},lt.normalize=function(e,t){return"string"==typeof e?lt.serialize(lt.parse(e,t),t):"object"===at(e)?lt.parse(lt.serialize(e,t),t):e},lt.equal=function(e,t,n){return"string"==typeof e?e=lt.serialize(lt.parse(e,n),n):"object"===at(e)&&(e=lt.serialize(e,n)),"string"==typeof t?t=lt.serialize(lt.parse(t,n),n):"object"===at(t)&&(t=lt.serialize(t,n)),e===t},lt.escapeComponent=function(e){return e&&(""+e).replace(Y,rt)},lt.unescapeComponent=function(e){return e&&(""+e).replace(X,ot)},n.Components=st,n.URI=lt,n.URI={SCHEMES:lt.SCHEMES,parse:lt.parse,removeDotSegments:lt.removeDotSegments,serialize:lt.serialize,resolveComponents:lt.resolveComponents,resolve:lt.resolve,normalize:lt.normalize,equal:lt.equal,escapeComponent:lt.escapeComponent,unescapeComponent:lt.unescapeComponent}}();var n=n||this,t=t||function(){return n};(function(){function e(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function r(){}function i(e){return r.prototype=e||{},new r}function o(e,t,n){var r,i={};for(r in e)e[r]!==x[r]&&(i[r]=t.call(n,e[r],r,e));return i}function a(e){return void 0!==e&&null!==e?e instanceof Array&&!e.callee?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}function s(t){var n,r=[];switch(e(t)){case"object":for(n in t)t[n]!==x[n]&&(r[r.length]=n);break;case"array":for(n=t.length-1;n>=0;--n)r[n]=n}return r}function l(e,t){return-1===w(e,t)&&e.push(t),e}function u(e,t){var n=w(e,t);return n>-1&&e.splice(n,1),e}function c(){return[E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],"-",E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],"-4",E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],"-",E[8|3&Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],"-",E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())],E[Math.floor(16*Math.random())]].join("")}function d(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function f(e){return"string"==typeof e&&-1===e.indexOf("#")&&(e+="#"),e}function p(){this.errors=[],this.validated={}}function h(e,t,n,r){t instanceof h&&("string"!=typeof r&&(r=t._fd),"string"!=typeof n&&(n=t._uri),t=t._value),"string"!=typeof n?n="urn:uuid:"+c()+"#":-1===n.indexOf(":")&&(n=f(k.resolve("urn:uuid:"+c()+"#",n))),this._env=e,this._value=t,this._uri=n,this._fd=r||this._env._options.defaultFragmentDelimiter}function m(t,n){var r,o;switch(t instanceof h&&(t=t.getValue()),e(t)){case"object":if(n){r={};for(o in t)t[o]!==x[o]&&(r[o]=m(t[o],n));return r}return i(t);case"array":if(n){for(r=Array(t.length),o=t.length;--o>=0;)r[o]=m(t[o],n);return r}return Array.prototype.slice.call(t);default:return t}}function g(e,t,n,r){var i;h.call(this,e,t,n),this._schema=r===!0?this:t instanceof g&&!(r instanceof g)?t._schema:r instanceof g?r:this._env.getDefaultSchema()||g.createEmptySchema(this._env),i=this._schema.getValueOfProperty("fragmentResolution"),"dot-delimited"===i?this._fd=".":"slash-delimited"===i&&(this._fd="/")}function v(t,n,r){var i,o,a=e(t),s=e(n);if("undefined"===s)return m(t,!0);if("undefined"===a||s!==a)return m(n,!0);if("object"===s){t instanceof g&&(t=t.getAttributes()),n instanceof g&&(n=n.getAttributes(),n["extends"]&&r&&n["extends"]instanceof g&&(n["extends"]=[n["extends"]])),i=m(t,!0);for(o in n)n[o]!==x[o]&&(i[o]=v(t[o],n[o],r));return i}return m(n,!0)}function _(){this._id=c(),this._schemas={},this._options={}}var y,b,w,S,k=t("./uri/uri").URI,x={},E="0123456789abcdef".split("");y=function(e,t,n){for(var r=0,i=e.length,o=Array(i);i>r;++r)o[r]=t.call(n,e[r],r,e);return o},Array.prototype.map&&(y=function(e,t,n){return Array.prototype.map.call(e,t,n)}),b=function(e,t,n){for(var r=0,i=e.length,o=[];i>r;++r)t.call(n,e[r],r,e)&&(o[o.length]=e[r]);return o},Array.prototype.filter&&(b=function(e,t,n){return Array.prototype.filter.call(e,t,n)}),w=function(e,t){for(var n=0,r=e.length;r>n;++n)if(e[n]===t)return n;return-1},Array.prototype.indexOf&&(w=function(e,t){return Array.prototype.indexOf.call(e,t)}),p.prototype.addError=function(e,t,n,r,i){this.errors.push({uri:e instanceof h?e.getURI():e,schemaUri:t instanceof h?t.getURI():t,attribute:n,message:r,details:i})},p.prototype.registerValidation=function(e,t){this.validated[e]?this.validated[e].push(t):this.validated[e]=[t]},p.prototype.isValidatedBy=function(e,t){return!!this.validated[e]&&-1!==w(this.validated[e],t)},h.prototype.getEnvironment=function(){return this._env},h.prototype.getType=function(){return e(this._value)},h.prototype.getValue=function(){return this._value},h.prototype.getURI=function(){return this._uri},h.prototype.resolveURI=function(e){return f(k.resolve(this._uri,e))},h.prototype.getPropertyNames=function(){return s(this._value)},h.prototype.getProperty=function(e){var t=this._value?this._value[e]:void 0;return t instanceof h?t:new h(this._env,t,this._uri+this._fd+d(e),this._fd)},h.prototype.getProperties=function(){var t=e(this._value),n=this;return"object"===t?o(this._value,function(e,t){return e instanceof h?e:new h(n._env,e,n._uri+n._fd+d(t),n._fd)}):"array"===t?y(this._value,function(e,t){return e instanceof h?e:new h(n._env,e,n._uri+n._fd+d(t),n._fd)}):void 0},h.prototype.getValueOfProperty=function(e){return this._value?this._value[e]instanceof h?this._value[e]._value:this._value[e]:void 0},h.prototype.equals=function(e){return e instanceof h?this._value===e._value:this._value===e},g.prototype=i(h.prototype),g.createEmptySchema=function(e){var t=i(g.prototype);return h.call(t,e,{},void 0,void 0),t._schema=t,t},g.prototype.getSchema=function(){return this._schema},g.prototype.getAttribute=function(e,t){var n,r,i,o;return!t&&this._attributes&&this._attributes.hasOwnProperty(e)?this._attributes[e]:(n=this._schema.getProperty("properties").getProperty(e),r=n.getValueOfProperty("parser"),i=this.getProperty(e),"function"==typeof r?(o=r(i,n,t),!t&&this._attributes&&(this._attributes[e]=o),o):i.getValue())},g.prototype.getAttributes=function(){var e,t,n,r,i;if(!this._attributes&&"object"===this.getType()){e=this.getProperties(),t=this._schema.getProperty("properties"),this._attributes={};for(n in e)e[n]!==x[n]&&(r=t&&t.getProperty(n),i=r&&r.getValueOfProperty("parser"),this._attributes[n]="function"==typeof i?i(e[n],r):e[n].getValue())}return m(this._attributes,!1)},g.prototype.getLink=function(e,t){var n=this.getAttribute("links",[e,t]);return n&&n.length&&n[n.length-1]?n[n.length-1]:void 0},g.prototype.validate=function(e,t,n,r,i){var o=this._schema.getValueOfProperty("validator");return e instanceof h||(e=this.getEnvironment().createInstance(e)),t instanceof p||(t=new p),"function"!=typeof o||t.isValidatedBy(e.getURI(),this.getURI())||(t.registerValidation(e.getURI(),this.getURI()),o(e,this,this._schema,t,n,r,i)),t},_.prototype.clone=function(){var e=new _;return e._schemas=i(this._schemas),e._options=i(this._options),e},_.prototype.createInstance=function(e,t){var n;return t=f(t),e instanceof h&&(!t||e.getURI()===t)?e:n=new h(this,e,t)},_.prototype.createSchema=function(e,t,n){var r,i;return n=f(n),!(e instanceof g)||n&&e._uri!==n||t&&!e._schema.equals(t)?(r=new g(this,e,n,t),i=r.getSchema().getValueOfProperty("initializer"),"function"==typeof i&&(r=i(r)),this._schemas[r._uri]=r,this._schemas[n]=r,r.getAttributes(),r):e},_.prototype.createEmptySchema=function(){var e=g.createEmptySchema(this);return this._schemas[e._uri]=e,e},_.prototype.findSchema=function(e){return this._schemas[f(e)]},_.prototype.setOption=function(e,t){this._options[e]=t},_.prototype.getOption=function(e){return this._options[e]},_.prototype.setDefaultFragmentDelimiter=function(e){"string"==typeof e&&e.length>0&&(this._options.defaultFragmentDelimiter=e)},_.prototype.getDefaultFragmentDelimiter=function(){return this._options.defaultFragmentDelimiter},_.prototype.setDefaultSchemaURI=function(e){"string"==typeof e&&(this._options.defaultSchemaURI=f(e))},_.prototype.getDefaultSchema=function(){return this.findSchema(this._options.defaultSchemaURI)},_.prototype.validate=function(e,t){var n,r,i,o=new p;try{n=this.createInstance(e),o.instance=n}catch(a){o.addError(a.uri,a.schemaUri,a.attribute,a.message,a.details)}try{r=this.createSchema(t),o.schema=r,i=r.getSchema(),o.schemaSchema=i}catch(a){o.addError(a.uri,a.schemaUri,a.attribute,a.message,a.details)}return i&&i.validate(r,o),o.errors.length?o:r.validate(n,o)},_.prototype._checkForInvalidInstances=function(t,n){for(var r,i,o,a,s,l=[],u=[[n,this._schemas[n]]],c=0;t>c++&&u.length;)if(r=u.shift(),i=r[0],o=r[1],o instanceof g)if(this._schemas[o._uri]!==o)l.push("Instance "+i+" does not match "+o._uri);else{a=o.getAttributes();for(s in a)a[s]!==x[s]&&u.push([i+"/"+d(s),a[s]])}else if("object"===e(o)){a=o;for(s in a)a.hasOwnProperty(s)&&u.push([i+"/"+d(s),a[s]])}else if("array"===e(o))for(a=o,s=0;a.length>s;++s)u.push([i+"/"+d(s),a[s]]);return l.length?l:c},S={_environments:{},_defaultEnvironmentID:"",isJSONInstance:function(e){return e instanceof h},isJSONSchema:function(e){return e instanceof g},createEnvironment:function(e){if(e=e||this._defaultEnvironmentID,!this._environments[e])throw Error("Unknown Environment ID");return this._environments[e].clone()},Environment:_,registerEnvironment:function(e,t){e=e||(t||0)._id,e&&!this._environments[e]&&t instanceof _&&(t._id=e,this._environments[e]=t)},setDefaultEnvironmentID:function(e){if("string"==typeof e){if(!this._environments[e])throw Error("Unknown Environment ID");this._defaultEnvironmentID=e}},getDefaultEnvironmentID:function(){return this._defaultEnvironmentID},typeOf:e,createObject:i,mapObject:o,mapArray:y,filterArray:b,searchArray:w,toArray:a,keys:s,pushUnique:l,popFirst:u,clone:m,randomUUID:c,escapeURIComponent:d,formatURI:f,inherits:v},this.JSV=S,n.JSV=S,t("./environments")})(),function(){function e(e,t,n,r){var i,o,a,s,l,u={};if("object"===e.getType()){i=t.getAttribute("patternProperties"),s=e.getProperties();for(o in i)if(i[o]!==A[o]){a=null;try{a=RegExp(o)}catch(c){n&&n.addError(t,r,"patternProperties","Invalid pattern",o)}if(a)for(l in s)s[l]!==A[l]&&a.test(l)&&(u[l]=u[l]?N.pushUnique(u[l],i[o]):[i[o]])}}return u}var n,r,i,o,a,s,l,u,c,d,f,p,h,m,g,v,_,y,b,w,S,k,x,E,T,C,M,A={},N=t("./jsv").JSV;n=function n(e,t,n,r,i){Error.call(this,r),this.uri=e.getURI(),this.schemaUri=t.getURI(),this.attribute=n,this.message=r,this.description=r,this.details=i},n.prototype=Error(),n.prototype.constructor=n,n.prototype.name="InitializationError",r={string:function(e){return"string"===e.getType()},number:function(e){return"number"===e.getType()},integer:function(e){return"number"===e.getType()&&0===e.getValue()%1},"boolean":function(e){return"boolean"===e.getType()},object:function(e){return"object"===e.getType()},array:function(e){return"array"===e.getType()},"null":function(e){return"null"===e.getType()},any:function(){return!0}},i=new N.Environment,i.setOption("strict",!1),i.setOption("validateReferences",!1),o={$schema:"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/schema#",type:"object",properties:{type:{type:["string","array"],items:{type:["string",{$ref:"#"}]},optional:!0,uniqueItems:!0,"default":"any",parser:function(e,t){var n;return"string"===e.getType()?e.getValue():"object"===e.getType()?e.getEnvironment().createSchema(e,t.getEnvironment().findSchema(t.resolveURI("#"))):"array"===e.getType()?(n=t.getValueOfProperty("parser"),N.mapArray(e.getProperties(),function(e){return n(e,t)})):"any"},validator:function(e,t,n,r,i,o,a){var s,l,u,c,d,f=N.toArray(t.getAttribute("type"));if("undefined"!==e.getType()&&f&&f.length){for(d=n.getValueOfProperty("typeValidators")||{},s=0,l=f.length;l>s;++s)if(u=f[s],N.isJSONSchema(u)){if(c=N.createObject(r),c.errors=[],c.validated=N.clone(r.validated),0===u.validate(e,c,i,o,a).errors.length)return!0
}else{if(d[u]===A[u]||"function"!=typeof d[u])return!0;if(d[u](e,r))return!0}return r.addError(e,t,"type","Instance is not a required type",f),!1}return!0},typeValidators:r},properties:{type:"object",additionalProperties:{$ref:"#"},optional:!0,"default":{},parser:function(e,t,n){var r=e.getEnvironment(),i=t.getEnvironment();return"object"===e.getType()?n?r.createSchema(e.getProperty(n),i.findSchema(t.resolveURI("#"))):N.mapObject(e.getProperties(),function(e){return r.createSchema(e,i.findSchema(t.resolveURI("#")))}):{}},validator:function(e,t,n,r){var i,o;if("object"===e.getType()){i=t.getAttribute("properties");for(o in i)i[o]!==A[o]&&i[o]&&i[o].validate(e.getProperty(o),r,e,t,o)}}},items:{type:[{$ref:"#"},"array"],items:{$ref:"#"},optional:!0,"default":{},parser:function(e,t){return"object"===e.getType()?e.getEnvironment().createSchema(e,t.getEnvironment().findSchema(t.resolveURI("#"))):"array"===e.getType()?N.mapArray(e.getProperties(),function(e){return e.getEnvironment().createSchema(e,t.getEnvironment().findSchema(t.resolveURI("#")))}):e.getEnvironment().createEmptySchema()},validator:function(e,t,n,r){var i,o,a,s,l,u;if("array"===e.getType())if(i=e.getProperties(),o=t.getAttribute("items"),u=t.getAttribute("additionalProperties"),"array"===N.typeOf(o))for(a=0,s=i.length;s>a;++a)l=o[a]||u,l!==!1?l.validate(i[a],r,e,t,a):r.addError(e,t,"additionalProperties","Additional items are not allowed",l);else for(l=o||u,a=0,s=i.length;s>a;++a)l.validate(i[a],r,e,t,a)}},optional:{type:"boolean",optional:!0,"default":!1,parser:function(e){return!!e.getValue()},validator:function(e,t,n,r){"undefined"!==e.getType()||t.getAttribute("optional")||r.addError(e,t,"optional","Property is required",!1)},validationRequired:!0},additionalProperties:{type:[{$ref:"#"},"boolean"],optional:!0,"default":{},parser:function(e,t){return"object"===e.getType()?e.getEnvironment().createSchema(e,t.getEnvironment().findSchema(t.resolveURI("#"))):"boolean"===e.getType()&&e.getValue()===!1?!1:e.getEnvironment().createEmptySchema()},validator:function(e,t,n,r){var i,o,a,s;if("object"===e.getType()){i=t.getAttribute("additionalProperties"),o=t.getAttribute("properties")||{},a=e.getProperties();for(s in a)a[s]!==A[s]&&a[s]&&o[s]===A[s]&&(N.isJSONSchema(i)?i.validate(a[s],r,e,t,s):i===!1&&r.addError(e,t,"additionalProperties","Additional properties are not allowed",i))}}},requires:{type:["string",{$ref:"#"}],optional:!0,parser:function(e,t){return"string"===e.getType()?e.getValue():"object"===e.getType()?e.getEnvironment().createSchema(e,t.getEnvironment().findSchema(t.resolveURI("#"))):void 0},validator:function(e,t,n,r,i){var o;"undefined"!==e.getType()&&i&&"undefined"!==i.getType()&&(o=t.getAttribute("requires"),"string"==typeof o?"undefined"===i.getProperty(o).getType()&&r.addError(e,t,"requires",'Property requires sibling property "'+o+'"',o):N.isJSONSchema(o)&&o.validate(i,r))}},minimum:{type:"number",optional:!0,parser:function(e){return"number"===e.getType()?e.getValue():void 0},validator:function(e,t,n,r){var i,o;"number"===e.getType()&&(i=t.getAttribute("minimum"),o=t.getAttribute("minimumCanEqual"),"number"==typeof i&&(i>e.getValue()||o===!1&&e.getValue()===i)&&r.addError(e,t,"minimum","Number is less then the required minimum value",i))}},maximum:{type:"number",optional:!0,parser:function(e){return"number"===e.getType()?e.getValue():void 0},validator:function(e,t,n,r){var i,o;"number"===e.getType()&&(i=t.getAttribute("maximum"),o=t.getAttribute("maximumCanEqual"),"number"==typeof i&&(e.getValue()>i||o===!1&&e.getValue()===i)&&r.addError(e,t,"maximum","Number is greater then the required maximum value",i))}},minimumCanEqual:{type:"boolean",optional:!0,requires:"minimum","default":!0,parser:function(e){return"boolean"===e.getType()?e.getValue():!0}},maximumCanEqual:{type:"boolean",optional:!0,requires:"maximum","default":!0,parser:function(e){return"boolean"===e.getType()?e.getValue():!0}},minItems:{type:"integer",optional:!0,minimum:0,"default":0,parser:function(e){return"number"===e.getType()?e.getValue():0},validator:function(e,t,n,r){var i;"array"===e.getType()&&(i=t.getAttribute("minItems"),"number"==typeof i&&i>e.getProperties().length&&r.addError(e,t,"minItems","The number of items is less then the required minimum",i))}},maxItems:{type:"integer",optional:!0,minimum:0,parser:function(e){return"number"===e.getType()?e.getValue():void 0},validator:function(e,t,n,r){var i;"array"===e.getType()&&(i=t.getAttribute("maxItems"),"number"==typeof i&&e.getProperties().length>i&&r.addError(e,t,"maxItems","The number of items is greater then the required maximum",i))}},pattern:{type:"string",optional:!0,format:"regex",parser:function(e){if("string"===e.getType())try{return RegExp(e.getValue())}catch(t){return t}},validator:function(e,t,n,r){var i;try{i=t.getAttribute("pattern"),i instanceof Error?r.addError(t,n,"pattern","Invalid pattern",t.getValueOfProperty("pattern")):"string"===e.getType()&&i&&!i.test(e.getValue())&&r.addError(e,t,"pattern","String does not match pattern",""+i)}catch(o){r.addError(t,n,"pattern","Invalid pattern",t.getValueOfProperty("pattern"))}}},minLength:{type:"integer",optional:!0,minimum:0,"default":0,parser:function(e){return"number"===e.getType()?e.getValue():0},validator:function(e,t,n,r){var i;"string"===e.getType()&&(i=t.getAttribute("minLength"),"number"==typeof i&&i>e.getValue().length&&r.addError(e,t,"minLength","String is less then the required minimum length",i))}},maxLength:{type:"integer",optional:!0,parser:function(e){return"number"===e.getType()?e.getValue():void 0},validator:function(e,t,n,r){var i;"string"===e.getType()&&(i=t.getAttribute("maxLength"),"number"==typeof i&&e.getValue().length>i&&r.addError(e,t,"maxLength","String is greater then the required maximum length",i))}},"enum":{type:"array",optional:!0,minItems:1,uniqueItems:!0,parser:function(e){return"array"===e.getType()?e.getValue():void 0},validator:function(e,t,n,r){var i,o,a;if("undefined"!==e.getType()&&(i=t.getAttribute("enum"))){for(o=0,a=i.length;a>o;++o)if(e.equals(i[o]))return!0;r.addError(e,t,"enum","Instance is not one of the possible values",i)}}},title:{type:"string",optional:!0},description:{type:"string",optional:!0},format:{type:"string",optional:!0,parser:function(e){return"string"===e.getType()?e.getValue():void 0},validator:function(e,t,n,r){var i,o;"string"===e.getType()&&(i=t.getAttribute("format"),o=n.getValueOfProperty("formatValidators"),"string"!=typeof i||o[i]===A[i]||"function"!=typeof o[i]||o[i].call(this,e,r)||r.addError(e,t,"format","String is not in the required format",i))},formatValidators:{}},contentEncoding:{type:"string",optional:!0},"default":{type:"any",optional:!0},maxDecimal:{type:"integer",optional:!0,minimum:0,parser:function(e){return"number"===e.getType()?e.getValue():void 0},validator:function(e,t,n,r){var i,o;"number"===e.getType()&&(i=t.getAttribute("maxDecimal"),"number"==typeof i&&(o=e.getValue().toString(10).split(".")[1],o&&o.length>i&&r.addError(e,t,"maxDecimal","The number of decimal places is greater then the allowed maximum",i)))}},disallow:{type:["string","array"],items:{type:"string"},optional:!0,uniqueItems:!0,parser:function(e){return"string"===e.getType()||"array"===e.getType()?e.getValue():void 0},validator:function(e,t,n,r,i,o,a){var s,l,u,c,d,f=N.toArray(t.getAttribute("disallow"));if("undefined"!==e.getType()&&f&&f.length){for(c=n.getValueOfProperty("typeValidators")||{},s=0,l=f.length;l>s;++s)if(u=f[s],N.isJSONSchema(u)){if(d=N.createObject(r),d.errors=[],d.validated=N.clone(r.validated),0===u.validate(e,d,i,o,a).errors.length)return r.addError(e,t,"disallow","Instance is a disallowed type",f),!1}else if(c[u]!==A[u]&&"function"==typeof c[u]&&c[u](e,r))return r.addError(e,t,"disallow","Instance is a disallowed type",f),!1;return!0}return!0},typeValidators:r},"extends":{type:[{$ref:"#"},"array"],items:{$ref:"#"},optional:!0,"default":{},parser:function(e,t){return"object"===e.getType()?e.getEnvironment().createSchema(e,t.getEnvironment().findSchema(t.resolveURI("#"))):"array"===e.getType()?N.mapArray(e.getProperties(),function(e){return e.getEnvironment().createSchema(e,t.getEnvironment().findSchema(t.resolveURI("#")))}):void 0},validator:function(e,t,n,r,i,o,a){var s,l,u=t.getAttribute("extends");if(u)if(N.isJSONSchema(u))u.validate(e,r,i,o,a);else if("array"===N.typeOf(u))for(s=0,l=u.length;l>s;++s)u[s].validate(e,r,i,o,a)}}},optional:!0,"default":{},fragmentResolution:"dot-delimited",parser:function(e,t){return"object"===e.getType()?e.getEnvironment().createSchema(e,t):void 0},validator:function(e,t,n,r,i,o,a){var s,l,u,c=t.getPropertyNames(),d=n.getAttribute("properties"),f=e.getEnvironment().getOption("strict");for(s in d)d[s]!==A[s]&&(d[s].getValueOfProperty("validationRequired")&&N.pushUnique(c,s),f&&d[s].getValueOfProperty("deprecated")&&N.popFirst(c,s));for(s=0,l=c.length;l>s;++s)d[c[s]]!==A[c[s]]&&(u=d[c[s]].getValueOfProperty("validator"),"function"==typeof u&&u(e,t,d[c[s]],r,i,o,a))}},a={$schema:"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/hyper-schema#",properties:{links:{type:"array",items:{$ref:"links#"},optional:!0,parser:function(e,t,n){var r,i,o=t.getValueOfProperty("items").$ref,a=t.getEnvironment().findSchema(o),s=a&&a.getValueOfProperty("parser");return n=N.toArray(n),r="function"==typeof s?N.mapArray(e.getProperties(),function(e){return s(e,a)}):N.toArray(e.getValue()),n[0]&&(r=N.filterArray(r,function(e){return e.rel===n[0]})),n[1]&&(i=t.getValueOfProperty("selfReferenceVariable"),r=N.mapArray(r,function(e){var t=n[1],r=e.href;return r=r.replace(/\{(.+)\}/g,function(e,n){var r;return r=n===i?t.getValue():t.getValueOfProperty(n),void 0!==r?r+"":""}),r?N.formatURI(t.resolveURI(r)):r})),r},selfReferenceVariable:"-this"},fragmentResolution:{type:"string",optional:!0,"default":"dot-delimited"},root:{type:"boolean",optional:!0,"default":!1},readonly:{type:"boolean",optional:!0,"default":!1},pathStart:{type:"string",optional:!0,format:"uri",validator:function(e,t,n,r){var i;"undefined"!==e.getType()&&(i=t.getAttribute("pathStart"),"string"==typeof i&&0!==e.getURI().indexOf(i)&&r.addError(e,t,"pathStart","Instance's URI does not start with "+i,i))}},mediaType:{type:"string",optional:!0,format:"media-type"},alternate:{type:"array",items:{$ref:"#"},optional:!0}},links:[{href:"{$ref}",rel:"full"},{href:"{$schema}",rel:"describedby"},{href:"{id}",rel:"self"}],initializer:function(e){var t,r,i;if(t=e._schema.getLink("describedby",e),t&&e._schema._uri!==t){if(e._env._schemas[t])return e._schema=e._env._schemas[t],initializer=e._schema.getValueOfProperty("initializer"),"function"==typeof initializer?initializer(e):e;if(e._env._options.validateReferences)throw new n(e,e._schema,"{link:describedby}","Unknown schema reference",t)}if(t=e._schema.getLink("full",e),t&&e._uri!==t){if(e._env._schemas[t])return e=e._env._schemas[t];if(e._env._options.validateReferences)throw new n(e,e._schema,"{link:full}","Unknown schema reference",t)}return r=e.getAttribute("extends"),N.isJSONSchema(r)&&(i=N.inherits(r,e,!0),e=e._env.createSchema(i,e._schema,e._uri)),t=e._schema.getLink("self",e),"string"===N.typeOf(t)&&(e._uri=N.formatURI(t)),e}},s={$schema:"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/links#",type:"object",properties:{href:{type:"string"},rel:{type:"string"},method:{type:"string","default":"GET",optional:!0},enctype:{type:"string",requires:"method",optional:!0},properties:{type:"object",additionalProperties:{$ref:"hyper-schema#"},optional:!0,parser:function(e,t,n){var r=e.getEnvironment(),i=t.getEnvironment(),o=t.getValueOfProperty("additionalProperties").$ref;return"object"===e.getType()?n?r.createSchema(e.getProperty(n),i.findSchema(t.resolveURI(o))):N.mapObject(e.getProperties(),function(e){return r.createSchema(e,i.findSchema(t.resolveURI(o)))}):void 0}}},parser:function(e,t){var n=t.getProperty("properties");return"object"===e.getType()?N.mapObject(e.getProperties(),function(e,t){var r=n.getProperty(t),i=r&&r.getValueOfProperty("parser");return"function"==typeof i?i(e,r):e.getValue()}):e.getValue()}},i.setOption("defaultFragmentDelimiter","."),i.setOption("defaultSchemaURI","http://json-schema.org/draft-00/schema#"),l=i.createSchema(o,!0,"http://json-schema.org/draft-00/schema#"),u=i.createSchema(N.inherits(l,i.createSchema(a,!0,"http://json-schema.org/draft-00/hyper-schema#"),!0),!0,"http://json-schema.org/draft-00/hyper-schema#"),i.setOption("defaultSchemaURI","http://json-schema.org/draft-00/hyper-schema#"),c=i.createSchema(s,u,"http://json-schema.org/draft-00/links#"),l=i.createSchema(l.getValue(),u,"http://json-schema.org/draft-00/schema#"),u=i.createSchema(u.getValue(),u,"http://json-schema.org/draft-00/hyper-schema#"),c=i.createSchema(c.getValue(),u,"http://json-schema.org/draft-00/links#"),d=N.inherits(o,{$schema:"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/schema#"}),f=N.inherits(a,{$schema:"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/hyper-schema#"}),p=N.inherits(s,{$schema:"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/links#"}),i.setOption("defaultSchemaURI","http://json-schema.org/draft-01/schema#"),h=i.createSchema(d,!0,"http://json-schema.org/draft-01/schema#"),m=i.createSchema(N.inherits(h,i.createSchema(f,!0,"http://json-schema.org/draft-01/hyper-schema#"),!0),!0,"http://json-schema.org/draft-01/hyper-schema#"),i.setOption("defaultSchemaURI","http://json-schema.org/draft-01/hyper-schema#"),g=i.createSchema(p,m,"http://json-schema.org/draft-01/links#"),h=i.createSchema(h.getValue(),m,"http://json-schema.org/draft-01/schema#"),m=i.createSchema(m.getValue(),m,"http://json-schema.org/draft-01/hyper-schema#"),g=i.createSchema(g.getValue(),m,"http://json-schema.org/draft-01/links#"),v=N.inherits(d,{$schema:"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/schema#",properties:{uniqueItems:{type:"boolean",optional:!0,"default":!1,parser:function(e){return!!e.getValue()},validator:function(e,t,n,r){var i,o,a,s,l;if("array"===e.getType()&&t.getAttribute("uniqueItems"))for(i=e.getProperties(),o=0,a=i.length-1;a>o;++o)for(s=o+1,l=i.length;l>s;++s)i[o].equals(i[s])&&r.addError(e,t,"uniqueItems","Array can only contain unique items",{x:o,y:s})}},maxDecimal:{deprecated:!0},divisibleBy:{type:"number",minimum:0,minimumCanEqual:!1,optional:!0,parser:function(e){return"number"===e.getType()?e.getValue():void 0},validator:function(e,t,n,r){var i;"number"===e.getType()&&(i=t.getAttribute("divisibleBy"),0===i?r.addError(e,t,"divisibleBy","Nothing is divisible by 0",i):1!==i&&0!==e.getValue()/i%1&&r.addError(e,t,"divisibleBy","Number is not divisible by "+i,i))}}},fragmentResolution:"slash-delimited"}),_=N.inherits(f,{id:"http://json-schema.org/draft-02/hyper-schema#",properties:{fragmentResolution:{"default":"slash-delimited"}}}),y=N.inherits(p,{$schema:"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/links#",properties:{targetSchema:{$ref:"hyper-schema#",parser:m.getAttribute("parser")}}}),i.setOption("defaultFragmentDelimiter","/"),i.setOption("defaultSchemaURI","http://json-schema.org/draft-02/schema#"),b=i.createSchema(v,!0,"http://json-schema.org/draft-02/schema#"),w=i.createSchema(N.inherits(b,i.createSchema(_,!0,"http://json-schema.org/draft-02/hyper-schema#"),!0),!0,"http://json-schema.org/draft-02/hyper-schema#"),i.setOption("defaultSchemaURI","http://json-schema.org/draft-02/hyper-schema#"),S=i.createSchema(y,w,"http://json-schema.org/draft-02/links#"),b=i.createSchema(b.getValue(),w,"http://json-schema.org/draft-02/schema#"),w=i.createSchema(w.getValue(),w,"http://json-schema.org/draft-02/hyper-schema#"),S=i.createSchema(S.getValue(),w,"http://json-schema.org/draft-02/links#"),k=N.inherits(v,{$schema:"http://json-schema.org/draft-03/schema#",id:"http://json-schema.org/draft-03/schema#",properties:{patternProperties:{type:"object",additionalProperties:{$ref:"#"},"default":{},parser:b.getValueOfProperty("properties").properties.parser,validator:function(t,n,r,i){var o,a,s;if("object"===t.getType()){o=e(t,n,i,r);for(a in o)if(o[a]!==A[a])for(s=o[a].length;s--;)o[a][s].validate(t.getProperty(a),i,t,n,a)}}},additionalProperties:{validator:function(t,n,r,i){var o,a,s,l,u;if("object"===t.getType()){o=n.getAttribute("additionalProperties"),a=n.getAttribute("properties")||{},s=t.getProperties(),l=e(t,n);for(u in s)s[u]!==A[u]&&s[u]&&a[u]===A[u]&&l[u]===A[u]&&(N.isJSONSchema(o)?o.validate(s[u],i,t,n,u):o===!1&&i.addError(t,n,"additionalProperties","Additional properties are not allowed",o))}}},items:{validator:function(e,t,n,r){var i,o,a,s,l,u;if("array"===e.getType())if(i=e.getProperties(),o=t.getAttribute("items"),u=t.getAttribute("additionalItems"),"array"===N.typeOf(o))for(a=0,s=i.length;s>a;++a)l=o[a]||u,l!==!1?l.validate(i[a],r,e,t,a):r.addError(e,t,"additionalItems","Additional items are not allowed",l);else for(l=o||u,a=0,s=i.length;s>a;++a)l.validate(i[a],r,e,t,a)}},additionalItems:{type:[{$ref:"#"},"boolean"],"default":{},parser:b.getValueOfProperty("properties").additionalProperties.parser,validator:function(e,t,n,r){var i,o,a,s;if("array"===e.getType()&&"undefined"===t.getProperty("items").getType())if(i=t.getAttribute("additionalItems"),o=e.getProperties(),i!==!1)for(a=0,s=o.length;s>a;++a)i.validate(o[a],r,e,t,a);else o.length&&r.addError(e,t,"additionalItems","Additional items are not allowed",i)}},optional:{validationRequired:!1,deprecated:!0},required:{type:"boolean","default":!1,parser:function(e){return!!e.getValue()},validator:function(e,t,n,r){"undefined"===e.getType()&&t.getAttribute("required")&&r.addError(e,t,"required","Property is required",!0)}},requires:{deprecated:!0},dependencies:{type:"object",additionalProperties:{type:["string","array",{$ref:"#"}],items:{type:"string"}},"default":{},parser:function(e,t,n){function r(e){var n=e.getType();return"string"===n||"array"===n?e.getValue():"object"===n?e.getEnvironment().createSchema(e,t.getEnvironment().findSchema(t.resolveURI("#"))):void 0}return"object"===e.getType()?n?r(e.getProperty(n)):N.mapObject(e.getProperties(),r):{}},validator:function(e,t,n,r){var i,o,a,s,l,u;if("object"===e.getType()){i=t.getAttribute("dependencies");for(o in i)if(i[o]!==A[o]&&"undefined"!==e.getProperty(o).getType())if(a=i[o],s=N.typeOf(a),"string"===s)"undefined"===e.getProperty(a).getType()&&r.addError(e,t,"dependencies",'Property "'+o+'" requires sibling property "'+a+'"',i);else if("array"===s)for(l=0,u=a.length;u>l;++l)"undefined"===e.getProperty(a[l]).getType()&&r.addError(e,t,"dependencies",'Property "'+o+'" requires sibling property "'+a[l]+'"',i);else N.isJSONSchema(a)&&a.validate(e,r)}}},minimumCanEqual:{deprecated:!0},maximumCanEqual:{deprecated:!0},exclusiveMinimum:{type:"boolean","default":!1,parser:function(e){return!!e.getValue()}},exclusiveMaximum:{type:"boolean","default":!1,parser:function(e){return!!e.getValue()}},minimum:{validator:function(e,t,n,r){var i,o;"number"===e.getType()&&(i=t.getAttribute("minimum"),o=t.getAttribute("exclusiveMinimum")||!e.getEnvironment().getOption("strict")&&!t.getAttribute("minimumCanEqual"),"number"==typeof i&&(i>e.getValue()||o===!0&&e.getValue()===i)&&r.addError(e,t,"minimum","Number is less then the required minimum value",i))}},maximum:{validator:function(e,t,n,r){var i,o;"number"===e.getType()&&(i=t.getAttribute("maximum"),o=t.getAttribute("exclusiveMaximum")||!e.getEnvironment().getOption("strict")&&!t.getAttribute("maximumCanEqual"),"number"==typeof i&&(e.getValue()>i||o===!0&&e.getValue()===i)&&r.addError(e,t,"maximum","Number is greater then the required maximum value",i))}},contentEncoding:{deprecated:!0},divisibleBy:{exclusiveMinimum:!0},disallow:{items:{type:["string",{$ref:"#"}]},parser:v.properties.type.parser},id:{type:"string",format:"uri"},$ref:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"}},dependencies:{exclusiveMinimum:"minimum",exclusiveMaximum:"maximum"},initializer:function(e){var t,r,i,o=e.getValueOfProperty("$schema"),a=e.getValueOfProperty("$ref"),s=e.getValueOfProperty("id");if(o&&(t=e.resolveURI(o),t&&e._schema._uri!==t)){if(e._env._schemas[t])return e._schema=e._env._schemas[t],initializer=e._schema.getValueOfProperty("initializer"),"function"==typeof initializer?initializer(e):e;if(e._env._options.validateReferences)throw new n(e,e._schema,"$schema","Unknown schema reference",t)}if(a&&(t=e.resolveURI(a),t&&e._uri!==t)){if(e._env._schemas[t])return e=e._env._schemas[t];if(e._env._options.validateReferences)throw new n(e,e._schema,"$ref","Unknown schema reference",t)}return r=e.getAttribute("extends"),N.isJSONSchema(r)&&(i=N.inherits(r,e,!0),e=e._env.createSchema(i,e._schema,e._uri)),s&&(t=e.resolveURI(s),"string"===N.typeOf(t)&&(e._uri=N.formatURI(t))),e}}),x=N.inherits(_,{$schema:"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/hyper-schema#",properties:{links:{selfReferenceVariable:"@"},root:{deprecated:!0},contentEncoding:{deprecated:!1},alternate:{deprecated:!0}}}),E=N.inherits(y,{$schema:"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/links#",properties:{href:{required:!0,format:"link-description-object-template"},rel:{required:!0},properties:{deprecated:!0},schema:{$ref:"http://json-schema.org/draft-03/hyper-schema#"}}}),i.setOption("validateReferences",!0),i.setOption("defaultSchemaURI","http://json-schema.org/draft-03/schema#"),i.createSchema({},!0,"http://json-schema.org/draft-03/schema#"),i.createSchema({},!0,"http://json-schema.org/draft-03/hyper-schema#"),i.createSchema({},!0,"http://json-schema.org/draft-03/links#"),T=i.createSchema(k,!0,"http://json-schema.org/draft-03/schema#"),C=i.createSchema(N.inherits(T,i.createSchema(x,!0,"http://json-schema.org/draft-03/hyper-schema#"),!0),!0,"http://json-schema.org/draft-03/hyper-schema#"),M=i.createSchema(E,!0,"http://json-schema.org/draft-03/links#"),i.setOption("defaultSchemaURI","http://json-schema.org/draft-03/hyper-schema#"),C=i.createSchema(C.getValue(),C,"http://json-schema.org/draft-03/hyper-schema#"),i.setOption("latestJSONSchemaSchemaURI","http://json-schema.org/draft-03/schema#"),i.setOption("latestJSONSchemaHyperSchemaURI","http://json-schema.org/draft-03/hyper-schema#"),i.setOption("latestJSONSchemaLinksURI","http://json-schema.org/draft-03/links#"),i._schemas["http://json-schema.org/schema#"]=T,i._schemas["http://json-schema.org/hyper-schema#"]=C,i._schemas["http://json-schema.org/links#"]=M,N.registerEnvironment("json-schema-draft-03",i),N.getDefaultEnvironmentID()&&"json-schema-draft-01"!==N.getDefaultEnvironmentID()&&"json-schema-draft-02"!==N.getDefaultEnvironmentID()||N.setDefaultEnvironmentID("json-schema-draft-03")}(),e.JSONFormValidator=n.JSV})(this,!1)}(),function(){(function(e,t,n,r,i){e&&(r=require("underscore"));var o=/\[([0-9]*)\](?=\.|$)/g,a=/\[([0-9]*)\](?:\.|$)/,s={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},l={evaluate:/\{\[([\s\S]+?)\]\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g},u={util:{}},c=function(e){return e?(""+e).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):""},d=function(e){return e.replace(/([\!\"\#\$\%\&\'\(\)\*\+\,\.\/\:\;<\=\>\?\@\[\\\]\^\`\{\|\}\~])/g,"\\$1")},f=function(e){var t=function(e,t){t.find("> .active").removeClass("active"),e.addClass("active")},r=function(e,t){e.find("input, textarea, select").removeAttr("disabled"),e.parent().children(":not([data-idx="+t+"])").find("input, textarea, select").attr("disabled","disabled")},i=function(e){var i,o=n("option:selected",n(this)),a=n(this),s=o.attr("data-idx")||o.attr("value");e.preventDefault(),o.hasClass("active")||(i=n(this).parents(".tabbable").eq(0).find(".tab-content [data-idx="+s+"]"),t(o,a),t(i,i.parent()),r(i,s))},o=function(e){n("a",n(this));var i=n(this).parents(".tabbable").first().find(".tab-content").first(),o=n(this).index(),a=i.find("[data-idx="+o+"]");e.preventDefault(),t(n(this),n(this).parent()),t(a,a.parent()),n(this).parent().hasClass("jsonform-alternative")&&r(a,o)};e.each(function(){n(this).delegate("select.nav","change",i),n(this).find("select.nav").each(function(){n(this).val(n(this).find(".active").attr("value"));var e=n(this).find("option:selected").attr("data-idx")||n(this).find("option:selected").attr("value"),t=n(this).parents(".tabbable").eq(0).find(".tab-content [data-idx="+e+"]");r(t,e)}),n(this).delegate("ul.nav li","click",o),n(this).find("ul.nav li.active").click()})};u.fieldTemplate=function(e){return'<div class="control-group jsonform-error-<%= keydash %> <%= elt.htmlClass ? elt.htmlClass : "" %>"><% if (node.title && !elt.notitle) { %><label class="control-label" for="<%= node.id %>"><%= node.title %></label><% } %><div class="controls"><% if (node.prepend || node.append) { %><div class="<% if (node.prepend) { %>input-prepend<% } %><% if (node.append) { %> input-append<% } %>"><% if (node.prepend) { %><span class="add-on"><%= node.prepend %></span><% } %><% } %>'+e+"<% if (node.append) { %>"+'<span class="add-on"><%= node.append %></span>'+"<% } %>"+"<% if (node.prepend || node.append) { %>"+"</div>"+"<% } %>"+"<% if (node.description) { %>"+'<span class="help-inline"><%= node.description %></span>'+"<% } %>"+'<span class="help-block jsonform-errortext" style="display:none;"></span>'+"</div></div>"};var p='<% if (value.type=="image") { %><img class="jsonform-preview" id="jsonformpreview-<%= id %>" src="<%= value.url %>" /><% } else { %><a href="<%= value.url %>"><%= value.name %></a> (<%= Math.ceil(value.size/1024) %>kB)<% } %><br/>';u.elementTypes={none:{template:""},root:{template:"<div><%= children %></div>"},text:{template:'<input class="input-xlarge xlarge" type="text" name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%> />',fieldtemplate:!0,inputfield:!0},password:{template:'<input class="input-xlarge xlarge" type="password" name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%> />',fieldtemplate:!0,inputfield:!0},color:{template:'<input class="input-xlarge xlarge" type="text" name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%> />',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){n(t.el).find("#"+d(t.id)).spectrum({preferredFormat:"hex",showInput:!0})}},textarea:{template:'<textarea id="<%= id %>" name="<%= node.name %>" style="height:<%= elt.height || "150px" %>;width:<%= elt.width || "100%" %>;"<%= (node.disabled? " disabled" : "")%>><%= value %></textarea>',fieldtemplate:!0,inputfield:!0},wysihtml5:{template:'<textarea id="<%= id %>" name="<%= node.name %>" style="height:<%= elt.height || "300px" %>;width:<%= elt.width || "100%" %>;"><%= value %></textarea>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){var r=function(){n(t.el).data("wysihtml5")||(n(t.el).data("wysihtml5_loaded",!0),n(t.el).find("#"+d(t.id)).wysihtml5({html:!0,link:!0,"font-styles":!0,image:!0}))};if(window.jsonform_wysihtml5_setup)return window.jsonform_wysihtml5_setup(r),void 0;var i=window.setInterval(function(){window.wysihtml5&&(window.clearInterval(i),r())},1e3)}},ace:{template:'<div id="<%= id %>" style="position:relative;height:<%= elt.height || "300px" %>;"><div id="<%= id %>__ace" style="width:<%= elt.width || "100%" %>;height:<%= elt.height || "300px" %>;"></div><input type="hidden" name="<%= node.name %>" id="<%= id %>__hidden" value="<%= escape(value) %>"/></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){var i=function(){var e=t.formElement||{},i=window.ace,o=i.edit(n(t.el).find("#"+d(t.id)+"__ace").get(0)),a="#"+d(t.id)+"__hidden";if(o.getSession().setNewLineMode("unix"),o.renderer.setShowPrintMargin(!1),o.setTheme("ace/theme/"+(e.aceTheme||"twilight")),e.aceMode){var s=i.require("ace/mode/"+e.aceMode).Mode;o.getSession().setMode(new s)}o.getSession().setTabSize(2),o.getSession().setValue(t.value||"");var l=r.debounce(function(){n(t.el).find(a).val(o.getSession().getValue()),n(t.el).find(a).change()},600);o.getSession().on("change",l),o.on("blur",function(){n(t.el).find(a).change(),n(t.el).find(a).trigger("blur")}),o.on("focus",function(){n(t.el).find(a).trigger("focus")})};if(window.jsonform_ace_setup)return window.jsonform_ace_setup(i),void 0;var o=window.setInterval(function(){window.ace&&(window.clearInterval(o),i())},1e3)}},checkbox:{template:'<label class="checkbox"><input type="checkbox" id="<%= id %>" name="<%= node.name %>" value="1" <% if (value) {%>checked<% } %><%= (node.disabled? " disabled" : "")%> /><span><%= node.inlinetitle || "" %></span></label>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return n(e).parent().get(0)}},file:{template:'<input class="input-file" id="<%= id %>" name="<%= node.name %>" type="file" />',fieldtemplate:!0,inputfield:!0},"file-hosted-public":{template:"<span><% if (value && (value.type||value.url)) { %>"+p+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="<%= transloaditname %>" /><input data-transloadit-name="_transloadit_<%= transloaditname %>" type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return n(e).parent().get(0)},onBeforeRender:function(e,t){t.ownerTree._transloadit_generic_public_index?t.ownerTree._transloadit_generic_public_index++:t.ownerTree._transloadit_generic_public_index=1,e.transloaditname="_transloadit_jsonform_genericupload_public_"+t.ownerTree._transloadit_generic_public_index,t.ownerTree._transloadit_generic_elts||(t.ownerTree._transloadit_generic_elts={}),t.ownerTree._transloadit_generic_elts[e.transloaditname]=t},onChange:function(e,t){if(t.ownerTree._transloadit_bound)return!1;t.ownerTree._transloadit_bound=!0;var r=n(t.ownerTree.domRoot);r.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(e){if(e.results[":original"])for(var o=0;e.results[":original"].length>o;o++){var a=e.results[":original"][o];n("#"+d(t.ownerTree._transloadit_generic_elts[a.field].id),r).val(i.stringify(a))}t.ownerTree._transloadit_bound=!1,r.unbind("submit.transloadit"),setTimeout(function(){t.ownerTree.submit()},10)},onError:function(e){console.log("Assembly error",e)}})},onSubmit:function(e,t){return t.ownerTree._transloadit_bound?!1:!0}},"file-transloadit":{template:"<span><% if (value && (value.type||value.url)) { %>"+p+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="_transloadit_<%= node.name %>" /><input type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return n(e).parent().get(0)},onChange:function(e,t){if(t.ownerTree._transloadit_bound)return!1;t.ownerTree._transloadit_bound=!0;var r=n(t.ownerTree.domRoot);r.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(e){if(e.results[":original"])for(var o=0;e.results[":original"].length>o;o++){var a=e.results[":original"][o];n("input[name='"+a.field.replace(/^_transloadit_/,"")+"']",r).val(i.stringify(a))}t.ownerTree._transloadit_bound=!1,r.unbind("submit.transloadit"),setTimeout(function(){t.ownerTree.submit()},10)},onError:function(e){console.log("Assembly error",e)}})},onSubmit:function(e,t){return t.ownerTree._transloadit_bound?!1:!0}},select:{template:'<select name="<%= node.name %>" id="<%= id %>" <%= (node.disabled? " disabled" : "")%>> <% _.each(node.options, function(key, val) { if(key instanceof Object) { if (value === key.value) { %> <option selected value="<%= key.value %>"><%= key.title %></option> <% } else { %> <option value="<%= key.value %>"><%= key.title %></option> <% }} else { if (value === key) { %> <option selected value="<%= key %>"><%= key %></option> <% } else { %><option value="<%= key %>"><%= key %></option> <% }}}); %> </select>',fieldtemplate:!0,inputfield:!0},imageselect:{template:'<div><input type="hidden" name="<%= node.name %>" id="<%= node.id %>" value="<%= value %>" /><div class="dropdown"><a class="btn<% if (buttonClass && node.value) { %> <%= buttonClass %><% } %>" data-toggle="dropdown" href="#"<% if (node.value) { %> style="max-width:<%= width %>px;max-height:<%= height %>px"<% } %>><% if (node.value) { %><img src="<% if (!node.value.match(/^https?:/)) { %><%= prefix %><% } %><%= node.value %><%= suffix %>" alt="" /><% } else { %><%= buttonTitle %><% } %></a><div class="dropdown-menu navbar" id="<%= node.id %>_dropdown"><div><% _.each(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class="btn<% if (buttonClass) { %> <%= buttonClass %><% } %>" style="max-width:<%= width %>px;max-height:<%= height %>px"><% if (key instanceof Object) { %><img src="<% if (!key.value.match(/^https?:/)) { %><%= prefix %><% } %><%= key.value %><%= suffix %>" alt="<%= key.title %>" /></a><% } else { %><img src="<% if (!key.match(/^https?:/)) { %><%= prefix %><% } %><%= key %><%= suffix %>" alt="" /><% } %></a> <% }); %></div><div class="pagination-right"><a class="btn">Reset</a></div></div></div></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var n=t.formElement||{},r=null,i=n.imageSelectorColumns||5;
e.buttonTitle=n.imageSelectorTitle||"Select...",e.prefix=n.imagePrefix||"",e.suffix=n.imageSuffix||"",e.width=n.imageWidth||32,e.height=n.imageHeight||32,e.buttonClass=n.imageButtonClass||!1,t.options.length>i?(r=Math.ceil(t.options.length/i),e.columns=Math.ceil(t.options.length/r)):e.columns=i},getElement:function(e){return n(e).parent().get(0)},onInsert:function(e,t){n(t.el).on("click",".dropdown-menu a",function(e){e.preventDefault(),e.stopPropagation();var r="img"===e.target.nodeName.toLowerCase()?n(e.target):n(e.target).find("img"),i=r.attr("src"),o=t.formElement||{},a=o.imagePrefix||"",s=o.imageSuffix||"",l=o.imageWidth||32,u=o.imageHeight||32;i?(0===i.indexOf(a)&&(i=i.substring(a.length)),i=i.substring(0,i.length-s.length),n(t.el).find("input").attr("value",i),n(t.el).find('a[data-toggle="dropdown"]').addClass(o.imageButtonClass).attr("style","max-width:"+l+"px;max-height:"+u+"px").html('<img src="'+(i.match(/^https?:/)?"":a)+i+s+'" alt="" />')):(n(t.el).find("input").attr("value",""),n(t.el).find('a[data-toggle="dropdown"]').removeClass(o.imageButtonClass).removeAttr("style").html(o.imageSelectorTitle||"Select..."))})}},radios:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><label class="radio"><input type="radio" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>"<%= (node.disabled? " disabled" : "")%>/><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtemplate:!0,inputfield:!0},radiobuttons:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><label class="radio btn"><input type="radio" style="position:absolute;left:-9999px;" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>" /><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtempate:!0,inputfield:!0,onInsert:function(e,t){var r="active",i=t.formElement||{};i.activeClass&&(r+=" "+i.activeClass),n(t.el).find("label").on("click",function(){n(this).parent().find("label").removeClass(r),n(this).addClass(r)})}},checkboxes:{template:"<div><%= choiceshtml %></div>",fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var n=null,i=null,o='<label class="checkbox"><input type="checkbox" <% if (value) { %> checked="checked" <% } %> name="<%= name %>" value="1"<%= (node.disabled? " disabled" : "")%>><span><%= title %></span></label>';t&&t.schemaElement&&t.schemaElement.items&&(n=t.schemaElement.items["enum"]||t.schemaElement.items[0]["enum"],n&&(i="",r.each(n,function(e,n){i+=r.template(o,{name:t.key+"["+n+"]",value:r.include(t.value,e),title:t.formElement.titleMap?t.formElement.titleMap[e]:e,node:t},s)}),e.choiceshtml=i))}},array:{template:'<div id="<%= id %>"><ul class="_jsonform-array-ul" style="list-style-type:none;"><%= children %></ul><span class="_jsonform-array-buttons"><a href="#" class="btn _jsonform-array-addmore"><i class="icon-plus-sign" title="Add new"></i></a> <a href="#" class="btn _jsonform-array-deletelast"><i class="icon-minus-sign" title="Delete last"></i></a></span></div>',fieldtemplate:!0,array:!0,childTemplate:function(e){return n("").sortable?'<li data-idx="<%= node.childPos %>"><span class="draggable line"><i class="icon-list" title="Move item"></i></span>'+e+"</li>":'<li data-idx="<%= node.childPos %>">'+e+"</li>"},onInsert:function(e,t){var r=n(t.el).find("#"+d(t.id)),i=t.getArrayBoundaries(),o=function(e,i){if(e!==i){var o=i>e?1:-1,a=0,s=n("> ul",r);for(a=e;a!==i;a+=o)t.children[a].switchValuesWith(t.children[a+o]),t.children[a].render(s.get(0)),t.children[a+o].render(s.get(0));var l=n(t.children[e].el),u=n(t.children[i].el);l.detach(),u.detach(),i>e?(0===e?s.prepend(l):n(t.children[e-1].el).after(l),n(t.children[i-1].el).after(u)):(0===i?s.prepend(u):n(t.children[i-1].el).after(u),n(t.children[e-1].el).after(l))}};n("> span > a._jsonform-array-addmore",r).click(function(e){e.preventDefault(),e.stopPropagation();var o=t.children.length;return i.maxItems>=0&&(o>i.maxItems-2&&n("> span > a._jsonform-array-addmore",r).addClass("disabled"),o>i.maxItems-1)?!1:(t.insertArrayItem(o,n("> ul",r).get(0)),i.minItems>0&&o>i.minItems-1&&n("> span > a._jsonform-array-deletelast",r).removeClass("disabled"),void 0)}),n("> span > a._jsonform-array-deletelast",r).click(function(e){var o=t.children.length-1;return e.preventDefault(),e.stopPropagation(),i.minItems>0&&(i.minItems+1>o&&n("> span > a._jsonform-array-deletelast",r).addClass("disabled"),i.minItems>o)?!1:(t.deleteArrayItem(o),i.maxItems>=0&&i.maxItems-1>=o&&n("> span > a._jsonform-array-addmore",r).removeClass("disabled"),void 0)}),n(t.el).sortable&&(n("> ul",r).sortable(),n("> ul",r).bind("sortstop",function(e,t){var r=n(t.item).data("idx"),i=n(t.item).index();o(r,i)}))}},tabarray:{template:'<div id="<%= id %>"><div class="tabbable tabs-left"><ul class="nav nav-tabs"><%= tabs %></ul><div class="tab-content"><%= children %></div></div><a href="#" class="btn _jsonform-array-addmore"><i class="icon-plus-sign" title="Add new"></i></a> <a href="#" class="btn _jsonform-array-deleteitem"><i class="icon-minus-sign" title="Delete item"></i></a></div>',fieldtemplate:!0,array:!0,childTemplate:function(e){return'<div data-idx="<%= node.childPos %>" class="tab-pane">'+e+"</div>"},onBeforeRender:function(e,t){var n="";r.each(t.children,function(e,t){var r=e.legend||e.title||"Item "+(t+1);n+='<li data-idx="'+t+'"'+(0===t?' class="active"':"")+'><a class="draggable tab" data-toggle="tab">'+c(r)+"</a></li>"}),e.tabs=n},onInsert:function(e,t){var i=n(t.el).find("#"+d(t.id)),o=t.getArrayBoundaries(),a=function(e,r){if(e!==r){var o=r>e?1:-1,a=0,s=n("> .tabbable > .tab-content",i).get(0);for(a=e;a!==r;a+=o)t.children[a].switchValuesWith(t.children[a+o]),t.children[a].render(s),t.children[a+o].render(s)}},s=function(e){var o="";void 0===e&&(e=n("> .tabbable > .nav-tabs .active",i).data("idx"),e=e?parseInt(e,10):0),e>=t.children.length&&(e=t.children.length-1),r.each(t.children,function(e,t){var n=e.legend||e.title||"Item "+(t+1);o+='<li data-idx="'+t+'">'+'<a class="draggable tab" data-toggle="tab">'+c(n)+"</a></li>"}),n("> .tabbable > .nav-tabs",i).html(o),n('> .tabbable > .nav-tabs [data-toggle="tab"]',i).eq(e).click()};n("> a._jsonform-array-deleteitem",i).click(function(e){var r=n("> .tabbable > .nav-tabs .active",i).data("idx");return e.preventDefault(),e.stopPropagation(),o.minItems>0&&(o.minItems+2>r&&n("> a._jsonform-array-deleteitem",i).addClass("disabled"),o.minItems>r)?!1:(t.deleteArrayItem(r),s(),o.maxItems>=0&&o.maxItems-1>=r&&n("> a._jsonform-array-addmore",i).removeClass("disabled"),void 0)}),n("> a._jsonform-array-addmore",i).click(function(e){var r=t.children.length;return o.maxItems>=0&&(r>o.maxItems-2&&n("> a._jsonform-array-addmore",i).addClass("disabled"),r>o.maxItems-1)?!1:(e.preventDefault(),e.stopPropagation(),t.insertArrayItem(r,n("> .tabbable > .tab-content",i).get(0)),s(r),o.minItems>0&&r>o.minItems-1&&n("> a._jsonform-array-deleteitem",i).removeClass("disabled"),void 0)}),n(t.el).on("legendUpdated",function(e){s(),e.preventDefault(),e.stopPropagation()}),n(t.el).sortable&&(n("> .tabbable > .nav-tabs",i).sortable({containment:t.el}),n("> .tabbable > .nav-tabs",i).bind("sortstop",function(e,t){var r=n(t.item).data("idx"),i=n(t.item).index();a(r,i),s(i)})),o.maxItems>=0&&t.children.length>=o.maxItems&&n("> a._jsonform-array-addmore",i).addClass("disabled"),o.minItems>=0&&t.children.length<=o.minItems&&n("> a._jsonform-array-deleteitem",i).addClass("disabled")}},help:{template:'<span class="help-block" style="padding-top:5px"><%= elt.helpvalue %></span>',fieldtemplate:!0},msg:{template:"<%= elt.msg %>"},fieldset:{template:'<fieldset class="control-group jsonform-error-<%= keydash %> <% if (elt.expandable) { %>expandable<% } %> <%= elt.htmlClass?elt.htmlClass:"" %>" <% if (id) { %> id="<%= id %>"<% } %>><% if (node.title || node.legend) { %><legend><%= node.title || node.legend %></legend><% } %><% if (elt.expandable) { %><div class="control-group"><% } %><%= children %><% if (elt.expandable) { %></div><% } %></fieldset>'},advancedfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable <%= elt.htmlClass?elt.htmlClass:"" %>"><legend>Advanced options</legend><div class="control-group"><%= children %></div></fieldset>'},authfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable <%= elt.htmlClass?elt.htmlClass:"" %>"><legend>Authentication settings</legend><div class="control-group"><%= children %></div></fieldset>'},submit:{template:'<input type="submit" <% if (id) { %> id="<%= id %>" <% } %> class="btn btn-primary <%= elt.htmlClass?elt.htmlClass:"" %>" value="<%= value || node.title %>"<%= (node.disabled? " disabled" : "")%>/>'},button:{template:' <button <% if (id) { %> id="<%= id %>" <% } %> class="btn <%= elt.htmlClass?elt.htmlClass:"" %>"><%= node.title %></button> '},actions:{template:'<div class="form-actions <%= elt.htmlClass?elt.htmlClass:"" %>"><%= children %></div>'},hidden:{template:'<input type="hidden" id="<%= id %>" name="<%= node.name %>" value="<%= escape(value) %>" />',inputfield:!0},selectfieldset:{template:'<fieldset class="tab-container <%= elt.htmlClass?elt.htmlClass:"" %>"><% if (node.legend) { %><legend><%= node.legend %></legend><% } %><% if (node.formElement.key) { %><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><% } else { %><a id="<%= node.id %>"></a><% } %><div class="tabbable"><div class="control-group<%= node.formElement.hideMenu ? " hide" : "" %>"><% if (node.title && !elt.notitle) { %><label class="control-label" for="<%= node.id %>"><%= node.title %></label><% } %><div class="controls"><%= tabs %></div></div><div class="tab-content"><%= children %></div></div></fieldset>',inputfield:!0,getElement:function(e){return n(e).parent().get(0)},childTemplate:function(e){return'<div data-idx="<%= node.childPos %>" class="tab-pane<% if (node.active) { %> active<% } %>">'+e+"</div>"},onBeforeRender:function(e,t){var n=null,i=[];t.schemaElement&&(i=t.schemaElement["enum"]||[]),n=t.options?r.map(t.options,function(e,n){var o=t.children[n];return e instanceof Object?(e=r.extend({node:o},e),e.title=e.title||o.legend||o.title||"Option "+(o.childPos+1),e.value=e.value||i[n]||n,e):{title:e,value:i[o.childPos]||o.childPos,node:o}}):r.map(t.children,function(e){return{title:e.legend||e.title||"Option "+(e.childPos+1),value:i[e.childPos]||e.childPos,node:e}});var o=null;e.value&&(o=r.find(n,function(e){return e.value===t.value})),o||(o=r.find(n,function(e){return e.node.hasNonDefaultValue()})),o||(o=n[0]),o.node.active=!0,e.value=o.value,t.formElement;var a='<select class="nav"'+(t.disabled?" disabled":"")+">";return r.each(n,function(e,t){a+='<option data-idx="'+t+'" value="'+e.value+'"'+(e.node.active?' class="active"':"")+">"+c(e.title)+"</option>"}),a+="</select>",e.tabs=a,e},onInsert:function(e,t){n(t.el).find("select.nav").first().on("change",function(){var e=n(this).find("option:selected");n(t.el).find('input[type="hidden"]').first().val(e.attr("value"))})}},optionfieldset:{template:'<div<% if (node.id) { %> id="<%= node.id %>"<% } %>><%= children %></div>'},section:{template:'<div<% if (node.id) { %> id="<%= node.id %>"<% } %>><%= children %></div>'},questions:{template:'<div><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><%= children %></div>',fieldtempate:!0,inputfield:!0,getElement:function(e){return n(e).parent().get(0)},onInsert:function(e,t){t.children&&0!==t.children.length&&(r.each(t.children,function(e){n(e.el).hide()}),n(t.children[0].el).show())}},question:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><label class="radio<%= (node.formElement.optionsType === "radiobuttons") ? " btn" : "" %><%= ((key instanceof Object && key.htmlClass) ? " " + key.htmlClass : "") %>"><input type="radio" <% if (node.formElement.optionsType === "radiobuttons") { %> style="position:absolute;left:-9999px;" <% } %>name="<%= node.id %>" value="<%= val %>"<%= (node.disabled? " disabled" : "")%>/><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtemplate:!0,onInsert:function(e,t){var i="active",o=t.formElement||{};o.activeClass&&(i+=" "+o.activeClass),n(t.el).find('input[type="radio"]').on("change",function(){var e=null,o=t.options[n(this).val()];t.parentNode&&t.parentNode.el&&(n(this).parent().parent().find("label").removeClass(i),n(this).parent().addClass(i),n(t.el).nextAll().hide(),n(t.el).nextAll().find('input[type="radio"]').prop("checked",!1),o.value&&n(t.parentNode.el).find('input[type="hidden"]').val(o.value),o.next&&(e=r.find(t.parentNode.children,function(e){return e.formElement&&e.formElement.qid===o.next}),n(e.el).show(),n(e.el).nextAll().hide(),n(e.el).nextAll().find('input[type="radio"]').prop("checked",!1)),o.href&&(o.target?window.open(o.href,o.target):window.location=o.href),o.submit&&setTimeout(function(){t.ownerTree.submit()},0))})}}},u.util.getObjKey=function(e,t,n){for(var i=e,o=t.split("."),s=null,l=null,u=0;o.length>u;u++){if(null===i||"object"!=typeof i)return null;if(s=o[u],l=s.match(a)){if(s=s.replace(a,""),!r.isArray(i[s]))return null;i=i[s][parseInt(l[1],10)]}else i=n&&!i[s]&&r.isArray(i)&&i[0]?i[0][s]:i[s]}return n&&r.isArray(i)&&i[0]?i[0]:i},u.util.setObjKey=function(e,t,n){for(var i=e,o=t.split("."),s=null,l=null,u=0;o.length-1>u;u++)s=o[u],l=s.match(a),l?(s=s.replace(a,""),r.isArray(i[s])||(i[s]=[]),("object"!=typeof i[s][parseInt(l[1],10)]||null===i[s][parseInt(l[1],10)])&&(i[s][parseInt(l[1],10)]={}),i=i[s][parseInt(l[1],10)]):(("object"!=typeof i[s]||null===i[s])&&(i[s]={}),i=i[s]);s=o[o.length-1],l=s.match(a),l?(s=s.replace(a,""),r.isArray(i[s])||(i[s]=[]),i[s][parseInt(l[1],10)]=n):i[s]=n};var h=function(e,t){var n=t.replace(/\./g,".properties.").replace(/\[[0-9]*\](\.|$)/g,".items$1");return u.util.getObjKey(e,n,!0)},m=function(e,t){var n=0,r=0;if(!e)return null;if(t>0)for(;t>n;){if(r=e.indexOf("[]",r),-1===r)return e;r+=2,n+=1}return r=e.indexOf("[]",r),-1===r?e:e.substring(0,r)},g=function(e,t){var n=0;if(!e)return null;if(!t||0===t.length)return e;var i=e.replace(o,function(e){var i=e;return r.isUndefined(t[n])||r.isNull(t[n])||(i="["+t[n]+"]"),n+=1,i});return i},v=function(e,t,n,i,o){var a=null;i=i||{},i.idx=i.idx||(n?n[n.length-1]:1),i.value=i.value||"",i.getValue=i.getValue||function(t){return v(e,t,n,i,o)};var s=function(e,t){var n=null;return e&&e.length?(r.each(e,function(e){return n?void 0:e===t?(n={key:e},void 0):(r.isString(e)||(e.key===t?n=e:e.items&&(n=s(e.items,t))),void 0)}),n):null},c=s(e.form||[],t);if(o&&e.value&&(a=u.util.getObjKey(e.value,g(t,n))),a===void 0||null===a){if(c&&c.value!==void 0)a=c.value;else{var d=h(e.schema.properties,t);d&&(a=d["default"]||"")}a&&-1!==a.indexOf("{{values.")&&(a=a.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}')),a&&(a=r.template(a,i,l))}return a!==void 0&&null!==a&&c&&c.titleMap&&c.titleMap[a]&&(a=r.template(c.titleMap[a],i,l)),a===void 0?null:a},_=function(){this.id=null,this.key=null,this.el=null,this.formElement=null,this.schemaElement=null,this.view=null,this.children=[],this.ownerTree=null,this.parentNode=null,this.childTemplate=null,this.legendChild=null,this.arrayPath=[],this.childPos=0};_.prototype.clone=function(e){var t=new _;return t.arrayPath=r.clone(this.arrayPath),t.ownerTree=this.ownerTree,t.parentNode=e||this.parentNode,t.formElement=this.formElement,t.schemaElement=this.schemaElement,t.view=this.view,t.children=r.map(this.children,function(e){return e.clone(t)}),this.childTemplate&&(t.childTemplate=this.childTemplate.clone(t)),t},_.prototype.hasNonDefaultValue=function(){if(this.formElement&&"hidden"==this.formElement.type)return!1;if(this.value&&!this.defaultValue)return!0;var e=r.find(this.children,function(e){return e.hasNonDefaultValue()});return!!e},_.prototype.appendChild=function(e){return e.parentNode=this,e.childPos=this.children.length,this.children.push(e),e},_.prototype.removeChild=function(){var e=this.children[this.children.length-1];if(e)return n(e.el).remove(),this.children.pop()},_.prototype.moveValuesTo=function(e){var t=this.getFormValues(e.arrayPath);e.resetValues(),e.computeInitialValues(t,!0)},_.prototype.switchValuesWith=function(e){var t=this.getFormValues(e.arrayPath),n=e.getFormValues(this.arrayPath);e.resetValues(),e.computeInitialValues(t,!0),this.resetValues(),this.computeInitialValues(n,!0)},_.prototype.resetValues=function(){var e=null;if(this.value=null,this.parentNode?(this.arrayPath=r.clone(this.parentNode.arrayPath),this.parentNode.view&&this.parentNode.view.array&&this.arrayPath.push(this.childPos)):this.arrayPath=[],this.view&&this.view.inputfield)e=n(":input",this.el).serializeArray(),r.each(e,function(e){n('[name="'+d(e.name)+'"]',n(this.el)).val("")},this);else if(this.view&&this.view.array)for(;this.children.length>0;)this.removeChild();r.each(this.children,function(e){e.resetValues()})},_.prototype.setChildTemplate=function(e){this.childTemplate=e,e.parentNode=this},_.prototype.computeInitialValues=function(e,t){var n=this,i=null,o=1,a=0,s=this.ownerTree.formDesc.tpldata||{};if(this.parentNode?(this.arrayPath=r.clone(this.parentNode.arrayPath),this.parentNode.view&&this.parentNode.view.array&&this.arrayPath.push(this.childPos)):this.arrayPath=[],s.idx=this.arrayPath.length>0?this.arrayPath[this.arrayPath.length-1]+1:this.childPos+1,s.value="",s.getValue=function(t){return v(n.ownerTree.formDesc,t,n.arrayPath,s,!!e)},this.formElement&&(this.formElement.id?this.id=g(this.formElement.id,this.arrayPath):this.view&&this.view.array?this.id=d(this.ownerTree.formDesc.prefix)+"-elt-counter-"+r.uniqueId():this.parentNode&&this.parentNode.view&&this.parentNode.view.array?this.id=d(this.ownerTree.formDesc.prefix)+"-elt-counter-"+r.uniqueId():("button"===this.formElement.type||"selectfieldset"===this.formElement.type||"question"===this.formElement.type||"buttonquestion"===this.formElement.type)&&(this.id=d(this.ownerTree.formDesc.prefix)+"-elt-counter-"+r.uniqueId()),this.formElement.key&&(this.key=g(this.formElement.key,this.arrayPath),this.keydash=this.key.replace(/\./g,"---")),this.name=g(this.formElement.name,this.arrayPath),r.each(["title","legend","description","append","prepend","inlinetitle","helpvalue","value","disabled"],function(e){r.isString(this.formElement[e])?(this[e]=-1!==this.formElement[e].indexOf("{{values.")?this.formElement[e].replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):g(this.formElement[e],this.arrayPath),this[e]&&(this[e]=r.template(this[e],s,l))):this[e]=this.formElement[e]},this),this.formElement.options&&(this.options=r.map(this.formElement.options,function(e){var t=null;return r.isObject(e)&&e.title?(t=-1!==e.title.indexOf("{{values.")?e.title.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):g(e.title,n.arrayPath),r.extend({},e,{value:e.value!==void 0?e.value:"",title:r.template(t,s,l)})):e}))),this.view&&this.view.inputfield&&this.schemaElement)e?u.util.getObjKey(e,this.key)&&(this.value=u.util.getObjKey(e,this.key)):t||!this.value&&this.schemaElement["default"]&&(this.value=this.schemaElement["default"],r.isString(this.value)&&(this.value=-1!==this.value.indexOf("{{values.")?this.value.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):g(this.value,this.arrayPath),this.value&&(this.value=r.template(this.value,s,l))),this.defaultValue=!0);else if(this.view&&this.view.array)for(o=0,e&&(o=this.getPreviousNumberOfItems(e,this.arrayPath)),0===o&&(o=1),a=0;o>a;a++)this.appendChild(this.childTemplate.clone());if(r.each(this.children,function(n){n.computeInitialValues(e,t)}),this.formElement&&this.formElement.valueInLegend)for(i=this;i;){if(i.parentNode&&i.parentNode.view&&i.parentNode.view.array&&(i.legendChild=this,i.formElement&&i.formElement.legend)){i.legend=g(i.formElement.legend,i.arrayPath),s.idx=i.arrayPath.length>0?i.arrayPath[i.arrayPath.length-1]+1:i.childPos+1,s.value=this.value||"",i.legend=r.template(i.legend,s,l);break}i=i.parentNode}},_.prototype.getPreviousNumberOfItems=function(e,t){var n=null,i=null,o=null;return e?this.view.inputfield&&this.schemaElement?(n=m(this.formElement.key,t.length),n=g(n,t),(i=u.util.getObjKey(e,n))?(o=r.map(this.children,function(n){return n.getPreviousNumberOfItems(e,t)}),r.max([r.max(o)||0,i.length])):0):this.view.array?this.childTemplate.getPreviousNumberOfItems(e,t):(o=r.map(this.children,function(n){return n.getPreviousNumberOfItems(e,t)}),r.max(o)||0):0},_.prototype.getFormValues=function(e){var t={};if(!this.el)throw Error("formNode.getFormValues can only be called on nodes that are associated with a DOM element in the tree");var o=n(":input",this.el).serializeArray();e&&r.each(o,function(t){t.name=g(t.name,e)});for(var a=this.ownerTree.formDesc.schema,s=0;o.length>s;s++){var l=o[s].name,c=h(a.properties,l),d=null,f=null;if(c)if(c._jsonform_checkboxes_as_array&&(d=l.match(/\[([0-9]*)\]$/)))l=l.replace(/\[([0-9]*)\]$/,""),f=u.util.getObjKey(t,l)||[],"1"===o[s].value&&f.push(c["enum"][parseInt(d[1],10)]),u.util.setObjKey(t,l,f);else{if("boolean"===c.type&&(o[s].value="0"===o[s].value?!1:!!o[s].value),("number"===c.type||"integer"===c.type)&&r.isString(o[s].value)&&(o[s].value.length?isNaN(Number(o[s].value))||(o[s].value=Number(o[s].value)):o[s].value=void 0),"string"!==c.type||""!==o[s].value||c._jsonform_allowEmpty||(o[s].value=null),"object"===c.type&&r.isString(o[s].value)&&"{"===o[s].value.substring(0,1))try{o[s].value=i.parse(o[s].value)}catch(p){o[s].value={}}"object"!==c.type||"null"!==o[s].value&&""!==o[s].value||(o[s].value=null),o[s].name&&null!==o[s].value&&u.util.setObjKey(t,o[s].name,o[s].value)}}return t},_.prototype.render=function(e){var t=this.generate();this.setContent(t,e),this.enhance()},_.prototype.setContent=function(e,t){var r=n(e),i=t||(this.parentNode?this.parentNode.el:this.ownerTree.domRoot),o=null;this.el?n(this.el).replaceWith(r):(o=n(i).children().get(this.childPos),o?n(o).before(r):n(i).append(r)),this.el=r,this.updateElement(this.el)},_.prototype.updateElement=function(e){this.id&&(this.el=n("#"+d(this.id),e).get(0),this.view&&this.view.getElement&&(this.el=this.view.getElement(this.el)),this.fieldtemplate!==!1&&this.view&&this.view.fieldtemplate&&(this.el=n(this.el).parent().parent(),(this.prepend||this.prepend)&&(this.el=this.el.parent()),this.el=this.el.get(0)),this.parentNode&&this.parentNode.view&&this.parentNode.view.childTemplate&&(this.el=n(this.el).parent().get(0))),r.each(this.children,function(t){t.updateElement(this.el||e)})},_.prototype.generate=function(){var e={id:this.id,keydash:this.keydash,elt:this.formElement,schema:this.schemaElement,node:this,value:this.value||"",escape:c},t=null,n="";this.ownerTree.formDesc.onBeforeRender&&this.ownerTree.formDesc.onBeforeRender(e,this),this.view.onBeforeRender&&this.view.onBeforeRender(e,this),t=this.template?this.template:this.formElement&&this.formElement.template?this.formElement.template:this.view.template,this.fieldtemplate!==!1&&(this.fieldtemplate||this.view.fieldtemplate)&&(t=u.fieldTemplate(t)),this.parentNode&&this.parentNode.view&&this.parentNode.view.childTemplate&&(t=this.parentNode.view.childTemplate(t));var i="";return r.each(this.children,function(e){i+=e.generate()}),e.children=i,n=r.template(t,e,s)},_.prototype.enhance=function(){var e=this,t=null,i=null,o=r.clone(this.ownerTree.formDesc.tpldata)||{};this.formElement&&(this.view.onInsert&&this.view.onInsert({target:n(this.el)},this),t=this.handlers||this.formElement.handlers,i=this.onInsert||this.formElement.onInsert,i&&i({target:n(this.el)},this),t&&r.each(t,function(e,t){"insert"===t&&e({target:n(this.el)},this)},this),this.el&&(this.onChange&&n(this.el).bind("change",function(t){e.onChange(t,e)}),this.view.onChange&&n(this.el).bind("change",function(t){e.view.onChange(t,e)}),this.formElement.onChange&&n(this.el).bind("change",function(t){e.formElement.onChange(t,e)}),this.onClick&&n(this.el).bind("click",function(t){e.onClick(t,e)}),this.view.onClick&&n(this.el).bind("click",function(t){e.view.onClick(t,e)}),this.formElement.onClick&&n(this.el).bind("click",function(t){e.formElement.onClick(t,e)}),this.onKeyUp&&n(this.el).bind("keyup",function(t){e.onKeyUp(t,e)}),this.view.onKeyUp&&n(this.el).bind("keyup",function(t){e.view.onKeyUp(t,e)}),this.formElement.onKeyUp&&n(this.el).bind("keyup",function(t){e.formElement.onKeyUp(t,e)}),t&&r.each(t,function(t,r){"insert"!==r&&n(this.el).bind(r,function(n){t(n,e)})},this)),this.legendChild&&this.legendChild.formElement&&n(this.legendChild.el).bind("keyup",function(t){e.formElement&&e.formElement.legend&&e.parentNode&&(e.legend=g(e.formElement.legend,e.arrayPath),o.idx=e.arrayPath.length>0?e.arrayPath[e.arrayPath.length-1]+1:e.childPos+1,o.value=n(t.target).val(),e.legend=r.template(e.legend,o,l),n(e.parentNode.el).trigger("legendUpdated"))})),r.each(this.children,function(e){e.enhance()})},_.prototype.insertArrayItem=function(e,t){var n=0;void 0===e&&(e=this.children.length);var r=this.childTemplate.clone();for(this.appendChild(r),r.resetValues(),n=this.children.length-2;n>=e;n--)this.children[n].moveValuesTo(this.children[n+1]);for(this.children[e].resetValues(),this.children[e].computeInitialValues(),n=e;this.children.length>n;n++)this.children[n].render(t)},_.prototype.deleteArrayItem=function(e){var t=0;for(void 0===e&&(e=this.children.length-1),t=e;this.children.length-1>t;t++)this.children[t+1].moveValuesTo(this.children[t]),this.children[t].render();this.children.length>1?this.removeChild():(this.children[0].resetValues(),this.children[0].computeInitialValues(),this.children[0].render())},_.prototype.getArrayBoundaries=function(){var e={minItems:-1,maxItems:-1};if(!this.view||!this.view.array)return e;var t=function(e,n){var i=null,o={minItems:-1,maxItems:-1};return n=n||e,e.view&&e.view.array&&e!==n?o:e.key?(i=h(e.ownerTree.formDesc.schema.properties,e.key.replace(/\[[0-9]+\]/g,"[]").replace(/\[\][^\[\]]*$/,"")),i?{minItems:i.minItems||i.maxLength||-1,maxItems:i.maxItems||i.maxLength||-1}:o):(r.each(e.children,function(e){var r=t(e,n);-1!==r.minItems&&(o.minItems=-1!==o.minItems?Math.max(o.minItems,r.minItems):r.minItems),-1!==r.maxItems&&(o.maxItems=-1!==o.maxItems?Math.min(o.maxItems,r.maxItems):r.maxItems)}),o)};return t(this)};var y=function(){this.eventhandlers=[],this.root=null,this.formDesc=null};y.prototype.initialize=function(e){e=e||{},this.formDesc=r.clone(e),this.formDesc.prefix=this.formDesc.prefix||"jsonform-"+r.uniqueId(),this.formDesc.schema&&!this.formDesc.schema.properties&&(this.formDesc.schema={properties:this.formDesc.schema}),this.formDesc.form=this.formDesc.form||["*",{type:"actions",items:[{type:"submit",value:"Submit"}]}],this.formDesc.form=r.isArray(this.formDesc.form)?this.formDesc.form:[this.formDesc.form],this.root=new _,this.root.ownerTree=this,this.root.view=u.elementTypes.root,this.buildTree(),this.computeInitialValues()},y.prototype.buildTree=function(){r.each(this.formDesc.form,function(e){"*"===e?r.each(this.formDesc.schema.properties,function(e,t){this.root.appendChild(this.buildFromLayout({key:t}))},this):(r.isString(e)&&(e={key:e}),this.root.appendChild(this.buildFromLayout(e)))},this)},y.prototype.buildFromLayout=function(e){var t=null,n=new _,i=null,o=null;if(e=r.clone(e),e.items&&(e.items=r.isArray(e.items)?r.map(e.items,r.clone):[r.clone(e.items)]),e.key){if(t=h(this.formDesc.schema.properties,e.key),!t)throw Error('The JSONForm object references the schema key "'+e.key+'" but that key does not exist in the JSON schema');if(this.formDesc.onElementSchema&&this.formDesc.onElementSchema(e,t),e.name=e.name||e.key,e.title=e.title||t.title,e.description=e.description||t.description,e.id||(e.id=d(this.formDesc.prefix)+"-elt-"+e.key),e.allowEmpty&&(t._jsonform_allowEmpty=!0),e.type||(e.type="string"===t.type&&"color"===t.format?"color":"number"!==t.type&&"integer"!==t.type&&"string"!==t.type&&"any"!==t.type||t["enum"]?"boolean"===t.type?"checkbox":"object"===t.type?"fieldset":r.isUndefined(t["enum"])?t.type:"select":"text"),!e.options&&t["enum"]&&(e.options=e.titleMap?r.map(t["enum"],function(t){return{value:t,title:e.titleMap[t]||t}}):t["enum"]),"checkboxes"===e.type&&t.items){var a=t.items["enum"];a&&(t.items._jsonform_checkboxes_as_array=!0),!a&&t.items[0]&&(a=t.items[0]["enum"],a&&(t.items[0]._jsonform_checkboxes_as_array=!0))}"object"===t.type&&r.each(t.properties,function(t,r){n.appendChild(this.buildFromLayout({key:e.key+"."+r}))},this)}if(e.type||(e.type=e.parentNode?"none":"root"),i=u.elementTypes[e.type],!i)throw Error('The JSONForm contains an element whose type is unknown: "'+e.type+'"');if(t){if(!i.inputfield&&!i.array&&"selectfieldset"!==e.type&&"object"!==t.type)throw Error('The JSONForm contains an element that links to an element in the JSON schema (key: "'+e.key+'") '+'and that should not based on its type ("'+e.type+'")')}else if(i.inputfield&&"selectfieldset"!==e.type)throw Error('The JSONForm defines an element of type "'+e.type+'" '+'but no "key" property to link the input field to the JSON schema');return e.iddot=d(e.id||""),n.formElement=e,n.schemaElement=t,n.view=i,n.ownerTree=this,e.handlers||(e.handlers={}),n.view.array?(o=e.items?e.items[0]||e.items:e.key+"[]",r.isString(o)&&(o={key:o}),n.setChildTemplate(this.buildFromLayout(o))):e.items&&r.each(e.items,function(e){r.isString(e)&&(e={key:e}),n.appendChild(this.buildFromLayout(e))},this),n},y.prototype.computeInitialValues=function(){this.root.computeInitialValues(this.formDesc.value)},y.prototype.render=function(e){e&&(this.domRoot=e,this.root.render())},y.prototype.forEachElement=function(e){var t=function(n){for(var r=0;n.children.length>r;r++)e(n.children[r]),t(n.children[r])};t(this.root)},y.prototype.validate=function(e){var r=u.getFormValue(this.domRoot),i=!1,o=this.formDesc;if(o.validate!==!1){var a=!1;if("object"!=typeof o.validate?t.JSONFormValidator&&(a=t.JSONFormValidator.createEnvironment("json-schema-draft-03")):a=o.validate,a){var s=a.validate(r,this.formDesc.schema);n(this.domRoot).jsonFormErrors(!1,o),s.errors.length&&(i||(i=[]),i=i.concat(s.errors))}}return i&&!e&&(o.displayErrors?o.displayErrors(i,this.domRoot):n(this.domRoot).jsonFormErrors(i,o)),{errors:i}},y.prototype.submit=function(e){var t=function(){return e&&(e.preventDefault(),e.stopPropagation()),!1},n=u.getFormValue(this.domRoot),r=this.formDesc,i=!1;if(this.forEachElement(function(t){i||t.view.onSubmit&&(i=!t.view.onSubmit(e,t))}),i)return t();var o=this.validate();return r.onSubmit&&!r.onSubmit(o.errors,n)?t():o.errors?t():r.onSubmitValid&&!r.onSubmitValid(n)?t():!1},u.getFormValue=function(e){var t=n(e).data("jsonform-tree");return t?t.root.getFormValues():null},n.fn.jsonFormErrors=function(e){if(n(".error",this).removeClass("error"),n(".warning",this).removeClass("warning"),n(".jsonform-errortext",this).hide(),e)for(var t=0;e.length>t;t++){var r=e[t].uri.replace(/.*#\//,"").replace(/\//g,".").replace(/\.([0-9]+)(\.|$)/,"[$1]$2"),i=".jsonform-error-"+d(r.replace(/\./g,"---")),o=e[t].type||"error";n(i,this).addClass(o),n(i+" .jsonform-errortext",this).html(e[t].message).show()}},n.fn.jsonForm=function(e){var t=this;e=e||{};var r=new y;return r.initialize(e),r.render(t.get(0)),e.transloadit&&t.append('<input type="hidden" name="params" value=\''+c(i.stringify(e.transloadit.params))+"'>"),t.data("jsonform-tree",r),t.unbind((e.submitEvent||"submit")+".jsonform"),t.bind((e.submitEvent||"submit")+".jsonform",function(e){r.submit(e)}),f(t),n(".expandable > div, .expandable > fieldset",t).hide(),n(".expandable > legend",t).click(function(){var e=n(this).parent();e.toggleClass("expanded"),n("> div",e).slideToggle(100)}),r},n.fn.jsonFormValue=function(){return u.getFormValue(this)
},t.JSONForm=t.JSONForm||{util:{}},t.JSONForm.getFormValue=u.getFormValue,t.JSONForm.fieldTemplate=u.fieldTemplate,t.JSONForm.fieldTypes=u.elementTypes,t.JSONForm.getInitialValue=v,t.JSONForm.util.getObjKey=u.util.getObjKey,t.JSONForm.util.setObjKey=u.util.setObjKey})("undefined"!=typeof exports,"undefined"!=typeof exports?exports:window,"undefined"!=typeof jQuery?jQuery:{fn:{}},"undefined"!=typeof _?_:null,JSON)}(),function(){jQuery.expr[":"].regex=function(e,t,n){var r=n[3].split(","),i=/^(data|css):/,o={method:r[0].match(i)?r[0].split(":")[0]:"attr",property:r.shift().replace(i,"")},a="ig",s=RegExp(r.join("").replace(/^\s+|\s+$/g,""),a);return s.test(jQuery(e)[o.method](o.property))}}(),function(){(function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(n){function r(){!e&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;e=!0;var o=new this;e=!1;for(var a in n)o[a]="function"==typeof n[a]&&"function"==typeof i[a]&&t.test(n[a])?function(e,t){return function(){var n=this._super;this._super=i[e];var r=t.apply(this,arguments);return this._super=n,r}}(a,n[a]):n[a];return r.prototype=o,r.prototype.constructor=r,r.extend=arguments.callee,r}})()}(),function(){DatabaseForm=Class.extend({generateFor:function(e,t){this.model=e,this.formOptions=e.formOptions,$(t).jsonForm({schema:this.model.formSchema()})},submit:function(e,t){this.updateModelFromFormValues(),this.model.save(e,t)},updateModelFromFormValues:function(){for(field in this.model.schema){var e=":regex(id, jsonform.*"+field+")",t=$(e);this.model.schema[field]=this.model.schema[field].constructor==Boolean?!!t.attr("checked"):t.val()}}})}(),function(){var e={humanize:function(e){return this.capitalize(this.convertCamelToSpaces(e))},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},convertCamelToSpaces:function(e){return e.replace(/([A-Z])/g,function(e){return" "+e})}};FormModel=Class.extend({init:function(e,t){this.collection=e,this.schema=this.blankSchema,this.formOptions={},this.load(t)},load:function(e){if(e){this._id=e._id;for(field in this.schema)e[field]&&(this.schema[field]=e[field])}},formSchema:function(){var t={};for(var n in this.schema)t[n]={type:this.option(n,"type")||this.schema[n].constructor.name.toLowerCase(),title:this.option(n,"title")||e.humanize(n),id:n,"default":this.schema[n]},this.option(n,"enum")&&(t[n]["enum"]=this.option(n,"enum"));return t},option:function(e,t){return this.formOptions[e]?this.formOptions[e][t]:null},overwriteTitle:function(e,t){this.formOptions[e]?this.formOptions[e].title=t:this.formOptions[e]={title:t}},overwriteType:function(e,t){this.formOptions[e]?this.formOptions[e].type=t:this.formOptions[e]={type:t}},makeSelect:function(e,t){this.formOptions[e]?this.formOptions[e]["enum"]=t:this.formOptions[e]={"enum":t}},save:function(e,t){this._id?this.collection.update(this._id,{$set:this.schema},t):this._id=this.collection.insert(this.schema,e)}})}(),function(){PaginatedSubscriptionHandle=function(e){this.perPage=e,this._limit=e,this._limitListeners=new Deps.Dependency,this._loaded=0,this._loadedListeners=new Deps.Dependency},PaginatedSubscriptionHandle.prototype.loaded=function(){return Deps.depend(this._loadedListeners),this._loaded},PaginatedSubscriptionHandle.prototype.limit=function(){return Deps.depend(this._limitListeners),this._limit},PaginatedSubscriptionHandle.prototype.ready=function(){return this.loaded()===this.limit()},PaginatedSubscriptionHandle.prototype.loading=function(){return!this.ready()},PaginatedSubscriptionHandle.prototype.loadNextPage=function(){this._limit+=this.perPage,this._limitListeners.changed()},PaginatedSubscriptionHandle.prototype.done=function(){this._loaded=this._limit,this._loadedListeners.changed()},Meteor.subscribeWithPagination=function(){var e=Array.prototype.slice.call(arguments,0),t=e.pop(),n=new PaginatedSubscriptionHandle(t);return Meteor.autorun(function(){var t=_.map(e,function(e){return _.isFunction(e)?e():e}),r=Meteor.subscribe.apply(this,t.concat([n.limit(),function(){n.done()}]));n.stop=r.stop}),n}}(),function(){Meteor._def_template("categories",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog admin">\n    <h2>Categories</h2>\n    <form class="form-block">\n      <h3>Add new category</h3>\n      <div class="control-group">\n        <label>Name</label>\n        <div class="controls"><input id="name" type="text" value="" /></div>\n      </div>\n      <div class="form-actions">\n        <input type="submit" class="button" value="Submit" />\n      </div>\n    </form>\n    <ul>\n      ',["#",[[0,"each"],[0,"categories"]],["\n        ",[">","category_item"],"\n      "]],"\n    </ul>\n  </div>"]))}(),function(){Meteor._def_template("category_item",Handlebars.json_ast_to_func(['<li>      \n    <form>\n        <div class="control-group inline">\n          <a class="button submit edit-link" href="#">Save</a>\n          <div class="controls"><input id="name_',["{",[[0,"_id"]]],'" type="text" value="',["{",[[0,"name"]]],'" /></div>\n          <span class="category-slug small">Slug: /',["{",[[0,"slug"]]],"</span>\n        </div>\n      </form>\n  </li>"]))}(),function(){Meteor._def_template("settings",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog settings">\n    ',["#",[[0,"with"],[0,"setting"]],["\n\n      <h2>Settings</h2>\n\n      ",["#",[[0,"if"],[0,"noSettings"]],["\n      <p>No settings yet.</p>\n      "]],"\n\n      ",["#",[[0,"if"],[0,"currentUser","isAdmin"]],['\n        <form id="json-form"></form>\n        ',["{",[[0,"generateSettingsForm"],[0,"setting"]]],"\n      "]],"\n\n    "]],"\n  </div>"]))}(),function(){Meteor._def_template("toolbox",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog admin">\n      <h2>Toolbox</h2>\n      <ul>\n      <li><a href="#" class="update-categories">Update Categories</a></li>\n      </ul>\n    </div>']))}(),function(){Meteor._def_template("comment_deleted",Handlebars.json_ast_to_func(['<div class="grid-small grid-block">\n    <p>Your comment has been deleted.</p>\n  </div>']))}(),function(){Meteor._def_template("comment_edit",Handlebars.json_ast_to_func(['<div class="grid submit">\n    ',["#",[[0,"with"],[0,"comment"]],['\n    <form class="grid-block form-horizontal">\n      ',["#",[[0,"constant"]],['\n      <div class="control-group">\n        <label class="control-label">Comment</label>\n        <div class="controls" id="editor"><textarea id="body" value="" class="input-xlarge">',["{",[[0,"body"]]],"</textarea></div>\n      </div>\n      "]],'\n      <div class="form-actions">\n        <a class="delete-link" href="/comments/deleted">Delete Comment</a>\n        <input type="submit" value="Submit" title="(âŒ˜+enter)" />\n      </div>\n    </form>\n    ']],"\n  </div>"]))}(),function(){Meteor._def_template("comment_form",Handlebars.json_ast_to_func(['<div class="comment-new">\n    <form>\n      ',["#",[[0,"constant"]],['\n      <div class="comment-field" id="editor">\n        <textarea id="comment" rows="3" autofocus="autofocus"></textarea>\n      </div>\n      ']],'\n      <div class="comment-submit">\n        <input type="submit" class="button" value="Add Comment" title="(âŒ˜+enter)" />\n      </div>\n    </form>\n  </div>']))}(),function(){Meteor._def_template("comment_item",Handlebars.json_ast_to_func(['<li class="comment comment-displayed" id="',["{",[[0,"_id"]]],'">\n   <div class="comment-body">\n      <div class="comment-content">\n        <div class="comment-actions ',["#",[[0,"if"],[0,"upvoted"]],["upvoted"],["not-upvoted"]]," ",["#",[[0,"if"],[0,"downvoted"]],["downvoted"],["not-downvoted"]],'">\n          <a class="upvote" href="#">\n            <i class="icon-up"></i>\n            <span>upvote</span>\n          </a>\n          <a class="downvote" href="#">\n            <i class="icon-down"></i>\n            <span>downvote</span>\n          </a>\n        </div>\n        <div class="user-avatar"><img src="',["{",[[0,"user_avatar"]]],'" /></div>\n        <div class="comment-main">\n          <div class="comment-meta">\n            <a class="comment-username" href="/users/',["{",[[0,"userId"]]],'">',["{",[[0,"authorName"]]],'</a>\n            <span class="comment-time">',["{",[[0,"ago"]]],',</span>\n            <span class="points">',["{",[[0,"votes"]]],' <span class="unit">points </span>\n            <a href="/comments/',["{",[[0,"_id"]]],'" class="comment-permalink icon-link goto-comment">link</a>\n            ',["#",[[0,"if"],[0,"can_edit"]],['\n              | <a class="edit-link" href="/comments/',["{",[[0,"_id"]]],'/edit">Edit</a>\n            ']],"\n            ",["#",[[0,"if"],[0,"currentUser","isAdmin"]],['\n              | <a class="queue-comment" href="#">queue</a>\n              | <span>',["{",[[0,"full_date"]]],"</span>\n            "]],'\n          </div>\n          <div class="comment-text markdown">',["!",[[0,"body_formatted"]]],'</div>\n          <a href="/comments/',["{",[[0,"_id"]]],'/reply" class="comment-reply goto-comment">Reply</a>\n        </div>\n      </div>\n      ',["#",[[0,"if"],[0,"showChildComments"]],['\n      <ul class="comment-children comment-list">\n      ',["#",[[0,"each"],[0,"child_comments"]],["\n        ",["#",[[0,"with"],[0]],["\n        ",[">","comment_item"],"\n        "]],"\n      "]],"\n      </ul>\n      "]],"\n    </div>\n  </li>"]))}(),function(){Meteor._def_template("comment_list",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"has_comments"]],['\n     <ul class="comments comment-list">\n      ',["#",[[0,"each"],[0,"child_comments"]],["\n     ",[">","comment_item"],"\n      "]],"\n     </ul>\n    "],["\n      <p>No comments.</p>\n    "]]]))}(),function(){Meteor._def_template("comment_page",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"canView"]],['\n  <div class="post grid comment-page">\n\n    ',["#",[[0,"if"],[0,"comment"]],["\n    ",["#",[[0,"with"],[0,"comment"]],['\n      <ul class="selected-comment">\n       ',[">","comment_item"],"\n      </ul>\n    "]],"\n    "]],"\n\n  </div>\n  "]]]))}(),function(){Meteor._def_template("comment_reply",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"canComment"],"replace"],['\n  <div class="post grid comment-page">\n    ',["#",[[0,"if"],[0,"post"]],["\n    ",["#",[[0,"with"],[0,"post"]],["\n      ",[">","post_item"],"\n    "]],"\n    "]],"\n\n    ",["#",[[0,"if"],[0,"comment"]],["\n    ",["#",[[0,"with"],[0,"comment"]],['\n      <ul class="selected-comment">\n       ',[">","comment_item"],"\n      </ul>\n    "]],"\n    "]],"\n\n    ",[">","comment_form"],"\n  </div>\n  "]]]))}(),function(){Meteor._def_template("error",Handlebars.json_ast_to_func([["#",[[0,"each"],[0,"errors"]],["\n    ",[">","error_item"],"\n  "]]]))}(),function(){Meteor._def_template("error_item",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"show"]],['\n    <div class="grid">\n      <div class="error ',["{",[[0,"type"]]],'-message">\n        ',["{",[[0,"message"]]],"\n      </div>\n    </div>\n  "]]]))}(),function(){Meteor._def_template("footer",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"footerCode"]],['\n  <div class="footer grid ',["{",[[0,"footerClass"]]],'" style="top: ',["{",[[0,"distanceFromTop"]]],'px">\n    ',["!",[[0,"footerCode"]]],"\n  </div>\n  "]]]))}(),function(){Meteor._def_template("mobile_nav",Handlebars.json_ast_to_func(['<div id="" class="mobile-nav">\n    <div>\n      <ul>\n        <li><a class="top" href="/top">Top</a></li>\n        <li><a class="new" href="/new">New</a></li>\n        <li><a class="digest" href="/digest">Digest</a></li>\n        ',["#",[[0,"if"],[0,"currentUser","isAdmin"]],['\n          <li><a class="users" href="/users">Users</a></li>\n          <li><a class="settings" href="/settings">Settings</a></li>\n          <li><a class="admin" href="/admin">Admin</a></li>\n        ']],"\n        ",["#",[[0,"if"],[0,"canView"]],['\n          <li><a href="/submit">Post</a></li>\n        ']],"\n      </ul>\n    </div>\n  </div>"]))}(),function(){Meteor._def_template("nav",Handlebars.json_ast_to_func(['<header class="header grid">\n\n    <a id="mobile-menu" href="#menu" class="mobile mobile-button menu"><i class="icon-menu"></i><span>Menu</span></a>\n    \n    <ul class="nav site-nav desktop">\n      ',["#",[[0,"if"],[0,"canView"]],['\n      <li><a class="top" href="/top">Top</a></li>\n      <li><a class="new" href="/new">New</a></li>\n      <li><a class="best" href="/best">Best</a></li>\n      <li><a class="digest" href="/digest">Digest</a></li>\n      ']],"\n      ",["#",[[0,"if"],[0,"hasCategories"]],['\n      <li class="dropdown">\n        <a class="categories" href="/">Categories</a>\n        <div class="dropdown-menu">\n          <ul role="menu" aria-labelledby="dLabel">\n            ',["#",[[0,"each"],[0,"categories"]],['\n              <li><a class="pending" href="/c/',["{",[[0,"slug"]]],'">',["{",[[0,"name"]]],"</a></li>\n            "]],"\n          </ul>\n        </div>\n      </li>\n      "]],"\n      ",["#",[[0,"if"],[0,"isAdmin"]],['\n      <li class="dropdown">\n        <a class="admin" href="/">Admin</a>\n        <div class="dropdown-menu">\n          <ul role="menu" aria-labelledby="dLabel">\n            <li><a class="pending" href="/pending">Pending</a></li>\n            <li><a class="users" href="/users">Users</a></li>\n            <li><a class="settings" href="/settings">Settings</a></li>\n            <li><a class="categories" href="/categories">Categories</a></li>\n            <li><a class="categories" href="/toolbox">Toolbox</a></li>\n          </ul>\n        </div>\n      </li>\n      ']],"\n    </ul>\n    \n    ",["#",[[0,"if"],[0,"logo_url"]],['\n      <h1 class="logo image" style="height:',["{",[[0,"logo_height"]]],"px; width:",["{",[[0,"logo_width"]]],"px; top:",["{",[[0,"logo_top"]]],"px; margin-left:",["{",[[0,"logo_offset"]]],'px;">\n        <a href="/">\n          <img src="',["{",[[0,"logo_url"]]],'" style="height:',["{",[[0,"logo_height"]]],'px;" alt="',["{",[[0,"site_title"]]],'"/>\n        </a>\n      </h1>\n    '],['\n      <h1 class="logo"><a href="/">',["{",[[0,"site_title"]]],"</a></h1>\n    "]],"\n    \n    ",["#",[[0,"if"],[0,"canView"]],['\n    <ul class="nav user-nav desktop">\n      <li><a id="submit" class="submit button" href="/submit">Post</a></li>\n    </ul>\n    ']],'\n    \n    <div class="auth-buttons">\n      ',["{",[[0,"loginButtons"],{align:"right"}]],"\n    </div>\n\n  </header>"]))}(),function(){Meteor._def_template("already_logged_in",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog">\n   <p>You are already logged in</p>\n  </div>']))}(),function(){Meteor._def_template("loading",Handlebars.json_ast_to_func(['<div id="loading" class="grid"></div>']))}(),function(){Meteor._def_template("no_account",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog">\n    <p>Sorry, this is a private site. Please sign up first.</p>\n   ',["{",[[0,"landingPageText"]]],'\n   <div class="twitter-signup twitter-auth">\n         <a class="twitter-button button" href="#">Sign In/Sign Up with Twitter</a>\n      </div>\n  </div>']))}(),function(){Meteor._def_template("no_invite",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog">\n    <h2>Thanks for signing up!</h2>\n   ',["{",[[0,"afterSignupText"]]],"\n   <p>The site is currently invite-only, but we will let you know as soon as a spot opens up.</p>\n  </div>"]))}(),function(){Meteor._def_template("no_rights",Handlebars.json_ast_to_func(["No rights"]))}(),function(){Meteor._def_template("not_found",Handlebars.json_ast_to_func(["<div class=\"grid-small grid-block dialog\">\n   <h2>Not Found!</h2>\n    <p>We're sorry; whatever you were looking for isn't here..</p>\n </div>"]))}(),function(){Meteor._def_template("notification_item",Handlebars.json_ast_to_func(['<li class="',["#",[[0,"if"],[0,"read"]],["read"]],'">\n    <span class="notification-timestamp">',["{",[[0,"nice_time"]]],"</span>\n    <p>\n      ",["!",[[0,"notificationHTML"]]],"\n    </p>\n  </li>"]))}(),function(){Meteor._def_template("notifications",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"currentUser"]],["\n   ",["#",[[0,"if"],[0,"canPost"]],['\n    <div class="notifications desktop">\n     <a href="#" class="notifications-toggle ',["{",[[0,"notification_class"]]],'">',["{",[[0,"notification_count"]]],'</a>\n      <a href="#" class="mark-as-read">Mark all as read</a>\n     <ul>\n      ',["#",[[0,"each"],[0,"notifications"]],["\n        ",[">","notification_item"],"\n       "]],"\n     </ul>\n   </div>\n    "]],"\n "]]]))}(),function(){Meteor._def_template("unsubscribe",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog admin">\n    <p>',["{",[[0,"unsubscribed"]]],"</p>\n  </div>"]))}(),function(){Meteor._def_template("post_deleted",Handlebars.json_ast_to_func(['<div class="grid-small grid-block">\n   <p>Your post has been deleted.</p>\n  </div>']))}(),function(){Meteor._def_template("posts_digest",Handlebars.json_ast_to_func(['<div class="grid">\n    <div class="grid-block">\n      The top 5 posts of each day. |\n    ',["#",[[0,"if"],[0,"showPreviousDate"]],['\n    <a href="',["{",[[0,"previousDateURL"]]],'" class="prev-link">Previous Day</a> | \n    ']],"\n    ",["{",[[0,"currentDate"]]]," |\n    ",["#",[[0,"if"],[0,"showNextDate"]],['\n    <a href="',["{",[[0,"nextDateURL"]]],'" class="next-link">Next Day</a>\n    ']],'\n    </div>\n  </div>\n  <div class="posts grid list">\n    ',["#",[[0,"each"],[0,"posts"]],["\n      ",[">","post_item"],"\n    "]],"\n  </div>"]))}(),function(){Meteor._def_template("post_edit",Handlebars.json_ast_to_func(['<div class="grid submit">\n    ',["#",[[0,"constant"]],[["#",[[0,"with"],[0,"post"]],['\n      <form class="grid-block form-horizontal">\n        <div class="control-group">\n          <label class="control-label post-form-headline">Created</label>\n          <div class="controls"><p>',["{",[[0,"created"]]],'</p></div>\n        </div>\n        <div class="control-group">\n          <label class="control-label post-form-headline">Title</label>\n          <div class="controls"><input id="title" type="text" value="',["{",[[0,"headline"]]],'" /></div>\n        </div>\n        <div class="control-group">\n          <label class="control-label post-form-url">URL</label>\n          <div class="controls"><input id="url" type="text" value="',["{",[[0,"url"]]],'" /></div>\n        </div>\n        <div class="control-group">\n          <label class="control-label post-form-body">Body</label>\n          <div class="controls" id="editor"><textarea id="body" value="" class="input-xlarge">',["{",[[0,"body"]]],'</textarea></div>\n        </div>\n        <div class="control-group post-form-category">\n          <label class="control-label">Category</label>\n          <div class="controls">\n            ',["#",[[0,"each"],[0,"categories"]],['\n            <label class="radio inline">\n              <input id="category_',["{",[[0,"_id"]]],'" type="radio" value="',["{",[[0,"_id"]]],'" name="category" ',["{",[[0,"checked"]]]," /> ",["{",[[0,"name"]]],"\n            </label>\n            "]],"\n          </div>\n        </div>\n        ",["#",[[0,"if"],[0,"isAdmin"]],['\n          <div class="control-group post-form-sticky">\n            <label class="control-label">Inactive?</label>\n            <div class="controls">\n              ',["{",[[0,"inactive"]]],'\n            </div>\n          </div>\n          <div class="control-group post-form-sticky">\n            <label class="control-label">Sticky?</label>\n            <div class="controls">\n              <input type="checkbox" name="sticky" id="sticky" ',["{",[[0,"isSticky"]]]," />\n            </div>\n          </div>\n          ",["#",[[0,"if"],[0,"isApproved"]],['\n          <div class="control-group">\n            <label class="control-label post-form-date">Submission Date</label>\n            <div class="controls"><input id="submitted_date" type="text" value="',["{",[[0,"submittedDate"]]],'" /></div>\n            <input id="submitted_hidden" type="hidden" value="',["{",[[0,"submitted"]]],'" />\n          </div>\n          <div class="control-group">\n            <label class="control-label post-form-time">Submission Time</label>\n            <div class="controls"><input id="submitted_time" type="text" value="',["{",[[0,"submittedTime"]]],'" /></div>\n          </div>\n          '],['\n          <div class="control-group">\n            <label class="control-label post-form-timestamp">Submission</label>\n            <div class="controls">\n              <p>Note: this post is still pending so it has no submission timestamp yet.</p>\n            </div>  \n          </div>\n          ']],'\n          <div class="control-group post-form-user">\n            <label class="control-label">User</label>\n            <div class="controls">\n              <select id="postUser">\n                ',["#",[[0,"each"],[0,"users"]],["\n                  <option ",["{",[[0,"isSelected"]]],' value="',["{",[[0,"_id"]]],'">',["{",[[0,"userName"]]],"</option>\n                "]],'\n              </select>\n            </div>\n          </div>\n          <div class="control-group post-form-status">\n            <label class="control-label">Status</label>\n            <div class="controls">\n              <label class="radio inline">\n                <input id="status_pending" type="radio" value="1" name="status" ',["{",[[0,"hasStatusPending"]]],' /> Pending\n              </label>\n              <label class="radio inline">\n                <input id="status_approved" type="radio" value="2" name="status" ',["{",[[0,"hasStatusApproved"]]],' /> Approved\n              </label>\n              <label class="radio inline">  \n                <input id="status_rejected" type="radio" value="3" name="status" ',["{",[[0,"hasStatusRejected"]]]," /> Rejected\n              </label>\n            </div>\n          </div>\n        "]],'\n        <div class="form-actions">\n          <a class="delete-link" href="/posts/deleted">Delete Post</a>\n          <input type="submit" value="Submit" />\n        </div>\n      </form>\n    ']]]],"\n  </div>"]))}(),function(){Meteor._def_template("post_item",Handlebars.json_ast_to_func(['<div class="post post-',["{",[[0,"rank"]]]," ",["#",[[0,"if"],[0,"sticky"]],["sticky"]]," ",["{",[[0,"inactiveClass"]]],'" id="',["{",[[0,"_id"]]],'">\n    <ul class="post-actions">\n      <li class="post-share desktop"><a href="#" class="share-link"><i class="icon-share"></i><span class="action">Share</span></a>\n        <div class="share-options hidden">\n          ',["#",[[0,"constant"]],['\n          <div data-url="',["#",[[0,"if"],[0,"url"]],[["{",[[0,"url"]]]],[["{",[[0,"current_domain"]]],"/posts/",["{",[[0,"_id"]]]]],'" data-text="',["{",[[0,"headline"]]],'" class="share-replace">\n          </div>\n          ']],'\n        </div>\n      </li>\n      <li class="post-discuss">\n        <a class="discuss-link go-to-comments" href="/posts/',["{",[[0,"_id"]]],'">\n          <i class="icon-comment"></i>\n          <span class="count">',["{",[[0,"comments"]]],'</span>\n          <span class="action">Discuss</span>\n        </a>\n      </li>\n      <li class="post-more mobile"><a class="more-link"><i class="icon-share"></i><span class="action">Text </span></a></li>\n    </ul>\n    <div class="post-content">\n      ',["#",[[0,"if"],[0,"showRank"]],['<span class="post-rank">',["{",[[0,"rank"]]],"</span>"]],'\n      <div class="post-upvote">\n        ',["#",[[0,"if"],[0,"voted"]],['\n          <span class="upvote-link voted"><i class="icon-check"></i><span>Upvote</span></span>\n        '],['\n          <a class="upvote-link not-voted" href="#"><i class="icon-up"></i><span>Upvote</span></a>\n        ']],'\n      </div>\n      <div class="post-info">\n        ',["#",[[0,"if"],[0,"sticky"]],['\n          <span class="post-sticky"><i class="icon-pin"></i><span>Sticky</span></span>\n        ']],'\n        <h3 class="post-heading">\n          <a href="',["{",[[0,"postLink"]]],'" class="post-title" target="_blank">',["{",[[0,"headline"]]],"</a>\n          ",["#",[[0,"if"],[0,"url"]],['<span class="post-domain">',["{",[[0,"domain"]]],"</span>"]],"\n            ",["#",[[0,"each"],[0,"categories"]],['\n              <a href="',["{",[[0,"categoryLink"]]],'" class="post-category">',["{",[[0,"name"]]],"</a>\n            "]],'\n        </h3>\n        <p class="post-meta"><span class="points">',["{",[[0,"votes"]]],' <span class="unit">points </span></span>by  <a class="post-author" href="/users/',["{",[[0,"userId"]]],'">',["{",[[0,"authorName"]]],'</a> <span class="post-time">',["{",[[0,"ago"]]],'</span><span class="comments">, <a class="go-to-comments" href="/posts/',["{",[[0,"_id"]]],'">',["{",[[0,"comments"]]]," comments</a></span>\n          ",["#",[[0,"if"],[0,"can_edit"]],['\n            | <a href="/posts/',["{",[[0,"_id"]]],'/edit" class="edit-link goto-edit">Edit</a>\n          ']],"\n          ",["#",[[0,"if"],[0,"currentUser","isAdmin"]],["\n            | status: ",["{",[[0,"status"]]],"</span>, votes: ",["{",[[0,"votes"]]],", baseScore: ",["{",[[0,"baseScore"]]],", score: ",["{",[[0,"short_score"]]],"\n          "]],"\n        </p>\n      </div>\n    </div>\n    ",["#",[[0,"if"],[0,"body"]],['\n      <div class="post-message markdown">',["!",[[0,"body_formatted"]]],"</div>\n    "]],"\n  </div>"]))}(),function(){Meteor._def_template("post_page",Handlebars.json_ast_to_func([["#",[[0,"if"],[0,"canView"]],['\n  <div class="single-post grid">\n    ',["#",[[0,"with"],[0,"post"]],["\n     ",[">","post_item"],"\n    "]],"\n    ",["#",[[0,"if"],[0,"canComment"]],["\n      ",[">","comment_form"],"\n    "]],"\n    ",[">","comment_list"],"\n  </div>\n  "]]]))}(),function(){Meteor._def_template("post_submit",Handlebars.json_ast_to_func(['<div class="grid submit">\n    <form class="grid-block form-horizontal">\n      ',["#",[[0,"constant"]],['\n      <div class="control-group">\n        <label class="control-label">URL</label>\n        <div class="controls"><input id="url" type="text" value="" /></div>\n      </div>\n      <div class="control-group">\n        <label class="control-label">Title</label>\n        <div class="controls"><input id="title" type="text" value="" /><a href="#" class="get-title-link">Suggest title</a></div>\n      </div>\n      <div class="control-group">\n        <label class="control-label">Message</label>\n        <div class="controls" id="editor"><textarea id="body" value="" class="input-xlarge"/></div>\n      </div>\n      <div class="control-group">\n        <label class="control-label">Category</label>\n        <div class="controls">\n          ',["#",[[0,"each"],[0,"categories"]],['\n          <label class="radio inline">\n            <input id="category_',["{",[[0,"_id"]]],'" type="radio" value="',["{",[[0,"_id"]]],'" name="category" /> ',["{",[[0,"name"]]],"\n          </label>\n          "]],"\n        </div>\n      </div>\n      "]],"\n      ",["#",[[0,"if"],[0,"isAdmin"]],["\n        ",["#",[[0,"constant"]],['\n        <div class="control-group">\n          <label class="control-label">Sticky?</label>\n          <div class="controls">\n            <input type="checkbox" name="sticky" id="sticky" />\n          </div>\n        </div>\n        <div class="control-group">\n          <label class="control-label">Date</label>\n          <div class="controls"><input id="submitted" type="text" value="',["{",[[0,"submittedDate"]]],'" /><input id="submitted_hidden" type="hidden" value="',["{",[[0,"submitted"]]],'" /></div>\n        </div>\n        <div class="control-group">\n          <label class="control-label">User</label>\n          <div class="controls">\n            <select id="postUser">\n              ',["#",[[0,"each"],[0,"users"]],["\n              <option ",["#",[[0,"if"],[0,"isSelected"]],["selected"]],' value="',["{",[[0,"_id"]]],'">',["{",[[0,"userName"]]],"</option>\n              "]],'\n            </select>\n          </div>\n        </div>\n        <div class="control-group">\n          <label class="control-label">Status</label>\n          <div class="controls">\n            <label class="radio inline">\n              <input id="status_pending" type="radio" value="1" name="status"/> Pending\n            </label>\n            <label class="radio inline">\n              <input id="status_approved" type="radio" value="2" name="status" checked /> Approved\n            </label>\n            <label class="radio inline">  \n              <input id="status_rejected" type="radio" value="3" name="status"/> Rejected\n            </label>\n          </div>\n        </div>\n        ']]," \n      "]],'\n      <div class="form-actions">\n        <input type="submit" value="Submit" />\n      </div>\n    </form>\n  </div>']))}(),function(){Meteor._def_template("posts_list",Handlebars.json_ast_to_func(['<div class="posts grid list">\n    ',["#",[[0,"each"],[0,"posts"]],["\n      ",[">","post_item"],"\n   "]],"\n </div>\n  ",["#",[[0,"if"],[0,"postsReady"]],['\n   <div class="grid more-button ',["#",[[0,"if"],[0,"allPostsLoaded"]],[" hidden "]],'">\n     <a class="more-link" href="#">Load more</a>\n   </div>\n  '],["\n    <div>Loading... </div>\n  "]]])),Meteor._def_template("posts_top",Handlebars.json_ast_to_func([["#",[[0,"with"],[0,"topPostsHandle"]],[[">","posts_list"]]]])),Meteor._def_template("posts_new",Handlebars.json_ast_to_func([["#",[[0,"with"],[0,"newPostsHandle"]],[[">","posts_list"]]]])),Meteor._def_template("posts_best",Handlebars.json_ast_to_func([["#",[[0,"with"],[0,"bestPostsHandle"]],[[">","posts_list"]]]])),Meteor._def_template("posts_pending",Handlebars.json_ast_to_func([["#",[[0,"with"],[0,"pendingPostsHandle"]],[[">","posts_list"]]]]))}(),function(){Meteor._def_template("user_edit",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog user-edit">\n   ',["#",[[0,"with"],[0,"user"]],["\n    ",["#",[[0,"if"],[0,"profileIncomplete"]],["\n    <div>\n      Please complete your profile below before continuing.\n    </div>\n    "]],"\n    <form>\n      <h2>Account</h2>\n      ",["#",[[0,"if"],[0,"username"]],['\n      <div class="control-group">\n        <label>Username</label>\n        <div class="controls">\n          <input id="username" name="username" disabled="disabled" type="text" value="',["{",[[0,"username"]]],'" />\n        </div>\n      </div>\n      ']],'\n<!--       <div class="control-group">\n        <label>Email</label>\n        <div class="controls">\n          <input id="email" name="email" disabled="disabled" type="text" value="',["{",[[0,"email"]]],'" />\n        </div>\n      </div> -->\n      <div class="control-group">\n        <label>Display Name</label>\n        <div class="controls">\n          <input name="name" type="text" value="',["{",[[0,"profile","name"]]],'" />\n        </div>\n      </div>\n      <div class="control-group">\n        <label>Email</label>\n        <div class="controls">\n          <input name="email" type="text" value="',["{",[[0,"userEmail"]]],'" />\n        </div>\n      </div>\n      <div class="control-group">\n        <label>Bio</label>\n        <div class="controls"><textarea name="bio" type="text">',["{",[[0,"profile","bio"]]],'</textarea></div>\n      </div>\n      <h3>Change Password?</h3>\n      <div class="control-group">\n        <label>Old Password</label>\n        <div class="controls"><input name="old_password" type="text" value="" /></div>\n      </div>\n      <div class="control-group">\n        <label>New Password</label>\n        <div class="controls"><input name="new_password" type="text" value="" /></div>\n      </div>\n          <div class="control-group">\n            <label class="control-label">Email Notifications</label>\n            <div class="controls">\n              <label class="radio">\n                <input id="notifications_activity" type="radio" value="1" name="notifications" ',["{",[[0,"hasNotificationsActivity"]]],' /> When people reply to me\n              </label>\n              <label class="radio">\n                <input id="notifications_none" type="radio" value="0" name="notifications" ',["{",[[0,"hasNotificationsNone"]]],' /> None\n              </label>\n<!--               <label class="radio">  \n                <input id="notifications_all" type="radio" value="2" name="notifications" ',["{",[[0,"hasNotificationsAll"]]],' /> All\n              </label> -->\n            </div>\n          </div>\n      <div class="form-actions">\n        <a href="/forgot_password">Forgot password?</a>\n        <input type="submit" class="button" value="Submit" />\n      </div>\n    </form>\n    ']],"\n  </div>"]))
}(),function(){Meteor._def_template("user_email",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog user-edit">\n   ',["#",[[0,"with"],[0,"user"]],['\n    <div>\n      Please fill in your email below to finish signing up.\n    </div>\n    <form>\n      <div class="control-group">\n        <label>Email</label>\n        <div class="controls">\n          <input name="email" type="text" value="',["{",[[0,"profile","email"]]],'" />\n        </div>\n      </div>\n      <div class="form-actions">\n        <input type="submit" class="button" value="Submit" />\n      </div>\n    </form>\n    ']],"\n  </div>"]))}(),function(){Meteor._def_template("user_item",Handlebars.json_ast_to_func(['<tr class="user">\n  <td><span class="user-avatar" style="background-image:url(',["{",[[0,"avatarUrl"]]],');"></span></td>\n <td><a href="/users/',["{",[[0,"_id"]]],'/edit">',["{",[[0,"displayName"]]],"</a></td>\n  <td>",["{",[[0,"createdAtFormatted"]]],"</td>\n <td>",["{",[[0,"profile","email"]]],'</td>\n  <td>\n    <a href="#">',["{",[[0,"postsCount"]]],'</a>\n    <ul class="posts-list hidden">\n      ',["#",[[0,"each"],[0,"posts"]],['\n        <li><a href="/posts/',["{",[[0,"_id"]]],'">',["{",[[0,"headline"]]],"</a></li>\n      "]],'\n   </ul>\n </td>\n <td><a href="#">',["{",[[0,"commentsCount"]]],"</a></td>\n  <td>",["{",[[0,"karma"]]],"</td>\n  <td>",["#",[[0,"if"],[0,"isInvited"]],['<a class="uninvite-link" href="#"><i class="icon-check"></i>Uninvite</a>'],['<a href="#" class="invite-link">Invite</a>']],"</td>\n <td>",["#",[[0,"if"],[0,"userIsAdmin"]],['<a class="unadmin-link" href="#"><i class="icon-check unadmin-link"></i>Unadmin</a>'],['<a href="#" class="admin-link">Make admin</a>']],'</td>\n <td><a class="delete-link" href="#">Delete User</a></td>\n</tr>']))}(),function(){Meteor._def_template("user_password",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog user-edit">\n    <form>\n      <h2>Forgot Password?</h2>\n      <div class="control-group">\n        <label>Your Email</label>\n        <div class="controls"><input id="email" name="email" type="text" value="" /></div>\n      </div>\n      <div class="form-actions">\n        <input type="submit" class="button" value="Reset Password" />\n      </div>\n    </form>\n  </div>']))}(),function(){Meteor._def_template("user_profile",Handlebars.json_ast_to_func(['<div class="grid">\n   ',["#",[[0,"with"],[0,"user"]],['\n   <div class="user-profile grid-block">\n     <table>\n       <tr>\n          <td colspan="2"><span class="user-avatar" style="background-image:url(',["{",[[0,"avatarUrl"]]],');"></span></td>\n       </tr>\n       <tr>\n          <td>Name: </td>\n         <td>',["{",[[0,"username"]]],"</td>\n       </tr>\n       <tr>\n          <td>Member since: </td>\n         <td>",["{",[[0,"createdAtFormatted"]]],"</td>\n       </tr>\n       <tr>\n          <td>Bio: </td>\n          <td>",["{",[[0,"profile","bio"]]],"</td>\n        </tr>\n     </table>\n      ",["#",[[0,"if"],[0,"isCurrentUser"]],['\n      <a href="/users/',["{",[[0,"_id"]]],'/edit">Edit profile</a>\n      ']],"\n   </div>\n    "]],"\n </div>"]))}(),function(){Meteor._def_template("user_signin",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog signin">\n    <h2>Sign In</h2>\n    <div class="twitter-signup twitter-auth">\n      <a class="twitter-button button" href="#">Sign In/Sign Up with Twitter</a>\n    </div>\n    <div class="regular-signup regular-auth">\n      <form>\n        <div class="control-group">\n          <label>Username</label>\n          <div class="controls"><input id="username" type="text" value="" /></div>\n        </div>\n        <div class="control-group">\n          <label>Password</label>\n          <div class="controls"><input id="password" type="password" value="" /></div>\n        </div>\n        <div class="form-actions">\n          <a href="/forgot_password">Forgot password?</a>\n          <input type="submit" class="button" value="Sign In" />\n        </div>\n      </form>\n    </div>\n  </div>\n  <p class="grid-small footer-notice">Don\'t have an account? <a href="signup" id="signup">Sign up!</a></p>']))}(),function(){Meteor._def_template("user_signup",Handlebars.json_ast_to_func(['<div class="grid-small grid-block dialog signup">\n    <h2>Sign Up</h2>\n    <div class="twitter-signup twitter-auth">\n      <a class="twitter-button button" href="#">Sign In/Sign Up with Twitter</a>\n    </div>\n    <div class="regular-signup regular-auth">\n      <form>\n        <div class="control-group">\n          <label>Username</label>\n          <div class="controls"><input id="username" name="username" type="text" value="" /></div>\n        </div>\n        <div class="control-group">\n          <label>Email</label>\n          <div class="controls"><input id="email" name="email" type="text" value="" /></div>\n        </div>\n        <div class="control-group">\n          <label>Password</label>\n          <div class="controls"><input id="password" name="password" type="password" value="" /></div>\n        </div>\n        <div class="form-actions">\n          <input type="submit" class="button" value="Sign Up" />\n        </div>  \n      </form>\n    </div>\n  </div>\n  <p class="grid-small footer-notice">Already have an account? <a href="signin" id="signin">Sign in!</a></p>']))}(),function(){Meteor._def_template("users",Handlebars.json_ast_to_func(['<div class="grid">\n      <div class="user-table grid-block">\n        <h1>Users</h1>\n        <table>\n          <thead>\n            <tr>\n              <td colspan="2">Name</td>\n              <td>Member since</td>\n              <td>Email</td>\n              <td>Posts</td>\n              <td>Comments</td>\n              <td>Karma</td>\n              <td>Is Invited?</td>\n              <td>Is Admin?</td>\n              <td>Delete</td>\n            </tr>\n          </thead>\n          <tbody>\n              ',["#",[[0,"each"],[0,"users"]],["\n                ",[">","user_item"],"\n              "]],"\n          </tbody>\n        </table>\n      </div>\n    </div>"]))}(),function(){Meteor.startup(function(){document.body.appendChild(Spark.render(Meteor._def_template(null,Handlebars.json_ast_to_func(['<div class="outer-wrapper ',["{",[[0,"currentPage"]]],'">\n  ',[">","body"],"\n</div>"]))))})}(),function(){Meteor._def_template("body",Handlebars.json_ast_to_func(["<style>\n    ",["#",[[0,"if"],[0,"backgroundColor"]],["\n      body{\n        background-color: ",["{",[[0,"backgroundColor"]]],";\n      }\n    "]],"\n    ",["#",[[0,"if"],[0,"buttonColor"]],['\n      input[type="submit"], button, .button, .auth-buttons #login-buttons #login-buttons-password, .btn, .error{\n        background-color: ',["{",[[0,"buttonColor"]]],";\n      }\n      a:hover, .post-content .post-heading .post-title:hover, .post-content .post-upvote .upvote-link i, .comment-actions a i, .comment-actions.upvoted .upvote i, .comment-actions.downvoted .downvote i{\n        color: ",["{",[[0,"buttonColor"]]],";\n      }\n    "]],"\n    ",["#",[[0,"if"],[0,"secondaryColor"]],["\n      .post-content .post-upvote .upvote-link.voted i.icon-check{\n        color: ",["{",[[0,"secondaryColor"]]],";\n      }\n    "]],"\n    ",["#",[[0,"if"],[0,"headerColor"]],["\n      .header{\n        background-color: ",["{",[[0,"headerColor"]]],";\n      }\n    "]],"\n  </style>\n\n  ",[">","mobile_nav"],'\n  <div class="content-wrapper template-',["{",[[0,"pageName"]]],'">\n    ',[">","nav"],"\n    ",[">","error"],"\n    ",["!",[[0,"renderPage"]]],"\n    ",[">","notifications"],"\n    ",[">","footer"],'\n    <div class="overlay hidden"></div>\n  </div>\n  ',["!",[[0,"extraCode"]]]]))}(),function(){Markdown={},Markdown="object"==typeof exports&&"function"==typeof require?exports:{},function(){function e(e){return e}function t(){return!1}function n(){}function r(){}n.prototype={chain:function(t,n){var r=this[t];if(!r)throw Error("unknown hook "+t);this[t]=r===e?n:function(e){return n(r(e))}},set:function(e,t){if(!this[e])throw Error("unknown hook "+e);this[e]=t},addNoop:function(t){this[t]=e},addFalse:function(e){this[e]=t}},Markdown.HookCollection=n,r.prototype={set:function(e,t){this["s_"+e]=t},get:function(e){return this["s_"+e]}},Markdown.Converter=function(){function e(e){return e=e.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(e,t,n,r,i,o){return t=t.toLowerCase(),O.set(t,k(n)),i?r:(o&&L.set(t,o.replace(/"/g,"&quot;")),"")})}function t(e){return e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,i),e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,i),e=e.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,i),e=e.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,i),e=e.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,i)}function i(e,t){var n=t;return n=n.replace(/^\n+/,""),n=n.replace(/\n+$/g,""),n="\n\n~K"+(P.push(n)-1)+"K\n\n"}function o(e,n){e=p(e);var r="<hr />\n";return e=e.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,r),e=e.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,r),e=e.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,r),e=h(e),e=g(e),e=w(e),e=t(e),e=S(e,n)}function a(e){return e=_(e),e=s(e),e=x(e),e=c(e),e=l(e),e=E(e),e=e.replace(/~P/g,"://"),e=k(e),e=b(e),e=e.replace(/  +\n/g," <br>\n")}function s(e){var t=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return e=e.replace(t,function(e){var t=e.replace(/(.)<\/?code>(?=.)/g,"$1`");return t=N(t,"!"==e.charAt(1)?"\\`*_/":"\\`*_")})}function l(e){return e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,u),e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,u),e=e.replace(/(\[([^\[\]]+)\])()()()()()/g,u)}function u(e,t,n,r,i,o,a,s){void 0==s&&(s="");var l=t,u=n.replace(/:\/\//g,"~P"),c=r.toLowerCase(),f=i,p=s;if(""==f)if(""==c&&(c=u.toLowerCase().replace(/ ?\n/g," ")),f="#"+c,void 0!=O.get(c))f=O.get(c),void 0!=L.get(c)&&(p=L.get(c));else{if(!(l.search(/\(\s*\)$/m)>-1))return l;f=""}f=A(f),f=N(f,"*_");var h='<a href="'+f+'"';return""!=p&&(p=d(p),p=N(p,"*_"),h+=' title="'+p+'"'),h+=">"+u+"</a>"}function c(e){return e=e.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,f),e=e.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,f)}function d(e){return e.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function f(e,t,n,r,i,o,a,s){var l=t,u=n,c=r.toLowerCase(),f=i,p=s;if(p||(p=""),""==f){if(""==c&&(c=u.toLowerCase().replace(/ ?\n/g," ")),f="#"+c,void 0==O.get(c))return l;f=O.get(c),void 0!=L.get(c)&&(p=L.get(c))}u=N(d(u),"*_[]()"),f=N(f,"*_");var h='<img src="'+f+'" alt="'+u+'"';return p=d(p),p=N(p,"*_"),h+=' title="'+p+'"',h+=" />"}function p(e){return e=e.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(e,t){return"<h1>"+a(t)+"</h1>\n\n"}),e=e.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,t){return"<h2>"+a(t)+"</h2>\n\n"}),e=e.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(e,t,n){var r=t.length;return"<h"+r+">"+a(n)+"</h"+r+">\n\n"})}function h(e){e+="~0";var t=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return j?e=e.replace(t,function(e,t,n){var r=t,i=n.search(/[*+-]/g)>-1?"ul":"ol",o=m(r,i);return o=o.replace(/\s+$/,""),o="<"+i+">"+o+"</"+i+">\n"}):(t=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,e=e.replace(t,function(e,t,n,r){var i=t,o=n,a=r.search(/[*+-]/g)>-1?"ul":"ol",s=m(o,a);return s=i+"<"+a+">\n"+s+"</"+a+">\n"})),e=e.replace(/~0/,"")}function m(e,t){j++,e=e.replace(/\n{2,}$/,"\n"),e+="~0";var n=R[t],r=RegExp("(^[ \\t]*)("+n+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+n+")[ \\t]+))","gm"),i=!1;return e=e.replace(r,function(e,t,n,r){var s=r,l=/\n\n$/.test(s),u=l||s.search(/\n{2,}/)>-1;return u||i?s=o(C(s),!0):(s=h(C(s)),s=s.replace(/\n$/,""),s=a(s)),i=l,"<li>"+s+"</li>\n"}),e=e.replace(/~0/g,""),j--,e}function g(e){return e+="~0",e=e.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(e,t,n){var r=t,i=n;return r=y(C(r)),r=M(r),r=r.replace(/^\n+/g,""),r=r.replace(/\n+$/g,""),r="<pre><code>"+r+"\n</code></pre>","\n\n"+r+"\n\n"+i}),e=e.replace(/~0/,"")}function v(e){return e=e.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(P.push(e)-1)+"K\n\n"}function _(e){return e=e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(e,t,n,r){var i=r;return i=i.replace(/^([ \t]*)/g,""),i=i.replace(/[ \t]*$/g,""),i=y(i),i=i.replace(/:\/\//g,"~P"),t+"<code>"+i+"</code>"})}function y(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=N(e,"*_{}[]\\",!1)}function b(e){return e=e.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4"),e=e.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4")}function w(e){return e=e.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(e,t){var n=t;return n=n.replace(/^[ \t]*>[ \t]?/gm,"~0"),n=n.replace(/~0/g,""),n=n.replace(/^[ \t]+$/gm,""),n=o(n),n=n.replace(/(^|\n)/g,"$1  "),n=n.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){var n=t;return n=n.replace(/^  /gm,"~0"),n=n.replace(/~0/g,"")}),v("<blockquote>\n"+n+"\n</blockquote>")})}function S(e,t){e=e.replace(/^\n+/g,""),e=e.replace(/\n+$/g,"");for(var n=e.split(/\n{2,}/g),r=[],i=/~K(\d+)K/,o=n.length,s=0;o>s;s++){var l=n[s];i.test(l)?r.push(l):/\S/.test(l)&&(l=a(l),l=l.replace(/^([ \t]*)/g,"<p>"),l+="</p>",r.push(l))}if(!t){o=r.length;for(var s=0;o>s;s++)for(var u=!0;u;)u=!1,r[s]=r[s].replace(/~K(\d+)K/g,function(e,t){return u=!0,P[t]})}return r.join("\n\n")}function k(e){return e=e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),e=e.replace(/<(?![a-z\/?\$!])/gi,"&lt;")}function x(e){return e=e.replace(/\\(\\)/g,I),e=e.replace(/\\([`*_{}\[\]()>#+-.!])/g,I)}function E(e){e=e.replace(/(^|\s)(https?|ftp)(:\/\/[-A-Z0-9+&@#\/%?=~_|\[\]\(\)!:,\.;]*[-A-Z0-9+&@#\/%=~_|\[\]])($|\W)/gi,"$1<$2$3>$4");var t=function(e,t){return'<a href="'+t+'">'+D.plainLinkText(t)+"</a>"};return e=e.replace(/<((https?|ftp):[^'">\s]+)>/gi,t)}function T(e){return e=e.replace(/~E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)})}function C(e){return e=e.replace(/^(\t|[ ]{1,4})/gm,"~0"),e=e.replace(/~0/g,"")}function M(e){if(!/\t/.test(e))return e;var t,n=["    ","   ","  "," "],r=0;return e.replace(/[\n\t]/g,function(e,i){return"\n"===e?(r=i+1,e):(t=(i-r)%4,r=i+1,n[t])})}function A(e){if(!e)return"";var t=e.length;return e.replace(B,function(n,r){return"~D"==n?"%24":":"!=n||r!=t-1&&!/[0-9\/]/.test(e.charAt(r+1))?"%"+n.charCodeAt(0).toString(16):":"})}function N(e,t,n){var r="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(r="\\\\"+r);var i=RegExp(r,"g");return e=e.replace(i,I)}function I(e,t){var n=t.charCodeAt(0);return"~E"+n+"E"}var D=this.hooks=new n;D.addNoop("plainLinkText"),D.addNoop("preConversion"),D.addNoop("postConversion");var O,L,P,j;this.makeHtml=function(n){if(O)throw Error("Recursive call to converter.makeHtml");return O=new r,L=new r,P=[],j=0,n=D.preConversion(n),n=n.replace(/~/g,"~T"),n=n.replace(/\$/g,"~D"),n=n.replace(/\r\n/g,"\n"),n=n.replace(/\r/g,"\n"),n="\n\n"+n+"\n\n",n=M(n),n=n.replace(/^[ \t]+$/gm,""),n=t(n),n=e(n),n=o(n),n=T(n),n=n.replace(/~D/g,"$$"),n=n.replace(/~T/g,"~"),n=D.postConversion(n),P=L=O=null,n};var R={ol:"\\d+[.]",ul:"[*+-]"},B=/(?:["'*()[\]:]|~D)/g}}()}(),function(){trackEvent=function(e,t){console.log("trackevent: ",e,t);var t=t===void 0?{}:t;Meteor.isClient&&(mixpanel.track!==void 0&&mixpanel.track(e,t),"undefined"!=typeof GoSquared&&GoSquared.DefaultTracker!==void 0&&GoSquared.DefaultTracker.TrackEvent(e,JSON.stringify(t)))}}(),function(){Gravatar={getGravatar:function(e,t){if(e.email_hash){var t=t||{},n=t.secure?"https":"http";delete t.secure;var r=e.email_hash,i=n+"://www.gravatar.com/avatar/"+r,o=_.map(t,function(e,t){return t+"="+e}).join("&");return""!==o&&(i+="?"+o),i}return e.services.twitter.profile_image_url}}}(),function(){t=function(e){var t=new Date;console.log("### "+e+" rendered at "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds())},nl2br=function(e){var t="<br />";return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+t+"$2")},getSetting=function(e,t){var n=Settings.find().fetch()[0];return n&&n[e]?n[e]:t},getAuthorName=function(e){var t=e.userId||e.user_id;return t&&(user=Meteor.users.findOne(t))?getDisplayName(user):this.author},scrollPageTo=function(e){$("body").scrollTop($(e).offset().top)},getDigestURL=function(e){return"/digest/"+e.year()+"/"+(e.month()+1)+"/"+e.date()},getDateRange=function(e){var t=moment(new Date),n=t.subtract("days",e-1),r={};return r.start=n.startOf("day").valueOf(),r.end=n.endOf("day").valueOf(),r},getDomain=function(e){return urlObject=Npm.require("url"),urlObject.parse(e).hostname},getPostUrl=function(e){return Meteor.absoluteUrl()+"posts/"+e},getCommentUrl=function(e){return Meteor.absoluteUrl()+"comments/"+e},getPostCommentUrl=function(e,t){return Meteor.absoluteUrl()+"posts/"+e+"/comment/"+t},getUserUrl=function(e){return Meteor.absoluteUrl()+"users/"+e},getCategoryUrl=function(e){return Meteor.absoluteUrl()+"c/"+e},slugify=function(e){return e=e.replace(/[^-a-zA-Z0-9,&\s]+/gi,""),e=e.replace(/-/gi,"_"),e=e.replace(/\s/gi,"-"),e=e.toLowerCase()},cleanUp=function(e){return stripHTML(e)},stripHTML=function(e){return e.replace(/<(?:.|\n)*?>/gm,"")},stripMarkdown=function(e){var t=new Markdown.Converter,n=t.makeHtml(e);return stripHTML(n)},trimWords=function(e,t){return expString=e.split(/\s+/,t),expString.length>=t?expString.join(" ")+"â€¦":e}}(),function(){canView=function(e,t){var e=e===void 0?Meteor.user():e;return Meteor.isClient&&!Session.get("settingsLoaded")?!1:getSetting("requireViewInvite")===!0?e?isAdmin(e)||e.isInvited?!0:t?"no_invite":!1:t?"no_account":!1:!0},canViewById=function(e,t){var n=Meteor.users.findOne(e);return canView(n,t)},canPost=function(e,t){var e=e===void 0?Meteor.user():e;return Meteor.isClient&&!Session.get("settingsLoaded")?!1:e?isAdmin(e)?!0:getSetting("requirePostInvite")?e.isInvited?!0:t?"no_invite":!1:!0:t?"no_account":!1},canPostById=function(e,t){var n=Meteor.users.findOne(e);return canPost(n,t)},canComment=function(e,t){return canPost(e,t)},canCommentById=function(e,t){var n=Meteor.users.findOne(e);return canComment(n,t)},canUpvote=function(e,t,n){return canPost(e,n)},canUpvoteById=function(e,t){var n=Meteor.users.findOne(e);return canUpvote(n,t)},canDownvote=function(e,t,n){return canPost(e,n)},canDownvoteById=function(e,t){var n=Meteor.users.findOne(e);return canDownvote(n,t)},canEdit=function(e,t,n){var e=e===void 0?Meteor.user():e;return e&&t?isAdmin(e)?!0:e._id!==t.userId?n?"no_rights":!1:!0:n?"no_rights":!1},canEditById=function(e,t){var n=Meteor.users.findOne(e);return canEdit(n,t)}}(),function(){selectPosts=function(e){var t={};return e.status&&(t=_.extend(t,{status:e.status})),e.slug&&(t=_.extend(t,{"categories.slug":e.slug})),e.date&&(t=_.extend(t,{submitted:{$gte:moment(e.date).startOf("day").valueOf(),$lt:moment(e.date).endOf("day").valueOf()}})),t},sortPosts=function(e){var t={sort:{sticky:-1}};return t.sort[e]=-1,t},selectDigest=function(e){return _.extend({submitted:{$gte:e.startOf("day").valueOf(),$lt:e.endOf("day").valueOf()}},selectPosts({status:STATUS_APPROVED}))},sortDigest=function(){return{sort:{baseScore:-1}}},findDigestPosts=function(e){return Posts.find(selectDigest(e),sortDigest())}}(),function(){isAdminById=function(e){var t=Meteor.users.findOne(e);return t&&isAdmin(t)},isAdmin=function(e){return e&&void 0!==e?!!e.isAdmin:!1},adminUsers=function(){return Meteor.users.find({isAdmin:!0}).fetch()},getDisplayName=function(e){return e.profile&&e.profile.name?e.profile.name:e.username},getDisplayNameById=function(e){return getDisplayName(Meteor.users.findOne(e))},getTwitterName=function(e){try{return e.services.twitter.screenName}catch(t){return void 0}},getTwitterNameById=function(e){return getTwitterName(Meteor.users.findOne(e))},getSignupMethod=function(e){return e.services&&e.services.twitter?"twitter":"regular"},getEmail=function(e){return"twitter"==getSignupMethod(e)?e.profile.email:e.emails?e.emails[0].address||e.emails[0].email:e.profile&&e.profile.email?e.profile.email:""},getAvatarUrl=function(e){return"twitter"==getSignupMethod(e)?"https://api.twitter.com/1/users/profile_image?screen_name="+e.services.twitter.screenName:Gravatar.getGravatar(e,{d:"http://demo.telesc.pe/img/default_avatar.png",s:30})},getCurrentUserEmail=function(){return Meteor.user()?getEmail(Meteor.user()):""},userProfileComplete=function(e){return!!getEmail(e)},findLast=function(e,t){return t.findOne({userId:e._id},{sort:{createdAt:-1}})},timeSinceLast=function(e,t){var n=(new Date).getTime(),r=findLast(e,t);return r?Math.abs(Math.floor((n-r.createdAt)/1e3)):999},numberOfItemsInPast24Hours=function(e,t){var n=moment(new Date),r=t.find({userId:e._id,createdAt:{$gte:n.subtract("hours",24).valueOf()}});return r.count()}}(),function(){(function(){var e=function(e){return e&&e.isAdmin?5:1},t=function(e,t){Meteor.users.update({_id:e},{$inc:{karma:t}})},n=function(e,t,n){return void 0!==t.findOne({_id:n,upvoters:e._id})},r=function(e,t,n){return void 0!==t.findOne({_id:n,downvoters:e._id})},i=function(r,i,o){var o=o===void 0?Meteor.user():o;if(!o||!canUpvote(o,r,!0)||n(o,r,i))return!1;var a=e(o),s=r.findOne(i);return r.update({_id:i},{$addToSet:{upvoters:o._id},$inc:{votes:1,baseScore:a},$set:{inactive:!1}}),this.isSimulation||updateScore(r,i,!0),s.user_id!=o._id&&t(s.user_id,a),!0},o=function(n,i,o){var o=o===void 0?Meteor.user():o;if(!o||!canDownvote(o,n,"redirect")||r(o,n,i))return!1;var a=e(o),s=n.findOne(i);return n.update({_id:i},{$addToSet:{downvoters:o._id},$inc:{votes:-1,baseScore:-a},$set:{inactive:!1}}),this.isSimulation||updateScore(n,i,!0),s.user_id!=o._id&&t(s.user_id,-a),!0},a=function(r,i,o){var o=o===void 0?Meteor.user():o;if(!o||!canUpvote(o,r,"redirect")||!n(o,r,i))return!1;var a=e(o),s=r.findOne(i);return r.update({_id:i},{$pull:{upvoters:o._id},$inc:{votes:-1,baseScore:-a},$set:{inactive:!1}}),this.isSimulation||updateScore(r,i,!0),s.user_id!=o._id&&t(s.user_id,-a),!0},s=function(n,i,o){var o=o===void 0?Meteor.user():o;if(!o||!canDownvote(o,n,"redirect")||!r(o,n,i))return!1;var a=e(o),s=n.findOne(i);return n.update({_id:i},{$pull:{downvoters:o._id},$inc:{votes:1,baseScore:a},$set:{inactive:!1}}),this.isSimulation||updateScore(n,i,!0),s.user_id!=o._id&&t(s.user_id,a),!0},l=function(e){return isAdmin(Meteor.user())&&e!==void 0?e:Meteor.user()};Meteor.methods({upvotePost:function(e,t){var t=l(t);return i.call(this,Posts,e,t)},downvotePost:function(e,t){var t=l(t);return o.call(this,Posts,e,t)},cancelUpvotePost:function(e,t){var t=l(t);return a.call(this,Posts,e,t)},cancelDownvotePost:function(e,t){var t=l(t);return s.call(this,Posts,e,t)},upvoteComment:function(e,t){var t=l(t);return i.call(this,Comments,e,t)},downvoteComment:function(e,t){var t=l(t);return o.call(this,Comments,e,t)},cancelUpvoteComment:function(e,t){var t=l(t);return a.call(this,Comments,e,t)},cancelDownvoteComment:function(e,t){var t=l(t);return s.call(this,Comments,e,t)}})})()}(),function(){Template.categories.helpers({categories:function(){return Categories.find()}}),Template.categories.events({"click input[type=submit]":function(e){e.preventDefault();var t=$("#name").val(),n=slugify(t);Meteor.call("category",{name:t,slug:n},function(e){e?(console.log(e),throwError(e.reason),clearSeenErrors()):$("#name").val("")})}})}(),function(){Template.category_item.events({"click .edit-link":function(e,t){e.preventDefault();var n=t.data._id,r=$("#name_"+n).val(),i=slugify(r);r?Categories.update(n,{$set:{name:r,slug:i}}):Categories.remove(n)}})}(),function(){var e;Template.settings.helpers({generateSettingsForm:function(t){Meteor.defer(function(){e=new DatabaseForm,e.generateFor(t,"#json-form")})},noSettings:function(){return Settings.findOne()?!1:!0},setting:function(){var e=Settings.find().fetch()[0];return new Setting(e)||new Setting}}),Template.settings.events={"click input[type=submit]":function(t){if(t.preventDefault(),!Meteor.user())throw"You must be logged in.";e.submit(function(){throwError("Settings have been created")},function(e){e&&console.log(e),throwError("Settings have been updated")})}}}(),function(){Template.toolbox.events={"click .update-categories":function(){var e=Posts.find().fetch();$.each(e,function(e,t){t.categories&&(console.log('Found categories for post "'+t.headline+'"'),$.each(t.categories),Posts.update(t._id,{$set:{userId:t.user_id}},function(e){console.log(e)}),console.log(t))})}}}(),function(){Template.comment_edit.helpers({comment:function(){return Comments.findOne(Session.get("selectedCommentId"))}}),Template.comment_edit.rendered=function(){var e=Comments.findOne(Session.get("selectedCommentId"));e&&Meteor.user()&&!this.editor&&(this.editor=new EpicEditor(EpicEditorOptions).load(),this.editor.importFile("editor",e.body),$(this.editor.editor).bind("keydown","meta+return",function(){$(window.editor).closest("form").find('input[type="submit"]').click()}))},Template.comment_edit.events={"click input[type=submit]":function(e,t){if(e.preventDefault(),!Meteor.user())throw"You must be logged in.";var n=Session.get("selectedCommentId"),r=Comments.findOne(n).post,i=cleanUp(t.editor.exportFile());Comments.update(n,{$set:{body:i}}),trackEvent("edit comment",{postId:r,commentId:n}),Meteor.Router.to("/posts/"+r+"/comment/"+n)},"click .delete-link":function(e){if(e.preventDefault(),confirm("Are you sure?")){var t=Session.get("selectedCommentId");Meteor.call("removeComment",t),Meteor.Router.to("/comments/deleted")}}}}(),function(){Template.comment_form.rendered=function(){Meteor.user()&&!this.editor&&(this.editor=new EpicEditor(EpicEditorOptions).load(),$(this.editor.editor).bind("keydown","meta+return",function(){$(window.editor).closest("form").find('input[type="submit"]').click()}))},Template.comment_form.events={"click input[type=submit]":function(e,t){e.preventDefault(),$(e.target).addClass("disabled"),clearSeenErrors();var n=t.editor.exportFile();if("comment_reply"==Meteor.Router.page()){var r=Session.get("selectedCommentId"),i=Comments.findOne(r).post;Meteor.call("comment",i,r,n,function(e,t){e?(console.log(e),throwError(e.reason)):(Session.set("selectedCommentId",null),trackEvent("newComment",t),Session.set("scrollToCommentId",t.commentId),Meteor.Router.to("/posts/"+i))})}else{var r=null,i=Session.get("selectedPostId");Meteor.call("comment",i,r,n,function(e,n){e?(console.log(e),throwError(e.reason)):(trackEvent("newComment",n),Session.set("scrollToCommentId",n.commentId),t.editor.importFile("editor",""))})}}}}(),function(){(function(){commentIsNew=function(e){var t=new Date(e.submitted),n=t>new Date(Session.get("requestTimestamp"));return n},findQueueContainer=function(e){return $up=e.prevAll(".queue-container, .comment-displayed").first(),$down=e.nextAll(".queue-container, .comment-displayed").first(),$prev=e.prev(),$next=e.next(),$queuedAncestors=e.parents(".comment-queued"),$queuedAncestors.exists()?$container=$queuedAncestors.last().data("queue"):$prev.hasClass("queue-container")?$container=$prev.data("queue"):$prev.find(".comment").last().hasClass("comment-queued")?$container=$prev.find(".comment").last().data("queue"):$down.hasClass("queue-container")?$container=$next.data("queue"):($up.hasClass("comment-displayed")||!$up.exists())&&($container=$('<div class="queue-container"><ul></ul></div>').insertBefore(e),$container.click(function(e){e.preventDefault();var t=$(this).find("a");t.each(function(){var e=$(this).attr("href");$(e).removeClass("comment-queued").addClass("comment-displayed");var t=Session.get("openedComments")||[];t.push(e.substr(1)),Session.set("openedComments",t)}),$(this).hide("slow").remove()})),$container},Template.comment_item.helpers({full_date:function(){var e=new Date(this.submitted);return""+e},child_comments:function(){var e=Session.get("selectedPostId"),t=Comments.find({post:e,parent:this._id});return t},author:function(){return Meteor.users.findOne(this.userId)},authorName:function(){return getAuthorName(this)},user_avatar:function(){return(author=Meteor.users.findOne(this.userId))?getAvatarUrl(author):void 0},can_edit:function(){return this.userId&&Meteor.userId()?Meteor.user().isAdmin||Meteor.userId()===this.userId:!1},body_formatted:function(){if(this.body){var e=new Markdown.Converter,t=e.makeHtml(this.body);return t.autoLink()}},showChildComments:function(){return Session.get("showChildComments")},ago:function(){return moment(this.submitted).fromNow()},upvoted:function(){return Meteor.user()&&_.include(this.upvoters,Meteor.user()._id)},downvoted:function(){return Meteor.user()&&_.include(this.downvoters,Meteor.user()._id)}}),Template.comment_item.created=function(){},Template.comment_item.rendered=function(){if(this.data){var e=this.data,t=$("#"+e._id),n=Session.get("openedComments")||[];if(Meteor.user()&&Meteor.user()._id==e.userId);else if(commentIsNew(e)&&!t.hasClass("comment-queued")&&-1==n.indexOf(e._id)&&Meteor.users.findOne(e.userId)){var r=Meteor.users.findOne(e.userId),i=getDisplayName(r),o=getAvatarUrl(r),a=findQueueContainer(t),s='<li class="icon-user"><a href="#'+e._id+'" class="has-tooltip" style="background-image:url('+o+')"><span class="tooltip"><span>'+i+"</span></span></a></li>";this.firstRender?($(s).appendTo(a.find("ul")).hide().fadeIn("slow"),this.firstRender=!1):$(s).appendTo(a.find("ul")),t.removeClass("comment-displayed").addClass("comment-queued"),t.data("queue",a)}}},Template.comment_item.events={"click .queue-comment":function(e){e.preventDefault();var t=$(event.target).closest(".comment").attr("id");new Date,Comments.update(t,{$set:{submitted:(new Date).getTime()}})},"click .not-upvoted .upvote":function(e,t){e.preventDefault(),Meteor.user()||(Meteor.Router.to("/signin"),throwError("Please log in first")),Meteor.call("upvoteComment",this._id,function(){trackEvent("post upvoted",{commentId:t.data._id,postId:t.data.post,authorId:t.data.userId})})},"click .upvoted .upvote":function(e,t){e.preventDefault(),Meteor.user()||(Meteor.Router.to("/signin"),throwError("Please log in first")),Meteor.call("cancelUpvoteComment",this._id,function(){trackEvent("post upvote cancelled",{commentId:t.data._id,postId:t.data.post,authorId:t.data.userId})})},"click .not-downvoted .downvote":function(e,t){e.preventDefault(),Meteor.user()||(Meteor.Router.to("/signin"),throwError("Please log in first")),Meteor.call("downvoteComment",this._id,function(){trackEvent("post downvoted",{commentId:t.data._id,postId:t.data.post,authorId:t.data.userId})})},"click .downvoted .downvote":function(e,t){e.preventDefault(),Meteor.user()||(Meteor.Router.to("/signin"),throwError("Please log in first")),Meteor.call("cancelDownvoteComment",this._id,function(){trackEvent("post downvote cancelled",{commentId:t.data._id,postId:t.data.post,authorId:t.data.userId})})}}})()}(),function(){Template.comment_list.helpers({has_comments:function(){var e=Posts.findOne(Session.get("selectedPostId"));return e?Comments.find({post:e._id,parent:null}).count()>0:void 0},child_comments:function(){var e=Posts.findOne(Session.get("selectedPostId"));return Comments.find({post:e._id,parent:null},{sort:{score:-1,submitted:-1}})}})}(),function(){Template.comment_page.post=function(){var e=Comments.findOne(Session.get("selectedCommentId"));return e&&Posts.findOne(e.post)},Template.comment_page.helpers({comment:function(){var e=Comments.findOne(Session.get("selectedCommentId"));return e}})}(),function(){Template.comment_reply.post=function(){var e=Comments.findOne(Session.get("selectedCommentId"));return e&&Posts.findOne(e.post)},Template.comment_reply.helpers({comment:function(){var e=Comments.findOne(Session.get("selectedCommentId"));return e}})}(),function(){Template.error.errors=function(){return Errors.find()
}}(),function(){Template.error_item.helpers({}),Template.error_item.created=function(){var e=this.data._id;Meteor.setTimeout(function(){Errors.update(e,{$set:{seen:!0}})},100)}}(),function(){Template.footer.helpers({footerCode:function(){return getSetting("footerCode")},distanceFromTop:function(){var e=parseInt(Session.get("distanceFromTop"))+70+20;return"posts_digest"==Meteor.Router.page()||Session.get("allPostsLoaded")||(e+=70),e},footerClass:function(){return Session.get("isPostsList")?"absolute":"static"}})}(),function(){Template.mobile_nav.events={"click .mobile-nav a":function(){$("body").toggleClass("mobile-nav-open")}}}(),function(){Template.nav.events={"click #logout":function(e){e.preventDefault(),Meteor.logout()},"click #mobile-menu":function(e){e.preventDefault(),$("body").toggleClass("mobile-nav-open")},"click .login-header":function(e){e.preventDefault(),Meteor.Router.to("/account")}},Template.nav.rendered=function(){Meteor.user()?$("#login-buttons-logout").before('<a href="/account" class="account-link button">My Account</a>'):$(".login-link-text").text("Sign Up/Sign In")},Template.nav.helpers({site_title:function(){return getSetting("title")},logo_url:function(){return getSetting("logoUrl")},logo_height:function(){return getSetting("logoHeight")},logo_width:function(){return getSetting("logoWidth")},logo_top:function(){return Math.floor((70-getSetting("logoHeight"))/2)},logo_offset:function(){return-Math.floor(getSetting("logoWidth")/2)},intercom:function(){return!!getSetting("intercomId")},canPost:function(){return canPost(Meteor.user())},requirePostsApproval:function(){return getSetting("requirePostsApproval")},hasCategories:function(){return Categories.find().count()},categories:function(){return Categories.find()}})}(),function(){Template.loading.rendered=function(){this.spinner||(this.spinner=(new Spinner).spin(this.find("#loading")))}}(),function(){Template.no_account.helpers({landingPageText:function(){return getSetting("landingPageText")}}),Template.no_account.events={"click .twitter-button":function(){Meteor.loginWithTwitter(function(){Meteor.Router.to("/")})}}}(),function(){Template.no_invite.helpers({afterSignupText:function(){return getSetting("afterSignupText")}})}(),function(){Template.notification_item.helpers({nice_time:function(){return moment(this.timestamp).fromNow()},properties:function(){return this.properties},notificationHTML:function(){return getNotification(this.event,this.properties).html}}),Template.notification_item.events({"click .action-link":function(e,t){var n=t.data._id;Notifications.update({_id:n},{$set:{read:!0}},function(e){e&&console.log(e)})}})}(),function(){Template.notifications.helpers({notifications:function(){return Notifications.find({userId:Meteor.userId()},{sort:{timestamp:-1}})},notification_count:function(){var e=Notifications.find({userId:Meteor.userId(),read:!1}).fetch();return 0==e.length?"No notifications":1==e.length?"1 notification":e.length+" notifications"},notification_class:function(){var e=Notifications.find({userId:Meteor.userId(),read:!1}).fetch();return 0==e.length?"no-notifications":void 0}}),Template.notifications.events({"click .notifications-toggle":function(e){e.preventDefault(),$("body").toggleClass("notifications-open")},"click .mark-as-read":function(){Meteor.call("markAllNotificationsAsRead",function(e){e&&console.log(e)})}})}(),function(){Template.unsubscribe.created=function(){var e=Session.get("userEmailHash");Meteor.call("unsubscribeUser",e,function(e,t){t?Session.set("unsubscribedMessage","You have been unsubscribed from all notifications."):Session.set("unsubscribedMessage","User not found.")}),trackEvent("notificationsUnsubcribe",{hash:e})},Template.unsubscribe.helpers({unsubscribed:function(){return Session.get("unsubscribedMessage")}})}(),function(){Template.posts_digest.helpers({hasPosts:function(){return digestHandle&&digestHandle.ready()},posts:function(){return findDigestPosts(moment(Session.get("currentDate")))},currentDate:function(){var e=moment(Session.get("currentDate")),t=moment(new Date),n=t.diff(e,"days");return 1===n?"Today":2===n?"Yesterday":e.format("dddd, MMMM Do YYYY")},previousDateURL:function(){var e=moment(Session.get("currentDate")),t=e.subtract("days",1);return getDigestURL(t)},showPreviousDate:function(){return!0},nextDateURL:function(){var e=moment(Session.get("currentDate")),t=e.add("days",1);return getDigestURL(t)},showNextDate:function(){var e=moment(Session.get("currentDate")).startOf("day"),t=moment(new Date).startOf("day");return isAdmin(Meteor.user())||t.diff(e,"days")>0}}),Template.posts_digest.created=function(){$(document).unbind("keyup");var e=moment(Session.get("currentDate")).startOf("day"),t=moment(new Date).startOf("daysy");$(document).bind("keyup","left",function(){Meteor.Router.to($(".prev-link").attr("href"))}),$(document).bind("keyup","right",function(){(isAdmin(Meteor.user())||t.diff(e,"days")>0)&&Meteor.Router.to($(".next-link").attr("href"))})},Template.posts_digest.rendered=function(){var e=0;$(".post").each(function(){e+=$(this).height()}),e+=55,Session.set("distanceFromTop",e),$("body").css("min-height",e+160),$(".more-button").css("top",e+"px")}}(),function(){Template.post_edit.helpers({post:function(){return Posts.findOne(Session.get("selectedPostId"))},created:function(){var e=Posts.findOne(Session.get("selectedPostId"));return moment(e.createdAt).format("MMMM Do, h:mm:ss a")},categories:function(){var e=this;return Categories.find().map(function(t){return t.checked=_.contains(_.pluck(e.categories,"_id"),t._id)?"checked":"",t})},isApproved:function(){return this.status==STATUS_APPROVED},isSticky:function(){return this.sticky?"checked":""},isSelected:function(){var e=Posts.findOne(Session.get("selectedPostId"));return e&&this._id==e.userId?"selected":""},submittedDate:function(){return moment(this.submitted).format("MM/DD/YYYY")},submittedTime:function(){return moment(this.submitted).format("HH:mm")},users:function(){return Meteor.users.find().fetch()},userName:function(){return getDisplayName(this)},hasStatusPending:function(){return this.status==STATUS_PENDING?"checked":""},hasStatusApproved:function(){return this.status==STATUS_APPROVED?"checked":""},hasStatusRejected:function(){return this.status==STATUS_REJECTED?"checked":""}}),Template.post_edit.rendered=function(){var e=Posts.findOne(Session.get("selectedPostId"));e&&!this.editor&&(this.editor=new EpicEditor(EpicEditorOptions).load(),this.editor.importFile("editor",e.body),$("#submitted_date").datepicker())},Template.post_edit.events={"click input[type=submit]":function(e,t){if(e.preventDefault(),!Meteor.user())return throwError("You must be logged in."),!1;var n=Session.get("selectedPostId"),r=Posts.findOne(n),i=[],o=$("#url").val(),a=parseInt($("input[name=status]:checked").val());$("input[name=category]:checked").each(function(){var e=$(this).val();(category=Categories.findOne(e))&&i.push(category)});var s={headline:$("#title").val(),body:t.editor.exportFile(),categories:i};o&&(s.url="http://"==o.substring(0,7)||"https://"==o.substring(0,8)?o:"http://"+o),isAdmin(Meteor.user())&&(console.log("status: "+a),console.log(r),a==STATUS_APPROVED&&(r.submitted?$("#submitted_date").exists()&&(s.submitted=parseInt(moment($("#submitted_date").val()+$("#submitted_time").val(),"MM/DD/YYYY HH:mm").valueOf())):s.submitted=(new Date).getTime()),adminProperties={sticky:!!$("#sticky").attr("checked"),userId:$("#postUser").val(),status:a},s=_.extend(s,adminProperties),console.log(s)),Posts.update(n,{$set:s},function(e){e?throwError(e.reason):(trackEvent("edit post",{postId:n}),Meteor.Router.to("/posts/"+n))})},"click .delete-link":function(e){if(e.preventDefault(),confirm("Are you sure?")){var t=Session.get("selectedPostId");Posts.remove(t),Meteor.Router.to("/posts/deleted")}}}}(),function(){Template.post_item.preserve({".post":function(e){return e.id}}),Template.post_item.helpers({postLink:function(){return this.url?this.url:"/posts/"+this._id},rank:function(){return this._rank+1},showRank:function(){return Session.get("isPostsList")},domain:function(){var e=document.createElement("a");return e.href=this.url,e.hostname},current_domain:function(){return"http://"+document.domain},can_edit:function(){return canEdit(Meteor.user(),this)},authorName:function(){return getAuthorName(this)},short_score:function(){return Math.floor(1e3*this.score)/1e3},body_formatted:function(){var e=new Markdown.Converter,t=e.makeHtml(this.body);return t.autoLink()},ago:function(){return time=this.status==STATUS_APPROVED?this.submitted:this.createdAt,moment(time).fromNow()},timestamp:function(){return time=this.status==STATUS_APPROVED?this.submitted:this.createdAt,moment(time).format("MMMM Do, h:mm:ss a")},voted:function(){var e=Meteor.user();return e?_.include(this.upvoters,e._id):!1},userAvatar:function(){return(author=Meteor.users.findOne(this.userId))?getAvatarUrl(author):void 0},inactiveClass:function(){return isAdmin(Meteor.user())&&this.inactive?"inactive":""},categoryLink:function(){return getCategoryUrl(this.slug)}}),Template.post_item.rendered=function(){for(var e=this,t=e.data._rank,n=$(this.firstNode),r=0,i=0,o=1;t>=o;o++)i+=$(".post-"+o).height();if(r=e.currentPosition){var a=r-i;n.css("top",a+"px")}Meteor.defer(function(){e.currentPosition=i,n.addClass("animate").css("top","0px")})},Template.post_item.events={"click .upvote-link":function(e){var t=this;e.preventDefault(),Meteor.user()||(Meteor.Router.to("/signin"),throwError("Please log in first")),Meteor.call("upvotePost",t._id,function(){trackEvent("post upvoted",{_id:t._id})})},"click .share-link":function(e){var t=$(e.target).parents(".post-share").find(".share-link"),n=t.parents(".post-share").find(".share-options");e.preventDefault(),$(".share-link").not(t).removeClass("active"),$(".share-options").not(n).addClass("hidden"),t.toggleClass("active"),n.toggleClass("hidden"),n.find(".share-replace").sharrre(SharrreOptions)}}}(),function(){Template.post_page.helpers({post:function(){var e=Posts.findOne(Session.get("selectedPostId"));return e},body_formatted:function(){var e=new Markdown.Converter,t=e.makeHtml(this.body);return t.autoLink()},canComment:function(){return canComment(Meteor.user())},canView:function(){return canView(Meteor.user())}}),Template.post_page.rendered=function(){(scrollToCommentId=Session.get("scrollToCommentId"))&&!this.rendered&&$("#"+scrollToCommentId).exists()&&(scrollPageTo("#"+scrollToCommentId),Session.set("scrollToCommentId",null),this.rendered=!0)}}(),function(){Template.post_submit.helpers({categories:function(){return Categories.find()},users:function(){return Meteor.users.find()},userName:function(){return getDisplayName(this)},isSelected:function(){var e=Posts.findOne(Session.get("selectedPostId"));return e&&this._id==e.userId}}),Template.post_submit.rendered=function(){Session.set("selectedPostId",null)},Template.post_submit.rendered=function(){!this.editor&&$("#editor").exists()&&(this.editor=new EpicEditor(EpicEditorOptions).load()),$("#submitted").datepicker().on("changeDate",function(e){$("#submitted_hidden").val(moment(e.date).valueOf())})},Template.post_submit.events={"click input[type=submit]":function(e,t){if(e.preventDefault(),$(e.target).addClass("disabled"),!Meteor.user())return throwError("You must be logged in."),!1;var n=$("#title").val(),r=$("#url").val(),i=t.editor.exportFile(),o=[],a=!!$("#sticky").attr("checked"),s=$("#submitted_hidden").val(),l=$("#postUser").val(),u=parseInt($("input[name=status]:checked").val());$("input[name=category]:checked").each(function(){o.push(Categories.findOne($(this).val()))});var c={headline:n,body:i,categories:o,sticky:a,submitted:s,userId:l,status:u};if(r){var d="http://"==r.substring(0,7)||"https://"==r.substring(0,8)?r:"http://"+r;c.url=d}Meteor.call("post",c,function(t,n){t?(throwError(t.reason),clearSeenErrors(),$(e.target).removeClass("disabled"),603==t.error&&Meteor.Router.to("/posts/"+t.details)):(trackEvent("new post",{postId:n.postId}),n.status===STATUS_PENDING&&throwError("Thanks, your post is awaiting approval."),Meteor.Router.to("/posts/"+n.postId))})},"click .get-title-link":function(e){e.preventDefault();var t=$("#url").val();$(".get-title-link").addClass("loading"),t?$.get(t,function(e){null!=(suggestedTitle=/<title>(.*?)<\/title>/m.exec(e.responseText))?$("#title").val(suggestedTitle[1]):alert("Sorry, couldn't find a title..."),$(".get-title-link").removeClass("loading")}):(alert("Please fill in an URL first!"),$(".get-title-link").removeClass("loading"))}}}(),function(){Template.posts_top.topPostsHandle=function(){return topPostsHandle},Template.posts_new.newPostsHandle=function(){return newPostsHandle},Template.posts_best.bestPostsHandle=function(){return bestPostsHandle},Template.posts_pending.pendingPostsHandle=function(){return pendingPostsHandle},Template.posts_list.helpers({posts:function(){return this.fetch()},postsReady:function(){return console.log("checking postsReady",this.ready(),this),this.ready()},allPostsLoaded:function(){return allPostsLoaded=this.fetch().length<this.loaded(),Session.set("allPostsLoaded",allPostsLoaded),allPostsLoaded}}),Template.posts_list.rendered=function(){var e=0;$(".post").each(function(){e+=$(this).height()}),Session.set("distanceFromTop",e),$("body").css("min-height",e+160)},Template.posts_list.events({"click .more-link":function(e){e.preventDefault(),Session.set("currentScroll",$("body").scrollTop()),this.loadNextPage()}})}(),function(){Template.user_edit.helpers({profileIncomplete:function(){return Meteor.user()&&!this.loading&&!userProfileComplete(this)},user:function(){var e=Meteor.user();return Session.get("selectedUserId")&&!e.loading&&e.isAdmin&&(e=Meteor.users.findOne(Session.get("selectedUserId"))),e},userEmail:function(){var e=Meteor.user();return Session.get("selectedUserId")&&!e.loading&&e.isAdmin&&currentUserMeteor.users.findOne(Session.get("selectedUserId")),getEmail(e)},hasNotificationsNone:function(){return Meteor.user().profile&&0==Meteor.user().profile.notificationsFrequency?"checked":""},hasNotificationsActivity:function(){var e=Meteor.user();return!e.profile||1!=e.profile.notificationsFrequency&&void 0!==e.profile.notificationsFrequency?"":"checked"},hasNotificationsAll:function(){return Meteor.user().profile&&2==Meteor.user().profile.notificationsFrequency?"checked":""}}),Template.user_edit.events={"submit form":function(e){e.preventDefault(),Meteor.user()||throwError("You must be logged in.");var t=$(e.target),n=Session.get("selectedUserId")?Meteor.users.findOne(Session.get("selectedUserId")):Meteor.user(),r={"profile.name":t.find("[name=name]").val(),"profile.bio":t.find("[name=bio]").val(),"profile.email":t.find("[name=email]").val(),"profile.notificationsFrequency":parseInt($("input[name=notifications]:checked").val())};t.find("[name=email]").val();var i=t.find("[name=old_password]").val(),o=t.find("[name=new_password]").val();i&&o&&Meteor.changePassword(i,o),Meteor.users.update(n._id,{$set:r},function(e){e?throwError(e.reason):throwError("Profile updated")})}}}(),function(){Template.user_email.events={"submit form":function(e){e.preventDefault(),Meteor.user()||throwError("You must be logged in.");var t=$(e.target),n=Session.get("selectedUserId")?Meteor.users.findOne(Session.get("selectedUserId")):Meteor.user(),r={"profile.email":t.find("[name=email]").val()};t.find("[name=email]").val(),Meteor.users.update(n._id,{$set:r},function(e){e?throwError(e.reason):(throwError("Thanks for signing up!"),trackEvent("new sign-up",{userId:n._id,auth:"twitter"}),Meteor.Router.to("/"))})}},Template.user_email.profileIncomplete=function(){return Meteor.user()&&!this.loading&&!userProfileComplete(this)},Template.user_email.user=function(){var e=Meteor.user();return Session.get("selectedUserId")&&!e.loading&&e.isAdmin?Meteor.users.findOne(Session.get("selectedUserId")):e}}(),function(){Template.user_item.rendered=function(){},Template.user_item.helpers({avatarUrl:function(){return getAvatarUrl(this)},createdAtFormatted:function(){return this.createdAt?moment(this.createdAt).fromNow():"â€“"},displayName:function(){return getDisplayName(this)},email:function(){return getEmail(this)},posts:function(){return Posts.find({userId:this._id})},postsCount:function(){return Posts.find({userId:this._id}).count()},comments:function(){return Comments.find({userId:this._id})},commentsCount:function(){return Comments.find({userId:this._id}).count()},userIsAdmin:function(){return isAdmin(this)}}),Template.user_item.events({"click .invite-link":function(e,t){e.preventDefault();var n=Meteor.users.findOne(t.data._id);Meteor.users.update(n._id,{$set:{isInvited:!0}},{multi:!1},function(e){e?throwError():Meteor.call("createNotification","accountApproved",{},n)})},"click .uninvite-link":function(e,t){e.preventDefault(),Meteor.users.update(t.data._id,{$set:{isInvited:!1}})},"click .admin-link":function(e,t){e.preventDefault(),Meteor.users.update(t.data._id,{$set:{isAdmin:!0}})},"click .unadmin-link":function(e,t){e.preventDefault(),Meteor.users.update(t.data._id,{$set:{isAdmin:!1}})},"click .delete-link":function(e,t){e.preventDefault(),confirm("Are you sure you want to delete "+getDisplayName(t.data)+"?")&&Meteor.users.remove(t.data._id)}})}(),function(){(function(){Template.user_password.events={"click input[type=submit]":function(e){e.preventDefault();var t={};t.email=$("#email").val(),Accounts.forgotPassword(t,function(e){e?console.log(e):throwError("Password reset link sent!")})}}})()}(),function(){Template.user_profile.user=function(){return(userId=Session.get("selectedUserId"))?Meteor.users.findOne(userId):void 0},Template.user_profile.avatarUrl=function(){return Gravatar.getGravatar(this,{d:"http://telescope.herokuapp.com/img/default_avatar.png",s:80})},Template.user_profile.createdAtFormatted=Template.user_item.createdAtFormatted,Template.user_profile.isCurrentUser=function(){return Meteor.user()&&Session.get("selectedUserId")===Meteor.user()._id}}(),function(){Template.user_signin.events={"click input[type=submit]":function(e){e.preventDefault();var t=$("#username").val(),n=$("#password").val();Meteor.loginWithPassword(t,n,function(e){e&&(console.log(e),throwError(e.reason))})},"click #signup":function(){Meteor.Router.to("/signup")},"click .twitter-button":function(){Meteor.loginWithTwitter(function(){Meteor.Router.to("/")})}}}(),function(){Template.user_signup.events={"click input[type=submit]":function(e){e.preventDefault();var t=$("#username").val(),n=$("#email").val(),r=$("#password").val();return t&&n&&r?(Accounts.createUser({username:t,email:n,password:r},function(e){e?console.log(e):Meteor.Router.to("/")}),void 0):(throwError("Please fill in all fields"),!1)},"click #signin":function(){Meteor.Router.to("/signin")},"click .twitter-button":function(){Meteor.loginWithTwitter(function(){Meteor.Router.to("/")})}}}(),function(){Template.users.users=function(){var e=Meteor.users.find({},{sort:{createdAt:-1}});return e}}(),function(){analyticsInit=function(){if((mixpanelId=getSetting("mixpanelId"))&&(function(e,t){window.mixpanel=t;var n,r,i,o;n=e.createElement("script"),n.type="text/javascript",n.async=!0,n.src=("https:"===e.location.protocol?"https:":"http:")+"//cdn.mxpnl.com/libs/mixpanel-2.1.min.js",r=e.getElementsByTagName("script")[0],r.parentNode.insertBefore(n,r),t._i=[],t.init=function(e,n,r){function a(e,t){var n=t.split(".");2==n.length&&(e=e[n[0]],t=n[1]),e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}}var s=t;for(r!==void 0?s=t[r]=[]:r="mixpanel",s.people=s.people||[],i="disable track track_pageview track_links track_forms register register_once unregister identify name_tag set_config people.identify people.set people.increment".split(" "),o=0;i.length>o;o++)a(s,i[o]);t._i.push([e,n,r])},t.__SV=1.1}(document,window.mixpanel||[]),mixpanel.init(mixpanelId)),goSquaredId=getSetting("goSquaredId")){window.GoSquared={},GoSquared.acct=goSquaredId,window._gstc_lt=+new Date;var e=document,t=e.createElement("script");t.type="text/javascript",t.src="//d1l6p2sc9645hc.cloudfront.net/tracker.js";var n=e.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}(clickyId=getSetting("clickyId"))&&(clicky_site_ids=[],clicky_site_ids.push(clickyId),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//static.getclicky.com/js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()),(googleAnalyticsId=getSetting("googleAnalyticsId"))&&(window._gaq=window._gaq||[],_gaq.push(["_setAccount",googleAnalyticsId]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}())},analyticsRequest=function(){if((googleAnalyticsId=getSetting("googleAnalyticsId"))&&window._gaq.push(["_trackPageview",window.location.pathname]),"undefined"!=typeof mixpanel&&mixpanel.people!==void 0&&Meteor.user()){var e=getCurrentUserEmail();mixpanel.people.identify(e),mixpanel.people.set({username:getDisplayName(Meteor.user()),$last_login:new Date,$created:moment(Meteor.user().createdAt)._d,$email:e}),mixpanel.register({username:getDisplayName(Meteor.user()),createdAt:moment(Meteor.user().createdAt)._d,email:e}),mixpanel.name_tag(e)}"undefined"!=typeof GoSquared&&GoSquared.DefaultTracker!==void 0&&GoSquared.DefaultTracker.TrackView(window.location.pathname,Meteor.Router.page()),"undefined"!=typeof clicky&&clicky.log(encodeURIComponent(window.location.pathname),Meteor.Router.page(),"pageview")}}(),function(){Accounts.ui.config({passwordSignupFields:"USERNAME_AND_EMAIL"}),EpicEditorOptions={container:"editor",basePath:"/editor",clientSideStorage:!1,theme:{base:"/themes/base/epiceditor.css",preview:"/themes/preview/github.css",editor:"/themes/editor/epic-light.css"}},SharrreOptions={share:{googlePlus:!0,twitter:!0},buttons:{googlePlus:{size:"tall"},twitter:{count:"vertical",via:"TelescopeApp"}},enableHover:!1,enableCounter:!1,enableTracking:!0},Statuses={pending:1,approved:2,rejected:3}}(),function(){Handlebars.registerHelper("canView",function(e){var e="string"!=typeof e?null:e;return canView(Meteor.user(),e)}),Handlebars.registerHelper("canPost",function(e){var e="string"!=typeof e?null:e;return canPost(Meteor.user(),e)}),Handlebars.registerHelper("canComment",function(e){var e="string"!=typeof e?null:e;return canComment(Meteor.user(),e)}),Handlebars.registerHelper("canUpvote",function(e,t){var t="string"!=typeof t?null:t;return canUpvote(Meteor.user()),t}),Handlebars.registerHelper("canDownvote",function(e,t){var t="string"!=typeof t?null:t;return canDownvote(Meteor.user(),e,t)}),Handlebars.registerHelper("isAdmin",function(e){return isAdmin(Meteor.user())?!0:("string"==typeof e&&"true"===e&&throwError("Sorry, you do not have access to this page"),!1)}),Handlebars.registerHelper("canEdit",function(collectionName,item,action){var action="string"!=typeof action?null:action,collection="string"!=typeof collectionName?Posts:eval(collectionName);return console.log(item),item&&canEdit(Meteor.user(),item,action)})}(),function(){limitDocuments=function(e,t){var n=0,r=[];return e.forEach(function(e){t>n&&(e._rank=n,r.push(e)),n+=1}),r}}(),function(){(function(){Meteor.Router.beforeRouting=function(){Session.set("categorySlug",null),Session.set("openedComments",null),Session.set("requestTimestamp",new Date),Session.set("currentScroll",null);var e=getSetting("tagline")?": "+getSetting("tagline"):"";document.title=getSetting("title")+e,$("body").css("min-height","0"),clearSeenErrors(),analyticsRequest()},digest=function(e,t,n,r){var i=r===void 0?"posts_digest":"posts_digest_"+r;return n===void 0?Session.set("currentDate",new Date):Session.set("currentDate",new Date(e,t-1,n)),i},post=function(e,t){return Session.set("selectedPostId",e),t!==void 0&&Session.set("scrollToCommentId",t),Session.set("showChildComments",!0),"post_page"},post_edit=function(e){return Session.set("selectedPostId",e),"post_edit"},comment=function(e){return Session.set("selectedCommentId",e),"comment_page"},comment_reply=function(e){return Session.set("selectedCommentId",e),"comment_reply"},comment_edit=function(e){return Session.set("selectedCommentId",e),"comment_edit"},user_profile=function(e){return void 0!==typeof e&&Session.set("selectedUserId",e),"user_profile"},user_edit=function(e){return void 0!==typeof e&&Session.set("selectedUserId",e),"user_edit"},unsubscribe=function(e){return Session.set("userEmailHash",e),"unsubscribe"},category=function(e,t){var t=t===void 0?"top":t;return console.log("setting category slug to: "+e),Session.set("categorySlug",e),Meteor.Router.categoryFilter=!0,"posts_"+t},Meteor.Router.add({"/":"posts_top","/top":"posts_top","/top/:page":"posts_top","/new":"posts_new","/new/:page":"posts_new","/best":"posts_best","/pending":"posts_pending","/digest/:year/:month/:day":digest,"/digest":digest,"/c/:category_slug/:view":category,"/c/:category_slug":category,"/signin":"user_signin","/signup":"user_signup","/submit":"post_submit","/invite":"no_invite","/posts/deleted":"post_deleted","/posts/:id/edit":post_edit,"/posts/:id/comment/:comment_id":post,"/posts/:id":post,"/comments/deleted":"comment_deleted","/comments/:id":comment,"/comments/:id/reply":comment_reply,"/comments/:id/edit":comment_edit,"/settings":"settings","/toolbox":"toolbox","/categories":"categories","/users":"users","/account":"user_edit","/forgot_password":"user_password","/users/:id":user_profile,"/users/:id/edit":user_edit,"/:year/:month/:day":digest,"/unsubscribe/:hash":unsubscribe}),Meteor.Router.filters({requireLogin:function(e){return Meteor.loggingIn()?"loading":Meteor.user()?e:"user_signin"},canView:function(e){var t=canView(Meteor.user(),!0);return t===!0?e:Meteor.loggingIn()?"loading":t},canPost:function(e){var t=canPost(Meteor.user(),!0);return t===!0?e:Meteor.loggingIn()?"loading":t},canEdit:function(e){if("comment_edit"===e)var t=Comments.findOne(Session.get("selectedCommentId"));else var t=Posts.findOne(Session.get("selectedPostId"));var n=canEdit(Meteor.user(),t,!0);return n===!0?e:!t||Meteor.loggingIn()?"loading":n},isLoggedOut:function(e){return Meteor.user()?"already_logged_in":e},isAdmin:function(e){return isAdmin(Meteor.user())?e:"no_rights"},requireProfile:function(e){var t=Meteor.user();return!t||Meteor.loggingIn()||userProfileComplete(t)?e:(Session.set("selectedUserId",t._id),"user_email")},requirePost:function(e){return Posts.findOne(Session.get("selectedPostId"))?e:Session.get("postReady")?"not_found":"loading"}}),Meteor.Router.filter("requireProfile"),Meteor.Router.filter("requireLogin",{only:["comment_reply","post_submit"]}),Meteor.Router.filter("canView",{only:["posts_top","posts_new","posts_digest","posts_best"]}),Meteor.Router.filter("isLoggedOut",{only:["user_signin","user_signup"]}),Meteor.Router.filter("canPost",{only:["posts_pending","comment_reply","post_submit"]}),Meteor.Router.filter("canEdit",{only:["post_edit","comment_edit"]}),Meteor.Router.filter("requirePost",{only:["post_page","post_edit"]}),Meteor.Router.filter("isAdmin",{only:["posts_pending","users","settings","categories","admin"]}),Meteor.startup(function(){Meteor.autorun(function(){Meteor.Router.page(),"loading"!==Meteor.Router.page()&&(console.log("------ "+Meteor.Router.page()+" ------"),_.contains(["posts_top","posts_new","posts_pending","posts_best"],Meteor.Router.page())?Session.set("isPostsList",!0):Session.set("isPostsList",!1))})})})()}(),function(){(function(){function e(){}function t(e){this.buttonBar=d.getElementById("wmd-button-bar"+e),this.preview=d.getElementById("wmd-preview"+e),this.input=d.getElementById("wmd-input"+e)}function n(e,t){var n,i,o,a=this,s=[],u=0,c="none",d=function(e,t){c!=e&&(c=e,t||p()),m.isIE&&"moving"==c?o=null:i=setTimeout(f,1)},f=function(e){o=new r(t,e),i=void 0};this.setCommandMode=function(){c="command",p(),i=setTimeout(f,0)},this.canUndo=function(){return u>1},this.canRedo=function(){return s[u+1]?!0:!1},this.undo=function(){a.canUndo()&&(n?(n.restore(),n=null):(s[u]=new r(t),s[--u].restore(),e&&e())),c="none",t.input.focus(),f()},this.redo=function(){a.canRedo()&&(s[++u].restore(),e&&e()),c="none",t.input.focus(),f()};var p=function(){var i=o||new r(t);return i?"moving"==c?(n||(n=i),void 0):(n&&(s[u-1].text!=n.text&&(s[u++]=n),n=null),s[u++]=i,s[u+1]=null,e&&e(),void 0):!1},h=function(e){var t=!1;if(e.ctrlKey||e.metaKey){var n=e.charCode||e.keyCode,r=String.fromCharCode(n);switch(r){case"y":a.redo(),t=!0;break;case"z":e.shiftKey?a.redo():a.undo(),t=!0}}return t?(e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1),void 0):void 0},g=function(e){if(!e.ctrlKey&&!e.metaKey){var t=e.keyCode;t>=33&&40>=t||t>=63232&&63235>=t?d("moving"):8==t||46==t||127==t?d("deleting"):13==t?d("newlines"):27==t?d("escape"):(16>t||t>20)&&91!=t&&d("typing")}},v=function(){l.addEvent(t.input,"keypress",function(e){!e.ctrlKey&&!e.metaKey||89!=e.keyCode&&90!=e.keyCode||e.preventDefault()});var e=function(){(m.isIE||o&&o.text!=t.input.value)&&void 0==i&&(c="paste",p(),f())};l.addEvent(t.input,"keydown",h),l.addEvent(t.input,"keydown",g),l.addEvent(t.input,"mousedown",function(){d("moving")}),t.input.onpaste=e,t.input.ondrop=e},_=function(){v(),f(!0),p()};_()}function r(t,n){var r=this,i=t.input;this.init=function(){l.isVisible(i)&&(n||!d.activeElement||d.activeElement===i)&&(this.setInputAreaSelectionStartEnd(),this.scrollTop=i.scrollTop,(!this.text&&i.selectionStart||0===i.selectionStart)&&(this.text=i.value))},this.setInputAreaSelection=function(){if(l.isVisible(i))if(void 0===i.selectionStart||m.isOpera){if(d.selection){if(d.activeElement&&d.activeElement!==i)return;i.focus();var e=i.createTextRange();e.moveStart("character",-i.value.length),e.moveEnd("character",-i.value.length),e.moveEnd("character",r.end),e.moveStart("character",r.start),e.select()}}else i.focus(),i.selectionStart=r.start,i.selectionEnd=r.end,i.scrollTop=r.scrollTop},this.setInputAreaSelectionStartEnd=function(){if(t.ieCachedRange||!i.selectionStart&&0!==i.selectionStart){if(d.selection){r.text=l.fixEolChars(i.value);var e=t.ieCachedRange||d.selection.createRange(),n=l.fixEolChars(e.text),o="",a=o+n+o;e.text=a;var s=l.fixEolChars(i.value);e.moveStart("character",-a.length),e.text=n,r.start=s.indexOf(o),r.end=s.lastIndexOf(o)-o.length;var u=r.text.length-l.fixEolChars(i.value).length;if(u){for(e.moveStart("character",-n.length);u--;)n+="\n",r.end+=1;e.text=n}t.ieCachedRange&&(r.scrollTop=t.ieCachedScrollTop),t.ieCachedRange=null,this.setInputAreaSelection()}}else r.start=i.selectionStart,r.end=i.selectionEnd},this.restore=function(){void 0!=r.text&&r.text!=i.value&&(i.value=r.text),this.setInputAreaSelection(),i.scrollTop=r.scrollTop},this.getChunks=function(){var t=new e;return t.before=l.fixEolChars(r.text.substring(0,r.start)),t.startTag="",t.selection=l.fixEolChars(r.text.substring(r.start,r.end)),t.endTag="",t.after=l.fixEolChars(r.text.substring(r.end)),t.scrollTop=r.scrollTop,t},this.setChunks=function(e){e.before=e.before+e.startTag,e.after=e.endTag+e.after,this.start=e.before.length,this.end=e.before.length+e.selection.length,this.text=e.before+e.selection+e.after,this.scrollTop=e.scrollTop},this.init()}function i(e,t,n){var r,i,o,a=3e3,s="delayed",c=function(e,t){l.addEvent(e,"input",t),e.onpaste=t,e.ondrop=t,l.addEvent(e,"keypress",t),l.addEvent(e,"keydown",t)},f=function(){var e=0;return window.innerHeight?e=window.pageYOffset:d.documentElement&&d.documentElement.scrollTop?e=d.documentElement.scrollTop:d.body&&(e=d.body.scrollTop),e},p=function(){if(t.preview){var n=t.input.value;if(!n||n!=o){o=n;var r=(new Date).getTime();n=e.makeHtml(n);var a=(new Date).getTime();i=a-r,k(n)}}},h=function(){if(r&&(clearTimeout(r),r=void 0),"manual"!==s){var e=0;"delayed"===s&&(e=i),e>a&&(e=a),r=setTimeout(p,e)}},g=function(e){return e.scrollHeight<=e.clientHeight?1:e.scrollTop/(e.scrollHeight-e.clientHeight)
},v=function(){t.preview&&(t.preview.scrollTop=(t.preview.scrollHeight-t.preview.clientHeight)*g(t.preview))};this.refresh=function(e){e?(o="",p()):h()},this.processingTime=function(){return i};var _,y=!0,b=function(e){var n=t.preview,r=n.parentNode,i=n.nextSibling;r.removeChild(n),n.innerHTML=e,i?r.insertBefore(n,i):r.appendChild(n)},w=function(e){t.preview.innerHTML=e},S=function(e){if(_)return _(e);try{w(e),_=w}catch(t){_=b,_(e)}},k=function(e){var r=u.getTop(t.input)-f();if(t.preview&&(S(e),n()),v(),y)return y=!1,void 0;var i=u.getTop(t.input)-f();m.isIE?setTimeout(function(){window.scrollBy(0,i-r)},0):window.scrollBy(0,i-r)},x=function(){c(t.input,h),p(),t.preview&&(t.preview.scrollTop=0)};x()}function o(e,t,n,i,o,a){function s(e){if(g.focus(),e.textOp){n&&n.setCommandMode();var o=new r(t);if(!o)return;var a=o.getChunks(),s=function(){g.focus(),a&&o.setChunks(a),o.restore(),i.refresh()},l=e.textOp(a,s);l||s()}e.execute&&e.execute(n)}function u(e,n){var r="0px",i="-20px",o="-40px",a=e.getElementsByTagName("span")[0];n?(a.style.backgroundPosition=e.XShift+" "+r,e.onmouseover=function(){a.style.backgroundPosition=this.XShift+" "+o},e.onmouseout=function(){a.style.backgroundPosition=this.XShift+" "+r},m.isIE&&(e.onmousedown=function(){d.activeElement&&d.activeElement!==t.input||(t.ieCachedRange=document.selection.createRange(),t.ieCachedScrollTop=t.input.scrollTop)}),e.isHelp||(e.onclick=function(){return this.onmouseout&&this.onmouseout(),s(this),!1})):(a.style.backgroundPosition=e.XShift+" "+i,e.onmouseover=e.onmouseout=e.onclick=function(){})}function c(e){return"string"==typeof e&&(e=o[e]),function(){e.apply(o,arguments)}}function f(){var n=t.buttonBar,r=document.createElement("ul");r.id="wmd-button-row"+e,r.className="wmd-button-row",r=n.appendChild(r);var i=0,o=function(t,n,o,a){var s=document.createElement("li");s.className="wmd-button",s.style.left=i+"px",i+=25;var l=document.createElement("span");return s.id=t+e,s.appendChild(l),s.title=n,s.XShift=o,a&&(s.textOp=a),u(s,!0),r.appendChild(s),s},s=function(t){var n=document.createElement("li");n.className="wmd-spacer wmd-spacer"+t,n.id="wmd-spacer"+t+e,r.appendChild(n),i+=25};v.bold=o("wmd-bold-button","Strong <strong> Ctrl+B","0px",c("doBold")),v.italic=o("wmd-italic-button","Emphasis <em> Ctrl+I","-20px",c("doItalic")),s(1),v.link=o("wmd-link-button","Hyperlink <a> Ctrl+L","-40px",c(function(e,t){return this.doLinkOrImage(e,t,!1)})),v.quote=o("wmd-quote-button","Blockquote <blockquote> Ctrl+Q","-60px",c("doBlockquote")),v.code=o("wmd-code-button","Code Sample <pre><code> Ctrl+K","-80px",c("doCode")),v.image=o("wmd-image-button","Image <img> Ctrl+G","-100px",c(function(e,t){return this.doLinkOrImage(e,t,!0)})),s(2),v.olist=o("wmd-olist-button","Numbered List <ol> Ctrl+O","-120px",c(function(e,t){this.doList(e,t,!0)})),v.ulist=o("wmd-ulist-button","Bulleted List <ul> Ctrl+U","-140px",c(function(e,t){this.doList(e,t,!1)})),v.heading=o("wmd-heading-button","Heading <h1>/<h2> Ctrl+H","-160px",c("doHeading")),v.hr=o("wmd-hr-button","Horizontal Rule <hr> Ctrl+R","-180px",c("doHorizontalRule")),s(3),v.undo=o("wmd-undo-button","Undo - Ctrl+Z","-200px",null),v.undo.execute=function(e){e&&e.undo()};var l=/win/.test(p.platform.toLowerCase())?"Redo - Ctrl+Y":"Redo - Ctrl+Shift+Z";if(v.redo=o("wmd-redo-button",l,"-220px",null),v.redo.execute=function(e){e&&e.redo()},a){var d=document.createElement("li"),f=document.createElement("span");d.appendChild(f),d.className="wmd-button wmd-help-button",d.id="wmd-help-button"+e,d.XShift="-240px",d.isHelp=!0,d.style.right="0px",d.title=a.title||b,d.onclick=a.handler,u(d,!0),r.appendChild(d),v.help=d}h()}function h(){n&&(u(v.undo,n.canUndo()),u(v.redo,n.canRedo()))}var g=t.input,v={};f();var _="keydown";m.isOpera&&(_="keypress"),l.addEvent(g,_,function(e){if((e.ctrlKey||e.metaKey)&&!e.altKey&&!e.shiftKey){var t=e.charCode||e.keyCode,n=String.fromCharCode(t).toLowerCase();switch(n){case"b":s(v.bold);break;case"i":s(v.italic);break;case"l":s(v.link);break;case"q":s(v.quote);break;case"k":s(v.code);break;case"g":s(v.image);break;case"o":s(v.olist);break;case"u":s(v.ulist);break;case"h":s(v.heading);break;case"r":s(v.hr);break;case"y":s(v.redo);break;case"z":e.shiftKey?s(v.redo):s(v.undo);break;default:return}e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1)}}),l.addEvent(g,"keyup",function(e){if(e.shiftKey&&!e.ctrlKey&&!e.metaKey){var t=e.charCode||e.keyCode;if(13===t){var n={};n.textOp=c("doAutoindent"),s(n)}}}),m.isIE&&l.addEvent(g,"keydown",function(e){var t=e.keyCode;return 27===t?!1:void 0}),this.setUndoRedoButtonStates=h}function a(e){this.hooks=e}function s(e){return e.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(e,t,n){return t=t.replace(/\?.*$/,function(e){return e.replace(/\+/g," ")}),t=decodeURIComponent(t),t=encodeURI(t).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29"),t=t.replace(/\?.*$/,function(e){return e.replace(/\+/g,"%2b")}),n&&(n=n.trim?n.trim():n.replace(/^\s*/,"").replace(/\s*$/,""),n=n.replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),n?t+' "'+n+'"':t})}var l={},u={},c={},d=window.document,f=window.RegExp,p=window.navigator,h={lineLength:72},m={isIE:/msie/.test(p.userAgent.toLowerCase()),isIE_5or6:/msie 6/.test(p.userAgent.toLowerCase())||/msie 5/.test(p.userAgent.toLowerCase()),isOpera:/opera/.test(p.userAgent.toLowerCase())},g='<p><b>Insert Hyperlink</b></p><p>http://example.com/ "optional title"</p>',v="<p><b>Insert Image</b></p><p>http://example.com/images/diagram.jpg \"optional title\"<br><br>Need <a href='http://www.google.com/search?q=free+image+hosting' target='_blank'>free image hosting?</a></p>",_="http://",y="http://",b="Markdown Editing Help";Markdown.Editor=function(e,r,s){r=r||"";var l=this.hooks=new Markdown.HookCollection;l.addNoop("onPreviewRefresh"),l.addNoop("postBlockquoteCreation"),l.addFalse("insertImageDialog"),this.getConverter=function(){return e};var u,c=this;this.run=function(){if(!u){u=new t(r);var f,p,h=new a(l),m=new i(e,u,function(){l.onPreviewRefresh()});/\?noundo/.test(d.location.href)||(f=new n(function(){m.refresh(),p&&p.setUndoRedoButtonStates()},u),this.textOperation=function(e){f.setCommandMode(),e(),c.refreshPreview()}),p=new o(r,u,f,m,h,s),p.setUndoRedoButtonStates();var g=c.refreshPreview=function(){m.refresh(!0)};g()}}},e.prototype.findTags=function(e,t){var n,r=this;e&&(n=l.extendRegExp(e,"","$"),this.before=this.before.replace(n,function(e){return r.startTag=r.startTag+e,""}),n=l.extendRegExp(e,"^",""),this.selection=this.selection.replace(n,function(e){return r.startTag=r.startTag+e,""})),t&&(n=l.extendRegExp(t,"","$"),this.selection=this.selection.replace(n,function(e){return r.endTag=e+r.endTag,""}),n=l.extendRegExp(t,"^",""),this.after=this.after.replace(n,function(e){return r.endTag=e+r.endTag,""}))},e.prototype.trimWhitespace=function(e){var t,n,r=this;e?t=n="":(t=function(e){return r.before+=e,""},n=function(e){return r.after=e+r.after,""}),this.selection=this.selection.replace(/^(\s*)/,t).replace(/(\s*)$/,n)},e.prototype.skipLines=function(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),e++,t++;var r,i;if(navigator.userAgent.match(/Chrome/)&&"X".match(/()./),this.selection=this.selection.replace(/(^\n*)/,""),this.startTag=this.startTag+f.$1,this.selection=this.selection.replace(/(\n*$)/,""),this.endTag=this.endTag+f.$1,this.startTag=this.startTag.replace(/(^\n*)/,""),this.before=this.before+f.$1,this.endTag=this.endTag.replace(/(\n*$)/,""),this.after=this.after+f.$1,this.before){for(r=i="";e--;)r+="\\n?",i+="\n";n&&(r="\\n*"),this.before=this.before.replace(new f(r+"$",""),i)}if(this.after){for(r=i="";t--;)r+="\\n?",i+="\n";n&&(r="\\n*"),this.after=this.after.replace(new f(r,""),i)}},l.isVisible=function(e){return window.getComputedStyle?"none"!==window.getComputedStyle(e,null).getPropertyValue("display"):e.currentStyle?"none"!==e.currentStyle.display:void 0},l.addEvent=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},l.removeEvent=function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},l.fixEolChars=function(e){return e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n")},l.extendRegExp=function(e,t,n){(null===t||void 0===t)&&(t=""),(null===n||void 0===n)&&(n="");var r,i=""+e;return i=i.replace(/\/([gim]*)$/,function(e,t){return r=t,""}),i=i.replace(/(^\/|\/$)/g,""),i=t+i+n,new f(i,r)},u.getTop=function(e,t){var n=e.offsetTop;if(!t)for(;e=e.offsetParent;)n+=e.offsetTop;return n},u.getHeight=function(e){return e.offsetHeight||e.scrollHeight},u.getWidth=function(e){return e.offsetWidth||e.scrollWidth},u.getPageSize=function(){var e,t,n,r;self.innerHeight&&self.scrollMaxY?(e=d.body.scrollWidth,t=self.innerHeight+self.scrollMaxY):d.body.scrollHeight>d.body.offsetHeight?(e=d.body.scrollWidth,t=d.body.scrollHeight):(e=d.body.offsetWidth,t=d.body.offsetHeight),self.innerHeight?(n=self.innerWidth,r=self.innerHeight):d.documentElement&&d.documentElement.clientHeight?(n=d.documentElement.clientWidth,r=d.documentElement.clientHeight):d.body&&(n=d.body.clientWidth,r=d.body.clientHeight);var i=Math.max(e,n),o=Math.max(t,r);return[i,o,n,r]},c.createBackground=function(){var e=d.createElement("div"),t=e.style;e.className="wmd-prompt-background",t.position="absolute",t.top="0",t.zIndex="1000",m.isIE?t.filter="alpha(opacity=50)":t.opacity="0.5";var n=u.getPageSize();return t.height=n[1]+"px",m.isIE?(t.left=d.documentElement.scrollLeft,t.width=d.documentElement.clientWidth):(t.left="0",t.width="100%"),d.body.appendChild(e),e},c.prompt=function(e,t,n){var r,i;void 0===t&&(t="");var o=function(e){var t=e.charCode||e.keyCode;27===t&&a(!0)},a=function(e){l.removeEvent(d.body,"keydown",o);var t=i.value;return e?t=null:(t=t.replace(/^http:\/\/(https?|ftp):\/\//,"$1://"),/^(?:https?|ftp):\/\//.test(t)||(t="http://"+t)),r.parentNode.removeChild(r),n(t),!1},s=function(){r=d.createElement("div"),r.className="wmd-prompt-dialog",r.style.padding="10px;",r.style.position="fixed",r.style.width="400px",r.style.zIndex="1001";var n=d.createElement("div");n.innerHTML=e,n.style.padding="5px",r.appendChild(n);var s=d.createElement("form"),c=s.style;s.onsubmit=function(){return a(!1)},c.padding="0",c.margin="0",c.cssFloat="left",c.width="100%",c.textAlign="center",c.position="relative",r.appendChild(s),i=d.createElement("input"),i.type="text",i.value=t,c=i.style,c.display="block",c.width="80%",c.marginLeft=c.marginRight="auto",s.appendChild(i);var f=d.createElement("input");f.type="button",f.onclick=function(){return a(!1)},f.value="OK",c=f.style,c.margin="10px",c.display="inline",c.width="7em";var p=d.createElement("input");p.type="button",p.onclick=function(){return a(!0)},p.value="Cancel",c=p.style,c.margin="10px",c.display="inline",c.width="7em",s.appendChild(f),s.appendChild(p),l.addEvent(d.body,"keydown",o),r.style.top="50%",r.style.left="50%",r.style.display="block",m.isIE_5or6&&(r.style.position="absolute",r.style.top=d.documentElement.scrollTop+200+"px",r.style.left="50%"),d.body.appendChild(r),r.style.marginTop=-(u.getHeight(r)/2)+"px",r.style.marginLeft=-(u.getWidth(r)/2)+"px"};setTimeout(function(){s();var e=t.length;if(void 0!==i.selectionStart)i.selectionStart=0,i.selectionEnd=e;else if(i.createTextRange){var n=i.createTextRange();n.collapse(!1),n.moveStart("character",-e),n.moveEnd("character",e),n.select()}i.focus()},0)};var w=a.prototype;w.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)",w.unwrap=function(e){var t=new f("([^\\n])\\n(?!(\\n|"+this.prefixes+"))","g");e.selection=e.selection.replace(t,"$1 $2")},w.wrap=function(e,t){this.unwrap(e);var n=new f("(.{1,"+t+"})( +|$\\n?)","gm"),r=this;e.selection=e.selection.replace(n,function(e,t){return new f("^"+r.prefixes,"").test(e)?e:t+"\n"}),e.selection=e.selection.replace(/\s+$/,"")},w.doBold=function(e,t){return this.doBorI(e,t,2,"strong text")},w.doItalic=function(e,t){return this.doBorI(e,t,1,"emphasized text")},w.doBorI=function(e,t,n,r){e.trimWhitespace(),e.selection=e.selection.replace(/\n{2,}/g,"\n");var i=/(\**$)/.exec(e.before)[0],o=/(^\**)/.exec(e.after)[0],a=Math.min(i.length,o.length);if(a>=n&&(2!=a||1!=n))e.before=e.before.replace(f("[*]{"+n+"}$",""),""),e.after=e.after.replace(f("^[*]{"+n+"}",""),"");else if(!e.selection&&o){e.after=e.after.replace(/^([*_]*)/,""),e.before=e.before.replace(/(\s?)$/,"");var s=f.$1;e.before=e.before+o+s}else{e.selection||o||(e.selection=r);var l=1>=n?"*":"**";e.before=e.before+l,e.after=l+e.after}},w.stripLinkDefs=function(e,t){return e=e.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(e,n,r,i,o){return t[n]=e.replace(/\s*$/,""),i?(t[n]=e.replace(/["(](.+?)[")]$/,""),i+o):""})},w.addLinkDef=function(e,t){var n=0,r={};e.before=this.stripLinkDefs(e.before,r),e.selection=this.stripLinkDefs(e.selection,r),e.after=this.stripLinkDefs(e.after,r);var i="",o=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,a=function(e){n++,e=e.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+n+"]:"),i+="\n"+e},s=function(e,t,i,l,u,c){return i=i.replace(o,s),r[u]?(a(r[u]),t+i+l+n+c):e};e.before=e.before.replace(o,s),t?a(t):e.selection=e.selection.replace(o,s);var l=n;return e.after=e.after.replace(o,s),e.after&&(e.after=e.after.replace(/\n*$/,"")),e.after||(e.selection=e.selection.replace(/\n*$/,"")),e.after+="\n\n"+i,l},w.doLinkOrImage=function(e,t,n){e.trimWhitespace(),e.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);var r;if(!(e.endTag.length>1&&e.startTag.length>0)){if(e.selection=e.startTag+e.selection+e.endTag,e.startTag=e.endTag="",/\n\n/.test(e.selection))return this.addLinkDef(e,null),void 0;var i=this,o=function(o){if(r.parentNode.removeChild(r),null!==o){e.selection=(" "+e.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1);var a=" [999]: "+s(o),l=i.addLinkDef(e,a);e.startTag=n?"![":"[",e.endTag="]["+l+"]",e.selection||(e.selection=n?"enter image description here":"enter link description here")}t()};return r=c.createBackground(),n?this.hooks.insertImageDialog(o)||c.prompt(v,_,o):c.prompt(g,y,o),!0}e.startTag=e.startTag.replace(/!?\[/,""),e.endTag="",this.addLinkDef(e,null)},w.doAutoindent=function(e){var t=this,n=!1;e.before=e.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ \t]+\n$/,"\n\n"),e.selection||/^[ \t]*(?:\n|$)/.test(e.after)||(e.after=e.after.replace(/^[^\n]*/,function(t){return e.selection=t,""}),n=!0),/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(e.before)&&t.doList&&t.doList(e),/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(e.before)&&t.doBlockquote&&t.doBlockquote(e),/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&t.doCode&&t.doCode(e),n&&(e.after=e.selection+e.after,e.selection="")},w.doBlockquote=function(e){e.selection=e.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(t,n,r,i){return e.before+=n,e.after=i+e.after,r}),e.before=e.before.replace(/(>[ \t]*)$/,function(t,n){return e.selection=n+e.selection,""}),e.selection=e.selection.replace(/^(\s|>)+$/,""),e.selection=e.selection||"Blockquote";var t,n="",r="";if(e.before){for(var i=e.before.replace(/\n$/,"").split("\n"),o=!1,a=0;i.length>a;a++){var s=!1;t=i[a],o=o&&t.length>0,/^>/.test(t)?(s=!0,!o&&t.length>1&&(o=!0)):s=/^[ \t]*$/.test(t)?!0:o,s?n+=t+"\n":(r+=n+t,n="\n")}/(^|\n)>/.test(n)||(r+=n,n="")}e.startTag=n,e.before=r,e.after&&(e.after=e.after.replace(/^\n?/,"\n")),e.after=e.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(t){return e.endTag=t,""});var l=function(t){var n=t?"> ":"";e.startTag&&(e.startTag=e.startTag.replace(/\n((>|\s)*)\n$/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"})),e.endTag&&(e.endTag=e.endTag.replace(/^\n((>|\s)*)\n/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"}))};/^(?![ ]{0,3}>)/m.test(e.selection)?(this.wrap(e,h.lineLength-2),e.selection=e.selection.replace(/^/gm,"> "),l(!0),e.skipLines()):(e.selection=e.selection.replace(/^[ ]{0,3}> ?/gm,""),this.unwrap(e),l(!1),!/^(\n|^)[ ]{0,3}>/.test(e.selection)&&e.startTag&&(e.startTag=e.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(e.selection)&&e.endTag&&(e.endTag=e.endTag.replace(/^\n{0,2}/,"\n\n"))),e.selection=this.hooks.postBlockquoteCreation(e.selection),/\n/.test(e.selection)||(e.selection=e.selection.replace(/^(> *)/,function(t,n){return e.startTag+=n,""}))},w.doCode=function(e){var t=/\S[ ]*$/.test(e.before),n=/^[ ]*\S/.test(e.after);if(!n&&!t||/\n/.test(e.selection)){e.before=e.before.replace(/[ ]{4}$/,function(t){return e.selection=t+e.selection,""});var r=1,i=1;/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&(r=0),/^\n(\t|[ ]{4,})/.test(e.after)&&(i=0),e.skipLines(r,i),e.selection?/^[ ]{0,3}\S/m.test(e.selection)?/\n/.test(e.selection)?e.selection=e.selection.replace(/^/gm,"    "):e.before+="    ":e.selection=e.selection.replace(/^[ ]{4}/gm,""):(e.startTag="    ",e.selection="enter code here")}else e.trimWhitespace(),e.findTags(/`/,/`/),e.startTag||e.endTag?e.endTag&&!e.startTag?(e.before+=e.endTag,e.endTag=""):e.startTag=e.endTag="":(e.startTag=e.endTag="`",e.selection||(e.selection="enter code here"))},w.doList=function(e,t,n){var r=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,i=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/,o="-",a=1,s=function(){var e;return n?(e=" "+a+". ",a++):e=" "+o+" ",e},l=function(e){return void 0===n&&(n=/^\s*\d/.test(e)),e=e.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(){return s()})};if(e.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null),!e.before||/\n$/.test(e.before)||/^\n/.test(e.startTag)||(e.before+=e.startTag,e.startTag=""),e.startTag){var u=/\d+[.]/.test(e.startTag);if(e.startTag="",e.selection=e.selection.replace(/\n[ ]{4}/g,"\n"),this.unwrap(e),e.skipLines(),u&&(e.after=e.after.replace(i,l)),n==u)return}var c=1;e.before=e.before.replace(r,function(e){return/^\s*([*+-])/.test(e)&&(o=f.$1),c=/[^\n]\n\n[^\n]/.test(e)?1:0,l(e)}),e.selection||(e.selection="List item");var d=s(),p=1;e.after=e.after.replace(i,function(e){return p=/[^\n]\n\n[^\n]/.test(e)?1:0,l(e)}),e.trimWhitespace(!0),e.skipLines(c,p,!0),e.startTag=d;var m=d.replace(/./g," ");this.wrap(e,h.lineLength-m.length),e.selection=e.selection.replace(/\n/g,"\n"+m)},w.doHeading=function(e){if(e.selection=e.selection.replace(/\s+/g," "),e.selection=e.selection.replace(/(^\s+|\s+$)/g,""),!e.selection)return e.startTag="## ",e.selection="Heading",e.endTag=" ##",void 0;var t=0;e.findTags(/#+[ ]*/,/[ ]*#+/),/#+/.test(e.startTag)&&(t=f.lastMatch.length),e.startTag=e.endTag="",e.findTags(null,/\s?(-+|=+)/),/=+/.test(e.endTag)&&(t=1),/-+/.test(e.endTag)&&(t=2),e.startTag=e.endTag="",e.skipLines(1,1);var n=0==t?2:t-1;if(n>0){var r=n>=2?"-":"=",i=e.selection.length;for(i>h.lineLength&&(i=h.lineLength),e.endTag="\n";i--;)e.endTag+=r}},w.doHorizontalRule=function(e){e.startTag="----------\n",e.selection="",e.skipLines(2,1,!0)}})()}(),function(){(function(){function e(e){return e.replace(/<[^>]*>?/gi,t)}function t(e){return e.match(o)||e.match(a)||e.match(s)?e:""}function n(e){if(""==e)return"";var t=/<\/?\w+[^>]*(\s|$|>)/g,n=e.toLowerCase().match(t),r=(n||[]).length;if(0==r)return e;for(var i,o,a,s="<p><img><br><li><hr>",l=[],u=[],c=!1,d=0;r>d;d++)if(i=n[d].replace(/<\/?(\w+).*/,"$1"),!(l[d]||s.search("<"+i+">")>-1)){if(o=n[d],a=-1,!/^<\//.test(o))for(var f=d+1;r>f;f++)if(!l[f]&&n[f]=="</"+i+">"){a=f;break}-1==a?c=u[d]=!0:l[a]=!0}if(!c)return e;var d=0;return e=e.replace(t,function(e){var t=u[d]?"":e;return d++,t})}var r,i;"object"==typeof exports&&"function"==typeof require?(r=exports,i=require("./Markdown.Converter").Converter):(r=window.Markdown,i=r.Converter),r.getSanitizingConverter=function(){var t=new i;return t.hooks.chain("postConversion",e),t.hooks.chain("postConversion",n),t};var o=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,a=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,s=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i})()}(),function(){(function(){var e,t=[].slice;e=function(){var e,n,r,i,o,a,s,l;if(a=arguments.length>=1?t.call(arguments,0):[],s=/(^|\s)(\b(https?):\/\/[\-A-Z0-9+&@#\/%?=~_|!:,.;]*[\-A-Z0-9+&@#\/%=~_|]\b)/gi,a.length>0){o=a[0],n=o.callback,null!=n&&"function"==typeof n&&(e=n,delete o.callback),i="";for(r in o)l=o[r],i+=" "+r+"='"+l+"'";return this.replace(s,function(t,n,r){var o,a;return a=e&&e(r),o=a||"<a href='"+r+"'"+i+">"+r+"</a>",""+n+o})}return this.replace(s,"$1<a href='$2'>$2</a>")},String.prototype.autoLink=e}).call(this)}(),function(){!function(e){var t=function(t,r){if(this.element=e(t),this.format=n.parseFormat(r.format||this.element.data("date-format")||"mm/dd/yyyy"),this.picker=e(n.template).appendTo("body").on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)}),this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on"):!1,this.isInput?this.element.on({focus:e.proxy(this.show,this),blur:e.proxy(this.hide,this),keyup:e.proxy(this.update,this)}):this.component?this.component.on("click",e.proxy(this.show,this)):this.element.on("click",e.proxy(this.show,this)),this.minViewMode=r.minViewMode||this.element.data("date-minviewmode")||0,"string"==typeof this.minViewMode)switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0}if(this.viewMode=r.viewMode||this.element.data("date-viewmode")||0,"string"==typeof this.viewMode)switch(this.viewMode){case"months":this.viewMode=1;break;case"years":this.viewMode=2;break;default:this.viewMode=0}this.startViewMode=this.viewMode,this.weekStart=r.weekStart||this.element.data("date-weekstart")||0,this.weekEnd=0===this.weekStart?6:this.weekStart-1,this.fillDow(),this.fillMonths(),this.update(),this.showMode()};t.prototype={constructor:t,show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.isInput||e(document).on("mousedown",e.proxy(this.hide,this)),this.element.trigger({type:"show",date:this.date})},hide:function(){this.picker.hide(),e(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),this.set(),this.element.trigger({type:"hide",date:this.date})},set:function(){var e=n.formatDate(this.date,this.format);this.isInput?this.element.prop("value",e):(this.component&&this.element.find("input").prop("value",e),this.element.data("date",e))},setValue:function(e){this.date="string"==typeof e?n.parseDate(e,this.format):new Date(e),this.set(),this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0),this.fill()},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},update:function(e){this.date=n.parseDate("string"==typeof e?e:this.isInput?this.element.prop("value"):this.element.data("date"),this.format),this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0),this.fill()},fillDow:function(){for(var e=this.weekStart,t="<tr>";this.weekStart+7>e;)t+='<th class="dow">'+n.dates.daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;12>t;)e+='<span class="month">'+n.dates.monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").append(e)},fill:function(){var e=new Date(this.viewDate),t=e.getFullYear(),r=e.getMonth(),i=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(n.dates.months[r]+" "+t);var o=new Date(t,r-1,28,0,0,0,0),a=n.getDaysInMonth(o.getFullYear(),o.getMonth());o.setDate(a),o.setDate(a-(o.getDay()-this.weekStart+7)%7);var s=new Date(o);s.setDate(s.getDate()+42),s=s.valueOf(),html=[];for(var l;s>o.valueOf();)o.getDay()===this.weekStart&&html.push("<tr>"),l="",r>o.getMonth()?l+=" old":o.getMonth()>r&&(l+=" new"),o.valueOf()===i&&(l+=" active"),html.push('<td class="day'+l+'">'+o.getDate()+"</td>"),o.getDay()===this.weekEnd&&html.push("</tr>"),o.setDate(o.getDate()+1);this.picker.find(".datepicker-days tbody").empty().append(html.join(""));var u=this.date.getFullYear(),c=this.picker.find(".datepicker-months").find("th:eq(1)").text(t).end().find("span").removeClass("active");u===t&&c.eq(this.date.getMonth()).addClass("active"),html="",t=10*parseInt(t/10,10);var d=this.picker.find(".datepicker-years").find("th:eq(1)").text(t+"-"+(t+9)).end().find("td");t-=1;for(var f=-1;11>f;f++)html+='<span class="year'+(-1===f||10===f?" old":"")+(u===t?" active":"")+'">'+t+"</span>",t+=1;d.html(html)},click:function(t){t.stopPropagation(),t.preventDefault();var r=e(t.target).closest("span, td, th");if(1===r.length)switch(r[0].nodeName.toLowerCase()){case"th":switch(r[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.viewDate["set"+n.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+n.modes[this.viewMode].navFnc].call(this.viewDate)+n.modes[this.viewMode].navStep*("prev"===r[0].className?-1:1)),this.fill(),this.set()}break;case"span":if(r.is(".month")){var i=r.parent().find("span").index(r);this.viewDate.setMonth(i)}else{var o=parseInt(r.text(),10)||0;this.viewDate.setFullYear(o)}0!==this.viewMode&&(this.date=new Date(this.viewDate),this.element.trigger({type:"changeDate",date:this.date,viewMode:n.modes[this.viewMode].clsName})),this.showMode(-1),this.fill(),this.set();break;case"td":if(r.is(".day")){var a=parseInt(r.text(),10)||1,i=this.viewDate.getMonth();r.is(".old")?i-=1:r.is(".new")&&(i+=1);var o=this.viewDate.getFullYear();this.date=new Date(o,i,a,0,0,0,0),this.viewDate=new Date(o,i,Math.min(28,a),0,0,0,0),this.fill(),this.set(),this.element.trigger({type:"changeDate",date:this.date,viewMode:n.modes[this.viewMode].clsName})}}},mousedown:function(e){e.stopPropagation(),e.preventDefault()},showMode:function(e){e&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+n.modes[this.viewMode].clsName).show()}},e.fn.datepicker=function(n,r){return this.each(function(){var i=e(this),o=i.data("datepicker"),a="object"==typeof n&&n;o||i.data("datepicker",o=new t(this,e.extend({},e.fn.datepicker.defaults,a))),"string"==typeof n&&o[n](r)})},e.fn.datepicker.defaults={},e.fn.datepicker.Constructor=t;var n={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},isLeapYear:function(e){return 0===e%4&&0!==e%100||0===e%400},getDaysInMonth:function(e,t){return[31,n.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},parseFormat:function(e){var t=e.match(/[.\/\-\s].*?/),n=e.split(/\W+/);if(!t||!n||0===n.length)throw Error("Invalid date format.");return{separator:t,parts:n}},parseDate:function(e,t){var n,r=e.split(t.separator),e=new Date;if(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),r.length===t.parts.length)for(var i=0,o=t.parts.length;o>i;i++)switch(n=parseInt(r[i],10)||1,t.parts[i]){case"dd":case"d":e.setDate(n);break;case"mm":case"m":e.setMonth(n-1);break;case"yy":e.setFullYear(2e3+n);break;case"yyyy":e.setFullYear(n)}return e},formatDate:function(e,t){var n={d:e.getDate(),m:e.getMonth()+1,yy:(""+e.getFullYear()).substring(2),yyyy:e.getFullYear()};n.dd=(10>n.d?"0":"")+n.d,n.mm=(10>n.m?"0":"")+n.m;for(var e=[],r=0,i=t.parts.length;i>r;r++)e.push(n[t.parts[r]]);return e.join(t.separator)},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};n.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+n.headTemplate+"<tbody></tbody>"+"</table>"+"</div>"+'<div class="datepicker-months">'+'<table class="table-condensed">'+n.headTemplate+n.contTemplate+"</table>"+"</div>"+'<div class="datepicker-years">'+'<table class="table-condensed">'+n.headTemplate+n.contTemplate+"</table>"+"</div>"+"</div>"}(window.jQuery)}(),function(){(function(e,t){function n(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n])}function i(t,n){var r=t,i=null;return e.getComputedStyle?i=document.defaultView.getComputedStyle(r,null).getPropertyValue(n):r.currentStyle&&(i=r.currentStyle[n]),i}function o(e,t,n){var o,a={};if("save"===t){for(o in n)n.hasOwnProperty(o)&&(a[o]=i(e,o));r(e,n)}else"apply"===t&&r(e,n);return a}function a(e){var t,n=parseInt(i(e,"border-left-width"),10)+parseInt(i(e,"border-right-width"),10),r=parseInt(i(e,"padding-left"),10)+parseInt(i(e,"padding-right"),10),o=e.offsetWidth;return isNaN(n)&&(n=0),t=n+r+o}function s(e){var t,n=parseInt(i(e,"border-top-width"),10)+parseInt(i(e,"border-bottom-width"),10),r=parseInt(i(e,"padding-top"),10)+parseInt(i(e,"padding-bottom"),10),o=e.offsetHeight;return isNaN(n)&&(n=0),t=n+r+o}function l(e,t,r){r=r||"";var i=t.getElementsByTagName("head")[0],o=t.createElement("link");n(o,{type:"text/css",id:r,rel:"stylesheet",href:e,name:e,media:"screen"}),i.appendChild(o)}function u(e,t,n){e.className=e.className.replace(t,n)}function c(e){return e.contentDocument||e.contentWindow.document}function d(e){var t;return document.body.innerText?t=e.innerText:(t=e.innerHTML.replace(/<br>/gi,"\n"),t=t.replace(/<(?:.|\n)*?>/gm,""),t=t.replace(/&lt;/gi,"<"),t=t.replace(/&gt;/gi,">")),t}function f(e,t){return document.body.innerText?e.innerText=t:e.innerHTML=t.replace(/\n/g,"<br>"),!0}function p(){var e,t=-1,n=navigator.userAgent;return"Microsoft Internet Explorer"==navigator.appName&&(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/,null!=e.exec(n)&&(t=parseFloat(RegExp.$1,10))),t}function h(e){var t={};return e&&"[object Function]"===t.toString.call(e)}function m(){var e,n,r,i,o=arguments[0]||{},a=1,s=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[1]||{},a=2),"object"!=typeof o&&!h(o)&&(o={}),s===a&&(o=this,--a);s>a;a++)if(null!=(e=arguments[a]))for(n in e)if(e.hasOwnProperty(n)){if(r=o[n],i=e[n],o===i)continue;l&&i&&"object"==typeof i&&!i.nodeType?o[n]=m(l,r||(null!=i.length?[]:{}),i):i!==t&&(o[n]=i)}return o}function g(e){var n,r,i=this,o=e||{},a={container:"epiceditor",basePath:"epiceditor",clientSideStorage:!0,localStorageName:"epiceditor",file:{name:null,defaultContent:"",autoSave:100},theme:{base:"/themes/base/epiceditor.css",preview:"/themes/preview/github.css",editor:"/themes/editor/epic-dark.css"},focusOnLoad:!1,shortcut:{modifier:18,fullscreen:70,preview:80,edit:79},parser:"function"==typeof marked?marked:null};return i.settings=m(!0,a,o),("function"!=typeof i.settings.parser||"string"!=typeof i.settings.parser("TEST"))&&(i.settings.parser=function(e){return e}),"string"==typeof i.settings.container?i.element=document.getElementById(i.settings.container):"object"==typeof i.settings.container&&(i.element=i.settings.container),i.settings.file.name||("string"==typeof i.settings.container?i.settings.file.name=i.settings.container:"object"==typeof i.settings.container&&(i.element.id?i.settings.file.name=i.element.id:(g._data.unnamedEditors||(g._data.unnamedEditors=[]),g._data.unnamedEditors.push(i),i.settings.file.name="__epiceditor-untitled-"+g._data.unnamedEditors.length))),i._instanceId="epiceditor-"+Math.round(1e5*Math.random()),i._storage={},i._canSave=!0,i._defaultFileSchema=function(){return{content:i.settings.file.defaultContent,created:new Date,modified:new Date}
},localStorage&&i.settings.clientSideStorage&&(this._storage=localStorage,this._storage[i.settings.localStorageName]&&i.getFiles(i.settings.file.name)===t&&(n=i.getFiles(i.settings.file.name),n=i._defaultFileSchema(),n.content=i.settings.file.defaultContent)),this._storage[i.settings.localStorageName]||(r={},r[i.settings.file.name]=i._defaultFileSchema(),r=JSON.stringify(r),this._storage[i.settings.localStorageName]=r),i.events||(i.events={}),this}g.prototype.load=function(t){function n(e){for(var t=0;e.length>t;t++)e[t].style.width=D.element.offsetWidth-_+"px",e[t].style.height=D.element.offsetHeight-y+"px"}function u(e){_=a(D.element)-D.element.offsetWidth;for(var t=0;e.length>t;t++)e[t].style.width=D.element.offsetWidth-_+"px"}function d(t){(Math.abs(O.y-t.pageY)>=5||Math.abs(O.x-t.pageX)>=5)&&(w.style.display="block",S&&clearTimeout(S),S=e.setTimeout(function(){w.style.display="none"},1e3)),O={y:t.pageY,x:t.pageX}}function f(e){e.keyCode==D.settings.shortcut.modifier&&(P=!0),17==e.keyCode&&(j=!0),P===!0&&e.keyCode==D.settings.shortcut.preview&&!D.eeState.fullscreen&&(e.preventDefault(),D.preview()),P===!0&&e.keyCode==D.settings.shortcut.edit&&(e.preventDefault(),D.eeState.fullscreen||D.edit()),P===!0&&e.keyCode==D.settings.shortcut.fullscreen&&(e.preventDefault(),T(A)),P===!0&&e.keyCode!==D.settings.shortcut.modifier&&(P=!1),27==e.keyCode&&D.eeState.fullscreen&&(document.body.webkitRequestFullScreen||C(A)),j===!0&&83==e.keyCode&&(D.save(),e.preventDefault(),j=!1),e.metaKey&&83==e.keyCode&&(D.save(),e.preventDefault())}function h(e){e.keyCode==D.settings.shortcut.modifier&&(P=!1),17==e.keyCode&&(j=!1)}var m,g,v,_,y,b,w,S,k,x,E,T,C,M,A,N,I,D=this,O={y:-1,x:-1},L=document.body.webkitRequestFullScreen?!0:!1,P=!1,j=!1;for(t=t||function(){},D.eeState={fullscreen:!1,preview:!1,edit:!0,loaded:!1,unloaded:!1},m={chrome:'<div id="epiceditor-wrapper" class="epiceditor-edit-mode"><iframe frameborder="0" id="epiceditor-editor-frame"></iframe><iframe frameborder="0" id="epiceditor-previewer-frame"></iframe><div id="epiceditor-utilbar"><img width="30" src="'+this.settings.basePath+'/images/preview.png" title="Toggle Preview Mode" class="epiceditor-toggle-btn epiceditor-toggle-preview-btn"> '+'<img width="30" src="'+this.settings.basePath+'/images/edit.png" title="Toggle Edit Mode" class="epiceditor-toggle-btn epiceditor-toggle-edit-btn"> '+'<img width="30" src="'+this.settings.basePath+'/images/fullscreen.png" title="Enter Fullscreen" class="epiceditor-fullscreen-btn">'+"</div>"+"</div>",previewer:'<div id="epiceditor-preview"></div>'},D.element.innerHTML='<iframe scrolling="no" frameborder="0" id= "'+D._instanceId+'"></iframe>',g=document.getElementById(D._instanceId),D.iframeElement=g,D.iframe=c(g),D.iframe.open(),D.iframe.write(m.chrome),D.editorIframe=D.iframe.getElementById("epiceditor-editor-frame"),D.previewerIframe=D.iframe.getElementById("epiceditor-previewer-frame"),D.editorIframeDocument=c(D.editorIframe),D.editorIframeDocument.open(),D.editorIframeDocument.write(""),D.editorIframeDocument.close(),D.previewerIframeDocument=c(D.previewerIframe),D.previewerIframeDocument.open(),D.previewerIframeDocument.write(m.previewer),v=D.previewerIframeDocument.createElement("base"),v.target="_blank",D.previewerIframeDocument.getElementsByTagName("head")[0].appendChild(v),D.previewerIframeDocument.close(),_=a(D.element)-D.element.offsetWidth,y=s(D.element)-D.element.offsetHeight,M=[D.iframeElement,D.editorIframe,D.previewerIframe],n(M),l(D.settings.basePath+D.settings.theme.base,D.iframe,"theme"),l(D.settings.basePath+D.settings.theme.editor,D.editorIframeDocument,"theme"),l(D.settings.basePath+D.settings.theme.preview,D.previewerIframeDocument,"theme"),D.iframe.getElementById("epiceditor-wrapper").style.position="relative",D.editor=D.editorIframeDocument.body,D.previewer=D.previewerIframeDocument.getElementById("epiceditor-preview"),D.editor.contentEditable=!0,D.iframe.body.style.height=this.element.offsetHeight+"px",this.previewerIframe.style.display="none",p()>-1&&(this.previewer.style.height=parseInt(i(this.previewer,"height"),10)+2),this.open(D.settings.file.name),D.settings.focusOnLoad&&D.iframe.addEventListener("readystatechange",function(){"complete"==D.iframe.readyState&&D.editorIframeDocument.body.focus()}),b=D.iframe.getElementById("epiceditor-utilbar"),x={},T=function(t){if(D.eeState.fullscreen)return C(t),void 0;L&&t.webkitRequestFullScreen(),E=D.eeState.edit,D.eeState.fullscreen=!0,D.eeState.edit=!0,D.eeState.preview=!0;var n=(e.innerWidth,e.innerHeight),r=e.outerWidth,a=e.outerHeight;L||(a=e.innerHeight),x.editorIframe=o(D.editorIframe,"save",{width:r/2+"px",height:a+"px","float":"left",cssFloat:"left",styleFloat:"left",display:"block"}),x.previewerIframe=o(D.previewerIframe,"save",{width:r/2+"px",height:a+"px","float":"right",cssFloat:"right",styleFloat:"right",display:"block"}),x.element=o(D.element,"save",{position:"fixed",top:"0",left:"0",width:"100%","z-index":"9999",zIndex:"9999",border:"none",margin:"0",background:i(D.editor,"background-color"),height:n+"px"}),x.iframeElement=o(D.iframeElement,"save",{width:r+"px",height:n+"px"}),b.style.visibility="hidden",L||(document.body.style.overflow="hidden"),D.preview(),D.editorIframeDocument.body.focus()},C=function(){o(D.element,"apply",x.element),o(D.iframeElement,"apply",x.iframeElement),o(D.editorIframe,"apply",x.editorIframe),o(D.previewerIframe,"apply",x.previewerIframe),D.element.style.width="",D.element.style.height="",b.style.visibility="visible",L?document.webkitCancelFullScreen():document.body.style.overflow="auto",D.eeState.fullscreen=!1,E?D.edit():D.preview(),u(M)},D.editor.addEventListener("keyup",function(){k&&e.clearTimeout(k),k=e.setTimeout(function(){D.eeState.fullscreen&&D.preview()},250)}),A=D.iframeElement,b.addEventListener("click",function(e){var t=e.target.className;t.indexOf("epiceditor-toggle-preview-btn")>-1?D.preview():t.indexOf("epiceditor-toggle-edit-btn")>-1?D.edit():t.indexOf("epiceditor-fullscreen-btn")>-1&&T(A)}),document.body.webkitRequestFullScreen&&A.addEventListener("webkitfullscreenchange",function(){document.webkitIsFullScreen||C(A)},!1),w=D.iframe.getElementById("epiceditor-utilbar"),w.style.display="none",w.addEventListener("mouseover",function(){S&&clearTimeout(S)}),N=[D.previewerIframeDocument,D.editorIframeDocument],I=0;N.length>I;I++)N[I].addEventListener("mousemove",function(e){d(e)}),N[I].addEventListener("scroll",function(e){d(e)}),N[I].addEventListener("keyup",function(e){h(e)}),N[I].addEventListener("keydown",function(e){f(e)});return D.settings.file.autoSave&&(D.saveInterval=e.setInterval(function(){D._canSave&&D.save()},D.settings.file.autoSave)),e.addEventListener("resize",function(){!D.iframe.webkitRequestFullScreen&&D.eeState.fullscreen?(r(D.iframeElement,{width:e.outerWidth+"px",height:e.innerHeight+"px"}),r(D.element,{height:e.innerHeight+"px"}),r(D.previewerIframe,{width:e.outerWidth/2+"px",height:e.innerHeight+"px"}),r(D.editorIframe,{width:e.outerWidth/2+"px",height:e.innerHeight+"px"})):D.eeState.fullscreen||u(M)}),D.iframe.close(),D.eeState.loaded=!0,D.eeState.unloaded=!1,t.call(this),this.emit("load"),this},g.prototype.unload=function(t){if(this.eeState.unloaded)throw Error("Editor isn't loaded");var n=this,r=e.parent.document.getElementById(n._instanceId);return r.parentNode.removeChild(r),n.eeState.loaded=!1,n.eeState.unloaded=!0,t=t||function(){},n.saveInterval&&e.clearInterval(n.saveInterval),t.call(this),n.emit("unload"),n},g.prototype.preview=function(e){var t=this;return e=e||t.settings.basePath+t.settings.theme.preview,u(t.getElement("wrapper"),"epiceditor-edit-mode","epiceditor-preview-mode"),t.previewerIframeDocument.getElementById("theme")?t.previewerIframeDocument.getElementById("theme").name!==e&&(t.previewerIframeDocument.getElementById("theme").href=e):l(e,t.previewerIframeDocument,"theme"),t.previewer.innerHTML=t.exportFile(null,"html"),t.eeState.fullscreen||(t.editorIframe.style.display="none",t.previewerIframe.style.display="block",t.eeState.preview=!0,t.eeState.edit=!1,t.previewerIframe.focus()),t.emit("preview"),t},g.prototype.edit=function(){var e=this;return u(e.getElement("wrapper"),"epiceditor-preview-mode","epiceditor-edit-mode"),e.eeState.preview=!1,e.eeState.edit=!0,e.editorIframe.style.display="block",e.previewerIframe.style.display="none",e.editorIframe.focus(),e.emit("edit"),this},g.prototype.getElement=function(e){var t={container:this.element,wrapper:this.iframe.getElementById("epiceditor-wrapper"),wrapperIframe:this.iframeElement,editor:this.editorIframeDocument,editorIframe:this.editorIframe,previewer:this.previewerIframeDocument,previewerIframe:this.previewerIframe};return!t[e]||this.eeState.unloaded?null:t[e]},g.prototype.open=function(e){var n,r=this,i=r.settings.file.defaultContent;return e=e||r.settings.file.name,r.settings.file.name=e,this._storage[r.settings.localStorageName]&&(n=r.getFiles(),n[e]!==t?(f(r.editor,n[e].content),r.emit("read")):(f(r.editor,i),r.save(),r.emit("create")),r.previewer.innerHTML=r.exportFile(null,"html"),r.emit("open")),this},g.prototype.save=function(){var e,n=this,r=!1,i=n.settings.file.name,o=d(this.editor);return this._canSave=!0,e=JSON.parse(this._storage[n.settings.localStorageName]),e[i]===t?e[i]=n._defaultFileSchema():o!==e[i].content&&(e[i].modified=new Date,r=!0),e[i].content=o,this._storage[n.settings.localStorageName]=JSON.stringify(e),r&&n.emit("update"),this.emit("save"),this},g.prototype.remove=function(e){var t,n=this;return e=e||n.settings.file.name,e==n.settings.file.name&&(n._canSave=!1),t=JSON.parse(this._storage[n.settings.localStorageName]),delete t[e],this._storage[n.settings.localStorageName]=JSON.stringify(t),this.emit("remove"),this},g.prototype.rename=function(e,t){var n=this,r=JSON.parse(this._storage[n.settings.localStorageName]);return r[t]=r[e],delete r[e],this._storage[n.settings.localStorageName]=JSON.stringify(r),n.open(t),this},g.prototype.importFile=function(e,n,r,i){var o=this,a=!1;return e=e||o.settings.file.name,n=n||"",r=r||"md",i=i||{},JSON.parse(this._storage[o.settings.localStorageName])[e]===t&&(a=!0),o.settings.file.name=e,f(o.editor,n),a&&o.emit("create"),o.save(),o.eeState.fullscreen&&o.preview(),this},g.prototype.exportFile=function(e,n){var r,i,o=this;if(e=e||o.settings.file.name,n=n||"text",r=o.getFiles(e),r!==t)switch(i=r.content,n){case"html":return i=i.replace(/\u00a0/g," ").replace(/&nbsp;/g," "),o.settings.parser(i);case"text":return i=i.replace(/&nbsp;/g," ");default:return i}},g.prototype.getFiles=function(e){var t=JSON.parse(this._storage[this.settings.localStorageName]);return e?t[e]:t},g.prototype.on=function(e,t){var n=this;return this.events[e]||(this.events[e]=[]),this.events[e].push(t),n},g.prototype.emit=function(e,t){function n(e){e.call(i,t)}var r,i=this;if(t=t||i.getFiles(i.settings.file.name),this.events[e]){for(r=0;i.events[e].length>r;r++)n(i.events[e][r]);return i}},g.prototype.removeListener=function(e,t){var n=this;return t?this.events[e]?(this.events[e].splice(this.events[e].indexOf(t),1),n):n:(this.events[e]=[],n)},g.version="0.1.1",g._data={},e.EpicEditor=g})(window),function(){function e(e,t){return"!"!==e[0][0]?'<a href="'+o(t.href)+'"'+(t.title?' title="'+o(t.title)+'"':"")+">"+p.lexer(e[1])+"</a>":'<img src="'+o(t.href)+'" alt="'+o(e[1])+'"'+(t.title?' title="'+o(t.title)+'"':"")+">"}function t(){return m=h.pop()}function n(){switch(m.type){case"space":return"";case"hr":return"<hr>\n";case"heading":return"<h"+m.depth+">"+p.lexer(m.text)+"</h"+m.depth+">\n";case"code":return g.highlight&&(m.code=g.highlight(m.text,m.lang),null!=m.code&&m.code!==m.text&&(m.escaped=!0,m.text=m.code)),m.escaped||(m.text=o(m.text,!0)),"<pre><code"+(m.lang?' class="lang-'+m.lang+'"':"")+">"+m.text+"</code></pre>\n";case"blockquote_start":for(var e="";"blockquote_end"!==t().type;)e+=n();return"<blockquote>\n"+e+"</blockquote>\n";case"list_start":for(var i=m.ordered?"ol":"ul",e="";"list_end"!==t().type;)e+=n();return"<"+i+">\n"+e+"</"+i+">\n";case"list_item_start":for(var e="";"list_item_end"!==t().type;)e+="text"===m.type?r():n();return"<li>"+e+"</li>\n";case"loose_item_start":for(var e="";"list_item_end"!==t().type;)e+=n();return"<li>"+e+"</li>\n";case"html":return g.sanitize?p.lexer(m.text):m.pre||g.pedantic?m.text:p.lexer(m.text);case"paragraph":return"<p>"+p.lexer(m.text)+"</p>\n";case"text":return"<p>"+r()+"</p>\n"}}function r(){for(var e,n=m.text;(e=h[h.length-1])&&"text"===e.type;)n+="\n"+t().text;return p.lexer(n)}function i(e){h=e.reverse();for(var r="";t();)r+=n();return h=null,m=null,r}function o(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function a(e){for(var t,n="",r=e.length,i=0;r>i;i++)t=e.charCodeAt(i),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n}function s(){var e="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+";return e}function l(e,t){return e=e.source,t=t||"",function n(r,i){return r?(e=e.replace(r,i.source||i),n):RegExp(e,t)}}function u(){}function c(e,t){return d(t),i(f.lexer(e))}function d(e){e||(e=v),g!==e&&(g=e,g.gfm?(f.fences=f.gfm.fences,f.paragraph=f.gfm.paragraph,p.text=p.gfm.text,p.url=p.gfm.url):(f.fences=f.normal.fences,f.paragraph=f.normal.paragraph,p.text=p.normal.text,p.url=p.normal.url),g.pedantic?(p.em=p.pedantic.em,p.strong=p.pedantic.strong):(p.em=p.normal.em,p.strong=p.normal.strong))}var f={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:u,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,lheading:/^([^\n]+)\n *(=|-){3,} *\n*/,blockquote:/^( *>[^\n]+(\n[^\n]+)*\n*)+/,list:/^( *)(bull) [^\0]+?(?:hr|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *([^\s]+)(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,paragraph:/^([^\n]+\n?(?!body))+\n*/,text:/^[^\n]+/};f.bullet=/(?:[*+-]|\d+\.)/,f.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,f.item=l(f.item,"gm")(/bull/g,f.bullet)(),f.list=l(f.list)(/bull/g,f.bullet)("hr",/\n+(?=(?: *[-*_]){3,} *(?:\n+|$))/)(),f.html=l(f.html)("comment",/<!--[^\0]*?-->/)("closed",/<(tag)[^\0]+?<\/\1>/)("closing",/<tag(?!:\/|@)\b(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,s())(),f.paragraph=function(){var e=f.paragraph.source,t=[];return function n(e){return e=f[e]?f[e].source:e,t.push(e.replace(/(^|[^\[])\^/g,"$1")),n}("hr")("heading")("lheading")("blockquote")("<"+s())("def"),RegExp(e.replace("body",t.join("|")))}(),f.normal={fences:f.fences,paragraph:f.paragraph},f.gfm={fences:/^ *``` *(\w+)? *\n([^\0]+?)\s*``` *(?:\n+|$)/,paragraph:/^/},f.gfm.paragraph=l(f.paragraph)("(?!","(?!"+f.gfm.fences.source.replace(/(^|[^\[])\^/g,"$1")+"|")(),f.lexer=function(e){var t=[];return t.links={},e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),f.token(e,t,!0)},f.token=function(e,t,n){for(var r,i,o,a,s,l,u,e=e.replace(/^ +$/gm,"");e;)if((o=f.newline.exec(e))&&(e=e.substring(o[0].length),o[0].length>1&&t.push({type:"space"})),o=f.code.exec(e))e=e.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),t.push({type:"code",text:g.pedantic?o:o.replace(/\n+$/,"")});else if(o=f.fences.exec(e))e=e.substring(o[0].length),t.push({type:"code",lang:o[1],text:o[2]});else if(o=f.heading.exec(e))e=e.substring(o[0].length),t.push({type:"heading",depth:o[1].length,text:o[2]});else if(o=f.lheading.exec(e))e=e.substring(o[0].length),t.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(o=f.hr.exec(e))e=e.substring(o[0].length),t.push({type:"hr"});else if(o=f.blockquote.exec(e))e=e.substring(o[0].length),t.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),f.token(o,t,n),t.push({type:"blockquote_end"});else if(o=f.list.exec(e)){for(e=e.substring(o[0].length),t.push({type:"list_start",ordered:isFinite(o[2])}),o=o[0].match(f.item),r=!1,u=o.length,l=0;u>l;l++)a=o[l],s=a.length,a=a.replace(/^ *([*+-]|\d+\.) +/,""),~a.indexOf("\n ")&&(s-=a.length,a=g.pedantic?a.replace(/^ {1,4}/gm,""):a.replace(RegExp("^ {1,"+s+"}","gm"),"")),i=r||/\n\n(?!\s*$)/.test(a),l!==u-1&&(r="\n"===a[a.length-1],i||(i=r)),t.push({type:i?"loose_item_start":"list_item_start"}),f.token(a,t),t.push({type:"list_item_end"});t.push({type:"list_end"})}else(o=f.html.exec(e))?(e=e.substring(o[0].length),t.push({type:"html",pre:"pre"===o[1],text:o[0]})):n&&(o=f.def.exec(e))?(e=e.substring(o[0].length),t.links[o[1].toLowerCase()]={href:o[2],title:o[3]}):n&&(o=f.paragraph.exec(e))?(e=e.substring(o[0].length),t.push({type:"paragraph",text:o[0]})):(o=f.text.exec(e))&&(e=e.substring(o[0].length),t.push({type:"text",text:o[0]}));return t};var p={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:u,tag:/^<!--[^\0]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([^\0]+?)__(?!_)|^\*\*([^\0]+?)\*\*(?!\*)/,em:/^\b_((?:__|[^\0])+?)_\b|^\*((?:\*\*|[^\0])+?)\*(?!\*)/,code:/^(`+)([^\0]*?[^`])\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,text:/^[^\0]+?(?=[\\<!\[_*`]| {2,}\n|$)/};p._linkInside=/(?:\[[^\]]*\]|[^\]]|\](?=[^\[]*\]))*/,p._linkHref=/\s*<?([^\s]*?)>?(?:\s+['"]([^\0]*?)['"])?\s*/,p.link=l(p.link)("inside",p._linkInside)("href",p._linkHref)(),p.reflink=l(p.reflink)("inside",p._linkInside)(),p.normal={url:p.url,strong:p.strong,em:p.em,text:p.text},p.pedantic={strong:/^__(?=\S)([^\0]*?\S)__(?!_)|^\*\*(?=\S)([^\0]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([^\0]*?\S)_(?!_)|^\*(?=\S)([^\0]*?\S)\*(?!\*)/},p.gfm={url:/^(https?:\/\/[^\s]+[^.,:;"')\]\s])/,text:/^[^\0]+?(?=[\\<!\[_*`]|https?:\/\/| {2,}\n|$)/},p.lexer=function(t){for(var n,r,i,s,l="",u=h.links;t;)if(s=p.escape.exec(t))t=t.substring(s[0].length),l+=s[1];else if(s=p.autolink.exec(t))t=t.substring(s[0].length),"@"===s[2]?(r=":"===s[1][6]?a(s[1].substring(7)):a(s[1]),i=a("mailto:")+r):(r=o(s[1]),i=r),l+='<a href="'+i+'">'+r+"</a>";else if(s=p.url.exec(t))t=t.substring(s[0].length),r=o(s[1]),i=r,l+='<a href="'+i+'">'+r+"</a>";else if(s=p.tag.exec(t))t=t.substring(s[0].length),l+=g.sanitize?o(s[0]):s[0];else if(s=p.link.exec(t))t=t.substring(s[0].length),l+=e(s,{href:s[2],title:s[3]});else if((s=p.reflink.exec(t))||(s=p.nolink.exec(t))){if(t=t.substring(s[0].length),n=(s[2]||s[1]).replace(/\s+/g," "),n=u[n.toLowerCase()],!n||!n.href){l+=s[0][0],t=s[0].substring(1)+t;continue}l+=e(s,n)}else(s=p.strong.exec(t))?(t=t.substring(s[0].length),l+="<strong>"+p.lexer(s[2]||s[1])+"</strong>"):(s=p.em.exec(t))?(t=t.substring(s[0].length),l+="<em>"+p.lexer(s[2]||s[1])+"</em>"):(s=p.code.exec(t))?(t=t.substring(s[0].length),l+="<code>"+o(s[2],!0)+"</code>"):(s=p.br.exec(t))?(t=t.substring(s[0].length),l+="<br>"):(s=p.text.exec(t))&&(t=t.substring(s[0].length),l+=o(s[0]));return l};var h,m;u.exec=u;var g,v;c.options=c.setOptions=function(e){return v=e,d(e),c},c.setOptions({gfm:!0,pedantic:!1,sanitize:!1,highlight:null}),c.parser=function(e,t){return d(t),i(e)},c.lexer=function(e,t){return d(t),f.lexer(e)},c.parse=c,"undefined"!=typeof module?module.exports=c:this.marked=c}.call(function(){return this||("undefined"!=typeof window?window:global)}())}(),function(){$.fn.exists=function(){return 0!==this.length}}(),function(){(function(e){function t(t){if("string"==typeof t.data){var n=t.handler,r=t.data.toLowerCase().split(" ");t.handler=function(t){if(this===t.target||!/textarea|select/i.test(t.target.nodeName)&&"text"!==t.target.type){var i="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],o=String.fromCharCode(t.which).toLowerCase(),a="",s={};t.altKey&&"alt"!==i&&(a+="alt+"),t.ctrlKey&&"ctrl"!==i&&(a+="ctrl+"),t.metaKey&&!t.ctrlKey&&"meta"!==i&&(a+="meta+"),t.shiftKey&&"shift"!==i&&(a+="shift+"),i?s[a+i]=!0:(s[a+o]=!0,s[a+e.hotkeys.shiftNums[o]]=!0,"shift+"===a&&(s[e.hotkeys.shiftNums[o]]=!0));for(var l=0,u=r.length;u>l;l++)if(s[r[l]])return n.apply(this,arguments)}}}}e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})})(jQuery)}(),function(){eval(function(e,t,n,r,i,o){if(i=function(e){return(t>e?"":i(parseInt(e/t)))+((e%=t)>35?String.fromCharCode(e+29):e.toString(36))},!"".replace(/^/,String)){for(;n--;)o[i(n)]=r[n]||i(n);r=[function(e){return o[e]}],i=function(){return"\\w+"},n=1}for(;n--;)r[n]&&(e=e.replace(RegExp("\\b"+i(n)+"\\b","g"),r[n]));return e}(";(4($,g,h,i){l j='1X',1Y={2u:'1X',L:{N:B,C:B,y:B,H:B,o:B,I:B,J:B,A:B},1Z:0,1a:'',Y:'',3:h.2v.14,w:h.Y,1g:'1X.2w',x:{},1h:0,1r:r,2x:r,2y:r,20:B,21:4(){},2z:4(){},1C:4(){},22:4(){},8:{N:{3:'',15:B,1i:'2A',Z:'2B-3f',23:''},C:{3:'',15:B,R:'1D',11:'3g',F:'',1s:'B',24:'B',25:'',1t:'',Z:'3h'},y:{3:'',15:B,x:'2C',26:'',16:'',1E:'',Z:'2B'},H:{3:'',15:B,P:'3i'},o:{3:'',15:B,1i:'2A'},I:{3:'',15:B,11:'1'},J:{3:'',15:B,27:''},A:{3:'',1u:'',1v:'',11:'2C'}}},1j={N:\"\",C:\"Q://3j.C.p/?28={3}&1w=?\",y:\"Q://3k.3l.y.p/1/3m/x.2D?3={3}&1w=?\",H:\"Q://3n.H.p/2.0/3o.3p?3q={3}&P=1b&1w=?\",o:'Q://3r.o.p/3s/2D/3t/n?3={3}&1w=?',I:\"\",J:\"Q://1k.J.p/3u/x/L?3v=3w&3={3}&1w=?\",A:\"\"},2E={N:4(b){l c=b.6.8.N;$(b.q).V('.8').12('<m G=\"S 3x\"><m G=\"g-1F\" n-1i=\"'+c.1i+'\" n-14=\"'+(c.3!==''?c.3:b.6.3)+'\" n-23=\"'+c.23+'\"></m></m>');g.3y={Z:b.6.8.N.Z};l d=0;9(z 2F==='E'&&d==0){d=1;(4(){l a=h.1c('O');a.P='w/1b';a.1l=r;a.17='//3z.2G.p/W/1F.W';l s=h.1d('O')[0];s.1e.1f(a,s)})()}K{2F.1F.3A()}},C:4(c){l e=c.6.8.C;$(c.q).V('.8').12('<m G=\"S C\"><m 28=\"1G-3B\"></m><m G=\"1G-1D\" n-14=\"'+(e.3!==''?e.3:c.6.3)+'\" n-1s=\"'+e.1s+'\" n-11=\"'+e.11+'\" n-F=\"'+e.F+'\" n-3C-24=\"'+e.24+'\" n-R=\"'+e.R+'\" n-25=\"'+e.25+'\" n-1t=\"'+e.1t+'\" n-16=\"'+e.16+'\"></m></m>');l f=0;9(z 1m==='E'&&f==0){f=1;(4(d,s,a){l b,29=d.1d(s)[0];9(d.3D(a)){1x}b=d.1c(s);b.28=a;b.17='//3E.C.3F/'+e.Z+'/3G.W#3H=1';29.1e.1f(b,29)}(h,'O','C-3I'))}K{1m.3J.3K()}},y:4(b){l c=b.6.8.y;$(b.q).V('.8').12('<m G=\"S y\"><a 14=\"1H://y.p/L\" G=\"y-L-S\" n-3=\"'+(c.3!==''?c.3:b.6.3)+'\" n-x=\"'+c.x+'\" n-w=\"'+b.6.w+'\" n-16=\"'+c.16+'\" n-26=\"'+c.26+'\" n-1E=\"'+c.1E+'\" n-Z=\"'+c.Z+'\">3L</a></m>');l d=0;9(z 2a==='E'&&d==0){d=1;(4(){l a=h.1c('O');a.P='w/1b';a.1l=r;a.17='//1I.y.p/1J.W';l s=h.1d('O')[0];s.1e.1f(a,s)})()}K{$.3M({3:'//1I.y.p/1J.W',3N:'O',3O:r})}},H:4(a){l b=a.6.8.H;$(a.q).V('.8').12('<m G=\"S H\"><a G=\"3P '+b.P+'\" 3Q=\"3R 3S\" 14=\"Q://H.p/2H?3='+T((b.3!==''?b.3:a.6.3))+'\"></a></m>');l c=0;9(z 3T==='E'&&c==0){c=1;(4(){l s=h.1c('2I'),2b=h.1d('2I')[0];s.P='w/1b';s.1l=r;s.17='//1J.H.p/8.W';2b.1e.1f(s,2b)})()}},o:4(a){9(a.6.8.o.1i=='3U'){l b='F:2c;',2d='D:2J;F:2c;1t-1i:3V;1y-D:2J;',2e='D:2K;1y-D:2K;2f-3W:1K;'}K{l b='F:3X;',2d='2g:3Y;2h:0 1K;D:1z;F:3Z;1y-D:1z;',2e='2g:40;D:1z;1y-D:1z;'}l c=a.1r(a.6.x.o);9(z c===\"E\"){c=0}$(a.q).V('.8').12('<m G=\"S o\"><m 1L=\"'+b+'1t:41 42,43,44-45;46:47;1M:#48;2L:49-2M;2g:2N;D:1z;1y-D:4a;2f:0;2h:0;w-4b:0;4c-2i:4d;\">'+'<m 1L=\"'+2d+'2O-1M:#2P;2f-4e:4f;4g:4h;w-2i:2Q;1N:2R 2S #4i;1N-2T:1K;\">'+c+'</m>'+'<m 1L=\"'+2e+'2L:2M;2h:0;w-2i:2Q;w-4j:2N;F:2c;2O-1M:#4k;1N:2R 2S #4l;1N-2T:1K;1M:#2P;\">'+'<2U 17=\"Q://1k.o.p/4m/2U/o.4n.4o\" D=\"10\" F=\"10\" 4p=\"4q\" /> 4r</m></m></m>');$(a.q).V('.o').4s('1C',4(){a.2V('o')})},I:4(b){l c=b.6.8.I;$(b.q).V('.8').12('<m G=\"S I\"><2W:2j 11=\"'+c.11+'\" 2v=\"'+(c.3!==''?c.3:b.6.3)+'\"></2W:2j></m>');l d=0;9(z 1O==='E'&&d==0){d=1;(4(){l a=h.1c('O');a.P='w/1b';a.1l=r;a.17='//1I.I.p/1/1J.W';l s=h.1d('O')[0];s.1e.1f(a,s)})();s=g.4t(4(){9(z 1O!=='E'){1O.2X();2k(s)}},2l)}K{1O.2X()}},J:4(b){l c=b.6.8.J;$(b.q).V('.8').12('<m G=\"S J\"><O P=\"2m/L\" n-3=\"'+(c.3!==''?c.3:b.6.3)+'\" n-27=\"'+c.27+'\"></O></m>');l d=0;9(z g.2Y==='E'&&d==0){d=1;(4(){l a=h.1c('O');a.P='w/1b';a.1l=r;a.17='//1I.J.p/2m.W';l s=h.1d('O')[0];s.1e.1f(a,s)})()}K{g.2Y.1P()}},A:4(b){l c=b.6.8.A;$(b.q).V('.8').12('<m G=\"S A\"><a 14=\"Q://A.p/1Q/2n/S/?3='+(c.3!==''?c.3:b.6.3)+'&1u='+c.1u+'&1v='+c.1v+'\" G=\"1Q-4u-S\" x-11=\"'+c.11+'\">4v 4w</a></m>');(4(){l a=h.1c('O');a.P='w/1b';a.1l=r;a.17='//4x.A.p/W/4y.W';l s=h.1d('O')[0];s.1e.1f(a,s)})()}},2Z={N:4(){},C:4(){1G=g.30(4(){9(z 1m!=='E'){1m.2o.2p('31.2n',4(a){1n.1o(['1p','C','1D',a])});1m.2o.2p('31.4z',4(a){1n.1o(['1p','C','4A',a])});1m.2o.2p('4B.1s',4(a){1n.1o(['1p','C','1s',a])});2k(1G)}},32)},y:4(){33=g.30(4(){9(z 2a!=='E'){2a.4C.4D('1R',4(a){9(a){1n.1o(['1p','y','1R'])}});2k(33)}},32)},H:4(){},o:4(){},I:4(){},J:4(){4 4E(){1n.1o(['1p','J','L'])}},A:4(){}},34={N:4(a){g.18(\"1H://1F.2G.p/35/+1/4F?4G=\"+a.8.N.Z+\"&3=\"+T((a.8.N.3!==''?a.8.N.3:a.3)),\"\",\"19=0, 1S=0, F=36, D=2l\")},C:4(a){g.18(\"Q://1k.C.p/4H.2w?u=\"+T((a.8.C.3!==''?a.8.C.3:a.3))+\"&t=\"+a.w+\"\",\"\",\"19=0, 1S=0, F=36, D=2l\")},y:4(a){g.18(\"1H://y.p/4I/1R?w=\"+T(a.w)+\"&3=\"+T((a.8.y.3!==''?a.8.y.3:a.3))+(a.8.y.16!==''?'&16='+a.8.y.16:''),\"\",\"19=0, 1S=0, F=37, D=38\")},H:4(a){g.18(\"Q://H.p/4J/4K/2H?3=\"+T((a.8.H.3!==''?a.8.H.3:a.3))+\"&Y=\"+a.w+\"&1E=r&1L=r\",\"\",\"19=0, 1S=0, F=37, D=38\")},o:4(a){g.18('Q://1k.o.p/4L?v=5&4M&4N=4O&3='+T((a.8.o.3!==''?a.8.o.3:a.3))+'&Y='+a.w,'o','19=1T,F=1q,D=1q')},I:4(a){g.18('Q://1k.I.p/2j/?3='+T((a.8.o.3!==''?a.8.o.3:a.3)),'I','19=1T,F=1q,D=1q')},J:4(a){g.18('1H://1k.J.p/4P/L?3='+T((a.8.o.3!==''?a.8.o.3:a.3))+'&4Q=&4R=r','J','19=1T,F=1q,D=1q')},A:4(a){g.18('Q://A.p/1Q/2n/S/?3='+T((a.8.A.3!==''?a.8.A.3:a.3))+'&1u='+T(a.8.A.1u)+'&1v='+a.8.A.1v,'A','19=1T,F=4S,D=4T')}};4 U(a,b){7.q=a;7.6=$.4U(r,{},1Y,b);7.6.L=b.L;7.4V=1Y;7.4W=j;7.1P()};U.X.1P=4(){l c=7;9(7.6.1g!==''){1j.N=7.6.1g+'?3={3}&P=N';1j.I=7.6.1g+'?3={3}&P=I';1j.A=7.6.1g+'?3={3}&P=A'}$(7.q).4X(7.6.2u);9(z $(7.q).n('Y')!=='E'){7.6.Y=$(7.q).4Y('n-Y')}9(z $(7.q).n('3')!=='E'){7.6.3=$(7.q).n('3')}9(z $(7.q).n('w')!=='E'){7.6.w=$(7.q).n('w')}$.1A(7.6.L,4(a,b){9(b===r){c.6.1Z++}});9(c.6.2y===r){$.1A(7.6.L,4(a,b){9(b===r){4Z{c.39(a)}50(e){}}})}K{7.2q();7.6.22(7,7.6)}$(7.q).21(4(){9($(7).V('.8').51===0&&c.6.2x===r){c.2q()}c.6.21(c,c.6)},4(){c.6.2z(c,c.6)});$(7.q).1C(4(){c.6.1C(c,c.6);1x B})};U.X.2q=4(){l c=7;$(7.q).12('<m G=\"8\"></m>');$.1A(c.6.L,4(a,b){9(b==r){2E[a](c);9(c.6.20===r){2Z[a]()}}})};U.X.39=4(c){l d=7,x=0,3=1j[c].1B('{3}',T(7.6.3));9(7.6.8[c].15===r&&7.6.8[c].3!==''){3=1j[c].1B('{3}',7.6.8[c].3)}9(3!=''&&d.6.1g!==''){$.52(3,4(a){9(z a.x!==\"E\"){l b=a.x+'';b=b.1B('\\53\\54','');x+=1U(b,10)}K 9(z a.3a!==\"E\"){x+=1U(a.3a,10)}K 9(z a.3b!==\"E\"){x+=1U(a.3b,10)}K 9(z a[0]!==\"E\"){x+=1U(a[0].55,10)}K 9(z a[0]!==\"E\"){}d.6.x[c]=x;d.6.1h+=x;d.2r();d.1V()}).56(4(){d.6.x[c]=0;d.1V()})}K{d.2r();d.6.x[c]=0;d.1V()}};U.X.1V=4(){l a=0;57(e 2m 7.6.x){a++}9(a===7.6.1Z){7.6.22(7,7.6)}};U.X.2r=4(){l a=7.6.1h,1a=7.6.1a;9(7.6.1r===r){a=7.1r(a)}9(1a!==''){1a=1a.1B('{1h}',a);$(7.q).1W(1a)}K{$(7.q).1W('<m G=\"58\"><a G=\"x\" 14=\"#\">'+a+'</a>'+(7.6.Y!==''?'<a G=\"L\" 14=\"#\">'+7.6.Y+'</a>':'')+'</m>')}};U.X.1r=4(a){9(a>=3c){a=(a/3c).3d(2)+\"M\"}K 9(a>=3e){a=(a/3e).3d(1)+\"k\"}1x a};U.X.2V=4(a){34[a](7.6);9(7.6.20===r){l b={N:{13:'59',R:'+1'},C:{13:'C',R:'1D'},y:{13:'y',R:'1R'},H:{13:'H',R:'2s'},o:{13:'o',R:'2s'},I:{13:'I',R:'2s'},J:{13:'J',R:'L'},A:{13:'A',R:'1Q'}};1n.1o(['1p',b[a].13,b[a].R])}};U.X.5a=4(){l a=$(7.q).1W();$(7.q).1W(a.1B(7.6.1h,7.6.1h+1))};U.X.5b=4(a,b){9(a!==''){7.6.3=a}9(b!==''){7.6.w=b}};$.5c[j]=4(b){l c=5d;9(b===i||z b==='5e'){1x 7.1A(4(){9(!$.n(7,'2t'+j)){$.n(7,'2t'+j,5f U(7,b))}})}K 9(z b==='5g'&&b[0]!=='35'&&b!=='1P'){1x 7.1A(4(){l a=$.n(7,'2t'+j);9(a 5h U&&z a[b]==='4'){a[b].5i(a,5j.X.5k.5l(c,1))}})}}})(5m,5n,5o);",62,335,"|||url|function||options|this|buttons|if||||||||||||var|div|data|delicious|com|element|true|||||text|count|twitter|typeof|pinterest|false|facebook|height|undefined|width|class|digg|stumbleupon|linkedin|else|share||googlePlus|script|type|http|action|button|encodeURIComponent|Plugin|find|js|prototype|title|lang||layout|append|site|href|urlCount|via|src|open|toolbar|template|javascript|createElement|getElementsByTagName|parentNode|insertBefore|urlCurl|total|size|urlJson|www|async|FB|_gaq|push|_trackSocial|550|shorterTotal|send|font|media|description|callback|return|line|20px|each|replace|click|like|related|plusone|fb|https|platform|widgets|3px|style|color|border|STMBLPN|init|pin|tweet|status|no|parseInt|rendererPerso|html|sharrre|defaults|shareTotal|enableTracking|hover|render|annotation|faces|colorscheme|hashtags|counter|id|fjs|twttr|s1|50px|cssCount|cssShare|margin|float|padding|align|badge|clearInterval|500|in|create|Event|subscribe|loadButtons|renderer|add|plugin_|className|location|php|enableHover|enableCounter|hide|medium|en|horizontal|json|loadButton|gapi|google|submit|SCRIPT|35px|18px|display|block|none|background|fff|center|1px|solid|radius|img|openPopup|su|processWidgets|IN|tracking|setInterval|edge|1000|tw|popup|_|900|650|360|getSocialJson|likes|shares|1e6|toFixed|1e3|US|button_count|en_US|DiggCompact|graph|cdn|api|urls|services|story|getInfo|links|feeds|v2|urlinfo|countserv|format|jsonp|googleplus|___gcfg|apis|go|root|show|getElementById|connect|net|all|xfbml|jssdk|XFBML|parse|Tweet|ajax|dataType|cache|DiggThisButton|rel|nofollow|external|__DBW|tall|15px|top|93px|right|26px|left|12px|Arial|Helvetica|sans|serif|cursor|pointer|666666|inline|normal|indent|vertical|baseline|bottom|5px|overflow|hidden|ccc|decoration|7EACEE|40679C|static|small|gif|alt|Delicious|Add|on|setTimeout|it|Pin|It|assets|pinit|remove|unlike|message|events|bind|LinkedInShare|confirm|hl|sharer|intent|tools|diggthis|save|noui|jump|close|cws|token|isFramed|700|300|extend|_defaults|_name|addClass|attr|try|catch|length|getJSON|u00c2|u00a0|total_posts|error|for|box|Google|simulateClick|update|fn|arguments|object|new|string|instanceof|apply|Array|slice|call|jQuery|window|document".split("|"),0,{}))}(),function(){jQuery.ajax=function(e){function t(e){return!i.test(e)&&/:\/\//.test(e)}var n=location.protocol,r=location.hostname,i=RegExp(n+"//"+r),o="http"+(/^https/.test(n)?"s":"")+"://query.yahooapis.com/v1/public/yql?callback=?",a='select * from html where url="{URL}" and xpath="*"';return function(n){var r=n.url;return/get/i.test(n.type)&&!/json/i.test(n.dataType)&&t(r)&&(n.url=o,n.dataType="json",n.data={q:a.replace("{URL}",r+(n.data?(/\?/.test(r)?"&":"?")+jQuery.param(n.data):"")),format:"xml"},!n.success&&n.complete&&(n.success=n.complete,delete n.complete),n.success=function(e){return function(t){e&&e.call(this,{responseText:(t.results[0]||"").replace(/<script[^>]+?\/>|<script(.|\s)*?\/script>/gi,"")},"success")}}(n.success)),e.apply(this,arguments)}}(jQuery.ajax)}(),function(){(function(e,t){window.mixpanel=t;var n,r,i,o;n=e.createElement("script"),n.type="text/javascript",n.async=!0,n.src=("https:"===e.location.protocol?"https:":"http:")+"//cdn.mxpnl.com/libs/mixpanel-2.1.min.js",r=e.getElementsByTagName("script")[0],r.parentNode.insertBefore(n,r),t._i=[],t.init=function(e,n,r){function a(e,t){var n=t.split(".");2==n.length&&(e=e[n[0]],t=n[1]),e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}}var s=t;for(r!==void 0?s=t[r]=[]:r="mixpanel",s.people=s.people||[],i="disable track track_pageview track_links track_forms register register_once unregister identify name_tag set_config people.identify people.set people.increment".split(" "),o=0;i.length>o;o++)a(s,i[o]);t._i.push([e,n,r])},t.__SV=1.1})(document,window.mixpanel||[])}(),function(){jQuery.expr[":"].regex=function(e,t,n){var r=n[3].split(","),i=/^(data|css):/,o={method:r[0].match(i)?r[0].split(":")[0]:"attr",property:r.shift().replace(i,"")},a="ig",s=RegExp(r.join("").replace(/^\s+|\s+$/g,""),a);return s.test(jQuery(e)[o.method](o.property))
}}(),function(){!function(e,t,n){function r(e,n){var r,i=t.createElement(e||"div");for(r in n)i[r]=n[r];return i}function i(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function o(e,t,n,r){var i=["opacity",t,~~(100*e),n,r].join("-"),o=.01+100*(n/r),a=Math.max(1-(1-e)/t*(100-o),e),s=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=s&&"-"+s+"-"||"";return f[i]||(p.insertRule("@"+l+"keyframes "+i+"{"+"0%{opacity:"+a+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}"+"100%{opacity:"+a+"}"+"}",p.cssRules.length),f[i]=1),i}function a(e,t){var r,i,o=e.style;if(o[t]!==n)return t;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0;d.length>i;i++)if(r=d[i]+t,o[r]!==n)return r}function s(e,t){for(var n in t)e.style[a(e,n)||n]=t[n];return e}function l(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var i in r)e[i]===n&&(e[i]=r[i])}return e}function u(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}var c,d=["webkit","Moz","ms","O"],f={},p=function(){var e=r("style",{type:"text/css"});return i(t.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),h={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"},m=function m(e){return this.spin?(this.opts=l(e||{},m.defaults,h),n):new m(e)};m.defaults={},l(m.prototype,{spin:function(e){this.stop();var t,n,i=this,o=i.opts,a=i.el=s(r(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),l=o.radius+o.length+o.width;if(e&&(e.insertBefore(a,e.firstChild||null),n=u(e),t=u(a),s(a,{left:("auto"==o.left?n.x-t.x+(e.offsetWidth>>1):parseInt(o.left,10)+l)+"px",top:("auto"==o.top?n.y-t.y+(e.offsetHeight>>1):parseInt(o.top,10)+l)+"px"})),a.setAttribute("aria-role","progressbar"),i.lines(a,i.opts),!c){var d=0,f=o.fps,p=f/o.speed,h=(1-o.opacity)/(p*o.trail/100),m=p/o.lines;(function g(){d++;for(var e=o.lines;e;e--){var t=Math.max(1-(d+e*m)%p*h,o.opacity);i.opacity(a,o.lines-e,t,o)}i.timeout=i.el&&setTimeout(g,~~(1e3/f))})()}return i},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=n),this},lines:function(e,t){function n(e,n){return s(r(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*l+t.rotate)+"deg) translate("+t.radius+"px"+",0)",borderRadius:(t.corners*t.width>>1)+"px"})}for(var a,l=0;t.lines>l;l++)a=s(r(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:c&&o(t.opacity,t.trail,l,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&i(a,s(n("#000","0 0 4px #000"),{top:"2px"})),i(e,i(a,n(t.color,"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){e.childNodes.length>t&&(e.childNodes[t].style.opacity=n)}}),function(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}var t=s(r("group"),{behavior:"url(#default#VML)"});!a(t,"transform")&&t.adj?(p.addRule(".spin-vml","behavior:url(#default#VML)"),m.prototype.lines=function(t,n){function r(){return s(e("group",{coordsize:u+" "+u,coordorigin:-l+" "+-l}),{width:u,height:u})}function o(t,o,a){i(d,i(s(r(),{rotation:360/n.lines*t+"deg",left:~~o}),i(s(e("roundrect",{arcsize:n.corners}),{width:l,height:n.width,left:n.radius,top:-n.width>>1,filter:a}),e("fill",{color:n.color,opacity:n.opacity}),e("stroke",{opacity:0}))))}var a,l=n.length+n.width,u=2*l,c=2*-(n.width+n.length)+"px",d=s(r(),{position:"absolute",top:c,left:c});if(n.shadow)for(a=1;n.lines>=a;a++)o(a,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(a=1;n.lines>=a;a++)o(a);return i(t,d)},m.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&i.childNodes.length>t+r&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}):c=a(t,"animation")}(),"function"==typeof define&&define.amd?define(function(){return m}):e.Spinner=m}(window,document)}(),function(){Setting=FormModel.extend({blankSchema:{requireViewInvite:!1,requirePostInvite:!1,requirePostsApproval:!1,scoreUpdateInterval:"",postInterval:"",commentInterval:"",maxPostsPerDay:"",title:"",tagline:"",logoUrl:"",logoHeight:"",logoWidth:"",defaultEmail:"",newPostsNotifications:!0,backgroundColor:"",secondaryColor:"",buttonColor:"",headerColor:"",googleAnalyticsId:"",mixpanelId:"",clickyId:"",goSquaredId:"",embedlyId:"",footerCode:"",extraCode:"",notes:""},init:function(e){this._super(Settings,e),this.overwriteTitle("scoreUpdateInterval","Scoring Frequency"),this.overwriteTitle("requireViewInvite","Require Invite to view?"),this.overwriteTitle("requirePostInvite","Require Invite to post?"),this.overwriteTitle("requirePostsApproval","Posts must be approved by admin?"),this.overwriteTitle("title","Site Title"),this.overwriteTitle("mixpanelId",'<a href="http://mixpanel.com/">Mixpanel</a> ID'),this.overwriteTitle("clickyId",'<a href="http://getclicky.com/">Clicky</a> ID'),this.overwriteTitle("goSquaredId",'<a href="http://gosquared.com/">GoSquared</a> ID'),this.overwriteTitle("logoUrl","Logo URL"),this.overwriteType("footerCode","textarea"),this.overwriteType("extraCode","textarea"),this.overwriteType("notes","textarea")}})}(),function(){Session.set("initialLoad",!0),Session.set("currentDate",new Date),Session.set("categorySlug",null),l=function(e){console.log(e)},getSetting=function(e){var t=Settings.find().fetch()[0];return t?t[e]:""},clearSeenErrors=function(){Errors.update({seen:!0},{$set:{show:!1}},{multi:!0})},Meteor.subscribe("settings",function(){analyticsInit(),Session.set("settingsLoaded",!0)}),Meteor.subscribe("categories"),Meteor.subscribe("currentUser"),Meteor.subscribe("allUsers"),null!=Meteor.userId()&&Meteor.subscribe("notifications"),Meteor.autorun(function(){Meteor.subscribe("singlePost",Session.get("selectedPostId"))}),Meteor.autorun(function(){Meteor.subscribe("singlePost",Session.get("selectedPostId"))}),STATUS_PENDING=1,STATUS_APPROVED=2,STATUS_REJECTED=3,postListSubscription=function(e,t,n){var r=Meteor.subscribeWithPagination("paginatedPosts",e,t,n);return r.fetch=function(){var n=_.isFunction(e)?e():e;return limitDocuments(Posts.find(n,t),r.loaded())},r},selectTop=function(){return selectPosts({name:"top",status:STATUS_APPROVED,slug:Session.get("categorySlug")})},selectNew=function(){return selectPosts({name:"new",status:STATUS_APPROVED,slug:Session.get("categorySlug")})},selectBest=function(){return selectPosts({name:"best",status:STATUS_APPROVED,slug:Session.get("categorySlug")})},selectPending=function(){return selectPosts({name:"pending",status:STATUS_PENDING,slug:Session.get("categorySlug")})},topPostsHandle=postListSubscription(selectTop,sortPosts("score"),10),newPostsHandle=postListSubscription(selectNew,sortPosts("submitted"),10),bestPostsHandle=postListSubscription(selectBest,sortPosts("baseScore"),10),pendingPostsHandle=postListSubscription(selectPending,sortPosts("createdAt"),10),Meteor.autorun(function(){digestHandle=Meteor.subscribe("postDigest",Session.get("currentDate"))}),Session.set("selectedPostId",null),Meteor.autosubscribe(function(){var e={$or:[{post:Session.get("selectedPostId")},{_id:Session.get("selectedCommentId")}]};Meteor.subscribe("comments",e,function(){Session.set("commentReady",!0)})})}(),function(){Template.body.helpers({pageName:function(){return Meteor.Router.page()},backgroundColor:function(){return getSetting("backgroundColor")},secondaryColor:function(){return getSetting("secondaryColor")},buttonColor:function(){return getSetting("buttonColor")},headerColor:function(){return getSetting("headerColor")},extraCode:function(){return getSetting("extraCode")}}),Template.body.created=function(){Session.set("currentScroll",null)},Template.body.rendered=function(){(currentScroll=Session.get("currentScroll"))&&($("body").scrollTop(currentScroll),Session.set("currentScroll",null))}}(),function(){Categories=new Meteor.Collection("categories"),Meteor.methods({category:function(e){var t=Meteor.user();if(!t||!isAdmin(t))throw new Meteor.Error("You need to login and be an admin to add a new category.");return Categories.insert(e),e.name}})}(),function(){Comments=new Meteor.Collection("comments"),Meteor.methods({comment:function(e,t,n){var r=Meteor.user(),i=Posts.findOne(e),o=Meteor.users.findOne(i.userId),a=timeSinceLast(r,Comments),s=cleanUp(n),l=Math.abs(parseInt(getSetting("commentInterval")))||15,u={commentAuthorId:r._id,commentAuthorName:getDisplayName(r),commentExcerpt:trimWords(stripMarkdown(s),20),postId:e,postHeadline:i.headline};if(!r||!canPost(r))throw new Meteor.Error("You need to login or be invited to post new comments.");if(!this.isSimulation&&l>a)throw new Meteor.Error(704,"Please wait "+(l-a)+" seconds before commenting again");var c={post:e,body:s,userId:r._id,submitted:(new Date).getTime(),author:getDisplayName(r)};t&&(c.parent=t);var d=Comments.insert(c);if(Posts.update(e,{$inc:{comments:1}}),Meteor.call("upvoteComment",d),u.commentId=d,!this.isSimulation)if(t){var f=Comments.findOne(t),p=Meteor.users.findOne(f.userId);u.parentCommentId=t,u.parentAuthorId=f.userId,u.parentAuthorName=getDisplayName(p),p._id!=r._id&&Meteor.call("createNotification","newReply",u,p,r),o._id!=r._id&&f.userId!=i.userId&&Meteor.call("createNotification","newComment",u,o,r)}else o._id!=r._id&&Meteor.call("createNotification","newComment",u,o,Meteor.user());return u},removeComment:function(e){var t=Comments.findOne(e);Posts.update(t.post,{$inc:{comments:-1}}),Comments.remove(e)}})}(),function(){Meteor.isClient&&(Errors=new Meteor.Collection(null)),throwError=function(e,t){t=t===void 0?"error":t,Errors.insert({message:e,type:t,seen:!1,show:!0})}}(),function(){Notifications=new Meteor.Collection("notifications"),getNotification=function(e,t,n){var r={},n=n===void 0?"sidebar":n,i=t;switch(e){case"newReply":r.subject='Someone replied to your comment on "'+i.postHeadline+'"',r.text=i.commentAuthorName+' has replied to your comment on "'+i.postHeadline+'": '+getPostCommentUrl(i.postId,i.commentId),r.html='<p><a href="'+getUserUrl(i.commentAuthorId)+'">'+i.commentAuthorName+'</a> has replied to your comment on "<a href="'+getPostCommentUrl(i.postId,i.commentId)+'" class="action-link">'+i.postHeadline+'</a>"</p>',"email"===n&&(r.html+="<p>"+i.commentExcerpt+'</p><a href="'+getPostCommentUrl(i.postId,i.commentId)+'" class="action-link">Read more</a>');break;case"newComment":r.subject='A new comment on your post "'+i.postHeadline+'"',r.text="You have a new comment by "+i.commentAuthorName+' on your post "'+i.postHeadline+'": '+getPostCommentUrl(i.postId,i.commentId),r.html='<p><a href="'+getUserUrl(i.commentAuthorId)+'">'+i.commentAuthorName+'</a> left a new comment on your post "<a href="'+getPostCommentUrl(i.postId,i.commentId)+'" class="action-link">'+i.postHeadline+'</a>"</p>',"email"===n&&(r.html+="<p>"+i.commentExcerpt+'</p><a href="'+getPostCommentUrl(i.postId,i.commentId)+'" class="action-link">Read more</a>');break;case"newPost":r.subject=i.postAuthorName+' has created a new post: "'+i.postHeadline+'"',r.text=i.postAuthorName+' has created a new post: "'+i.postHeadline+'" '+getPostUrl(i.postId),r.html='<a href="'+getUserUrl(i.postAuthorId)+'">'+i.postAuthorName+'</a> has created a new post: "<a href="'+getPostUrl(i.postId)+'" class="action-link">'+i.postHeadline+'</a>".';break;case"accountApproved":r.subject="Your account has been approved.",r.text="Welcome to "+getSetting("title")+"! Your account has just been approved.",r.html="Welcome to "+getSetting("title")+'!<br/> Your account has just been approved. <a href="'+Meteor.absoluteUrl()+'">Start posting.</a>';break;default:}return r},Meteor.methods({markAllNotificationsAsRead:function(){Notifications.update({userId:Meteor.userId()},{$set:{read:!0}},{multi:!0})}})}(),function(){Posts=new Meteor.Collection("posts"),STATUS_PENDING=1,STATUS_APPROVED=2,STATUS_REJECTED=3,Meteor.methods({post:function(e){var t=cleanUp(e.headline),n=cleanUp(e.body),r=Meteor.user(),i=e.userId||r._id,o=parseInt(e.submitted)||(new Date).getTime(),a=getSetting("requirePostsApproval")?STATUS_PENDING:STATUS_APPROVED,s=e.status||a,l=Posts.findOne({url:e.url}),u=timeSinceLast(r,Posts),c=numberOfItemsInPast24Hours(r,Posts),d=Math.abs(parseInt(getSetting("postInterval")))||30,f=Math.abs(parseInt(getSetting("maxPostsPerDay")))||30,p="";if(!r||!canPost(r))throw new Meteor.Error(601,"You need to login or be invited to post new stories.");if(!e.headline)throw new Meteor.Error(602,"Please fill in a headline");if(e.url&&l)throw Meteor.call("upvotePost",l._id),new Meteor.Error(603,"This link has already been posted",l._id);if(!isAdmin(Meteor.user())){if(!this.isSimulation&&d>u)throw new Meteor.Error(604,"Please wait "+(d-u)+" seconds before posting again");if(!this.isSimulation&&c>f)throw new Meteor.Error(605,"Sorry, you cannot submit more than "+f+" posts per day")}e=_.extend(e,{headline:t,body:n,userId:i,author:getDisplayNameById(i),createdAt:(new Date).getTime(),votes:0,comments:0,baseScore:0,score:0,inactive:!1,status:s}),s==STATUS_APPROVED&&(e.submitted=o),Posts.insert(e,function(e,t){t&&(p=t)});var h=Meteor.users.findOne(e.userId);if(Meteor.call("upvotePost",p,h),getSetting("newPostsNotifications")){var m={postAuthorName:getDisplayName(h),postAuthorId:e.userId,postHeadline:t,postId:p},g=getNotification("newPost",m);Meteor.call("notifyAdmins",g,Meteor.user(),function(){})}return e.postId=p,e},post_edit:function(){}})}(),function(){Settings=new Meteor.Collection("settings")}();